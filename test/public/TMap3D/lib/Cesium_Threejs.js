!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CesiumMeshVisualizerDemo=e()}(function(){var define,module,exports;return function n(i,a,o){function s(t,e){if(!a[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=a[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,a,o)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<o.length;e++)s(o[e]);return s}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function g(e,t,r,n,i){var a;S&&(t=Cesium.Cartesian3.fromDegrees(e,t),t=Cesium.Transforms.eastNorthUpToFixedFrame(t),(a=S.camera).constrainedAxis=Cesium.Cartesian3.UNIT_Z,a.lookAtTransform(t,new Cesium.Cartesian3(r,n,i)),setTimeout(function(){a.lookAtTransform(Cesium.Matrix4.IDENTITY)},100))}Object.defineProperty(r,"__esModule",{value:!0}),r.BuildingVector3DLoader=r.GeometryUtils=r.CameraUtils=r.RendererUtils=r.MeshVisModel=r.PostProcessLib=r.Object3D=r.Mesh=r.MeshMaterial=r.MeshPhongMaterial=r.PagedLOD=r.QuadtreeLOD=r.QuadtreeLODUtil=r.ExtrudeGradientMaterial=r.GeometricPointLights=r.LineGlowMaterial=r.VectorPolylineGeometry=r.VectorPolygonGeometry=r.GroundLineVisualizer=r.author=void 0,r.initCesium=function(e,t,r,n,i,a,o,s,u,l,c){l&&b.Cesium3DTileExtension.init();var d=Cesium,f=(d.ProviderViewModel,d.Cartesian3),h=d.Matrix4,p=d.Camera,l=d.Rectangle,m=(d.Viewer,d.WebMapTileServiceImageryProvider,r);return x.default.DefaultDracoDecoderPath="./js/libs/draco/gltf/",u="boolean"!=typeof u||u,a=a||[100,30,1e3],A={inverseMatrix:h.IDENTITY.clone(),matrix:h.IDENTITY.clone()},p.DEFAULT_VIEW_RECTANGLE=l.fromDegrees(70,-1,140,70),(S=e).scene.postProcessStages.fxaa.enabled=!0,null==a[3]?a[2]:a[3],null==a[4]?a[2]:a[4],null==a[5]?a[2]:a[5],(E=new _.default({position:f.fromDegrees(a[0],a[1],o||0)})).init(S.scene.frameState),S.scene.primitives.add(E),C=E.renderer,m&&E.add(m),E.beforeUpdate.addEventListener(function(){m&&(E.fog=m.fog,u&&(E.background=m.background),m.traverse(function(e){e.frustumCulled=!1,s&&!f.equals(s,e.up)&&e.up.copy(f["UNIT_"+s])})),n&&C.copy(n),t&&(y.default.yUp2Zup(E.modelMatrix,A.matrix),h.inverse(A.matrix,A.inverseMatrix),c&&c.useCemera3js?v.default.fromPerspectiveCamera3js(t,S.camera,S.scene,A):v.default.toPerspectiveCamera3js(S.camera,t,A),t._referenceFrame=A),i&&i()}),{look:g,visualizer:E,viewer:S,mRenderer:C,referenceFrame:A,updateScene3js:function(e){m&&E.remove(m),m=e,E.add(m)}}},r.readRenderTarget=function(e,t,r,n){n=(n="string"==typeof n?document.getElementById(n):n)||document.createElement("canvas");var i=4;1022==t.texture.format&&(i=3);var a=new Uint8Array(t.width*t.height*i);e.readRenderTargetPixels(t,0,0,t.width,t.height,a,r),(r=n).width=t.width,r.height=t.height;var o=(t=r.getContext("2d")).getImageData(0,0,r.width,r.height);if(4==i)o.data.set(a);else for(var s=0,u=0;s<o.data.length;s+=4,u+=i){for(var l=0;l<i;l++)o.data[s+l]=a[u+l];o.data[s+3]=255}return t.putImageData(o,0,0),n};var _=n(e("M_0")),v=n(e("e_1")),i=(n(e("s_2")),e("h_3")),y=n(i),b=e("-_4"),x=n(e("3_5")),a=n(e("d_6")),o=n(e("__7")),s=e("M_8"),u=e("i_9"),l=e("k_10"),c=e("e_11"),d=e("s_12"),f=n(e("W_13")),h=n(e("e_14")),p=n(e("i_15")),m=n(e("M_16")),M=n(e("e_17")),w=e("s_18"),T=n(e("h_19")),i=n(e("-_20")),e=n(e("3_21"));console.log(),console.log();var S=void(r.author={}),E=void 0,C=void 0,A=void 0;r.GroundLineVisualizer=e.default,r.VectorPolygonGeometry=i.default,r.VectorPolylineGeometry=w.VectorPolylineGeometry,r.LineGlowMaterial=T.default,r.GeometricPointLights=M.default,r.ExtrudeGradientMaterial=m.default,r.QuadtreeLODUtil=p.default,r.QuadtreeLOD=h.default,r.PagedLOD=f.default,r.MeshPhongMaterial=d.MeshPhongMaterial,r.MeshMaterial=c.MeshMaterial,r.Mesh=l.Mesh,r.Object3D=u.Object3D,r.PostProcessLib=s.PostProcessLib,r.MeshVisModel=x.default,r.RendererUtils=y.default,r.CameraUtils=v.default,r.GeometryUtils=a.default,r.BuildingVector3DLoader=o.default},{"-_4":3,e_1:7,d_6:11,k_10:15,e_11:22,s_12:23,M_0:24,h_3:27,s_2:72,i_9:179,"-_20":182,s_18:183,M_16:184,h_19:185,"3_5":186,M_8:192,__7:193,e_17:194,"3_21":195,W_13:198,e_14:201,i_15:202}],2:[function(e,t,r){"use strict";function x(e,t,r,n,i,a){var o;f||(f=!0,o=Cesium,M=o.Cartesian3,s=o.Color,w=o.ComponentDatatype,T=o.defaultValue,S=o.defined,u=o.deprecationWarning,l=o.destroyObject,c=o.DeveloperError,E=o.getStringFromTypedArray,C=o.Matrix4,A=o.RuntimeError,O=o.Cesium3DTileBatchTable,d=o.Cesium3DTileFeature,L=o.Cesium3DTileFeatureTable,x._deprecationWarning=u),this._tileset=e,this._tile=t,this._resource=r,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,this._visualizer=a,function(e,t,r,n){var i=e._tileset,a=e._tile,o=e._resource,s=T(r,0);r=s;var u=new Uint8Array(t),l=new DataView(t);r+=I;var c=l.getUint32(r,!0);if(1!==c)throw new A("Only Batched 3D Model version 1 is supported.  Version "+c+" is not.");r+=I;var d=l.getUint32(r,!0);r+=I;var f=l.getUint32(r,!0);r+=I;var h=l.getUint32(r,!0);r+=I;var p=l.getUint32(r,!0);r+=I;var m,g,c=l.getUint32(r,!0);r+=I,570425344<=p?(r-=2*I,m=f,p=h,h=f=c=0,x._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):570425344<=c&&(r-=I,m=p,p=f,c=h,h=f=0,x._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")),0===f?g={BATCH_LENGTH:T(m,0)}:(l=E(u,r,f),g=JSON.parse(l),r+=f);f=new Uint8Array(t,r,h);r+=h;var _,f=new L(g,f);{var v;m=f.getGlobalProperty("BATCH_LENGTH"),f.featuresLength=m,0<p&&(v=E(u,r,p),v=JSON.parse(v),r+=p,0<c&&(_=new Uint8Array(t,r,c),_=new Uint8Array(_),r+=c))}S(i.classificationType)&&(y=function(r){return function(e,t){r._model.updateCommands(e,t)}}(e));var y=new O(e,m,v,_,y);e._batchTable=y;d=s+d-r;if(0==d)throw new A("glTF byte length must be greater than 0.");r=r%4==0?new Uint8Array(t,r,d):(x._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),new Uint8Array(u.subarray(r,r+d)));d={content:e,primitive:i};e._rtcCenterTransform=C.IDENTITY;f=f.getGlobalProperty("RTC_CENTER",w.FLOAT,3);S(f)&&(e._rtcCenterTransform=C.fromTranslation(M.fromArray(f))),e._contentModelMatrix=C.multiply(a.computedTransform,e._rtcCenterTransform,new C);try{var b=Cesium;e._model=new P.default({dracoDecoderPath:P.default.DefaultDracoDecoderPath,gltf:r,visualizer:n,cull:!1,releaseGltfJson:!0,opaquePass:4,basePath:o,requestType:b.RequestType.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:i._gltfUpAxis,forwardAxis:b.Axis.X,shadows:i.shadows,debugWireframe:i.debugWireframe,incrementallyLoadTextures:!1,pickObject:d,imageBasedLightingFactor:i.imageBasedLightingFactor,lightColor:i.lightColor,luminanceAtZenith:i.luminanceAtZenith,sphericalHarmonicCoefficients:i.sphericalHarmonicCoefficients,specularEnvironmentMaps:i.specularEnvironmentMaps})}catch(e){throw console.error(e),e}}(this,n,i,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.Batched3DModel3DTileContentEx=void 0;var M,s,w,T,S,u,l,c,E,C,A,O,d,L,e=e("d_22"),P=e&&e.__esModule?e:{default:e},f=!1;x._deprecationWarning=u,Object.defineProperties(x.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var I=Uint32Array.BYTES_PER_ELEMENT;x.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},x.prototype.getFeature=function(e){var t=this.featuresLength;if(!S(e)||e<0||t<=e)throw new c("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!S(e._features)&&0<t){for(var r=new Array(t),n=0;n<t;++n)r[n]=new d(e,n);e._features=r}}(this),this._features[e]},x.prototype.applyDebugSettings=function(e,t){t=e?t:s.WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)},x.prototype.applyStyle=function(e){var t,r,n;0===this.featuresLength?(t=S(e)&&S(e.color),r=S(e)&&S(e.show),(n=this._model).color=t?e.color.evaluateColor(void 0,n.color):s.clone(s.WHITE,n.color),n.show=!r||e.show.evaluate(void 0)):this._batchTable.applyStyle(e)},x.prototype.update=function(e,t){this._batchTable.update(e,t),this._contentModelMatrix=C.multiply(this._tile.computedTransform,this._rtcCenterTransform,this._contentModelMatrix);var r=this._model,e=this._tileset;r.modelMatrix=this._contentModelMatrix,r.shadows=e.shadows,r.imageBasedLightingFactor=e.imageBasedLightingFactor,r.lightColor=e.lightColor,r.luminanceAtZenith=e.luminanceAtZenith,r.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,r.specularEnvironmentMaps=e.specularEnvironmentMaps,r.debugWireframe=e.debugWireframe,this._model.update(t)},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),this._visualizer=null,l(this)},r.Batched3DModel3DTileContentEx=x},{d_22:186}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Cesium3DTileExtension=void 0;var s=e("__23"),u=e("M_24"),e={init:function(){var e=Cesium,o=e.Cesium3DTileContentFactory;e.Cesium3DTileset.prototype.render=function(e,t){this.__frameNumber!=e.frameNumber&&this.update(e),this.__frameNumber=e.frameNumber;for(var r=0;r<this._selectedTiles.length;r++){var n=this._selectedTiles[r].content;n&&(n._contents&&Array.isArray(n._contents)?n._contents.forEach(function(e){e=e._model||e._modelInstanceCollection;e&&e.isMeshVisModel&&(t.push(e.root),0)}):(n=n._model||n._modelInstanceCollection)&&n.isMeshVisModel&&(t.push(n.root),0))}},o._b3dm=o.b3dm,o.b3dm=function(e,t,r,n,i){var a=e.visualizer;return a?new s.Batched3DModel3DTileContentEx(e,t,r,n,i,a):o._b3dm(e,t,r,n,i)},o._i3dm=o.i3dm,o.i3dm=function(e,t,r,n,i){var a=e.visualizer;return a?new u.Instanced3DModel3DTileContentEx(e,t,r,n,i,a):o._i3dm(e,t,r,n,i)}}};r.Cesium3DTileExtension=e},{__23:2,M_24:4}],4:[function(e,t,r){"use strict";function V(e,t,r,n,i,a){var o;f||(f=!0,o=Cesium,F=o.AttributeCompression,G=o.Cartesian3,s=o.Color,z=o.ComponentDatatype,W=o.defaultValue,H=o.defined,u=o.deprecationWarning,l=o.destroyObject,c=o.DeveloperError,Y=o.Ellipsoid,X=o.getStringFromTypedArray,q=o.Matrix3,K=o.Matrix4,Z=o.Quaternion,J=o.RequestType,Q=o.RuntimeError,$=o.Transforms,ee=o.TranslationRotationScale,o.Pass,te=o.Axis,re=o.Cesium3DTileBatchTable,d=o.Cesium3DTileFeature,ne=o.Cesium3DTileFeatureTable),this._tileset=e,this._tile=t,this._resource=r,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._visualizer=a,function(e,t,r,n){var i=W(r,0);r=i;var a=new Uint8Array(t),o=new DataView(t);r+=ae;var s=o.getUint32(r,!0);if(1!==s)throw new Q("Only Instanced 3D Model version 1 is supported. Version "+s+" is not.");r+=ae;var u=o.getUint32(r,!0);r+=ae;var l=o.getUint32(r,!0);if(0===l)throw new Q("featureTableJsonByteLength is zero, the feature table must be defined.");r+=ae;var c=o.getUint32(r,!0);r+=ae;var d=o.getUint32(r,!0);r+=ae;var f=o.getUint32(r,!0);r+=ae;s=o.getUint32(r,!0);if(1!==s&&0!==s)throw new Q("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+s+" is not.");o=X(a,r+=ae,l),o=JSON.parse(o);r+=l;l=new Uint8Array(t,r,c);r+=c;var h,p=new ne(o,l),m=p.getGlobalProperty("INSTANCES_LENGTH");if(p.featuresLength=m,!H(m))throw new Q("Feature table global property: INSTANCES_LENGTH must be defined");{var g;0<d&&(g=X(a,r,d),g=JSON.parse(g),r+=d,0<f&&(h=new Uint8Array(t,r,f),h=new Uint8Array(h),r+=f))}e._batchTable=new re(e,m,g,h);u=i+u-r;if(0==u)throw new Q("glTF byte length is zero, i3dm must have a glTF to instance.");r=r%4==0?new Uint8Array(t,r,u):(V._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),new Uint8Array(a.subarray(r,r+u)));u=e._tileset,u={dracoDecoderPath:ie.default.DefaultDracoDecoderPath,visualizer:n,instances:new Array(m),instancedAttributes:[{name:"batchId",default:0}],batchTable:e._batchTable,cull:!1,url:void 0,requestType:J.TILES3D,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,upAxis:u._gltfUpAxis,forwardAxis:te.X,opaquePass:4,imageBasedLightingFactor:u.imageBasedLightingFactor,lightColor:u.lightColor,luminanceAtZenith:u.luminanceAtZenith,sphericalHarmonicCoefficients:u.sphericalHarmonicCoefficients,specularEnvironmentMaps:u.specularEnvironmentMaps};0===s?(s=(s=X(r)).replace(/[\s\0]+$/,""),u.url=e._resource.getDerivedResource({url:s})):(u.gltf=r,u.basePath=e._resource.clone());var _,v=p.getGlobalProperty("EAST_NORTH_UP"),r=p.getGlobalProperty("RTC_CENTER",z.FLOAT,3);H(r)&&(_=G.unpack(r));for(var y=u.instances,b=new G,x=new Array(3),M=new G,w=new G,T=new G,S=new q,E=new Z,C=new G,A=new ee,O=new K,L=0;L<m;L++){var P=p.getProperty("POSITION",z.FLOAT,3,L,oe);if(!H(P)){P=x;var I=p.getProperty("POSITION_QUANTIZED",z.UNSIGNED_SHORT,3,L,oe);if(!H(I))throw new Q("Either POSITION or POSITION_QUANTIZED must be defined for each instance.");var R=p.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",z.FLOAT,3);if(!H(R))throw new Q("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var D=p.getGlobalProperty("QUANTIZED_VOLUME_SCALE",z.FLOAT,3);if(!H(D))throw new Q("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var U=0;U<3;U++)P[U]=I[U]/65535*D[U]+R[U]}G.unpack(P,0,b),H(_)&&G.add(b,_,b),A.translation=b;var N=p.getProperty("NORMAL_UP",z.FLOAT,3,L,oe),B=p.getProperty("NORMAL_RIGHT",z.FLOAT,3,L,se),k=!1;if(H(N)){if(!H(B))throw new Q("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");G.unpack(N,0,w),G.unpack(B,0,M),k=!0}else{var B=p.getProperty("NORMAL_UP_OCT32P",z.UNSIGNED_SHORT,2,L,oe),j=p.getProperty("NORMAL_RIGHT_OCT32P",z.UNSIGNED_SHORT,2,L,se);if(H(B)){if(!H(j))throw new Q("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");F.octDecodeInRange(B[0],B[1],65535,w),F.octDecodeInRange(j[0],j[1],65535,M),k=!0}else v?($.eastNorthUpToFixedFrame(b,Y.WGS84,O),K.getMatrix3(O,S)):q.clone(q.IDENTITY,S)}k&&(G.cross(M,w,T),G.normalize(T,T),q.setColumn(S,0,M,S),q.setColumn(S,1,w,S),q.setColumn(S,2,T,S)),Z.fromRotationMatrix(S,E),A.rotation=E,C=G.fromElements(1,1,1,C);j=p.getProperty("SCALE",z.FLOAT,1,L);H(j)&&G.multiplyByScalar(C,j,C);k=p.getProperty("SCALE_NON_UNIFORM",z.FLOAT,3,L,oe);H(k)&&(C.x*=k[0],C.y*=k[1],C.z*=k[2]),A.scale=C;j=p.getProperty("BATCH_ID",z.UNSIGNED_SHORT,1,L);H(j)||(j=L),K.fromTranslationRotationScale(A,O);k=O.clone();y[L]={modelMatrix:k,batchId:j}}e._modelInstanceCollection=new ie.default(u)}(this,n,i,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.Instanced3DModel3DTileContentEx=void 0;var F,G,s,z,W,H,u,l,c,Y,X,q,K,Z,J,Q,$,ee,te,re,d,ne,e=e("d_22"),ie=e&&e.__esModule?e:{default:e},f=!1;V._deprecationWarning=u,Object.defineProperties(V.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;return H(e)?e.trianglesLength:0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;return H(e)?e.geometryByteLength:0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;return H(e)?e.texturesByteLength:0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var ae=Uint32Array.BYTES_PER_ELEMENT,oe=new Array(4),se=new Array(4);V.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},V.prototype.getFeature=function(e){var t=this.featuresLength;if(!H(e)||e<0||t<=e)throw new c("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!H(e._features)&&0<t){for(var r=new Array(t),n=0;n<t;++n)r[n]=new d(e,n);e._features=r}}(this),this._features[e]},V.prototype.applyDebugSettings=function(e,t){t=e?t:s.WHITE,this._batchTable.setAllColor(t)},V.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)},V.prototype.update=function(e,t){this._batchTable.update(e,t);t=this._modelInstanceCollection,e=this._tileset;t.modelMatrix=this._tile.computedTransform,t.shadows=e.shadows,t.lightColor=e.lightColor,t.luminanceAtZenith=e.luminanceAtZenith,t.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,t.specularEnvironmentMaps=e.specularEnvironmentMaps,t.debugWireframe=e.debugWireframe},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),this._visualizer=null,l(this)},r.Instanced3DModel3DTileContentEx=V},{d_22:186}],5:[function(e,t,r){"use strict";function n(e){var t=Cesium.defaultValue;e=t(e,{}),this.length=t(e.length,5e4),this.width=t(e.width,125),this.headLength=t(e.headLength,5e3),this.headWidth=t(e.headWidth,1e3),this.reverse=t(e.reverse,!1)}Object.defineProperty(r,"__esModule",{value:!0}),r.ArrowGeometry=void 0;var e=e("k_26"),s=e&&e.__esModule?e:{default:e};n.createGeometry=function(e){var t,r=e.length,n=e.width,i=e.headLength,a=e.headWidth,o=e.reverse,e=Cesium.CylinderGeometry,n=e.createGeometry(new e({length:r,topRadius:n,bottomRadius:n}));return o?(t=e.createGeometry(new e({length:i,topRadius:a,bottomRadius:0})),s.default.translate(t,[0,0,-(r+i)/2])):(t=e.createGeometry(new e({length:i,topRadius:0,bottomRadius:a})),s.default.translate(t,[0,0,(r+i)/2])),s.default.mergeGeometries([n,t])},r.ArrowGeometry=n},{k_26:11}],6:[function(e,t,r){"use strict";function n(e){e=e||{};var t=Cesium,r=t.defaultValue,n=t.defined,t=(t.WebGLConstants,e.uniforms);(t=t||{ambientColor:[0,0,0,1],emissionColor:[0,0,0,1],diffuseColor:[0,0,0,1],specularColor:[0,0,0,1],specularShininess:0,alpha:void 0,ambientColorMap:void 0,emissionColorMap:void 0,diffuseColorMap:void 0,specularColorMap:void 0,specularShininessMap:void 0,normalMap:void 0,alphaMap:void 0}).ambientColor=r(t.ambientColor,[0,0,0,1]),t.emissionColor=r(t.emissionColor,[0,0,0,1]),t.diffuseColor=r(t.diffuseColor,[0,0,0,1]),t.specularColor=r(t.specularColor,[0,0,0,1]),t.alpha=r(t.alpha,1),t.specularShininess=r(t.specularShininess,0),e.side=r(e.side,a.MeshMaterial.Sides.FRONT),e.uniforms=t,a.MeshMaterial.call(this,e),this.blendEnable=!1;r=e.withTexture,e=e.withNormals;this.depthTest=!0,this.depthMask=!0,this.blending=!0,t.diffuseColorMap?("string"==typeof t.diffuseColorMap?(i=t.diffuseColorMap.toLowerCase(),".tif"!=(t=s.Path.GetExtension(i))&&".png"!=t&&"data:image/png"!==i.slice(0,"data:image/png".length)&&"data:image/tif"!==i.slice(0,"data:image/tif".length)||(this.translucent=!0)):(i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement)&&(this.translucent=!0),r=!0,n(this.uniforms.diffuseColorMap.flipY)||(this.uniforms.diffuseColorMap.flipY=!1),this.uniforms.diffuseColorMap.sampler||(this.uniforms.diffuseColorMap.sampler={magnificationFilter:9729,minificationFilter:9986,wrapS:10497,wrapT:10497})):r=!1;var i=null,n=null,n=r&&e?(i=o.default.texture_normals_vert,o.default.texture_normals_frag):r&&!e?(i=o.default.texture_vert,o.default.texture_frag):!r&&e?(i=o.default.normals_vert,o.default.normals_frag):(i=o.default.none_vert,o.default.none_frag);this.vertexShader=i,this.fragmentShader=n}Object.defineProperty(r,"__esModule",{value:!0}),r.BasicMeshMaterial=void 0;var a=e("e_27"),i=e("s_28"),o=i&&i.__esModule?i:{default:i},s=e("W_29");n.prototype=Object.create(a.MeshMaterial.prototype),r.BasicMeshMaterial=n},{W_29:169,e_27:22,s_28:30}],7:[function(e,t,r){"use strict";function o(e,t,r){var n=Cesium,i=n.Matrix4,a=n.Cartesian3,o=(n.Matrix3,e.matrixWorld.elements),n=e.matrixWorldInverse.elements;d||(d=new i,f=new i,l=new a,c=new a),r&&r.matrix?(e.modelMatrix=i.multiply(r.matrix,o,e.modelMatrix||new i),i.clone(e.modelMatrix,f),i.inverse(e.modelMatrix,d)):(i.clone(n,d),i.clone(o,f)),i.getTranslation(f,l),!e.isOrthographicCamera&&a.equals(a.ZERO,l)||(i.multiplyByPoint(f,p,c),a.subtract(c,l,c),l.clone(t.position),c.clone(t.direction)),i.clone(d,t.viewMatrix),i.clone(f,t.inverseViewMatrix),i.equals(t.frustum.projectionMatrix,e.projectionMatrix.elements)?t.customCamera=void 0:((a=t.customCamera||{}).projectionMatrix=i.clone(e.projectionMatrix.elements,a.projectionMatrix),t.customCamera=a)}function s(e,t,r){var n,i=Cesium.Matrix4,a=t.matrixWorld,o=e.inverseViewMatrix;i.equals(o,t.modelMatrix)||(r?(r.inverseMatrix||(r.inverseMatrix=i.inverse(r.matrix)),a.multiplyMatrices(r.inverseMatrix,o)):a.copy(o),a.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(),t.modelMatrix=i.clone(o,t.modelMatrix),e.customCamera&&(n=e.customCamera).projectionMatrix&&(t.projectionMatrix.copy(n.projectionMatrix),t.projectionMatrixInverse.invert(t.projectionMatrix)),u(t))}function u(e){var t=a.get(e);t||(t=new THREE.Frustum,a.set(e,t));e=e,(n=n||new THREE.Matrix4).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),e=n;t.setFromProjectionMatrix(e)}Object.defineProperty(r,"__esModule",{value:!0});var l,c,n,d,f,i=function(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e},h=new WeakMap,a=new WeakMap,p={x:0,y:1,z:0},i=(i(m,null,[{key:"getMirrorCamera",value:function(e,t,r,n){e instanceof Cesium.Camera&&(e=this.toPerspectiveCamera3js(e));var i=THREE,a=i.Vector3,o=i.Matrix4,s=i.PerspectiveCamera,u=new a,l=new a,c=new o,d=new a,i=new a,o=new a,a=new a,t={matrixWorld:t};return r=r||new s,u.setFromMatrixPosition(t.matrixWorld),l.setFromMatrixPosition(e.matrixWorld),c.extractRotation(t.matrixWorld),d.set(0,0,1),d.applyMatrix4(c),i.subVectors(u,l),i.reflect(d).negate(),i.add(u),c.extractRotation(e.matrixWorld),o.set(0,0,1),o.applyMatrix4(c),o.add(l),a.subVectors(u,o),a.reflect(d).negate(),a.add(u),r.position.copy(i),r.up.set(0,1,0),r.up.applyMatrix4(c),r.up.reflect(d),r.lookAt(a),r.updateMatrixWorld(),r.far=e.far,r.near=e.near,r.fov=e.fov,r.focus=e.focus,r.updateProjectionMatrix(),r.projectionMatrix.copy(e.projectionMatrix),r}},{key:"getCameraFromCache",value:function(e){return h.get(e)}},{key:"getFrustum3js",value:function(e){return e.isCamera||(e=h.get(e)),a.get(e)}},{key:"toPerspectiveCamera3js",value:function(e,t,r){r=r||e._referenceFrame;var n=e.frustum;return t||(h.has(e)?t=h.get(e):(t=new THREE.PerspectiveCamera,h.set(e,t))),t.aspect=n.aspectRatio,t.near=n.near,t.far=n.far,t.fov=Cesium.Math.toDegrees(n.fovy),t.updateProjectionMatrix(),s(e,t,r),t}},{key:"toOrthographicCamera3js",value:function(e,t,r){r=r||e._referenceFrame;var n=e.frustum;t||(h.has(e)?t=h.get(e):(t=new THREE.OrthographicCamera,h.set(e,t)));var i=e.frustum.width,a=i/n.aspectRatio;return t.right=i/2,t.left=-i/2,t.top=a/2,t.bottom=-a/2,t.near=n.near,t.far=n.far,t.updateProjectionMatrix(),s(e,t,r),t}},{key:"fromPerspectiveCamera3js",value:function(e,t,r,n){var i=Cesium;u(e),n=n||e._referenceFrame,t||(h.has(e)?t=h.get(e):((t=new i.Camera(r)).frustum.xOffset=0,t.frustum.yOffset=0,h.set(e,t)));r=t.frustum,i=i.Math.toRadians(e.fov);return r.aspectRatio=e.aspect,r.near=e.near,r.far=e.far,r.fov=2*Math.atan(Math.tan(.5*i)*r.aspectRatio),o(e,t,n),t}},{key:"fromOrthographicCamera3js",value:function(e,t,r,n){var i=Cesium,a=i.Camera,i=i.OrthographicFrustum;u(e),n=n||e._referenceFrame,t||(h.has(e)?t=h.get(e):((t=new a(r)).frustum=new i,h.set(e,t)));a=t.frustum,r=e.right-e.left,i=e.top-e.bottom;return a.aspectRatio=r/i,a.near=e.near||1e-16,a.far=e.far,a.width=r,o(e,t,n),t}}]),m);function m(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=i},{}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=!(r.default=function(){var e,t,r,n,i;a||"undefined"==typeof Cesium||(a=!0,t=(e=Cesium).Cartesian2,r=e.Quaternion,n=e.OrthographicFrustum,i=e.Camera,(e=e.Cartesian3).prototype.set=function(e,t,r){return this.x=e,this.y=t,this.z=r,this},e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},t.prototype.set=function(e,t){return this.x=e,this.y=t,this},t.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},r.prototype.set=function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},r.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},n.prototype.isOrthographicFrustum=!0,Object.defineProperties(i.prototype,{isOrthographicCamera:{get:function(){return 1==this.frustum.isOrthographicFrustum}}}))})},{}],9:[function(e,t,r){"use strict";function s(e){b||(m=Cesium,b=m.Cartesian2,m.Check,x=m.createGuid,M=m.defaultValue,w=m.defined,T=m.destroyObject,m.DeveloperError,m.Math,S=m.PixelFormat,m.WebGLConstants,m.ContextLimits,m.MipmapHint,m.PixelDatatype,E=m.Sampler,m.TextureMagnificationFilter,m.TextureMinificationFilter);var t=(e=M(e,M.EMPTY_OBJECT)).context,r=e.width,n=e.height,i=e.source;w(i)&&(w(r)||(r=M(i.videoWidth,i.width)),w(n)||(n=M(i.videoHeight,i.height)));var a=M(e.pixelFormat,6408),o=M(e.pixelDatatype,5121),s=a,u=S.isCompressedFormat(s);if(t.webgl2)if(34041===a?s=35056:6402===a&&(5123===o?s=33189:5125===o&&(s=33190)),5126===o)switch(a){case 6408:s=34836;break;case 6407:s=34837;break;case S.RG:s=33328;break;case S.R:s=33326}else if(36193===o)switch(a){case 6408:s=34842;break;case 6407:s=34843;break;case S.RG:s=33327;break;case S.R:s=33325}var l=e.preMultiplyAlpha||6407===a||6409===a,c=M(e.flipY,!0),d=!0,f=t._gl,h=f.TEXTURE_2D,p=f.createTexture();f.activeTexture(f.TEXTURE0),f.bindTexture(h,p);var m=4;w(i)&&w(i.arrayBufferView)&&!u&&(m=S.alignmentInBytes(a,o,r)),f.pixelStorei(f.UNPACK_ALIGNMENT,m);var g=Math.floor;if(w(i))if(w(i.arrayBufferView)){f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1);m=i.arrayBufferView;if(u){if(f.compressedTexImage2D(h,0,s,r,n,0,m),w(i.mipLevels))for(var _=r,v=n,y=0;y<i.mipLevels.length;++y)(_=0|g(_/2))<1&&(_=1),v=0|g(v/2),f.compressedTexImage2D(h,y+1,s,_,v=v<1?1:v,0,i.mipLevels[y])}else if(c&&(m=S.flipY(m,a,o,r,n)),f.texImage2D(h,0,s,r,n,0,a,o,m),w(i.mipLevels))for(_=r,v=n,y=0;y<i.mipLevels.length;++y)(_=0|g(_/2))<1&&(_=1),v=0|g(v/2),f.texImage2D(h,y+1,s,_,v=v<1?1:v,0,a,o,i.mipLevels[y])}else w(i.framebuffer)?(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._bind(),f.copyTexImage2D(h,0,s,i.xOffset,i.yOffset,r,n,0),i.framebuffer!==t.defaultFramebuffer&&i.framebuffer._unBind()):(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),f.texImage2D(h,0,s,a,o,i));else f.texImage2D(h,0,s,r,n,0,a,o,null),d=!1;f.bindTexture(h,null),u=u?S.compressedTextureSizeInBytes(a,r,n):S.textureSizeInBytes(a,o,r,n),this._id=x(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=h,this._texture=p,this._pixelFormat=a,this._pixelDatatype=o,this._width=r,this._height=n,this._dimensions=new b(r,n),this._hasMipmap=!1,this._sizeInBytes=u,this._preMultiplyAlpha=l,this._flipY=c,this._initialized=d,this._sampler=void 0,this.sampler=w(e.sampler)?e.sampler:new E}var b,x,M,w,T,S,E;Object.defineProperty(r,"__esModule",{value:!0}),s.create=function(e){return new s(e)},s.fromFramebuffer=function(e){var t=(e=M(e,M.EMPTY_OBJECT)).context,r=t._gl,n=M(e.pixelFormat,6407),i=M(e.framebufferXOffset,0),a=M(e.framebufferYOffset,0),o=M(e.width,r.drawingBufferWidth),r=M(e.height,r.drawingBufferHeight),e=e.framebuffer;return new s({context:t,width:o,height:r,pixelFormat:n,source:{framebuffer:w(e)?e:t.defaultFramebuffer,xOffset:i,yOffset:a,width:o,height:r}})},Object.defineProperties(s.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter,n=this._context,i=this._pixelDatatype;(5126===i&&!n.textureFloatLinear||36193===i&&!n.textureHalfFloatLinear)&&(t=9984===t||9986===t||9985===t||9987===t?9984:9728,r=9728);i=n._gl,n=this._textureTarget;i.activeTexture(i.TEXTURE0),i.bindTexture(n,this._texture),i.texParameteri(n,i.TEXTURE_MIN_FILTER,t),i.texParameteri(n,i.TEXTURE_MAG_FILTER,r),i.texParameteri(n,i.TEXTURE_WRAP_S,e.wrapS),i.texParameteri(n,i.TEXTURE_WRAP_T,e.wrapT),w(this._textureFilterAnisotropic)&&i.texParameteri(n,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),i.bindTexture(n,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),s.prototype.copyFrom=function(e,t,r){t=M(t,0),r=M(r,0);var n=this._context._gl,i=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(i,this._texture);var a=e.width,o=e.height,s=e.arrayBufferView,u=this._width,l=this._height,c=this._pixelFormat,d=this._pixelDatatype,f=this._preMultiplyAlpha,h=this._flipY,p=4;w(s)&&(p=S.alignmentInBytes(c,d,a)),n.pixelStorei(n.UNPACK_ALIGNMENT,p);var m=!1;this._initialized||(0===t&&0===r&&a===u&&o===l?(w(s)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),h&&(s=S.flipY(s,c,d,u,l)),n.texImage2D(i,0,c,u,l,0,c,d,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,h),n.texImage2D(i,0,c,c,d,e)),m=!0):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),p=S.createTypedArray(c,d,u,l),n.texImage2D(i,0,c,u,l,0,c,d,p)),this._initialized=!0),m||(w(s)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),h&&(s=S.flipY(s,c,d,a,o)),n.texSubImage2D(i,0,t,r,a,o,c,d,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,h),n.texSubImage2D(i,0,t,r,c,d,e))),n.bindTexture(i,null)},s.prototype.copyFromFramebuffer=function(e,t,r,n,i,a){e=M(e,0),t=M(t,0),r=M(r,0),n=M(n,0),i=M(i,this._width),a=M(a,this._height);var o=this._context._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.copyTexSubImage2D(s,0,e,t,r,n,i,a),o.bindTexture(s,null),this._initialized=!0},s.prototype.generateMipmap=function(e){e=M(e,4352),this._hasMipmap=!0;var t=this._context._gl,r=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(r,this._texture),t.generateMipmap(r),t.bindTexture(r,null)},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),T(this)},r.DDSTexture=s},{}],10:[function(e,t,r){"use strict";function n(e,t,r){this.mesh=e;e=Cesium;this._texture=t,this._depthTexture=r,this.framebuffer=null,this.ready=!1,this.readyPromise=e.when.defer(),t&&t instanceof e.Framebuffer?(this.framebuffer=t,this._texture=this.framebuffer._colorTextures[0],this._depthTexture=this.framebuffer._depthTexture,this.ready=!0,this.readyPromise.resolve(!0)):this.destroyAttachments=!0}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperties(n.prototype,{texture:{get:function(){return this._texture},set:function(e){e&&this._texture!=e&&(this._texture=e,this.checkIfInUniforms(this._texture),this.framebuffer&&(this.framebuffer._colorTextures[0]!=this._texture?this.framebuffer._colorTextures[0]=this._texture:this.framebuffer._colorTextures[0]))}},depthTexture:{get:function(){return this._depthTexture},set:function(e){e&&(this._depthTexture=e,this.framebuffer&&(this.framebuffer._depthTexture=this._depthTexture))}}}),n.prototype.checkIfInUniforms=function(e){if(this.mesh){var t,r=this.mesh.material.uniforms;for(t in r)if(r.hasOwnProperty(t))if(r[t].value==e)return!0}},n.prototype.destroy=function(){this.destroyAttachments&&(this.texture&&(this.texture.destroy(),delete this.texture),this.depthTexture&&(this.depthTexture.destroy(),delete this.depthTexture),this.framebuffer&&(this.framebuffer.destroy(),delete this.framebuffer),this.mesh&&(this.mesh.destroy(),delete this.mesh))},r.FramebufferTexture=n},{}],11:[function(e,t,r){"use strict";function h(){}function _(){var e;m||(m=!0,e=Cesium,i=e.Matrix3,a=e.Matrix4,O=e.Cartesian3,e.Cartesian2,L=e.BoundingSphere,v=e.GeometryAttribute,y=e.ComponentDatatype,o=new O,s=new a,u=new i,n=new O,l=new O,c=new O)}function C(e,t,r){var n=e.attributes.position,i=e.groups,a=e.drawRange,o=e.index,s=[],e=n.count;if(o)if(i&&0<i.length)for(var u=0,l=i.length;u<l;u++){var c=i[u];if(r){if(c.materialIndex!=t)continue}else if(u!=t)continue;for(var d=Math.max(c.start,a.start),f=Math.min(o.count,c.start+c.count,a.start+a.count);d<f;d+=3){var h=o.getX(d),p=o.getX(d+1),m=o.getX(d+2);s.push(h,p,m)}}else for(var g=Math.max(0,a.start),_=Math.min(o.count,a.start+a.count);g<_;g+=3){var v=o.getX(g),y=o.getX(g+1),b=o.getX(g+2);s.push(v,y,b)}else if(i&&0<i.length)for(var x=0,M=i.length;x<M;x++){var w=i[x];if(r){if(w.materialIndex!=t)continue}else if(x!=t)continue;for(var T=Math.max(w.start,a.start),S=Math.min(n.count,w.start+w.count,a.start+a.count);T<S;T+=3){var E=T;s.push(E,T+1,T+2)}}else for(var C=Math.max(0,a.start),A=Math.min(n.count,a.start+a.count);C<A;C+=3){var O=C;s.push(O,C+1,C+2)}return new(65535<e?Uint32Array:255<e?Uint16Array:Uint8Array)(s)}Object.defineProperty(r,"__esModule",{value:!0});var i,a,O,L,v,y,o,s,u,n,l,c,f=e("e_30"),E=e("i_31"),d=e("M_32"),p=e("e_33"),e=e("s_34"),e=e&&e.__esModule?e:{default:e},m=(d.MathUtils.pointInPolygon,d.MathUtils.findCrossPoint,d.MathUtils.pointOnSegment,!1);h.extractGeometry=function(e,t,r){var n,i=e.attributes,a=new THREE.BufferGeometry,o=C(e,t,r);for(n in i){for(var s=i[n],u=s.itemSize,l=s.array,s=s.normalized,c=new l.constructor(o.length*u),d=0,f=0;f<o.length;f++)for(var h=o[f]*u,p=0;p<u;p++)c[d++]=l[h+p];s=new THREE.BufferAttribute(c,u,s);a.setAttribute(n,s)}return o=null,a},h.genGeometryIndices=C,h.computeBoundingSphereAndIndices=function(e,t,r,n){var i=e,a=i.attributes.position,o=a.array,s=o.constructor,u=i.groups,l=i.drawRange,c=i.index,d=[],e=a.count;if(!u||u.length<=1)i.boundingSphere||i.computeBoundingSphere(),n=L.clone(i.boundingSphere,n),d=c&&c.array;else if(d=[],c){for(var f=0,h=u.length;f<h;f++){var p=u[f];if(r){if(p.materialIndex!=t)continue}else if(f!=t)continue;for(var m=Math.max(p.start,l.start),g=Math.min(c.count,p.start+p.count,l.start+l.count);m<g;m++)d.push(c.getX(m))}for(var _=[],v=0;v<d.length;v++){var c=d[v],y=O.unpack(a.array,3*c);_.push(y)}n=L.fromPoints(_,n)}else{for(var b=[],x=0,M=u.length;x<M;x++){var w=u[x];if(r){if(w.materialIndex!=t)continue}else if(x!=t)continue;var T=Math.max(w.start,l.start),S=Math.min(a.count,w.start+w.count,l.start+l.count),E=T*a.itemSize*s.BYTES_PER_ELEMENT,w=(S-T)*a.itemSize,w=new s(o.buffer,E,w),w=L.fromVertices(w);b.push(w);for(var C=T,A=S;C<A;C++)d.push(C)}0<b.length&&(n=1==b.length?L.clone(b[0],n):L.fromBoundingSpheres(b,n))}return{indices:d=d&&!d.buffer?new(65535<e?Uint32Array:255<e?Uint16Array:Uint8Array)(d):d,boundingSphere:n}},h.pointRotateX=function(e,t){_(),i.fromRotationX(t,u),a.fromRotationTranslation(u,O.ZERO,s),a.multiplyByPoint(s,e,e)},h.pointRotateY=function(e,t){_(),i.fromRotationY(t,u),a.fromRotationTranslation(u,O.ZERO,s),a.multiplyByPoint(s,e,e)},h.pointRotateZ=function(e,t){_(),i.fromRotationZ(t,u),a.fromRotationTranslation(u,O.ZERO,s),a.multiplyByPoint(s,e,e)},h.rotateX=function(e,t){_();var r=e.attributes.position.values;i.fromRotationX(t,u),a.fromRotationTranslation(u,O.ZERO,s);for(var n=0;n<r.length;n+=3)o.x=r[n],o.y=r[n+1],o.z=r[n+2],a.multiplyByPoint(s,o,o),r[n]=o.x,r[n+1]=o.y,r[n+2]=o.z},h.rotateY=function(e,t){_();var r=e.attributes.position.values;i.fromRotationY(t,u),a.fromRotationTranslation(u,O.ZERO,s);for(var n=0;n<r.length;n+=3)o.x=r[n],o.y=r[n+1],o.z=r[n+2],a.multiplyByPoint(s,o,o),r[n]=o.x,r[n+1]=o.y,r[n+2]=o.z},h.rotateZ=function(e,t){_();var r=e.attributes.position.values;i.fromRotationZ(t,u),a.fromRotationTranslation(u,O.ZERO,s);for(var n=0;n<r.length;n+=3)o.x=r[n],o.y=r[n+1],o.z=r[n+2],a.multiplyByPoint(s,o,o),r[n]=o.x,r[n+1]=o.y,r[n+2]=o.z},h.isValidVertex=function(e,t){return t*=3,!isNaN(e[t])&&!isNaN(e[t+1])&&!isNaN(e[t+2])},h.isValidTriangle=function(e,t,r,n){var i=this.isValidVertex(e,t)&&this.isValidVertex(e,r)&&this.isValidVertex(e,n);t=O.unpack(e,3*t),r=O.unpack(e,3*r),n=O.unpack(e,3*n);r=O.subtract(r,t,new O),t=O.subtract(n,t,new O),t=O.cross(r,t,new O);return i=O.equals(t,O.ZERO)?!1:i},h.removeInvalidVertices=function(e){function n(o){l.forEach(function(e){for(var t=s[e],r=u[e],n=t.itemSize,i=n*o,a=0;a<n;a++)r.array.push(t.array[i+a])})}function t(e,t,r){n(e),n(t),n(r)}if(!e.isBufferGeometry)return console.warn("unsupport geometry type"),e;var r,i,a,o=e.clone(),s=e.attributes,u=o.attributes,l=[];for(r in u)u.hasOwnProperty(r)&&u[r]&&(a=(i=u[r]).array.constructor,i.array=[],i.array._srcType=a,l.push(r));var c,d,f,h=(p=e.attributes.position).count,p=p.array||p.values;if(e.index)for(var m=e.index.array,g=0;g<m.length;g+=3){var _=m[g],v=m[g+1],y=m[g+2];this.isValidTriangle(p,_,v,y)&&t(_,v,y)}else for(var b=0;b<h;b+=3){var x=b,M=b+1,w=b+2;this.isValidTriangle(p,x,M,w)&&t(x,M,w)}for(c in u)u.hasOwnProperty(c)&&u[c]&&(f=(d=u[c]).array._srcType,d.array=new f(d.array),d.count=d.array.length/d.itemSize,delete d.array._srcType);return o},h.forceIndices=function(e,t,r){if("undefined"==typeof THREE)throw new Error("强制索引功能依赖threejs，但是上下文未找到THREE模块 ");if(e.index)console.warn("该几何已有索引");else{if(!(e.groups&&1<e.groups.length)){void 0===r&&(r=!0);var n,i,a,o=[],s=new Map,u=e.attributes,l=(c=u.position).count,c=c.array,e=e.clone(),d=e.attributes,f=[];for(n in d)r&&"uv3"==n||t&&"uv2"==n?delete d[n]:d.hasOwnProperty(n)&&d[n]&&(a=(i=d[n]).array.constructor,i.array=[],i.array._srcType=a,f.push(n));for(var h,p,m,g=0,_=0;_<l;_++){var v=function(o){var e,t=[c[3*o],c[3*o+1],c[3*o+2]].join(",");return d.uv&&(t+=","+[(e=u.uv.array)[2*o],e[2*o+1]].join(",")),d.uv2&&(t+=","+[(e=u.uv2.array)[2*o],e[2*o+1]].join(",")),s.has(t)||(f.forEach(function(e){for(var t=u[e],r=d[e],n=t.itemSize,i=n*o,a=0;a<n;a++)r.array.push(t.array[i+a])}),s.set(t,g),g++),s.get(t)}(_);o.push(v)}for(h in o=new(65535<g?Uint32Array:255<g?Uint16Array:Uint8Array)(o),s.clear(),e.groups=[{start:0,count:1/0,materialIndex:0}],e.index=new THREE.BufferAttribute(o,1,!1),d)d.hasOwnProperty(h)&&d[h]&&(m=(p=d[h]).array._srcType,p.array=new m(p.array),p.count=p.array.length/p.itemSize,delete p.array._srcType);return e}console.warn("该几何无法强制使用索引")}},h.clampToIndices=function(e){if(e.index){var t,r=e.index.array,n=d.MathUtils.minmax(r).max,i=e.attributes;for(t in i)if(i.hasOwnProperty(t)){var a=i[t],o=a.array,s=a.itemSize;if(a.count==n+1)continue;s=s*(n+1)*o.constructor.BYTES_PER_ELEMENT,s=o.buffer.slice(0,s),o=new o.constructor(s);i[t].array=o}}return e},h.computeSurfaceArea=function(e){if(!(e instanceof Cesium.Geometry||e.isBufferGeometry))return console.warn("unsupport geometry type"),-1;var t=e.attributes.position,r=(r=e.indices||e.index)&&(r.array||r),t=t.array||t.values;t=O.unpackArray(t);var n=0;if(r)for(var i=0;i<r.length;i+=3){var a=r[i],o=r[i+1],s=r[i+2];n+=(0,f.computeArea)(t[a],t[o],t[s])}else for(var u=0;u<t.length;u+=3){var l=t[u],c=t[u+1],d=t[u+2];n+=(0,f.computeArea)(l,c,d)}return n},h.geometryEquals=function(e,t){e=e.attributes.position.array,t=t.attributes.position.array;var r=e.length==t.length;if(r)for(var n=e.length,i=0;i<n;i++)if(e[i]!=t[i]){r=!1;break}return r},h.simplify=function(e,t,r){if("undefined"==typeof THREE)throw new Error("模型简化功能依赖threejs，但是上下文未找到THREE模块 ");if(!t)throw new Error("缺少参数simplifyFactor");var n=e.attributes.position.count,i=(e=(0,p.simplify_three)(e,t*n,r)).attributes.position.count;if(i-n<0){for(var a=e.attributes.position.array,o=!0,s=0;s<i;s++)if(!this.isValidVertex(a,s)){o=!1;break}o||(e=h.removeInvalidVertices(e))}return e},h.subdivUVNormalized=e.default;var b,e=(b=function(e,t,r){this.a=e,this.b=t,this.c=r;var n=t.x-e.x,i=t.y-e.y,a=r.x-e.x,o=r.y-e.y,s=n*(e.x+t.x)+i*(e.y+t.y),u=a*(e.x+r.x)+o*(e.y+r.y),t=2*(n*(r.y-t.y)-i*(r.x-t.x));this.x=(o*s-i*u)/t,this.y=(n*u-a*s)/t,t=this.x-e.x,e=this.y-e.y,this.r=t*t+e*e},function(e){if(e.length<3)return[];e.sort(x);for(var t,r,n,i,a,o=e[_=e.length-1].x,s=e[0].x,u=e[_].y,l=u;_--;)e[_].y<u&&(u=e[_].y),e[_].y>l&&(l=e[_].y);for(var c,d=s-o,f=l-u,h=f<d?d:f,p=[new b({__sentinel:!0,x:(s=.5*(s+o))-20*h,y:(o=.5*(l+u))-h},{__sentinel:!0,x:s,y:o+20*h},{__sentinel:!0,x:s+20*h,y:o-h})],m=[],g=[],_=e.length;_--;){for(g.length=0,c=p.length;c--;)0<(d=e[_].x-p[c].x)&&d*d>p[c].r?(m.push(p[c]),p.splice(c,1)):d*d+(f=e[_].y-p[c].y)*f>p[c].r||(g.push(p[c].a,p[c].b,p[c].b,p[c].c,p[c].c,p[c].a),p.splice(c,1));for(function(e){var t,r,n,i,a,o=e.length;e:for(;o;)for(r=e[--o],t=e[--o],n=o;n;)if(a=e[--n],i=e[--n],t===i&&r===a||t===a&&r===i){e.splice(o,2),e.splice(n,2),o-=2;continue e}}(g),c=g.length;c;)r=g[--c],t=g[--c],n=e[_],i=r.x-t.x,a=r.y-t.y,a=2*(i*(n.y-r.y)-a*(n.x-r.x)),1e-12<Math.abs(a)&&p.push(new b(t,r,n))}for(Array.prototype.push.apply(m,p),_=m.length;_--;)(m[_].a.__sentinel||m[_].b.__sentinel||m[_].c.__sentinel)&&m.splice(_,1);return m});function x(e,t){return t.x-e.x}h.triangulate=e,h.computeNormal=function(e,t,r,n){return _(),n=n||new O,O.subtract(r,t,l),O.subtract(e,t,c),O.cross(l,c,n),0!=O.magnitude(n)&&O.normalize(n,n),n},h.computeVertexNormals=function(e){_();var t=e.indices,r=e.attributes;if(r.position){var n=r.position.values,i=t?t.length:n.length/3;if(void 0===r.normal)r.normal=new v({componentDatatype:y.FLOAT,componentsPerAttribute:3,values:new Float32Array(n.length)});else{var a=r.normal.values;if(t)for(var o,s=0;s<i;s++)a[3*(o=t[s])]=0,a[3*o+1]=0,a[3*o+2]=0;else for(s=0;s<i;s++)a[s]=0}for(var u,l,c,d=r.normal.values,f=new O,h=new O,p=new O,m=new O,g=new O,s=0;s<i;s+=3)u=t?3*t[s+0]:3*s,l=t?3*t[s+1]:3*(s+1),c=t?3*t[s+2]:3*(s+2),O.fromArray(n,u,f),O.fromArray(n,l,h),O.fromArray(n,c,p),O.subtract(p,h,m),O.subtract(f,h,g),O.cross(m,g,m),d[u]+=m.x,d[1+u]+=m.y,d[2+u]+=m.z,d[l]+=m.x,d[1+l]+=m.y,d[2+l]+=m.z,d[c]+=m.x,d[1+c]+=m.y,d[2+c]+=m.z;(function(e){for(var t,r,n,i,a=e.attributes.normal.values,o=0;o<a.length;o+=3)t=a[o],r=a[o+1],n=a[o+2],i=1/Math.sqrt(t*t+r*r+n*n),a[o]=t*i,a[o+1]=r*i,a[o+2]=n*i})(e),r.normal.needsUpdate=!0}return e},h.mergeGeometries=function(e){if(!e||!e.length)throw new Error("缺少geometries参数");if(1==e.length)return e[0];for(var t=[],r=!1,n=!1,i=e[0].primitiveType,a=0;a<e.length;a++){if(t[a]=function(e){var t,r=[];for(t in e.attributes)e.attributes.hasOwnProperty(t)&&e.attributes[t]&&r.push(t);return r}(e[a]),0<a){if(i!=e[a].primitiveType){n=!0;break}var o=t[a-1];if(!(r=o.length!=t[a].length))for(var s=0;s<o.length;s++)if(o[s]!=t[a][s]){r=!0;break}}if(i=e[a].primitiveType,r||n)break}if(n)throw new Error("待合并的几何体中primitiveType属性不完全一致");if(r)throw new Error("待合并的几何体中属性数量和和名称不完全一致");return function(e){if(1==e.length)return e[0];var t,r,n=[],i=[],a=[],o=[],s=[],u=[],l=[],c=[],d=0,f=[],h=e[0],p=h.primitiveType;for(t in h.attributes)h.attributes.hasOwnProperty(t)&&h.attributes[t]&&(r=h.attributes[t],n.push(t),s.push(r.componentsPerAttribute),a.push(r.componentDatatype),o.push(r.values.constructor),u.push(r.normalize),f.push(0),l.push(0));for(var m=0;m<e.length;m++)for(var g=e[m],_=0;_<n.length;_++){var v=n[_];f[_]+=g.attributes[v].values.length}for(var y=0;y<n.length;y++)i.push(new o[y](f[y]));e[0].indices||(c=null);for(var b=0;b<e.length;b++){for(var x=e[b],M=0;M<n.length;M++){var w=n[M],T=i[M],w=x.attributes[w].values;T.set(w,l[M]),l[M]+=w.length}if(x.indices){for(var S=0;S<x.indices.length;S++){var E=x.indices[S];c.push(E+d)}d+=x.attributes.position.values.length/3}}for(var C={},A=0;A<n.length;A++)C[n[A]]={values:i[A],componentsPerAttribute:s[A],componentDatatype:a[A],normalize:u[A]};return c=c&&new(i[0]/s[0]<65535?Uint16Array:Uint32Array)(c),new Cesium.Geometry({attributes:C,indices:c,primitiveType:p})}(e)},h.mergeGroupedGeometries=function(t){var e,r=Cesium,n=h.cloneGeometryAttributes(t[0].attributes);for(e in n)!function(a){var o,e,s;n.hasOwnProperty(a)&&(e=n[a],o=e.componentsPerAttribute,e=e.componentDatatype,s=[],t.forEach(function(e){for(var t=e.attributes[a].values,r=0;r<e.indices.length;r++)for(var n=e.indices[r],i=0;i<o;i++)s.push(t[n*o+i])}),n[a].values=r.ComponentDatatype.createTypedArray(e,s))}(e);return new r.Geometry({attributes:n,primitiveType:t[0].primitiveType})},h.mergeGeometries3js=function(e){var t,r=THREE,n=e[0].clone(),i=n.attributes;for(t in i){for(var a=i[t],o=0,s=0,u=0;u<e.length;u++){var l=e[u].attributes[t];o+=l.count,s+=l.array.length}a.count=o,a.array=new a.array.constructor(s);for(var c=a.array,d=0,f=0;f<e.length;f++){var h=e[f].attributes[t].array;c.set(h,d),d+=h.length}}for(var p=[],m=0,g=0;g<e.length;g++){var _=C(e[g],0,!0);p.push(_),m+=_.length}for(var v,y=i.position.count,r=65535<y?(v=new Uint32Array(m),r.Uint32BufferAttribute):255<y?(v=new Uint16Array(m),r.Uint16BufferAttribute):(v=new Uint8Array(m),r.Uint8BufferAttribute),d=0,b=0,x=!0,M=-1,w=0;w<p.length;w++){for(var T=p[w],S=0;S<T.length;S++){var E=T[S]+d;(v[b++]=E)-M!=1&&(x=!1),M=E}d+=e[w].attributes.position.count}return x?n.index=null:n.setIndex(new r(v,1,!1)),n.computeBoundingSphere(),n.computeBoundingBox(),n},h.translate=function(e,t){_(),Array.isArray(t)?(n.x=t[0],n.y=t[1],n.z=t[2]):O.clone(t,n);for(var r=0;r<e.attributes.position.values.length;r+=3)e.attributes.position.values[r]+=n.x,e.attributes.position.values[r+1]+=n.y,e.attributes.position.values[r+2]+=n.z},h.getAttributeComponentType=function(e){var t=Cesium.ComponentDatatype,r=t.SHORT;return e instanceof Int8Array?r=t.BYTE:e instanceof Uint8Array||e instanceof Uint8ClampedArray?r=t.UNSIGNED_BYTE:e instanceof Int16Array?r=t.SHORT:e instanceof Uint16Array?r=t.UNSIGNED_SHORT:e instanceof Int32Array?r=t.INT:e instanceof Uint32Array?r=t.UNSIGNED_INT:e instanceof Float32Array?r=t.FLOAT:e instanceof Float64Array&&(r=t.DOUBLE),r},h.cloneGeometryAttributes=function(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&e[t]&&(r=e[t],n[t]={componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]});return n},h.cloneGeometry=function(e){var t,r,n,i=this.cloneGeometryAttributes(e.attributes);for(t in i)i.hasOwnProperty(t)&&(r=i[t],n=e.attributes[t].values,r.values=new n.constructor(n));var a=e.indices?new e.indices.constructor(e.indices):void 0;return new Cesium.Geometry({attributes:i,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere?e.boundingSphere.clone():void 0})},h.isGeometry3js=function(e){return"undefined"!=typeof THREE&&(e instanceof THREE.Geometry||e instanceof THREE.BufferGeometry)||e.attributes&&e.attributes.position&&e.index||e.vertices&&e.faces},h.parseBufferGeometry3js=function(e,t){var r,n,i=Cesium,a=i.GeometryAttribute,o=(i.PrimitiveType,i.Geometry),s={};for(r in e.attributes.normal||e.computeVertexNormals(),e.attributes)!e.attributes.hasOwnProperty(r)||(n=e.getAttribute(r))&&0<n.array.length&&(s[r]=new a({componentDatatype:h.getAttributeComponentType(n.array),componentsPerAttribute:n.itemSize,values:n.array,normalize:n.normalized}));var u,i=4;void 0!==e.GeometryMode&&(i=e.GeometryMode);var l,i=new o({attributes:s,indices:l=e.index?e.index.array:(u=s.position.values.length/3,e.groups&&e.groups.length?(l=[],e.groups.forEach(function(e){e.start+e.count>u&&console.warn("group.count>ptCount");for(var t=0;t<e.count&&t+e.start<u;t++)l.push(t+e.start)})):t.isLine?i=t.isLineSegments?1:t.isLineLoop?2:3:t.isPoints&&(i=0),l&&new(65535<u?Uint32Array:Uint16Array)(l)),primitiveType:i});return e.boundingSphere&&(i.boundingSphere=L.clone(e.boundingSphere)),i},h.fromGeometry3js=function(e,t,r){e.attributes&&(e.index||e.groups.length)||((e=!e.isBufferGeometry?(new THREE.BufferGeometry).fromGeometry(e):e).attributes.normal||r||!e.computeVertexNormals||e.computeVertexNormals());var n=Cesium,t=h.parseBufferGeometry3js(e,t);return r&&!t.attributes.normal&&4==t.primitiveType&&n.GeometryPipeline.computeNormal(t),t},h.toBufferGeometry3js=function(e,t){var r=THREE,n=r.BufferGeometry,i=r.BufferAttribute,r=r.Sphere;t=t||new n;var a,o,s=e.attributes;for(a in s)s.hasOwnProperty(a)&&s[a]&&(o=new i((o=s[a]).values,o.componentsPerAttribute,o.normalize),t.setAttribute(a,o));return e.indices&&(n=new i(e.indices,1,!1),t.setIndex(n)),e.boundingSphere&&(e=e.boundingSphere,t.boundingSphere||(t.boundingSphere=new r),t.boundingSphere.center.copy(e.center),t.boundingSphere.radius=e.radius),t},h.toGeometry3js=function(e){if("undefined"==typeof THREE)throw new Error("THREE 未加载");for(var t,r=THREE,n=r.Geometry,i=r.Vector3,a=r.Face3,o=e.attributes.position.values,s=new n,u=0;u<o.length;u+=3)s.vertices.push(new i(o[t=3*u],o[2+t],o[1+t]));for(u=0;u<e.indices.length;u+=3){var l=e.indices[u],c=e.indices[u+1],d=e.indices[u+2];s.faces.push(new a(l,c,d))}return s},h.toCSG=function(e,t){if("undefined"!=typeof THREE&&(e instanceof THREE.Geometry||e.isBufferGeometry))return h._toCSG3js(e,t);var r=Cesium;if(t=t||{x:0,y:0,z:0},4!==(e=!e.attributes.normal?r.GeometryPipeline.computeNormal(e):e).primitiveType)throw new Error("暂不支持此类几何体");if(!E.CSG)throw new Error("CSG 库未加载。请从 https://github.com/evanw/csg.js 获取");for(var n=(e.indices.length,[]),i=[],a=e.attributes.position.values,o=e.attributes.normal.values,s=0;s<e.indices.length;s+=3){var i=[],u=e.indices[s],l=e.indices[s+1],c=e.indices[s+2],d=3*u,f=3*u;i.push(new E.CSG.Vertex([a[d++]+t.x,a[d++]+t.y,a[+d]+t.z],[o[f++],o[f++],o[+f]])),f=d=3*l,i.push(new E.CSG.Vertex([a[d++]+t.x,a[d++]+t.y,a[+d]+t.z],[o[f++],o[f++],o[+f]])),f=d=3*c,i.push(new E.CSG.Vertex([a[d++]+t.x,a[d++]+t.y,a[+d]+t.z],[o[f++],o[f++],o[+f]])),n.push(new E.CSG.Polygon(i))}return E.CSG.fromPolygons(n)},h.fromCSG=function(e,t){if("undefined"!=typeof THREE&&t)return h._fromCSG3js(e);var r,n=e.toPolygons();if(!E.CSG)throw new Error("CSG 库未加载。请从 https://github.com/evanw/csg.js 获取");for(var i=Cesium,t=i.GeometryAttribute,e=(i.PrimitiveType,i.Geometry),a=[],o=[],s=[],u=0;u<n.length;u++){for(r=[],l=0;l<n[u].vertices.length;l++)r.push(this.getGeometryVertice(a,o,n[u].vertices[l].pos,n[u].plane.normal));r[0]===r[r.length-1]&&r.pop();for(var l=2;l<r.length;l++)s.push(r[0],r[l-1],r[l])}a=new Float32Array(a),o=new Float32Array(o),s=new Int32Array(s),i={};return i.position=new t({componentDatatype:y.FLOAT,componentsPerAttribute:3,values:a}),i.normal=new t({componentDatatype:y.FLOAT,componentsPerAttribute:3,values:o}),new e({attributes:i,indices:s,primitiveType:4})},h._toCSG3js=function(e,t,r){if("undefined"==typeof THREE)throw new Error("THREE 未加载");var n,i;if(!E.CSG)throw"CSG library not loaded. Please get a copy from https://github.com/evanw/csg.js";var a=THREE,o=a.Geometry,s=a.Euler,u=a.Vector3,l=a.Matrix4,c=a.Face3,d=a.Face4,f=E.CSG.Vertex,h=f.Vertex,p=f.Polygon;if(e instanceof a.Mesh)n=e.geometry,t=t||e.position,r=r||e.rotation;else if(e instanceof o)n=e,t=t||new u(0,0,0),r=r||new s(0,0,0);else{if(!e.isBufferGeometry)throw"Model type not supported.";n=(new o).fromBufferGeometry(e),t=t||new u(0,0,0),r=r||new s(0,0,0)}for(var m=(new l).makeRotationFromEuler(r),g=[],_=n.faces,v=n.vertices,y=0;y<_.length;y++){var b=_[y],x=b.a,M=b.b,w=b.c,T=b.d,S=b.normal,S=[S.x,S.y,S.z];if(b instanceof c)(i=[]).push(new h(v[x].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[M].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[w].clone().add(t).applyMatrix4(m),S)),g.push(new p(i));else{if(!(b instanceof d))throw"Model contains unsupported face.";(i=[]).push(new h(v[x].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[M].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[T].clone().add(t).applyMatrix4(m),S)),g.push(new p(i)),(i=[]).push(new h(v[M].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[w].clone().add(t).applyMatrix4(m),S)),i.push(new h(v[T].clone().add(t).applyMatrix4(m),S)),g.push(new p(i))}}return E.CSG.fromPolygons(g)},h._fromCSG3js=function(e){if("undefined"==typeof THREE)throw new Error("THREE 未加载");var t,r,n=new THREE.Geometry,i=e.toPolygons();if(!E.CSG)throw"CSG library not loaded. Please get a copy from https://github.com/evanw/csg.js";for(var e=THREE,a=e.Vector3,o=e.Vector2,s=e.Face3,u=0;u<i.length;u++){for(t=[],l=0;l<i[u].vertices.length;l++)t.push(h._getGeometryVertice3js(n,i[u].vertices[l].pos));t[0]===t[t.length-1]&&t.pop();for(var l=2;l<t.length;l++)r=new s(t[0],t[l-1],t[l],(new a).copy(i[u].plane.normal)),n.faces.push(r),n.faceVertexUvs[0].push(new o)}return n.computeBoundingBox(),n},h._getGeometryVertice3js=function(e,t){for(var r=0;r<e.vertices.length;r++)if(e.vertices[r].x===t.x&&e.vertices[r].y===t.y&&e.vertices[r].z===t.z)return r;return e.vertices.push(new THREE.Vector3(t.x,t.y,t.z)),e.vertices.length-1},h.getGeometryVertice=function(e,t,r,n){for(var i=0,a=0;a<e.length;a+=3){if(e[a]===r.x&&e[a+1]===r.y&&e[a+2]===r.z)return i;i++}return e.push(r.x,r.y,r.z),t.push(n.x,n.y,n.z),i},h.triangulateShape=function(e,t,r,n){var i,a=THREE.ShapeUtils,o=n,s=r,u=s.length,l=e.slice(),c=t.map(function(e){return e.slice()});for(!1===a.isClockWise(l)&&(l=l.reverse()),f=0,h=c.length;f<h;f++)i=c[f],!0===a.isClockWise(i)&&(c[f]=i.reverse());for(var d=a.triangulateShape(l,c),f=0,h=c.length;f<h;f++)i=c[f],l=l.concat(i);for(f=0,h=l.length;f<h;f++){var p=l[f];s.push(p)}for(f=0,h=d.length;f<h;f++){var m=d[f],g=m[0]+u,_=m[1]+u,m=m[2]+u;o.push(g,_,m)}},r.default=h},{i_31:165,M_32:167,e_30:171,e_33:19,s_34:41}],12:[function(e,t,r){"use strict";function n(){this.selected=[]}Object.defineProperty(r,"__esModule",{value:!0}),Object.assign(n.prototype,{isIEffect:!0,preUpdate:function(e,t,r,n){console.warn("IEffect.preRender not implemeted")},postUpdate:function(e,t,r,n){console.warn("IEffect.postRender not implemeted")}}),r.default=n},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IRenderable=void 0;var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e},e=e("h_35");function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.isIRenderable=!0,this.visualizer=null}e&&e.__esModule,r.IRenderable=(n(a,[{key:"render",value:function(e,t){throw new Error("IRenderable.render not implemented.")}}]),a)},{h_35:24}],14:[function(e,t,r){"use strict";function n(e){var t=Cesium,r=t.defaultValue,t=t.BoundingSphere;e=r(e,{}),a.Object3D.call(this,e),this.show=r(e.show,!0),this.maxAvailableDistance=r(e.maxAvailableDistance,Number.MAX_VALUE),this._boundingSphere=new t,this._needsUpdate=!1,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}Object.defineProperty(r,"__esModule",{value:!0}),r.LOD=void 0;var i=e("-_36"),u=i&&i.__esModule?i:{default:i},a=e("3_37");n.prototype=Object.assign(Object.create(a.Object3D.prototype),{constructor:n,isLOD:!0,addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),(e.parent=this)._children.push(e),this.levels[0].object.geometry?this._boundingSphere.radius=this.levels[0].object.geometry.boundingSphere.radius:this.levels[0].object.boundingSphere&&(this._boundingSphere.radius=this.levels[0].object.boundingSphere.radius)},update:function(e,t){var r=this.levels;if(1<r.length){this._modelMatrixNeedsUpdate&&(u.default.computeModelMatrix(e,this.position,this.rotation,this.scale,this.modelMatrix),this._modelMatrixNeedsUpdate=!1);var n=Cesium;n.Matrix4.getTranslation(this.modelMatrix,this._boundingSphere.center);var e=this._boundingSphere,i=Math.max(0,n.Cartesian3.distance(e.center,t.camera.positionWC)-e.radius),a=(a=this.maxAvailableDistance>i)&&-1!==t.cullingVolume.computeVisibility(this._boundingSphere);r[0].object.show=a;for(var o=1,s=r.length;o<s&&i>=r[o].distance;o++)r[o-1].object.show=!1,r[o].object.show=a;for(;o<s;o++)r[o].object.show=!1}},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object}}),r.LOD=n},{"3_37":25,"-_36":27}],15:[function(e,t,r){"use strict";function i(e){if(!(e=i.isGeometrySupported(e)?{geometry:e,material:arguments[1],instances:arguments[2],instancedAttributes:arguments[3]}:e)||!e.geometry)throw new Error("geometry是必须参数");if(!i.isGeometrySupported(e.geometry))throw new Error("暂不支持此类型的geometry");u.default.isGeometry3js(e.geometry)?(n=e.material instanceof s.BasicMeshMaterial||e.material instanceof l.MeshPhongMaterial,e.geometry=u.default.fromGeometry3js(e.geometry,null,n)):e.geometry instanceof a.CSG?(0==e.geometry.polygons.length&&(e.show=!1),e.geometry=a.CSG.fromCSG(e.geometry)):"function"==typeof e.geometry.constructor.createGeometry&&(e.geometry=e.geometry.constructor.createGeometry(e.geometry)),c.Object3D.call(this,e);var t=Cesium,r=t.defaultValue,n=t.GeometryPipeline,t=(t.PrimitiveType,t.Event);this.show=r(e.show,!0),this._geometry=e.geometry,this._material=r(e.material,new o.MeshMaterial),this._needsUpdate=!1,this._modelMatrixNeedsUpdate=!0,this._drawCommand=null,this._children=[],this._parent=null,this._instances=null,this._isCustomInstancedMesh=!1,this._center=this._position.clone(),this.instancedAttributes=e.instancedAttributes||[],e.instances&&e.instances.length&&(this._instances=[],e.instances.forEach(function(e){this.addInstance(e)},this)),this.userData={},!this._geometry.attributes.normal&&this.material instanceof l.MeshPhongMaterial&&4==this._geometry.primitiveType&&n.computeNormal(this._geometry),this._material&&this._material.addReference&&this._material.addReference(),this.beforeDestroy=new t}Object.defineProperty(r,"__esModule",{value:!0}),r.Mesh=void 0;var a=e("i_31"),o=e("e_27"),s=e("M_40"),n=e("k_26"),u=n&&n.__esModule?n:{default:n},l=e("k_42"),c=e("3_37");i.isGeometrySupported=function(e){return e instanceof Cesium.Geometry||e instanceof a.CSG||"function"==typeof e.constructor.createGeometry||u.default.isGeometry3js(e)},i.prototype=Object.create(c.Object3D.prototype),i.prototype.isMesh=!0,i.prototype.isRuntimeMesh=!0,i.prototype.addInstance=function(t){var r=Cesium;this._instances=this._instances||[],t.show=r.defaultValue(t.show,!0),t.primitive=this,t.boundingSphere=new r.BoundingSphere(new r.Cartesian3,this.geometry.boundingSphere?this.geometry.boundingSphere.radius:0),t.scale=t.scale||1;var n=t.modelMatrix;return Object.defineProperty(t,"modelMatrix",{get:function(){return n},set:function(e){n=e,r.Matrix4.getTranslation(t.modelMatrix,t.boundingSphere.center)}}),t.modelMatrix=n,t.id=t.id||r.createGuid(),t.instanceId=this._instances.length,this.instancedAttributes.forEach(function(e){t[e.name]||(t[e.name]=e.default)}),this._instances.push(t),this._isCustomInstancedMesh=!0,t},Object.defineProperties(i.prototype,{instances:{get:function(){return this._instances}},isCustomInstancedMesh:{get:function(){return this._isCustomInstancedMesh}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=e}},geometry:{get:function(){return this._geometry},set:function(e){this._geometry=e,this._needsUpdate=!0,this.modelMatrixNeedsUpdate=!0}},material:{get:function(){return this._material},set:function(e){this._material=e,this._needsUpdate=!0}},needsUpdate:{get:function(){return this._needsUpdate},set:function(e){this._needsUpdate=e}}}),i.prototype.destroy=function(){this.beforeDestroy.raiseEvent(this),this.beforeDestroy._listeners.splice(0),this.beforeDestroy=null,this._modelMatrix=null,this._instances&&(this._instances.splice(0),this._instances=null),this.instancedAttributes=null,this._center=null,this.userData=null,this.material&&this.material.removeReference&&this.material.removeReference();var e=Cesium.destroyObject;this.geometry&&(this.geometry.attributes=e(this.geometry.attributes),this.geometry=e(this.geometry)),delete this.__programCacheKey,e(this)},i.prototype.lookAt=c.Object3D.prototype.lookAt,r.Mesh=i},{i_31:165,M_40:6,k_26:11,e_27:22,k_42:23,"3_37":25}],16:[function(e,t,r){"use strict";function n(){}Object.defineProperty(r,"__esModule",{value:!0}),n.EPSILON=1e-6;var i="undefined"!=typeof Float32Array?Float32Array:Array;n.ARRAY_TYPE=i;var a=Math.random;n.RANDOM=a,n.setMatrixArrayType=function(e){0};var o=Math.PI/180;n.toRadian=function(e){return e*o},Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),r.glMatrix=n},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});function c(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===a.call(e)}function d(e){if(!e||"[object Object]"!==a.call(e))return!1;var t,r=i.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!n)return!1;for(t in e);return void 0===t||i.call(e,t)}function f(e,t){n&&"__proto__"===t.name?n(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue}function h(e,t){if("__proto__"===t){if(!i.call(e,t))return;if(o)return o(e,t).value}return e[t]}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor;r.extend=function e(){var t,r,n,i,a,o=arguments[0],s=1,u=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[1]||{},s=2),(null==o||"object"!==(void 0===o?"undefined":p(o))&&"function"!=typeof o)&&(o={});s<u;++s)if(null!=(t=arguments[s]))for(r in t)a=h(o,r),n=h(t,r),o!==n&&(l&&n&&(d(n)||(i=c(n)))?(a=i?(i=!1,a&&c(a)?a:[]):a&&d(a)?a:{},f(o,{name:r,newValue:e(l,a,n)})):void 0!==n&&f(o,{name:r,newValue:n}));return o}},{}],18:[function(e,t,r){"use strict";function o(e,t,r,n){var i=s.subtract(s.create(),r,t),a=s.subtract(s.create(),n,t),r=s.subtract(s.create(),e,t),n=s.dot(i,i),e=s.dot(i,a),t=s.dot(a,a),i=s.dot(r,i),r=s.dot(r,a),a=n*t-e*e,t=(t*i-e*r)/a,a=(n*r-e*i)/a;return s.fromValues(1-t-a,t,a)}Object.defineProperty(r,"__esModule",{value:!0}),r.barycentric=o,r.interpolate=function(e,t,r,n,i,a){n=o(t,r,n,i),i=s.create(),s.scale(e,a[0],n[0]),s.add(e,e,s.scale(i,a[1],n[1])),s.add(e,e,s.scale(i,a[2],n[2]))},r.barycentric2=function(e,t,r,n){var i=s.subtract([],t,e),a=s.subtract([],r,e),o=s.subtract([],n,e),e=s.subtract([],t,r),r=s.subtract([],t,n),t=s.cross([],e,r),n=s.cross([],a,o),e=s.cross([],o,i),r=s.cross([],i,a),o=1/s.length(t),i=s.dot(t,n)<0?-1:1,a=s.dot(t,e)<0?-1:1,t=s.dot(t,r)<0?-1:1,i=s.length(n)*o*i,a=s.length(e)*o*a,t=s.length(r)*o*t;return s.fromValues(i,a,t)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("s_44"))},{s_44:21}],19:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){var r=t.agressiveness,n=t.update,i=t.recompute,a=0,o=R.length,s=[],u=[],l=O.create(),c=0,d=0;for(console.log("agressiveness",r,"update",n,"recompute",i),c=R.length-1;0<=c;c--)R[c].deleted=!1;for(var f=0;f<100&&!(o-a<=e);f++){for(f%n==0&&function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=void 0,n=void 0;if(0<e){var i=0;for(r=0;r<R.length;r++)R[r].deleted||(R[i++]=R[r]);R.splice(i)}if(t||0===e){for(r=0;r<I.length;r++)I[r].q=new L.Quadric;for(r=0;r<R.length;r++){var a=R[r],o=a.v.map(function(e){return I[e].p}),s=O.subtract([],o[1],o[0]),u=O.subtract([],o[2],o[0]),u=O.cross([],s,u),l=new L.Quadric;for(O.normalize(a.n,u),l.makePlane(a.n[0],a.n[1],a.n[2],-O.dot(a.n,o[0])),n=0;n<3;n++)I[a.v[n]].q.addSelf(l)}for(r=0;r<R.length;r++){var c=R[r],d=O.create(),f=c.v.map(function(e){return I[e]});for(n=0;n<3;n++){var h=f[n],p=f[(n+1)%3];c.err[n]=C(h,p,d)}c.err[3]=Math.min(c.err[0],c.err[1],c.err[2])}}for(r=0;r<I.length;r++)I[r].tstart=0,I[r].tcount=0;for(r=0;r<R.length;r++){var m=R[r];for(n=0;n<3;n++)I[m.v[n]].tcount++}var g=0;for(r=0;r<I.length;r++){var _=I[r];_.tstart=g,g+=_.tcount,_.tcount=0}for(D=new Array(3*R.length),r=0;r<D.length;r++)D[r]=new A;for(r=0;r<R.length;r++){var v=R[r];for(n=0;n<3;n++){var y=I[v.v[n]];D[y.tstart+y.tcount].tid=r,D[y.tstart+y.tcount].tvertex=n,y.tcount++}}if(0==e){var b=[],x=[];for(r=I.length-1;0<=r;r--)I[r].border=!1;for(r=I.length-1;0<=r;r--){var M=I[r];for(b=[],x=[],n=M.tcount-1;0<=n;n--){var w=D[M.tstart+n].tid,T=R[w];for(w=0;w<3;w++){for(var S=0,E=T.v[w];S<b.length&&x[S]!==E;)S++;S===b.length?(b.push(1),x.push(E)):b[S]++}}for(n=b.length-1;0<=n;n--)1===b[n]&&(I[x[n]].border=!0)}}}(f,i),c=R.length-1;0<=c;c--)R[c].dirty=!1;for(var h=1e-9*Math.pow(f+3,r),c=R.length-1;0<=c;c--){var p=R[c];if(!(p.err[3]>=h||p.deleted||p.dirty)){for(d=0;d<3;d++)if(!(p.err[d]>=h)){var m=p.v[d],g=p.v[(d+1)%3],_=I[m],v=I[g];if(!(_.border||v.border||(C(_,v,l),u=[],x(l,0,g,_,0,s=[])||x(l,0,m,v,0,u)))){p.uvs&&(y(0,_,l,s),y(0,v,l,u)),O.copy(_.p,l),_.q.addSelf(v.q);g=D.length;a+=b(m,_,s),a+=b(m,v,u);v=D.length-g;_.tstart=g,_.tcount=v;break}}if(o-a<=e)break}}}return function(){var e=0,t=void 0,r=void 0;for(t=0;t<I.length;t++)I[t].tcount=0;for(t=0;t<R.length;t++){var n=R[t];if(!n.deleted)for(R[e++]=R[t],r=0;r<3;r++)I[n.v[r]].tcount=1}for(R.splice(e),t=e=0;t<I.length;t++)0<I[t].tcount&&(I[t].tstart=e,I[e].p=I[t].p,e++);for(t=0;t<R.length;t++){var i=R[t];for(O.create(),O.create(),r=0;r<3;r++)i.v[r]=I[i.v[r]].tstart}return I.splice(e),{vertices:I,triangles:R}}()}function y(e,t,r,n){for(var i=O.create(),a=0;a<t.tcount;a++){var o=D[t.tstart+a],s=R[o.tid];if(!s.deleted&&!n[a])for(var u=s.v.map(function(e){return I[e].p}),l=0;l<s.uvs.length;l++)(0,c.interpolate)(i,r,u[0],u[1],u[2],s.uvs[l]),O.copy(s.uvs[l][o.tvertex],i)}}function b(e,t,r){for(var n=0,i=O.create(),a=0;a<t.tcount;a++){var o=D[t.tstart+a],s=R[o.tid],u=s.v.map(function(e){return I[e]});s.deleted||(r[a]?(s.deleted=!0,n++):(s.v[o.tvertex]=e,s.dirty=!0,s.err[0]=C(u[0],u[1],i),s.err[1]=C(u[1],u[2],i),s.err[2]=C(u[2],u[0],i),s.err[3]=Math.min(s.err[0],Math.min(s.err[1],s.err[2])),D.push(o)))}return n}function x(e,t,r,n,i,a){for(var o=0;o<n.tcount;o++){var s=D[n.tstart+o],u=R[s.tid];if(!u.deleted){var l=s.tvertex,s=u.v[(l+1)%3],l=u.v[(l+2)%3];if(s!==r&&l!==r){s=O.subtract([],I[s].p,e),l=O.subtract([],I[l].p,e);if(O.normalize(s,s),O.normalize(l,l),.99999<Math.abs(O.dot(s,l)))return 1;l=O.cross([],s,l);if(O.normalize(l,l),a[o]=!1,O.dot(l,u.n)<.2)return 1}else a[o]=!0}}}function C(e,t,r){var n,i=e.q.add(t.q),a=e.border&t.border,o=i.optimize(),s=0;return o&&!a?(s=i.evaluate(o),O.copy(r,o)):(n=O.lerp([],e.p,t.p,.5),a=i.evaluate(e.p),o=i.evaluate(t.p),i=i.evaluate(n),(s=Math.max(a,o,i))===a&&O.copy(r,e),s===o&&O.copy(r,t),s===i&&O.copy(r,n)),s}Object.defineProperty(r,"__esModule",{value:!0}),r.Vertex=r.Triangle=r.SimplifyOptions=void 0,r.simplify=function(e,t){var r=(0,T.extend)(!0,{},S,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{});return I=e.vertices,R=e.triangles,w(t,r)},r.simplify_three=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=void 0;t.isBufferGeometry&&(n=Object.keys(t.attributes),t=(new THREE.Geometry).fromBufferGeometry(t)),t.mergeVertices(),r=(0,T.extend)(!0,{},S,r),I=[],R=[];for(var i=t,a=i.faces,o=i.faceVertexUvs,s=t.faceVertexUvs.length,u=0;u<t.vertices.length;u++){var l=t.vertices[u],c=new P;c.p[0]=l.x,c.p[1]=l.y,c.p[2]=l.z,I.push(c)}for(var d=0;d<a.length;d++){var f=a[d],h=f.a,p=f.b,f=f.c,m=new E(h,p,f);0<s&&o[0].length===a.length&&(m.uvs=new Array(s).map(function(e){return[]}));for(var g=0;g<s;g++)o[g].length===a.length&&(m.uvs[g]=o[g][d].map(function(e){return O.fromValues(e.x,e.y,0)}));m.id=d,R.push(m)}w(e,r),t.vertices.splice(I.length),t.faces.splice(R.length);for(var _=0;_<s;_++)t.faceVertexUvs[_].splice(R.length);for(var v=0;v<I.length;v++){var y=I[v];t.vertices[v].x=y.p[0],t.vertices[v].y=y.p[1],t.vertices[v].z=y.p[2]}for(var b=0;b<R.length;b++){m=R[b];t.faces[b].a=m.v[0],t.faces[b].b=m.v[1],t.faces[b].c=m.v[2];for(var x=0;x<s;x++)for(var M=0;M<3;M++)t.faceVertexUvs[x][b][M].x=m.uvs[x][M][0],t.faceVertexUvs[x][b][M].y=m.uvs[x][M][1]}return t.verticesNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t=(new THREE.BufferGeometry).fromGeometry(t),n&&Object.keys(t.attributes).forEach(function(e){-1==n.indexOf(e)&&delete t.attributes[e]}),t};function A(){i(this,A),this.tid=0,this.tvertex=0}var O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("s_44")),T=e("e_46"),L=e("i_47"),c=e("M_48"),S=r.SimplifyOptions={agressiveness:7,update:5,recompute:!1},E=r.Triangle=function e(t,r,n){i(this,e),this.v=[t,r,n],this.err=new Array(4),this.deleted=!1,this.dirty=!1,this.n=O.create(),this.uvs=null},P=r.Vertex=function e(){i(this,e),this.p=O.create(),this.tstart=0,this.tcount=0,this.q=null,this.border=!1},I=[],R=[],D=[]},{e_46:17,M_48:18,i_47:20,s_44:21}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Quadric=void 0;var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("s_44"));function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,s),this.m=new Float32Array(10),this.setZero()}r.Quadric=(n(s,null,[{key:"fromPoints",value:function(e,t,r){t=a.subtract(a.create(),t,e),r=a.subtract(a.create(),r,e),t=a.cross(a.create(),t,r),r=new s;return a.normalize(t,t),r.makePlane(t[0],t[1],t[2],-a.dot(t,e)),r}}]),n(s,[{key:"setZero",value:function(){for(var e=0;e<10;++e)this.m[e]=0}},{key:"set",value:function(e,t,r,n,i,a,o,s,u,l){return this.m[0]=e,this.m[1]=t,this.m[2]=r,this.m[3]=n,this.m[4]=i,this.m[5]=a,this.m[6]=o,this.m[7]=s,this.m[8]=u,this.m[9]=l,this}},{key:"makePlane",value:function(e,t,r,n){return this.set(e*e,e*t,e*r,e*n,t*t,t*r,t*n,r*r,r*n,n*n)}},{key:"det",value:function(e,t,r,n,i,a,o,s,u){return this.m[e]*this.m[i]*this.m[u]+this.m[r]*this.m[n]*this.m[s]+this.m[t]*this.m[a]*this.m[o]-this.m[r]*this.m[i]*this.m[o]-this.m[e]*this.m[a]*this.m[s]-this.m[t]*this.m[n]*this.m[u]}},{key:"add",value:function(e){return(new s).set(this.m[0]+e.m[0],this.m[1]+e.m[1],this.m[2]+e.m[2],this.m[3]+e.m[3],this.m[4]+e.m[4],this.m[5]+e.m[5],this.m[6]+e.m[6],this.m[7]+e.m[7],this.m[8]+e.m[8],this.m[9]+e.m[9])}},{key:"addSelf",value:function(e){this.m[0]+=e.m[0],this.m[1]+=e.m[1],this.m[2]+=e.m[2],this.m[3]+=e.m[3],this.m[4]+=e.m[4],this.m[5]+=e.m[5],this.m[6]+=e.m[6],this.m[7]+=e.m[7],this.m[8]+=e.m[8],this.m[9]+=e.m[9]}},{key:"evaluate",value:function(e){var t=this.m,r=i(e,3),n=r[0],e=r[1],r=r[2];return t[0]*n*n+2*t[1]*n*e+2*t[2]*n*r+2*t[3]*n+t[4]*e*e+2*t[5]*e*r+2*t[6]*e+t[7]*r*r+2*t[8]*r+t[9]}},{key:"optimize",value:function(){var e=this.det(0,1,2,1,4,5,2,5,7);if(Math.abs(e)<1e-12)return null;var t=new Float32Array(3);return t[0]=-1/e*this.det(1,2,3,4,5,6,5,7,8),t[1]=1/e*this.det(0,2,3,1,5,6,2,7,8),t[2]=-1/e*this.det(0,1,3,1,4,6,2,5,8),t}}]),s)},{s_44:21}],21:[function(e,t,r){"use strict";function n(){var e=new h.glMatrix.ARRAY_TYPE(3);return h.glMatrix.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){var t=e[0],r=e[1],e=e[2];return Math.hypot(t,r,e)}function a(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function o(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function s(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],e=t[2]-e[2];return Math.hypot(r,n,e)}function l(e,t){var r=t[0]-e[0],n=t[1]-e[1],e=t[2]-e[2];return r*r+n*n+e*e}function c(e){var t=e[0],r=e[1],e=e[2];return t*t+r*r+e*e}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(r,"__esModule",{value:!0}),r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0,r.create=n,r.clone=function(e){var t=new h.glMatrix.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.length=i,r.fromValues=function(e,t,r){var n=new h.glMatrix.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n},r.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},r.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},r.subtract=a,r.multiply=o,r.divide=s,r.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},r.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},r.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},r.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},r.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},r.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},r.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},r.distance=u,r.squaredDistance=l,r.squaredLength=c,r.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},r.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},r.normalize=function(e,t){var r=t[0],n=t[1],i=t[2];return 0<(i=r*r+n*n+i*i)&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},r.dot=d,r.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],t=r[1],r=r[2];return e[0]=i*r-a*t,e[1]=a*o-n*r,e[2]=n*t-i*o,e},r.lerp=function(e,t,r,n){var i=t[0],a=t[1],t=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=t+n*(r[2]-t),e},r.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),a=o*(3-2*a);return e[0]=t[0]*s+r[0]*u+n[0]*l+i[0]*a,e[1]=t[1]*s+r[1]*u+n[1]*l+i[1]*a,e[2]=t[2]*s+r[2]*u+n[2]*l+i[2]*a,e},r.bezier=function(e,t,r,n,i,a){var o=a*a,s=(u=(l=1-a)*l)*l,u=3*a*u,l=3*o*l,a=o*a;return e[0]=t[0]*s+r[0]*u+n[0]*l+i[0]*a,e[1]=t[1]*s+r[1]*u+n[1]*l+i[1]*a,e[2]=t[2]*s+r[2]*u+n[2]*l+i[2]*a,e},r.random=function(e,t){t=t||1;var r=2*h.glMatrix.RANDOM()*Math.PI,n=2*h.glMatrix.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},r.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],t=r[3]*n+r[7]*i+r[11]*a+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/(t=t||1),e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/t,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/t,e},r.transformMat3=function(e,t,r){var n=t[0],i=t[1],t=t[2];return e[0]=n*r[0]+i*r[3]+t*r[6],e[1]=n*r[1]+i*r[4]+t*r[7],e[2]=n*r[2]+i*r[5]+t*r[8],e},r.transformQuat=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=t[0],u=t[1],l=t[2],c=i*l-a*u,d=a*s-n*l,t=i*(r=n*u-i*s)-a*d,a=a*c-n*r,i=n*d-i*c;return d*=o=2*o,r*=o,a*=2,i*=2,e[0]=s+(c*=o)+(t*=2),e[1]=u+d+a,e[2]=l+r+i,e},r.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},r.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},r.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},r.angle=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2],s=(s=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+o*o+s*s))&&d(e,t)/s;return Math.acos(Math.min(Math.max(s,-1),1))},r.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},r.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},r.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},r.equals=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],e=t[1],t=t[2];return Math.abs(r-a)<=h.glMatrix.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-e)<=h.glMatrix.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))&&Math.abs(i-t)<=h.glMatrix.EPSILON*Math.max(1,Math.abs(i),Math.abs(t))};var f,h=e("s_50");r.sub=a,r.mul=o,r.div=s,r.dist=u,r.sqrDist=l,r.len=i,r.sqrLen=c,r.forEach=(f=n(),function(e,t,r,n,i,a){var o,s=void 0;for(t=t||3,r=r||0,o=n?Math.min(n*t+r,e.length):e.length,s=r;s<o;s+=t)f[0]=e[s],f[1]=e[s+1],f[2]=e[s+2],i(f,f,a),e[s]=f[0],e[s+1]=f[1],e[s+2]=f[2];return e})},{s_50:16}],22:[function(e,t,r){"use strict";function o(e){function t(e){var t,r={};for(t in e)if(e.hasOwnProperty(t)&&u(e[t])){var n,i=e[t],a={name:t,needsUpdate:!0,_disposeCallbacks:[],onDispose:function(e){-1==this._disposeCallbacks.indexOf(e)&&this._disposeCallbacks.push(e)},destroy:function(){for(var e=0;e<this._disposeCallbacks.length;e++)this._disposeCallbacks[e].call(this);this._disposeCallbacks.splice(0)}};if(Array.isArray(i)&&3<=i.length&&i.length<=4&&"number"==typeof i[0])e[t]=new l(e[t][0],e[t][1],e[t][2],e[t][3]);else if(u(i.value))for(var o in i)i.hasOwnProperty(o)&&(a[o]=i[o]);for(n in e[t].hasOwnProperty("uuid")?(0,c._defineProperty)(a,"uuid",e[t].uuid,function(e,t){t.needsUpdate=e}):(0,c._defineProperty)(a,"uuid",s(),function(e,t){t.needsUpdate=e}),e[t].hasOwnProperty("value")?(0,c._defineProperty)(a,"value",e[t].value,function(e,t){t.needsUpdate=e}):(0,c._defineProperty)(a,"value",e[t],function(e,t){t.needsUpdate=e}),r[t]=a,i)i.hasOwnProperty(n)&&(a[n]=i[n])}return r}function r(e){a.needsUpdate=e}var n=Cesium,i=n.defaultValue,s=n.createGuid,u=n.defined,l=n.Color;(e=i(e,{})).uniforms=i(e.uniforms,{});var a=this;this.referenceCount=0,this._disposeCallbacks=[],this._uuid=s(),this._defaultColor=i(e.defaultColor,l.WHITE),"string"==typeof this._defaultColor&&(this._defaultColor=l.fromCssColorString(this._defaultColor)),this._pickedColor=i(e.pickedColor,l.YELLOW),"string"==typeof this._pickedColor&&(this._pickedColor=l.fromCssColorString(this._pickedColor)),this._picked=i(e.picked,0),e.uniforms.pickedColor=this._pickedColor,e.uniforms.defaultColor=this._defaultColor,e.uniforms.picked=this._picked,this._uniforms=t(e.uniforms),(0,c._defineProperty)(this,"translucent",i(e.translucent,!1),r),(0,c._defineProperty)(this,"wireframe",i(e.wireframe,!1),r),(0,c._defineProperty)(this,"side",i(e.side,o.Sides.DOUBLE),r),(0,c._defineProperty)(this,"uniformStateUsed",i(e.uniformStateUsed,[{uniformStateName:"model",glslVarName:"modelMatrix"}]),r),(0,c._defineProperty)(this,"uniforms",this._uniforms,function(){a._uniforms=t(a._uniforms)}),this._vertexShader="//#inner\n void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}",this._fragmentShader="//#inner"+this._uuid+"\n uniform float picked;\n uniform vec4  pickedColor;\n uniform vec4  defaultColor;\n void main() {\ngl_FragColor = defaultColor;\n if(picked!=0.0){\ngl_FragColor = pickedColor;}}",(0,c._defineProperty)(this,"vertexShader",i(e.vertexShader,this._vertexShader),r),(0,c._defineProperty)(this,"fragmentShader",i(e.fragmentShader,this._fragmentShader),r),this.userData=e.userData||{},this.depthTest=i(e.depthTest,!0),this.depthMask=i(e.depthMask,!0),this.blending=i(e.blending,!0),this.polygonOffset=i(e.polygonOffset,!1),this.polygonOffsetFactor=i(e.polygonOffsetFactor,1),this.polygonOffsetUnits=i(e.polygonOffsetUnits,0),this.allowPick=i(e.allowPick,!0),this.pickColorQualifier=i(e.pickColorQualifier,"uniform"),this.needsUpdate=!0}Object.defineProperty(r,"__esModule",{value:!0}),r.MeshMaterial=void 0;var c=e("h_51");Object.defineProperties(o.prototype,{uuid:{get:function(){return this._uuid}},defaultColor:{set:function(e){var t=Cesium.Color;"string"==typeof e&&(e=t.fromCssColorString(e)),t.clone(e,this._defaultColor)},get:function(){return this._defaultColor}}}),o.prototype.isMeshMaterial=!0,o.prototype.isMaterial=!0,o.Sides={FRONT:3,BACK:1,DOUBLE:2},o.prototype.onDispose=function(e){-1==this._disposeCallbacks.indexOf(e)&&this._disposeCallbacks.push(e)},o.prototype.addReference=function(){this.referenceCount++},o.prototype.removeReference=function(){if(--this.referenceCount<=0){for(var e=0;e<this._disposeCallbacks.length;e++)this._disposeCallbacks[e].call(this);this._disposeCallbacks.splice(0),this.destroy()}},o.prototype.destroy=function(){for(var e in this._uniforms)this._uniforms.hasOwnProperty(e)&&this._uniforms[e].destroy&&this._uniforms[e].destroy();delete this._programCacheKey},r.MeshMaterial=o},{h_51:172}],23:[function(e,t,r){"use strict";function n(e){(e=e||{}).uniforms=e.uniforms||{shininess:-1,emission:[0,0,0],specular:0};var t=Cesium.defaultValue;e.uniforms.shininess=t(e.uniforms.shininess,0),e.uniforms.emission=t(e.uniforms.emission,[.2,.2,.2]),e.uniforms.specular=t(e.uniforms.specular,0),i.MeshMaterial.apply(this,arguments),this.vertexShader=o.phong_vert,this.fragmentShader=a.phong_frag}Object.defineProperty(r,"__esModule",{value:!0}),r.MeshPhongMaterial=void 0;var i=e("e_27"),a=e("3_53"),o=e("d_54");n.prototype=Object.create(i.MeshMaterial.prototype),r.MeshPhongMaterial=n},{e_27:22,"3_53":35,d_54:36}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e){var i,a;X||(X=!0,t=Cesium,w=t.Matrix4,o=t.Matrix3,s=t.Matrix2,u=t.GeometryPipeline,c=t.defaultValue,d=t.defined,f=t.Texture,t.PixelFormat,t.PixelDatatype,h=t.Cartesian3,p=t.Color,m=t.Ray,g=t.Transforms,_=t.Event,t.PrimitiveType,y=t.RenderState,v=Cesium.CubeMap,x=t.Renderbuffer,M=t.Framebuffer,t.RenderbufferFormat,t.Intersect,b=t.BoundingSphere,(0,G.default)(),(0,F.default)(),T=new w,S=new h,E=new h,C=new h,A=new h,O=new m,L=new w,P=new h,Object.defineProperties(w.prototype,{elements:{get:function(){return this}}}),Object.defineProperties(o.prototype,{elements:{get:function(){return this}}}),Object.defineProperties(s.prototype,{elements:{get:function(){return this}}}),"undefined"!=typeof THREE&&(t=THREE,Object.defineProperties(t.Material.prototype,{autoRefresh:{get:function(){return null==this._autoRefresh&&(this._autoRefresh=!0),this._autoRefresh},set:function(e){this._autoRefresh=e}},translucent:{get:function(){return null==this._translucent&&(this._translucent=!1),this._translucent},set:function(e){this._translucent!=e&&(this._translucent=e,this.needsUpdate=!0)}}}),Object.defineProperties(t.Color.prototype,{red:{get:function(){return this.r},set:function(e){this.r=e}},green:{get:function(){return this.g},set:function(e){this.g=e}},blue:{get:function(){return this.b},set:function(e){this.b=e}},alpha:{get:function(){return 1},set:function(e){}}}),i=[],a=[],Object.defineProperties(t.Object3D.prototype,{modelMatrixNeedsUpdate:{get:function(){return null==this._modelMatrixNeedsUpdate&&(this._modelMatrixNeedsUpdate=!0),this._modelMatrixNeedsUpdate},set:function(e){this._modelMatrixNeedsUpdate=e}},modelMatrix:{get:function(){return null==this._modelMatrix&&(this._modelMatrix=w.IDENTITY.clone()),this._modelMatrix},set:function(e){this._modelMatrix=e}},maxVisibleDistance:{get:function(){return this._maxVisibleDistance||(this._maxVisibleDistance=1/0),this._maxVisibleDistance},set:function(e){if(this._maxVisibleDistance!=e){this._maxVisibleDistance=e;for(var t=this.children,r=0;r<t;r++){var n=this.children[r];n._maxVisibleDistance==1/0&&(n.maxVisibleDistance=e)}}}},instances:{get:function(){return this._instances||(this._instances=i),this._instances},set:function(e){if(this._instances!=e){this._instances=e;for(var t=this.children.length,r=0;r<t;r++){var n=this.children[r];n._instances==i&&(n.instances=e)}e&&0<e.length?this._isCustomInstancedMesh=!0:this._isCustomInstancedMesh=!1}}},instancedAttributes:{get:function(){return this._instancedAttributes||(this._instancedAttributes=a),this._instancedAttributes},set:function(e){if(this._instancedAttributes!=e){this._instancedAttributes=e;for(var t=this.children,r=0;r<t;r++){var n=this.children[r];n._instancedAttributes==a&&(n.instancedAttributes=e)}}}},isCustomInstancedMesh:{get:function(){return null==this._isCustomInstancedMesh&&(this._isCustomInstancedMesh=!1),this._isCustomInstancedMesh}}}),t.Object3D.prototype._updateMatrixWorld=t.Object3D.prototype.updateMatrixWorld,t.Object3D.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,this.modelMatrixNeedsUpdate=e=!0);for(var t=this.children,r=0;r<t.length;r++)t[r].updateMatrixWorld(e)})),!(e=e||{}).modelMatrix&&e.position&&(e.modelMatrix=g.eastNorthUpToFixedFrame(e.position),e.position=new h(0,0,0));var t,r=this;B.Object3D.call(r,e),r.hasTHREE="undefined"!=typeof THREE,r.isMeshVisualizer=!0,r._actualModelMatrix=w.clone(r._modelMatrix),r._actualModelMatrixYup=new w,r._actualModelMatrixXup=new w,r._actualModelMatrixInverse=new w,r._actualModelMatrixYupInverse=new w,r._actualModelMatrixXupInverse=new w,r._modelMatrixNeedsUpdate=!0,r._ready=!0,r._isWireframe=!1,r._debug=!1,r._show=c(e.show,!0),r._center=w.getTranslation(r._modelMatrix,new h),r._framebufferTextures={},r._textureCache={},r._uniformMaps=new WeakMap,r.referenceMesh=new U.ReferenceMesh({axisParameter:c(e.referenceAxisParameter,{length:1e5}),show:c(e.showReference,!1)}),r.add(r.referenceMesh),r._pickIds=[],r.beforeUpdate=new _,r.afterUpdate=new _,r.beforeDestroy=new _,r._scene=e.scene,r.optimizeCommandInit=c(e.optimizeCommandInit,!1),r.optimizeInitCount=c(e.optimizeInitCount,10),r.hasTHREE&&(t=THREE,r._defaultAmbientLight=new t.AmbientLight("white",1),(t=new t.DirectionalLight(p.WHITE.clone(),2)).up.set(0,0,1),t.target.up.set(0,0,1),t.castShadow=!0,t.name="sunLight",r._sunLight=t,this.sunLightShadowRange=e.sunLightShadowRange||500,this.sunLightShadowFar=e.sunLightShadowFar||1e4,this.sunLightShadowSize=e.sunLightShadowSize||2048),r._sunPositionLC=new h,r._sunTargetPositionLC=new h,r._sunTargetPositionWC=new h,r._sunDirectionLC=new h,r.useSunLight=c(e.useSunLight,!1),r.renderer=new V.default(r),r._lights=new Y.default,r.maxChangingCount=10,r.useEncodedPosition=c(e.useEncodedPosition,!1),r.defaultTexture=null,r.defaultCubeMap=null,r.defaultShadowMap=null,r.textureEncoding=null,r._environment=null,r._environmentChanged=!1,r.environment=e.environment,r._backgroundMesh=null,r._background=null,r._backgroundSize=1,r.backgroundIsSkybox=!1,r.backgroundVisibleDistance=1e4,r.effects=[],r.fixedLights=[],r.partialLights=[],r._fixedWebGLLights=new Y.default,r._partialWebGLLights=new Y.default,r._minRange=c(e.minRange,8),r.isMoonVisible=c(e.isMoonVisible,!0),r.isSunVisible=c(e.isMoonVisible,!0),r.initBackground(),r.updateModelMatrix()}Object.defineProperty(r,"__esModule",{value:!0});var w,o,s,u,c,d,f,h,p,m,g,_,v,y,b,x,M,T,S,E,C,A,O,L,P,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I=n(e("-_36")),R=e("M_56"),D=e("i_57"),U=e("k_58"),N=n(e("e_59")),B=e("3_37"),k=n(e("W_61")),j=n(e("e_62")),V=n(e("i_63")),F=n(e("M_64")),G=n(e("e_65")),z=n(e("s_66")),W=n(e("h_67")),a=(n(e("-_68")),e("3_69")),a=(n(a),e("d_70")),a=(n(a),e("__71")),a=(n(a),e("M_72")),H=n(a),Y=n(e("i_73")),X=(n(e("k_74")),!1);l.prototype=Object.assign(Object.create(B.Object3D.prototype),{init:function(e){var t,r,n,i,a=this;e=e.frameState||e,this.renderer.init(e),this._scene||(this._scene=e.camera._scene),this._onCameraChanged||(t=null,this._onCameraChanged=function(){a._cameraChanged=!0,t=t&&clearTimeout(t),t=setTimeout(function(){a._cameraChanged=!1},2e3)},e.camera.changed.addEventListener(this._onCameraChanged)),this.frameState||(this._frameState=e),this.defaultTextureImage||(i=document.createElement("canvas"),(this.defaultTextureImage=i).width=2,i.height=2,(r=i.getContext("2d")).fillStyle="white",r.fillRect(0,0,2,2)),this.defaultCubeMap||((n=this.defaultTextureImage)||((n=document.createElement("canvas")).width=2,n.height=2,this.defaultTextureImage=n),this.defaultCubeMap=new v({context:e.context,source:{positiveX:n,negativeX:n,positiveY:n,negativeY:n,positiveZ:n,negativeZ:n}})),this.defaultTexture||(this.defaultTexture=new f({context:e.context,source:this.defaultTextureImage})),null==this.defaultShadowMap&&((i=document.createElement("canvas")).width=256,i.height=256,this.defaultShadowMap=new f({context:e.context,source:i})),this.defaultFramebuffer||(n=e.context,i=new f({context:n,width:256,height:256}),e=new x({context:n,width:256,height:256,format:33189}),this.defaultFramebuffer=new M({context:n,colorTextures:[i],depthRenderbuffer:e})),this.initBackground(),this.updateEnvironment()},initBackground:function(){var t,e,r;"undefined"==typeof THREE||this._backgroundMesh||(r=THREE,t=this.renderer,(e=this.defaultTextureImage)||((e=document.createElement("canvas")).width=2,e.height=2,this.defaultTextureImage=e),(e=new r.Mesh(new r.BoxBufferGeometry(2,2,2),new r.ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:r.UniformsUtils.clone(r.ShaderLib.cube.uniforms),vertexShader:r.ShaderLib.cube.vertexShader,fragmentShader:r.ShaderLib.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("uv"),e.pass=0,e.frustumCulled=!1,Object.defineProperty(e.material,"envMap",{get:function(){return this.uniforms.envMap.value},set:function(e){e&&(e=t._cubemaps.get(e),this.uniforms.envMap.value=e,this.uniforms.flipEnvMap.value=e.isCubeTexture&&e._needsFlipEnvMap?-1:1)}}),e.material.uniforms.flipEnvMap.value=1,r=this.background||new r.CubeTexture([this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage,this.defaultTextureImage]),e.material.uniforms.envMap.value=r,e.material.uniforms.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,e.scale.setScalar(this._backgroundSize),e.visible=!!this.background,this._backgroundMesh=e,this._background=null)},updateEnvironment:function(e){var t,r,n,i,a=this;(e=e||this._frameState)?this._environmentChanged&&this._environment&&this._environment.isTexture&&(t=this.environment.uuid,(r=this._textureCache[t])||(n=z.default.fromTexure3js(this._environment),i=!1,this._environment.isCubeTexture?(r=z.default.createCubeTexture(n,e.context),i=!0):n.isEmptyTextureUniform||(n.target=3553,r=z.default.createTexture(n,e.context),i=!0),i&&n.onDispose(function(){r.isDestroyed()||r.destroy(),delete a._textureCache[t]}),this._textureCache[t]=r)):console.warn("frameState  is required,this function will be called in the next frame")},remove:function(e,n){for(var i=this,t=Cesium,r=(t.Pass,t.destroyObject,0);r<this._children.length;r++)this._children[r]==e&&this._children.splice(r,1);B.Object3D.traverse(e,function(e){var t,r;N.default.isMesh3js(e)?(r=e.geometry,(t=e.material)&&r&&(n?((Array.isArray(t)?t:[t]).forEach(function(e){return e.dispose()}),r.dispose(),e.dispatchEvent({type:"dispose"},e)):k.default.delete(r))):e.renderItems&&((Array.isArray(e.renderItems)?e.renderItems:[e.renderItems]).forEach(function(e){e.destroy&&e.destroy(),e.material=null}),delete e.renderItems),(e.pickId||e.pickObject)&&((t=e.pickId||e.pickObject.pickId)&&(0<=(r=i._pickIds.indexOf(t))&&i._pickIds.splice(r,1),delete e.pickId,t.destroy&&t.destroy()),e.pickObject&&(delete e.pickObject.pickId,delete e.pickObject)),e._textureCommand&&(e._textureCommand=j.default.freeCommand(e._textureCommand))});var t=this._scene,a=[0,7,8,4];t._view.frustumCommandsList.forEach(function(n){a.forEach(function(e){var t=n.commands[e],r=[];t.forEach(function(e){e.isDestroyed&&e.isDestroyed()||e.vertexArray.isDestroyed()||r.push(e)}),t.length=0,r.forEach(function(e){t.push(e)})})}),t._shaderFrameCount=199},pickPosition:function(e,t){if(this._scene&&(S=this._scene.pickPosition(e,S)))return this.worldCoordinatesToLocal(S,S),h.clone(S,t),t},getPickRay:function(e,t,r){if(this._scene){var n=Cesium,i=n.Cartesian3,n=n.Ray;if(t=t||n(),this._scene.camera.getPickRay(e,O),S=this._scene.pickPosition(e,S))return i.clone(O.direction,E),this.worldCoordinatesToLocal(O.origin,A,r),this.worldCoordinatesToLocal(S,S,r),i.add(A,E,C),i.subtract(S,C,E),i.clone(S,t.origin),i.clone(E,t.direction),t}},worldCoordinatesToLocal:function(e,t,r){t=t||new h;var n=this._actualModelMatrix;return r&&(r.y?n=this._actualModelMatrixYup:r.x&&(n=this._actualModelMatrixXup)),w.inverseTransformation(n,T),w.multiplyByPoint(T,e,t),t},localToWorldCoordinates:function(e,t,r){t=t||new h;var n=this._actualModelMatrix;return r&&(r.y?n=this._actualModelMatrixYup:r.x&&(n=this._actualModelMatrixXup)),w.multiplyByPoint(n,e,t),t},onModelMatrixNeedUpdate:function(){this._modelMatrixNeedsUpdate=!0},toWireframe:function(e){return 4!==e.primitiveType&&6!==e.primitiveType&&5!==e.primitiveType||(e.triangleIndices||(e.triangleIndices=e.indices),void 0===e._oldPrimitiveType&&(e._oldPrimitiveType=e.primitiveType),(e=u.toWireframe(e)).primitiveType=1),e},restoreFromWireframe:function(e){return 0==e.primitiveType||(e.triangleIndices&&(e.indices=e.triangleIndices),void 0!==e._oldPrimitiveType&&(e.primitiveType=e._oldPrimitiveType)),e},computeModelMatrix:function(e){var t,r;e.parent&&e.parent instanceof D.LOD?e.modelMatrix=w.clone(e.parent.modelMatrix,e.modelMatrix):e.modelMatrixNeedsUpdate&&(t=e.matrixWorld.elements,r=e.modelMatrix,e.up.y?w.multiply(this._actualModelMatrixYup,t,r):e.up.x?w.multiply(this._actualModelMatrixXup,t,r):w.multiply(this._actualModelMatrix,t,r),e.forward&&e.forward.z&&w.multiplyTransformation(r,Cesium.Axis.Z_UP_TO_X_UP,r))},updateModelMatrix:function(){var e=this,t=e._actualModelMatrix,r=e._actualModelMatrixYup,n=e._actualModelMatrixXup;w.multiply(e.modelMatrix,e.matrixWorld,t),I.default.yUp2Zup(t,r),w.multiplyTransformation(t,Cesium.Axis.X_UP_TO_Z_UP,n),w.inverse(t,e._actualModelMatrixInverse),w.inverse(r,e._actualModelMatrixYupInverse),w.inverse(n,e._actualModelMatrixXupInverse),w.getTranslation(t,e._center)}}),l.prototype=Object.assign(l.prototype,{computeObjectVisibility:function(r,e,t){var n,i,a,o,s,u,l;if(0==r.frustumCulled)return r.isCustomInstancedMesh&&(n=r._availableInstances||[],(r._availableInstances=n).length=0,r.instances.forEach(function(e){n.push(e)})),void(r.mvis_visibility=0);r.isInstancedMesh||!r.geometry||((l=r.modelMatrixNeedsUpdate)||t)&&(i=e.camera,a=e.cullingVolume,s=H.default.get(r.geometry),o=s.boundingSphere,t=s.boundingVolume,r.isCustomInstancedMesh?(s=r.instances,u=r._availableInstances||[],(r._availableInstances=u).length=0,s.forEach(function(e){var t;e.show&&((t=e.boundingSphere).radius=o.radius*e.scale,e.modelMatrixNeedsUpdate&&w.getTranslation(e.modelMatrix,t.center),e.mvis_distanceToCamera=i.distanceToBoundingSphere(t),e.mvis_visibility=1,r.maxVisibleDistance&&e.mvis_distanceToCamera>r.maxVisibleDistance?e.mvis_visibility=-1:(e.mvis_visibility=a.computeVisibility(t),-1!=e.mvis_visibility&&u.push(e)))})):(l&&(l=r.modelMatrix,w.multiplyByPoint(l,o.center,t.center),t.radius=o.radius*w.getMaximumScale(r.modelMatrix)),r.mvis_distanceToCamera=i.distanceToBoundingSphere(t),r.mvis_visibility=1,(I.default.computeRange(r.mvis_distanceToCamera,t.radius,e)<this.minRange||r.maxVisibleDistance&&r.mvis_distanceToCamera>r.maxVisibleDistance)&&(r.mvis_visibility=-1),-1!=r.mvis_visibility&&(r.mvis_visibility=a.computeVisibility(t))))},isRenderItemVisible:function(e,t){if(!e.frustumCulled)return!0;var r=e.boundingVolume,n=t.camera.distanceToBoundingSphere(r),i=I.default.computeRange(n,r.radius,t);return e.distanceToCamera=n,!(i<this.minRange)&&(0!=e.object.mvis_visibility||-1!=t.cullingVolume.computeVisibility(r))},isLightVisible:function(e,t){var r=e.boundingSphere;return!e.modelMatrixNeedsUpdate&&r||(r||(r=new b,e.boundingSphere=r),w.getTranslation(e.modelMatrix,r.center),r.radius=e.distance),(this._cameraChanged||e.modelMatrixNeedsUpdate)&&(e._exVisible=-1!=t.cullingVolume.computeVisibility(r)),e._exVisible},updateExtensionLight:function(e,t){e.matrixAutoUpdate&&e.updateMatrixWorld(),!e.modelMatrixNeedsUpdate&&e.boundingSphere||this.computeModelMatrix(e),this.isLightVisible(e,t),e.modelMatrixNeedsUpdate=!1},projectObject:function(e,t,r,n,i){if(e.isObject3D&&(e.show||e.visible))if(e.isGroup||e.isScene)for(var a=e.children,o=0;o<a.length;o++)this.projectObject(a[o],t,r,n,i);else{e.isLOD?(e instanceof D.LOD&&(e.parent&&e.parent!=this&&e.parent.modelMatrix?e.update(e.parent.modelMatrix,t):e.update(this._actualModelMatrix,t)),!0===e.autoUpdate&&e.update(r)):e.isLight?(e.isPointLight?this.updateExtensionLight(e,t):this.computeModelMatrix(e),n.pushLight(e),e.target&&(e.target.matrixAutoUpdate&&e.target.updateMatrixWorld(),this.computeModelMatrix(e.target)),e.castShadow&&n.pushShadow(e)):(e.isMesh||e.isLine||e.isPoints||e.Sprite)&&(e.isCustomInstancedMesh||this.computeModelMatrix(e),this.computeObjectVisibility(e,t,this._cameraChanged,i),!(-1!=e.mvis_visibility)||t.passes.pick&&0==e.material.allowPick?e.modelMatrixNeedsUpdate=!1:n.pushRenderable(e));for(var s=e.children,u=0;u<s.length;u++)this.projectObject(s[u],t,r,n,i)}},updateBackground:function(e,t,r){var n,i=this._backgroundMesh;i&&i.visible&&(this.backgroundIsSkybox?(i.scale.setScalar(1),i.updateMatrixWorld(),i.matrixWorld.copyPosition(t.matrixWorld),(n=h.distance(e.camera.positionWC,this._center))>this.backgroundVisibleDistance?i.material.uniforms.opacity.value=1-(n-this.backgroundVisibleDistance)/this.backgroundVisibleDistance:i.material.uniforms.opacity.value=1):i.updateMatrixWorld(),this.computeModelMatrix(i),this.renderer._webglRenderItems.getAndUpdate(i,e,!1,r,t))},updateSunLight:function(e){var t=this,r=t._scene.light,n=t._sunLight,i=n.shadow,a=i.camera,o=(e.shadowState,e.context.uniformState),s=o._sunPositionWC,u=o._sunDirectionWC,l=t._sunPositionLC,e=t._sunTargetPositionLC,o=t._sunTargetPositionWC,t=t._sunDirectionLC;this.worldCoordinatesToLocal(s,l,{y:1}),h.subtract(s,u,o),this.worldCoordinatesToLocal(o,e,{y:1}),h.subtract(l,e,t),n&&(o=n.target,p.clone(n.color,r.color),n.intensity=r.intensity,e=this.sunLightShadowFar,t=this.sunLightShadowRange,r=this.sunLightShadowSize,n.position.copy(l).normalize().multiplyScalar(e),n.updateMatrixWorld(),o.updateMatrixWorld(),this.computeModelMatrix(n),this.computeModelMatrix(o),i.mapSize.set(r,r),a.left=-t,a.right=t,a.top=t,a.bottom=-t,a.far=2*e,a.near=.1,a.updateProjectionMatrix())},projectObjects:function(e,t,r,n,i){var a=this,o=n.dynamicRenderables;if(e.children.forEach(function(e){"function"==typeof e.render&&e.render(t,o,a.renderer,r,n),(e.visible||e.show)&&e.isObject3D&&(e.matrixAutoUpdate||e.modelMatrixNeedsUpdate)&&(e.updateMatrixWorld(),a.computeModelMatrix(e))}),e.isMeshVisualizer)for(var s=e.children,u=0;u<s.length;u++)this.projectObject(s[u],t,r,n,i);else this.projectObject(e,t,r,n,i);for(var l=0;l<o.length;l++)this.projectObject(o[l],t,r,n,i)},createOrUpdateCommands:function(o,s,u,l){var c=this,d=!1,f=o.camera._scene._globe._surface.tileProvider._debug.wireframe;f!=this._sysWireframe&&(d=!0),this._sysWireframe=f;var e=o.camera,t=e.frustum,h=this._cameraChanged;w.multiply(t.projectionMatrix,e.viewMatrix,L);for(var p=s.renderList,m=s.renderables,g=this.renderer._webglRenderItems,_=this.optimizeInitCount,v=this.optimizeCommandInit,y=[],b=0,r=m.length;b<r;b++){var x,M,n=function(){var e=m[b];if(v&&y.length>=_)return"continue";if(e.isRuntimeMesh){if(M=!(M=!e.renderItems||e.needsUpdate||e.geometry.needsUpdate||d)&&e.material.wireframe&&e.renderItems&&(4==e.renderItems.drawCommand.primitiveType||5==e.renderItems.drawCommand.primitiveType||6==e.renderItems.drawCommand.primitiveType)?!0:M){if(e._availableInstances&&0==e._availableInstances.length)return{v:void 0};f||e.material.wireframe?c.toWireframe(e.geometry):c.restoreFromWireframe(e.geometry),e.renderItems&&(k.default.delete((e.mesh3js||e).geometry),j.default.freeCommand(e.renderItems.drawCommand)),e.renderItems=j.default.create(e,o,c),e.beforeDestroy?e.beforeDestroy.addEventListener(function(){e.renderItems&&c.remove(e)}):e.addEventListener("dispose",function(){e.renderItems&&c.remove(e)})}else k.default.update(e,o.context,e.renderItems.drawCommand);if(j.default.update(e,o,c),M=e.renderItems,w.getTranslation(e.modelMatrix,P),w.multiplyByPoint(L,P,P),M.z=P.z,!M.loaded){if(v&&y.length>=_)return"continue";y.push(M),M.loaded=!0}p.push(M)}else{var t=g.getAndUpdate(e,o,f,s,u);x=e.modelMatrixNeedsUpdate||c.modelMatrixNeedsUpdate||h,1==t.length&&(t[0].visible=!0,x=!1);for(var r=0,n=t.length;r<n;r++){var i=t[r],a=i.boundingVolume;if(w.multiplyByPoint(L,a.center,P),i.z=P.z,0!=i.material.visible&&(!x&&null!=i.visible||(i.visible=c.isRenderItemVisible(i,o,l)),0!=i.visible)){if(!i.loaded){if(v&&y.length>=_)return{v:void 0};y.push(i),i.loaded=!0}e!=c._backgroundMesh&&p.push(i)}}}}();if("continue"!==n&&"object"===(void 0===n?"undefined":i(n)))return n.v}p.sort()},getAndUpdateRenderState:function(e,t,r,n){var i=this.renderer._webglRenderStates.get(e,t.camera);return i.init(),this.updateSunLight(t),this.updateBackground(t,r,i),this.projectObjects(e,t,r,i,n),i},update:function(t,e,r){var n,i=this;if(t.mode===Cesium.SceneMode.SCENE3D&&(this.init(t),this._ready&&(e||this.show)&&((e=e||this).geometry||0!=e.children.length))){var a=!!r,o=t.camera;this.updateSunLight(t),!a&&t.passes.render&&(this.mainCamera=o,this.beforeUpdate.raiseEvent(t));var s=this.renderer,u=s.shadowMap,l=s._webglRenderStates,c=l.get(e,o),d=c.renderList,f=this._backgroundMesh,h=a?r:t.commandList;if(t.passes.offscreen||t.passes.depth||t.passes.pick)(this.mainCamera?l.get(e,this.mainCamera):d).getDrawCommands(h);else{c.lights=this._lights,c.init(),s._webglRenderItems.changingState.maxChangingCount=this.maxChangingCount,this._modelMatrixNeedsUpdate&&(this._backgroundMesh&&(this._backgroundMesh.modelMatrixNeedsUpdate=!0),this.updateModelMatrix());var p,m=o._referenceFrame||{matrix:this._actualModelMatrixYup,inverseMatrix:this._actualModelMatrixYupInverse},g=!1,_=!1,r=s._clipping;this.hasTHREE&&(p=o.isOrthographicCamera?W.default.toOrthographicCamera3js(o,null,m):W.default.toPerspectiveCamera3js(o,null,m),o._referenceFrame||(p._referenceFrame=m),g=s.localClippingEnabled,_=r.init(s.clippingPlanes,g,p),c.clippingEnabled=_,c.localClippingEnabled=g,!a&&t.passes.render&&e.children.forEach(function(e){e.isIRenderable&&e.onBeforeRender&&e.onBeforeRender(t,i.renderer,p,c)}));l=a?W.default.getFrustum3js(p):null;this.projectObjects(e,t,p,c,l);var v,y=c.renderables,g=c.shadowsArray,b=c.lightsArray;if(this.hasTHREE){!0===_&&r.beginShadows();for(var x=null,M=o._referenceFrame,x=o.isOrthographicCamera?W.default.toOrthographicCamera3js(o,null,m):W.default.toPerspectiveCamera3js(o,null,m),w=0;w<y.length;w++){var T=y[w];T.visible&&T.onBeforeRender&&T.onBeforeRender!=THREE.Object3D.prototype.onBeforeRender&&(m=M||{matrix:this._actualModelMatrixYup,inverseMatrix:this._actualModelMatrixYupInverse},x._referenceFrame=m,T.onBeforeRender(s,e,x,this._scene),x._referenceFrame=M)}}this.useSunLight&&this._sunLight.castShadow&&!t.shadowState.shadowsEnabled&&c.pushShadow(this._sunLight),u.enabled||(g.length=0),u.autoUpdate&&u.render(g,e,t,this),0==b.length&&this.hasTHREE&&c.pushLight(this._defaultAmbientLight),this.useSunLight&&c.pushLight(this._sunLight),c.setupLights(o),this.fixedLights.forEach(function(e){i.updateExtensionLight(e,t)}),this.partialLights.forEach(function(e){i.updateExtensionLight(e,t)}),this._fixedWebGLLights.setup(this.fixedLights,null,o,t),this._partialWebGLLights.setup(this.partialLights,null,o,t),!0===_&&r.endShadows(),this.createOrUpdateCommands(t,c,p,l),f&&(this.updateBackground(t,p,c),v=f.renderItems,!this.backgroundIsSkybox&&v&&d.push(v[0])),d.getDrawCommands(h);for(var S,E,C=0;C<this.effects.length;C++){var A=this.effects[C];if(A.enabled&&(A.preUpdate||A.preUpdate)){A.name||(A.name="effect-"+Cesium.createGuid()),A.preUpdate(e,p,t,c);for(var O=A.selected||y,L=0;L<O.length;L++){var P=O[L];if(!P.isRuntimeMesh)for(var I=P.renderItems,R=H.default.get(P.geometry),D=P.material,U=Array.isArray(D),N=0;N<I.length;N++){var B=I[N],k=B.materialIndex,k=U?D[k]:D;P.onBeforeRender&&P.onBeforeRender(s,e,p,R,k);B=s._webglRenderItems.getAndUpdateDerived(P,R,k,B,A.name,t,c,p);B&&(P.onAfterRender&&P.onAfterRender(s,e,p,R,k),h.push(B))}}A.postUpdate&&A.postUpdate(e,p,t,c)}}for(S in this._framebufferTextures)this._framebufferTextures.hasOwnProperty(S)&&(E=this._framebufferTextures[S].value,this.updateFrameBufferTexture(t,E));l=this._scene._environmentState,d=this.backgroundIsSkybox&&f&&f.visible&&f.renderItems;if(a)l.isMoonVisible&&this.isMoonVisible&&h.unshift(l.moonCommand),l.isSunVisible&&this.isSunVisible&&h.unshift(l.sunDrawCommand),d&&(F=v[0].drawCommand,h.unshift(F)),this.mainCamera!=o&&c.init();else{for(var j=0;j<y.length;j++){var V=y[j];V.onBeforeFinalRender&&V.onBeforeFinalRender(s,e,x,this._scene),n=y[j],V=void 0,V=n.material,n.needsUpdate=!1,n.modelMatrixNeedsUpdate=!1,n.instances&&n.instances.forEach(function(e){e.modelMatrixNeedsUpdate=!1}),1==V.needsUpdate&&(V.needsUpdate=!1)}for(var F,G=0;G<b.length;G++)b[G].modelMatrixNeedsUpdate=!1;l.skyAtmosphereCommand&&d&&(F=v[0].drawCommand,l.isSkyAtmosphereVisible=!0,.5<f.material.uniforms.opacity.value&&(l.skyAtmosphereCommand=F)),this.afterUpdate.raiseEvent(t)}this._modelMatrixNeedsUpdate=!1,this.frameNumber=t.frameNumber,this._environmentChanged=!1}}},destroy:function(){var e,t=this;for(e in this.beforeDestroy.raiseEvent(this),this._ready=!1,l.traverse(this,function(e){t.remove(e),e.dispose&&e.dispose(),e.destroy&&e.destroy()},!1),this.renderer.dispose(),this._textureCache)this._textureCache.hasOwnProperty(e)&&delete this._textureCache[e];for(e in this._materials&&this._materials.forEach(function(e){t._uniformMaps.delete(e)}),this._framebufferTextures)this._framebufferTextures.hasOwnProperty(e)&&delete this._framebufferTextures[e];if(this._textureCache={},this._framebufferTextures={},this._pickIds)for(e=0;e<this._pickIds.length;++e)this._pickIds[e].destroy&&this._pickIds[e].destroy();this._pickIds.splice(0)}}),(l.prototype=Object.assign(l.prototype,{initFrameBufferTexture:function(a,e,o){var s=this,u=e;u instanceof R.FramebufferTexture&&(u.drawCommands=[],l.traverse(u.object,function(e){var t,r,n,i;N.default.isMesh3js(e)?console.warn("FramebufferTexture:unsupport three.js's object "):(s.computeModelMatrix(e,a),!e._textureCommand||e.needsUpdate||e.geometry.needsUpdate?(e.material.wireframe?s.toWireframe(e.geometry):s.restoreFromWireframe(e.geometry),e._textureCommand=j.default.create(e,a,s).drawCommand,e.needsUpdate=!1,e.material.needsUpdate=!1):k.default.update(e,a.context,e._textureCommand),e._textureCommand.modelMatrix=e.modelMatrix,r=(t=a.context).drawingBufferWidth,n=t.drawingBufferHeight,u.texture&&u.texture.width==r&&u.texture.height==n||((i=u._notFullScreen||d(u.texture))||(u.texture&&u.texture._createByMeshVisualizer&&u.texture.destroy(),u._texture=new f({context:t,width:r,height:n,pixelFormat:6408}),u._texture._createByMeshVisualizer=!0),u._notFullScreen=i),u.depthTexture&&u.depthTexture.width==u.texture.width&&u.depthTexture.height==u.texture.height||(u.depthTexture=new f({context:t,width:u.texture.width,height:u.texture.height,pixelFormat:6402,pixelDatatype:5123})),e.material._renderStateOptions.depthTest.enabled=e.material.depthTest,o&&(e.material._renderStateOptions.viewport=o),e._textureCommand.renderState=y.fromCache(e.material._renderStateOptions),u.drawCommands.push(e._textureCommand))},!0))},updateFrameBufferTexture:function(e,t,r){this.initFrameBufferTexture(e,t,r);var n=t;if(n.drawCommands&&0<n.drawCommands.length){n.depthTexture=I.default.renderToTexture(n.drawCommands,e,n.framebuffer||n.texture,n.depthTexture);for(var i=0;i<n.drawCommands.length;i++)n.drawCommands[i]._renderStateOptions.viewport=void 0,n.drawCommands[i].renderState=y.fromCache(n.drawCommands[i]._renderStateOptions)}t.ready||(t.ready=!0,t.readyPromise.resolve(t))},getPixels:function(e,t,r,n,i){(r=r||{}).x=r.x||0,r.y=r.y||0,r.width||(r.width=e.context._canvas.width),r.height||(r.height=e.context._canvas.height),this.initFrameBufferTexture(e,t,r);var a=t;if(a.drawCommands&&0<a.drawCommands.length){if(!a._computeTexture||a._computeTexture&&(a._computeTexture.width!=r.width||a._computeTexture.height!=r.height)){var o=r.pixelDatatype,t=r.pixelFormat;if(5126==o&&!e.context._gl.getExtension("OES_texture_float"))throw new Cesium.DeveloperError("此设备不支持浮点型纹理");a._computeTexture&&(a._computeTexture.destroy(),a._computeTexture=null),a._computeTexture=new f({context:e.context,width:r.width,height:r.height,pixelFormat:t,pixelDatatype:o})}i=I.default.renderToPixels(a.drawCommands,e,a._computeTexture,n||r,i);for(var s=0;s<a.drawCommands.length;s++)a.drawCommands[s].renderState.viewport=void 0;return i}return null}})).add=function(e){(e.visualizer=this)._children.push(e)},l.traverse=function(e,t,r,n){if(e&&((n=n||{cancelCurrent:!1,cancelAll:!1}).cancelCurrent=!1,!r||e.show||e.visible)){e instanceof l||!(e.geometry&&e.material||e.isLight||e.isGroup||e.isObject3D||e.isScene)||t(e,n);var i=e.children;if(i){for(var a=0;a<i.length;a++)if(!n.cancelCurrent){if(n.cancelAll)break;l.traverse(e.children[a],t,r,n)}}else e.scene&&l.traverse(e.scene,t,r,n)}},Object.defineProperties(l.prototype,{sunPositionLC:{get:function(){return this._sunPositionLC}},sunDirectionLC:{get:function(){return this._sunDirectionLC}},background:{get:function(){return this._background},set:function(e){var t,r;e&&e.isColor||(this._background=e,(t=this._backgroundMesh)&&(e?((r=t.material).envMap!=e&&(r.needsUpdate=!0),r.envMap=e,t.visible=!0):t.visible=!1))}},backgroundSize:{get:function(){return this._backgroundSize},set:function(e){this._backgroundSize=e=e||1;var t=this._backgroundMesh;t&&t.scale.setScalar(e)}},backgroundMesh:{get:function(){return this._backgroundMesh}},environment:{get:function(){return this._environment},set:function(e){var t=this,r=t._environment;e&&e.isTexture?(t._environment=e,t._environmentChanged=!0):r&&(e=r.uuid,(r=t._textureCache[e])&&(r.destroy(),delete t._textureCache[e]),t._environment=null,t._environmentChanged=!0)}},pickIds:{get:function(){return this._pickIds}},scene:{set:function(e){this._scene=e},get:function(){return this._scene}},frameState:{get:function(){if(this._scene)return this._frameState}},showReference:{get:function(){return this.referenceMesh.show},set:function(e){this.referenceMesh.show=e}},show:{get:function(){return this._show},set:function(e){this._show=e}},ready:{get:function(){return this._ready}},minRange:{get:function(){return this._minRange},set:function(e){var t=this;t._minRange!=e&&(t._minRange=e,t._cameraChanged=!0,requestAnimationFrame(function(){t._cameraChanged=!1}))}}}),r.default=l},{h_67:7,e_65:8,M_56:10,k_74:12,i_57:14,"3_37":25,k_58:26,"-_36":27,M_64:29,e_62:43,e_59:46,s_66:53,W_61:55,M_72:60,i_73:61,"-_68":67,__71:68,d_70:70,"3_69":71,i_63:72}],25:[function(e,t,r){"use strict";function l(e){e=e||{};var t=Cesium,r=this,n=t.Cartesian3,i=t.createGuid,a=t.defaultValue,o=t.Matrix4,s=t.Quaternion;r.uuid=i(),r._position=a(e.position,new n(0,0,0)),r._scale=a(e.scale,new n(1,1,1)),r._rotation=a(e.rotation,{axis:new n(0,0,1),angle:0}),r._rotation=new d.Rotation(r._rotation.axis,r._rotation.angle),r._children=[],r._up=a(e.up,new n(0,0,1)),r._parent=e.parent||null,r.show=!0,r._needsUpdate=!1,r._modelMatrix=e.modelMatrix||o.IDENTITY.clone(),r.castShadow=a(e.castShadow,!1),r._matrix=o.IDENTITY.clone(),r._matrixWorld=o.IDENTITY.clone(),r._quaternion=e.quaternion||new s,r.matrixAutoUpdate=!1,r._modelMatrixNeedsUpdate=!0,r._onQuatNeedUpdateChanged=function(){var e=r._rotation;s.fromAxisAngle(e.axis,t.Math.toRadians(e.angle),r.quaternion),r.updateMatrixWorld()},r._rotation.paramChanged.addEventListener(r._onQuatNeedUpdateChanged),r._onQuatNeedUpdateChanged()}function n(e,t,r,n){var i=Cesium,a=i.Matrix4,i=i.Cartesian3,n=n=n||new a;return u=u||new i,c=c||new i,s=s||new i,i.subtract(t,e,s),0===i.magnitudeSquared(s)&&(s.z=1),i.normalize(s,s),i.cross(r,s,u),0===i.magnitudeSquared(u)&&(1===Math.abs(r.z)?s.x+=1e-4:s.z+=1e-4,i.normalize(s,s),i.cross(r,s,u)),i.normalize(u,u),i.cross(s,u,c),n[0]=u.x,n[4]=c.x,n[8]=s.x,n[1]=u.y,n[5]=c.y,n[9]=s.y,n[2]=u.z,n[6]=c.z,n[10]=s.z,n}Object.defineProperty(r,"__esModule",{value:!0}),r.Object3D=void 0;var o,s,u,c,i,a,d=e("e_75");l.prototype.traverse=function(e){l.traverse(this,e,this.parent)},l.traverse=function(e,t,r){if(e.length)for(var n=0;n<e.length;n++){var i=e[n];l.traverse(i,t,e)}else{t(e,r);var a=e.children;if(a)for(var o=a.length,s=0;s<o;s++){var u=a[s];l.traverse(u,t,e)}}},Object.defineProperties(l.prototype,{matrix:{get:function(){return this._matrix}},matrixWorld:{get:function(){return this._matrixWorld}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){e&&(this._modelMatrix=e)}},up:{get:function(){return this._up},set:function(e){e&&(this._up=e)}},parent:{get:function(){return this._parent},set:function(e){e!=this._parent&&(this._parent=e,this.updateMatrixWorld())}},modelMatrixNeedsUpdate:{get:function(){return this._modelMatrixNeedsUpdate},set:function(e){this._modelMatrixNeedsUpdate=e}},children:{get:function(){return this._children},set:function(e){this._children=e,this._needsUpdate=!0}},needsUpdate:{get:function(){return this._needsUpdate},set:function(e){this._needsUpdate=e}},rotation:{get:function(){return this._rotation},set:function(e){e!=this._rotation&&(this._rotation=e,this._onQuatNeedUpdateChanged()),this._rotation.paramChanged.removeEventListener(this._onQuatNeedUpdateChanged),this._rotation=e,this._rotation.paramChanged.addEventListener(this._onQuatNeedUpdateChanged)}},quaternion:{set:function(e){Cesium.Quaternion.equals(e,this._quaternion)||(this._quaternion=e,this.updateMatrixWorld())},get:function(){return this._quaternion}},position:{get:function(){return this._position},set:function(e){var t=this._position;e.x==t.x&&e.y==t.y&&e.z==t.z||(this._position=e,this.updateMatrixWorld())}},scale:{get:function(){return this._scale},set:function(e){e.x==this._scale.x&&e.y==this._scale.y&&e.z==this._scale.z||(this._scale=e,this.updateMatrixWorld())}}}),l.prototype.isObject3D=!0,l.decomposeModelMatrix=function(e,t,r,n){var i=Cesium,a=i.Matrix4,i=i.Quaternion;o=o||new Matrix3,a.getTranslation(e,t),a.getMatrix3(e,o),a.getScale(e,n),i.fromRotationMatrix(o,r)},l.prototype.decomposeModelMatrix=function(e,t,r){l.decomposeModelMatrix(this.modelMatrix,e,t,r)},l.prototype.setPosition=function(e,t,r){var n=!1,i=this._position;1==arguments.length&&("number"==typeof e?(e!=i.x&&(n=!0),i.x=e):e instanceof Cesium.Cartesian3&&(e==i.x&&t==i.y&&r==i.z||(n=!0),i.x=e.x,i.y=e.y,i.z=e.z)),2==arguments.length&&"number"==typeof t&&(t!=i.y&&(n=!0),i.y=t),3==arguments.length&&"number"==typeof r&&(r!=i.z&&(n=!0),i.z=r),n&&this.updateMatrixWorld()},l.prototype.setScale=function(e,t,r){var n=!1;1==arguments.length&&("number"==typeof e?(e!=this._scale.x&&(n=!0),this._scale.x=e):e instanceof Cesium.Cartesian3&&(e==this._scale.x&&t==this._scale.y&&r==this._scale.z||(n=!0),this._scale.x=e.x,this._scale.y=e.y,this._scale.z=e.z)),2==arguments.length&&"number"==typeof t&&(t!=this._scale.y&&(n=!0),this._scale.y=t),3==arguments.length&&"number"==typeof r&&(r!=this._scale.z&&(n=!0),this._scale.z=r),n&&this.updateMatrixWorld()},l.prototype.updateMatrix=function(){var e=this;Cesium.Matrix4.fromTranslationQuaternionRotationScale(e.position,e.quaternion,e.scale,e._matrix),e.modelMatrixNeedsUpdate=!0},l.prototype.updateMatrixWorld=function(){var e,t=this;t.updateMatrix(),t._parent?(e=(e=t._parent.matrixWorld).elements||e,Cesium.Matrix4.multiply(e,t._matrix,t._matrixWorld)):t._matrix.clone(t._matrixWorld),t._children.forEach(function(e){e.updateMatrixWorld(),e.modelMatrixNeedsUpdate=!0})},l.prototype.dispatchEvent=function(e){},l.prototype.add=function(e){e.parent!==this&&(e.parent=this),this._children.push(e)},l.prototype.remove=function(e){for(var t=0;t<this._children.length;t++)if(this._children[t]==e)return this._children.splice(t,1)},l.prototype.lookAt=function(e){i=this.isCamera||this.isLight?n(e,this.position,this.up,i):n(this.position,e,this.up,i);e=Cesium;a=a||new e.Matrix3,e.Matrix4.getMatrix3(i,a),this.quaternion=e.Quaternion.fromRotationMatrix(a,this.quaternion),this.updateMatrixWorld()},l.DefaultUp={x:0,y:0,z:1e3},r.Object3D=l},{e_75:28}],26:[function(e,t,r){"use strict";function n(e){o=o||Cesium.defaultValue,e=Cesium.defaultValue(e,{}),c.Object3D.call(this,e),this._axisParameter=new s.ArrowGeometry(e.axisParameter),this._axisParameterY=new s.ArrowGeometry(e.axisParameter),this._axisParameterY.reverse=!0;var t=new l.MeshMaterial({defaultColor:"rgba(255,0,0,1)",wireframe:!1,side:l.MeshMaterial.Sides.DOUBLE,translucent:!1}),r=new l.MeshMaterial({defaultColor:"rgba(0,255,0,1)",wireframe:!1,side:l.MeshMaterial.Sides.DOUBLE,translucent:!0}),n=new l.MeshMaterial({defaultColor:"rgba(0,0,255,1)",wireframe:!1,side:l.MeshMaterial.Sides.DOUBLE,translucent:!1}),i=s.ArrowGeometry.createGeometry(new s.ArrowGeometry(this._axisParameter)),a=s.ArrowGeometry.createGeometry(new s.ArrowGeometry(this._axisParameterY)),t=new u.Mesh(i,t),r=new u.Mesh(a,r),n=new u.Mesh(i,n);t.position={z:this._axisParameter.length/2,x:0,y:0},r.position={y:-this._axisParameter.length/2,x:0,z:0},r.rotation.axis.y=1,r.rotation.angle=-180,n.position={x:this._axisParameter.length/2,y:0,z:0},n.rotation.axis.x=1,n.rotation.angle=-180,n.parent=this,r.parent=this,(t.parent=this)._children=[n,r,t],this.x=n,this.y=r,this.z=t,this.show=o(e.show,!0),this._needsUpdate=!0,this._modelMatrixNeedsUpdate=!0,this._parent=null,this.updateMatrixWorld()}Object.defineProperty(r,"__esModule",{value:!0}),r.ReferenceMesh=void 0;var o,s=e("s_76"),u=e("W_77"),l=e("e_27"),c=e("3_37");n.removeByValue=function(e,t){for(var r=0;r<e.length;r++)if(e[r]==t){e.splice(r,1);break}},n.prototype=Object.create(c.Object3D.prototype),r.ReferenceMesh=n},{s_76:5,W_77:15,e_27:22,"3_37":25}],27:[function(e,t,r){"use strict";function f(){}function d(e,t){var r,n=Cesium;t!==e._currentFramebuffer&&("undefined"!=typeof WebGLRenderingContext&&(i=[1029]),e._currentFramebuffer=t,r=i,n.defined(t)?(t._bind(),function(e){if(e.validateFramebuffer){var t,r=e._gl,e=r.checkFramebufferStatus(r.FRAMEBUFFER);if(e!==r.FRAMEBUFFER_COMPLETE){switch(e){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:t="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:t="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:t="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case r.FRAMEBUFFER_UNSUPPORTED:t="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new DeveloperError(t)}}}(e),r=t._getActiveColorAttachments()):(t=e._gl).bindFramebuffer(t.FRAMEBUFFER,null),e.drawBuffers&&e.glDrawBuffers(r))}var a,l,c,h,p,m,o,i,s;Object.defineProperty(r,"__esModule",{value:!0}),f.computeRange=function(e,t,r,n){var i=Cesium,a=i.defaultValue(n,1),n=r.camera;return t*(r.context.drawingBufferHeight*a)/(Math.max(e,i.Math.EPSILON7)*n.frustum.sseDenominator)/r.pixelRatio},f.projectSphere=function(e,t,r){var n=Cesium;o=o||new n.Cartesian4;var i=n.Matrix4.multiplyByPoint(t,e.center,o),t=e.radius*e.radius,e=i.z*i.z,i=n.Cartesian3.dot(i,i);return-Math.PI*r*r*t*Math.sqrt(Math.abs((i-t)/(t-e)))/(t-e)},f.renderToTexture=function(e,t,r,n){var i=Cesium,a=i.Framebuffer,o=i.Texture,s=(i.PixelFormat,i.PixelDatatype,i.ClearCommand),u=i.Color,i=Array.isArray(e)?e:[e],l=t.context,c=null,e=!1;(c=r instanceof a?r:c)||(n&&n.width==r.width&&n.height==r.height||(n=new o({context:l,width:r.width,height:r.height,pixelFormat:6402,pixelDatatype:5123})),c=new a({context:l,colorTextures:[r],destroyAttachments:!1,depthTexture:n}),e=!0);u=m=m||new s({color:new u(0,0,0,0)});u.framebuffer=c,u.renderState=t.renderState,u.execute(l),i.forEach(function(e){e.framebuffer=c,e.execute(l)}),e&&c.destroy()},f.renderToPixels=function(e,t,r,n,i){var a=Cesium,o=a.Framebuffer,s=a.Texture,u=(a.PixelFormat,a.PixelDatatype,a.ClearCommand),l=a.Color,a=Array.isArray(e)?e:[e],c=t.context,d=null,e=!1;(d=r instanceof o?r:d)||(s=new s({context:c,width:r.width,height:r.height,pixelFormat:6402,pixelDatatype:5123}),d=new o({context:c,colorTextures:[r],depthTexture:c.depthTexture?s:void 0,destroyAttachments:!1}),e=!0);l=m=m||new u({color:new l(0,0,0,0)});return l.framebuffer=d,l.renderState=t.renderState,l.execute(c),a.forEach(function(e){e.framebuffer=d,e.execute(c)}),n=n||{},i=f.readPixels(t,Object.assign(n,{framebuffer:d}),i),delete n.framebuffer,e&&d.destroy(),i},f.readPixels=function(e,t,r){var n=Cesium,i=n.DeveloperError,a=(n.Framebuffer,n.Texture,n.PixelFormat,n.PixelDatatype,n.ClearCommand,n.Color,e.context._gl);t=t||{};var o=Math.max(t.x||0,0),s=Math.max(t.y||0,0),u=t.width||a.drawingBufferWidth,l=t.height||a.drawingBufferHeight,c=t.pixelDatatype||5121,n=t.pixelFormat||6408,e=t.framebuffer||e.frameNumber;if(u<=0)throw new i("readState.width must be greater than zero.");if(l<=0)throw new i("readState.height must be greater than zero.");d(this,e);e=4;return 6407==n?e=3:6406==n&&(e=1),r=r||(5126==c?(c=a.FLOAT,new Float32Array(e*u*l)):new(5121==c?Uint8Array:Uint16Array)(e*u*l)),a.readPixels(o,s,u,l,n,c,r),r},f.yUp2Zup=function(e,t){var r=Cesium,n=r.Matrix4,i=r.Matrix3;return a||(a=n.fromRotationTranslation(i.fromRotationX(r.Math.PI_OVER_TWO)),s=n.inverse(a,new n)),n.multiplyTransformation(e,a,t)},f.zUp2YUp=function(e,t){var r=Cesium,n=r.Matrix4,i=r.Matrix3;return a||(a=n.fromRotationTranslation(i.fromRotationX(r.Math.PI_OVER_TWO)),s=n.inverse(a,new n)),n.multiplyTransformation(e,s,t)},f.computeModelMatrix=function(e,t,r,n,i){if(0==arguments.length)return e;var a=Cesium,o=a.Matrix4,s=a.Cartesian3,u=a.Quaternion;return l=l||new s,c=c||new u,h=h||new s,p=p||new o,i=i||new o,o.clone(e,i),t||(l.x=0,l.y=0,l.z=0),l.x=t.x,l.y=t.y,l.z=t.z,n||(h.x=1,h.y=1,h.z=1),h.x=n.x,h.y=n.y,h.z=n.z,r instanceof u?u.clone(r,c):(n=r.axis,r=r.angle,u.fromAxisAngle(new s(n.x,n.y,n.z),a.Math.toRadians(r),c)),o.fromTranslationQuaternionRotationScale(l,c,h,p),o.multiplyTransformation(i,p,i),i},r.default=f},{}],28:[function(e,t,r){"use strict";function n(e,t){this._axis=e,this._angle=t,this.paramChanged=new Cesium.Event}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperties(n.prototype,{axis:{set:function(e){e.x==this._axis.x&&e.y==this._axis.y&&e.z==this._axis.z||(this._axis=e,this.paramChanged.raiseEvent()),this._axis=e},get:function(){return this._axis}},angle:{set:function(e){e!=this._angle&&(this._angle=e,this.paramChanged.raiseEvent()),this._angle=e},get:function(){return this._angle}}}),r.Rotation=n},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=!(r.default=function(){var d;n||(n=!0,(d=Cesium).ShaderProgram.prototype._setUniforms=function(e,t,r){if(d.defined(e)){this._makeSupportStructureUniformsDone||(function(e){for(var t=e,r=t._gl,n=t._uniformsByName,i=t._program,a=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),o=0;o<a;o++){var s=r.getActiveUniform(i,o),u=s.name,l=u.indexOf("[");0<=l&&(l=n[u.slice(0,l)],d.defined(l)||n[s.name]||(l=r.getUniformLocation(i,s.name),l=d.createUniform(r,s,s.name,l),t._uniformsByName[s.name]=l,t._uniforms.push(l),t._manualUniforms.push(l)))}}(this),this._makeSupportStructureUniformsDone=!0);for(var n=this._manualUniforms,i=n.length,a=0;a<i;++a){var o=n[a];"uDistance"==o.name&&o.name,o.value=e[o.name]()}}var s=this._automaticUniforms;for(i=s.length,a=0;a<i;++a){var u=s[a];u.uniform.value=u.automaticUniform.getValue(t)}var l,c=this._uniforms;for(i=c.length,a=0;a<i;++a)c[a].set();r&&(l=this._gl,r=this._program,l.validateProgram(r))})})},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("M_80"),i=e("e_81"),a=e("s_82"),o=e("h_83"),s=e("-_84"),u=e("3_85"),l=e("d_86"),e=e("__87"),c={none_frag:n.none_frag,none_vert:i.none_vert,normals_frag:a.normals_frag,normals_vert:o.normals_vert,texture_frag:s.texture_frag,texture_vert:u.texture_vert,texture_normals_frag:l.texture_normals_frag,texture_normals_vert:e.texture_normals_vert};c.parseIncludes=function(e){return e.replace(/#include +<([\w\d.]+)>/g,function(e,t){var r=c[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return c.parseIncludes(r)})},r.default=c},{M_80:31,e_81:32,s_82:33,h_83:34,"-_84":37,d_86:38,__87:39,"3_85":40}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.none_frag="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\nvarying vec3 v_position;\n\nuniform vec4 ambientColor;\nuniform vec4 diffuseColor;\nuniform vec4 specularColor;\nuniform float specularShininess;\nuniform float picked;\nuniform vec4  pickedColor;\n\nvoid main(void) \n{\n    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n    vec4 ambient = ambientColor;\n    vec4 diffuse = diffuseColor;\n    vec4 specular = specularColor;\n    color.xyz += ambient.xyz;\n    color.xyz += diffuse.xyz;\n    color.xyz += specular.xyz;\n    color = vec4(color.rgb * diffuse.a, diffuse.a);\n    gl_FragColor = color;\n    if(picked!=0.0){\n        gl_FragColor =mix(color, pickedColor*0.5,1.0);\n    }\n}"},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.none_vert="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n\n\nvarying vec3 v_position;\n\nvoid main(void) \n{\n    vec4 pos =  modelViewMatrix * vec4( position,1.0);\n    v_position = pos.xyz;\n    gl_Position =  projectionMatrix * pos;\n}"},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.normals_frag="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\n\nuniform vec4 ambientColor;\nuniform vec4 diffuseColor;\nuniform vec4 specularColor;\nuniform float specularShininess;\nuniform float alpha;\nuniform float picked;\nuniform vec4  pickedColor;\n\nvarying vec3 v_light0Direction;\n\nvoid main(void) \n{\n    vec3 normal = normalize(v_normal);\n    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n    vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n    vec3 lightColor = vec3(1.0,1.0,1.0);\nvec4 ambient = ambientColor;\n    vec4 diffuse = diffuseColor;\n    vec4 specular = specularColor;\n\n    vec3 specularLight = vec3(0.0, 0.0, 0.0);\n    {\n        float specularIntensity = 0.0;\n        float attenuation = 1.0;\n        vec3 l = normalize(v_light0Direction);\n        vec3 viewDir = -normalize(v_position);\n        vec3 h = normalize(l+viewDir);\n        specularIntensity = max(0.0, pow(max(dot(normal,h), 0.0) , specularShininess)) * attenuation;\n        specularLight += lightColor * specularIntensity;\n        diffuseLight += lightColor * max(dot(normal,l), 0.0) * attenuation;\n    }\n    //specular.xyz *= specularLight;\n    //diffuse.xyz *= diffuseLight;\n    color.xyz += ambient.xyz;\n    color.xyz += diffuse.xyz;\n    color.xyz += specular.xyz;\n    color = vec4(color.rgb * diffuse.a, diffuse.a*alpha);\n    gl_FragColor = color;\n    if(picked!=0.0){\n        gl_FragColor =mix(color, pickedColor*0.5,1.0);\n    }\n}"},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.normals_vert="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\n\nvarying vec3 v_light0Direction;\n\nvoid main(void) \n{\n    vec4 pos =  modelViewMatrix * vec4( position,1.0);\n    v_normal =  normalMatrix *  normal;\n    v_position = pos.xyz;\n    v_light0Direction = mat3( modelViewMatrix) * vec3(1.0,1.0,1.0);\n    gl_Position =  projectionMatrix * pos;\n}"},{}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.phong_frag="\nvarying vec3 v_position;\nvarying vec3 v_normal;\nuniform float picked;\nuniform vec4  pickedColor;\nuniform vec4  defaultColor;\nuniform float specular;\nuniform float shininess;\nuniform vec3  emission;\nuniform vec3  u_cameraPosition;\nvoid main() {\n    vec3 positionToEyeEC = -v_position; \n    vec3 normalEC =normalize(v_normal);\n    vec4 color=defaultColor;\n    if(picked!=0.0){\n        color = pickedColor;\n    }\n    czm_material material;\n    material.specular = specular;\n    material.shininess = shininess;\n    material.normal =  normalEC;\n    material.emission =emission;//vec3(0.2,0.2,0.2);\n    material.diffuse = color.rgb ;\n    material.alpha =  color.a;\n    vec3 lightDirectionEC=-u_cameraPosition;\n    gl_FragColor =  czm_phong(normalize(positionToEyeEC), material,lightDirectionEC);\n}"},{}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.phong_vert="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n\n\nvarying vec3 v_position;\nvarying vec3 v_normal;\n\nvarying vec3 v_light0Direction;\n\nvoid main(void) \n{\n    vec4 pos =  modelViewMatrix * vec4( position,1.0);\n    v_normal =  normalMatrix *  normal;\n    v_position = pos.xyz;\n    v_light0Direction = mat3( modelViewMatrix) * vec3(1.0,1.0,1.0);\n    gl_Position =  projectionMatrix * pos;\n}"},{}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.texture_frag="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\nvarying vec3 v_position;\nvarying vec2 v_texcoord0;\n\nuniform vec4 ambientColor;\nuniform sampler2D diffuseColorMap;\nuniform vec4 specularColor;\nuniform float specularShininess;\nuniform float picked;\nuniform vec4  pickedColor;\n\nuniform float alpha;\n\nvoid main(void) \n{\n    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n    vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n    vec3 lightColor = vec3(1.0,1.0,1.0);\n    vec4 ambient = ambientColor;\n    vec4 diffuse = texture2D(diffuseColorMap, v_texcoord0);\n    vec4 specular = specularColor;\n    color.xyz += ambient.xyz;\n    color.xyz += diffuse.xyz;\n    color.xyz += specular.xyz;\n    color = vec4(diffuse.rgb * diffuse.a, diffuse.a*alpha);\n    gl_FragColor = color;\n    if(picked!=0.0){\n        gl_FragColor =mix(color, pickedColor*0.5,1.0);\n    }\n}"},{}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.texture_normals_frag="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\nvarying vec3 v_position;\nvarying vec2 v_texcoord0;\nvarying vec3 v_normal;\n\nuniform vec4 ambientColor;\nuniform sampler2D diffuseColorMap;\nuniform vec4 specularColor;\nuniform float specularShininess;\nuniform float picked;\nuniform vec4  pickedColor;\n\nvarying vec3 v_light0Direction;\n\nvoid main(void) \n{\n    vec3 normal = normalize(v_normal);\n    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n    vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n    vec3 lightColor = vec3(1.0,1.0,1.0);\n    vec4 ambient = ambientColor;\n    vec4 diffuse = texture2D(diffuseColorMap, v_texcoord0);\n    vec4 specular = specularColor;\n\n    vec3 specularLight = vec3(0.0, 0.0, 0.0);\n    {\n        float specularIntensity = 0.0;\n        float attenuation = 1.0;\n        vec3 l = normalize(v_light0Direction);\n        vec3 viewDir = -normalize(v_position);\n        vec3 h = normalize(l+viewDir);\n        specularIntensity = max(0.0, pow(max(dot(normal,h), 0.0) , specularShininess)) * attenuation;\n        specularLight += lightColor * specularIntensity;\n        diffuseLight += lightColor * max(dot(normal,l), 0.0) * attenuation;\n    }\n    //specular.xyz *= specularLight;\n    //diffuse.xyz *= diffuseLight;\n    color.xyz += ambient.xyz;\n    color.xyz += diffuse.xyz;\n    color.xyz += specular.xyz;\n    color = vec4(diffuse.rgb * diffuse.a, diffuse.a);\n    gl_FragColor = color;\n    if(picked!=0.0){\n        gl_FragColor = pickedColor*color;\n    }\n}"},{}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.texture_normals_vert="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n\n\nvarying vec3 v_position;\nvarying vec2 v_texcoord0;\nvarying vec3 v_normal;\n\nvarying vec3 v_light0Direction;\n\nvoid main(void) \n{\n    vec4 pos =  modelViewMatrix * vec4( position,1.0);\n    v_normal =  normalMatrix *  normal;\n    v_texcoord0 =uv;\n    v_position = pos.xyz;\n    v_light0Direction = mat3( modelViewMatrix) * vec3(1.0,1.0,1.0);\n    gl_Position =  projectionMatrix * pos;\n}"},{}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.texture_vert="\n#ifdef GL_ES\n    precision highp float;\n#endif\n\n\n\nvarying vec3 v_position;\nvarying vec2 v_texcoord0;\n\nvoid main(void) \n{\n    vec4 pos =  modelViewMatrix * vec4( position,1.0);\n    v_texcoord0 =  uv;\n    v_position = pos.xyz;\n    gl_Position =  projectionMatrix * pos;\n}"},{}],41:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function F(e,t,r){var n={x:e,y:t,weights:r||[0,0,0],clone:function(){var e=n.weights;return new F(n.x,n.y,e&&e.map(function(e){return e}))}};return n}function G(e,t,r){var n=Math.abs,i=Math.min,a=Math.max,o=Math.floor,s=i(e[0],t[0],r[0]),u=i(e[1],t[1],r[1]),i=a(e[0],t[0],r[0]),a=a(e[1],t[1],r[1])-u;if(!(1<n(i-s)||1<n(a))){for(var s=o(s),u=o(u),l=[e,t,r],c=0;c<l.length;c++){var d=l[c],f=d[0]%1,h=d[1]%1;0==f?d[0]-=s:d[0]=f,0==h?d[1]-=u:d[1]=h,d[0]<0&&(d[0]+=1),d[1]<0&&(d[1]+=1)}return 1}}function z(e,t,r,n,i,a){return i.x>=e-a&&i.x<=r+a&&i.y>=t-a&&i.y<=n+a}function c(f,h,p,e,t){var N=K(f.x,h.x,p.x),B=K(f.y,h.y,p.y),k=Z(f.x,h.x,p.x),j=Z(f.y,h.y,p.y),r=[f,h,p],s=[[f,h],[f,p],[h,p]],V=e||1e-8,u=t||1e-5,l=new F(0,0);this.bbox=[N,B,k,j],this.a=f,this.b=h,this.c=p;e=J(N),t=J(B);this.isNormalized=!(e!=J(k)&&e+1!=k||t!=J(j)&&t+1!=j),this.isPoint=F.equals(f,h)&&F.equals(f,p),this.isLine=!1,this.isPoint||(t=THREE.Vector2,o=o||new t,a=a||new t,o.subVectors(f,h),a.subVectors(p,h),this.isLine=0==o.cross(a,a)),this.isTriangle=!this.isPoint&&!this.isLine,this.vertices=r,this.edges=s,this.contains=function(e){return z(N,B,k,j,e,V)?m(e,r)?1:this.onEdges(e)?2:0:0},this.onEdges=function(e){for(var t=!1,r=0;r<s.length;r++){var n=s[r];if(t)break;t=_(e,n[0],n[1],V,u)}return t},this.cutSegement=function(e,t,r){if(r){for(var n=0,i=0;i<s.length;i++){var a=s[i],o=a[0],a=a[1];l.x=0,l.y=0,g(e,t,o,a,l,!1)&&_(l,e,t,V,u)&&_(l,o,a,V,u)&&(r(l.clone()),n++)}return n}},this.computeWeights=function(e){return r=h,n=e,i=(t=f).x,e=h.x,a=p.x,t=t.y,r=h.y,o=p.y,u=o-t,0!=(d=(s=r-o)*(l=i-a)+(c=a-e)*(t-o))&&(n.forEach(function(e){var t=e.x,r=e.y,n=(s*(t-a)+c*(r-o))/d,r=(u*(t-a)+l*(r-o))/d;e.weights=[n,r,1-n-r]}),!0);var t,r,n,i,a,o,s,u,l,c,d},this.getGridCount=function(){for(var e=[],t=[],r=J(N),n=J(B),i=Q(k),a=Q(j),o=r;o<=i;o++)e.push(o);for(var s=n;s<=a;s++)t.push(s);return e.length*t.length},this.subdivAndNormalize=function(){function n(e){var t=[e.x,e.y].join(",");return g[t]||(a.push(e),g[t]=e)}var i=this,e=i.a,t=i.b,r=i.c,m=[e,t,r],a=[],g={};n(e),n(t),n(r);for(var o=[],s=[],t=J(N),r=J(B),u=Q(k),l=Q(j),c=t;c<=u;c++)o.push(c);for(var d=r;d<=l;d++)s.push(d);if(2!=o.length||2!=s.length){for(var f=[],h=0;h<s.length;h++){var p=s[h];f[h]=[];for(var _=0;_<o.length;_++){var v=new F(o[_],p),y=i.contains(v);y&&(v=n(v)),f[h].push(v),v._inPolygon=y}}for(var b=[],x=[],M=[],w=0;w<s.length;w++){M[w]=[];for(var T=1;T<o.length;T++){var S=[f[w][T-1],f[w][T]];b.push(S),M[w].push(S)}}for(var E=0;E<o.length;E++){x[E]=[];for(var C=1;C<s.length;C++){var A=[f[C-1][E],f[C][E]];b.push(A),x[E].push(A)}}for(var O=0;O<b.length;O++)!function(){var t=b[O],e=t[0],r=t[1];i.cutSegement(e,r,function(e){e=n(e),t.includes(e)||(e._isCross=!0,t.push(e))})}();for(var L,P=[],I=M.length,R=x.length,D=1;D<I;D++)for(var U=1;U<R;U++)!function(e){for(var t=[x[e][D-1],x[e-1][D-1],M[D][e-1],M[D-1][e-1]],r=[],n=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o[0],o=o[1];n.push(s.x,o.x),i.push(s.y,o.y)}for(var u=K.apply(null,n),l=Z.apply(null,n),c=K.apply(null,i),d=Z.apply(null,i),f=0;f<t.length;f++)t[f].forEach(function(e){(e._inPolygon||e._isCross)&&z(u,c,l,d,e,V)&&r.push(e)});for(var h=0;h<m.length;h++){var p=m[h];z(u,c,l,d,p,V)&&r.push(g[[p.x,p.y].join(",")])}if(r.length<3)return;3==r.length?P.push({a:r[0],b:r[1],c:r[2]}):(L=Y(r),P.push.apply(P,L))}(U);return 0==P.length&&(L=Y(a),P.push.apply(P,L)),f.length=0,g={},{vertices:a,triangles:P,grid:f}}}}function W(e,i,a){var o=this;this.allNames=e,i&&e.forEach(function(e){var t=i[e],r=t.itemSize,n=t.array,t=new Float32Array(r);t="number"==typeof a?n.subarray(n=a*r,n+r):new Float32Array(r),o[e]=t}),this.clone=function(){var t=this,r=new W(e);return e.forEach(function(e){r[e]=new Float32Array(t[e])}),r}}function H(e,t,r,n,i){var a=THREE,o=a.Vector3,s=a.Vector2,u=new o;d=d||new o,f=f||new o;var l=e.position,a=t.position,o=r.position;d.set(o[0]-a[0],o[1]-a[1],o[2]-a[2]),f.set(l[0]-a[0],l[1]-a[1],l[2]-a[2]),u.crossVectors(d,f).normalize(),this.a=e,this.b=t,this.c=r,this.faceNormal=u,this.uvTriangle=new c((new s).fromArray(e.uv),(new s).fromArray(t.uv),(new s).fromArray(r.uv),n,i)}function Y(t){return"undefined"!==(l=l||("undefined"==typeof delauny?"undefined":i(delauny)))?delauny.triangulate(t.map(function(e){return[e.x,e.y]})).map(function(e){return{a:t[e[0]],b:t[e[1]],c:t[e[2]]}}):(0,s.default)(t)}Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.MeshClassification=function(e){this.generateKey=e,this.dic={},this.uvBox=null,this.list=[],this.init=function(e){var n=this;e.traverse(function(e){var t,r;!e.geometry||(t=n.generateKey(e.material,e.geometry,e))&&((r=n.dic[t])||(n.dic[t]=r={key:t,children:[],traverse:function(e){this.children.forEach(e)}},n.list.push(r)),r.children.push(e))})},this.each=function(e){this.list.forEach(e)},this.map=function(e){return this.list.map(e)},this.traverse=function(t){this.each(function(e){e.traverse(t)})},this.calcUVBox=function(s){this.each(function(e){var a,o=Number.MAX_VALUE;e.traverse(function(e){e=e.geometry.attributes;if(e[s]){a=a||[o,o,-o,-o];for(var t=e[s].array,r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];a[0]=Math.min(n,a[0]),a[2]=Math.max(n,a[2]),a[1]=Math.min(i,a[1]),a[3]=Math.max(i,a[3])}}}),e.uvBox=a})}},r.UVTriangle=c,r.Triangle=H;var d,f,a,o,s=n(e("M_88")),X=n(e("k_26")),u=e("M_32"),q=n(e("e_91")),m=u.MathUtils.pointInPolygon,g=u.MathUtils.findCrossPoint,_=u.MathUtils.pointOnSegment;u.MathUtils.clampToLine,u.MathUtils.circumcircle,u.MathUtils.distanceToSegment,F.equals=function(e,t,r){var n=Math.abs;return r=r||0,n(e.x-t.x)<=r&&n(e.y-t.y)<=r};var l,K=Math.min,Z=Math.max,J=(Math.abs,Math.floor),Q=Math.ceil;H.fromGeometry=function(e,t){if(e.getAttribute("uv")){var r,n=(t=t||{}).angleEpsilon,i=t.rangeEpsilon,a=X.default.genGeometryIndices(e,0,!0),o=e.attributes,s=[],u=[],l=[];for(r in o)Object.hasOwnProperty.call(o,r)&&(s.push(r),"uv"!=r&&"position"!=r&&u.push(r));for(var c=0;c<a.length;c+=3){var d=a[c],f=a[c+1],h=a[c+2],d=new W(s,o,d),f=new W(s,o,f),h=new W(s,o,h);l.push(new H(d,f,h,i,n))}return l}},H.toPlanes=function(e){},r.default=function(e,t){function v(e,t,r,n){n&&!G(e.uv,t.uv,r.uv)||(i(e),i(t),i(r))}function i(t,e){var r=[];w.forEach(function(e){r.push(t[e].join(","))});var r=r.join("-"),n=S[r];return null==n&&(n=E.length,S[r]=n,E.push(t)),!e&&(C.push(n),n)}function r(e){var t,r=e.uvTriangle,n=e.faceNormal,i=e.a,a=e.b,o=e.c;if(r.isNormalized||r.isPoint)return v(i,a,o,!0),0;if(!r.isLine&&(t=function(e,t,r){var n=t,i=e.a,a=e.b,o=e.c,s=(d=e.uvTriangle).subdivAndNormalize();if(s){var u=s.vertices,l=s.triangles,c=[];if(!d.computeWeights(u))return{triangles:[{a:i,b:a,c:o}],vertices:[i,a,o],invalidWeights:!0};for(var t=i.position,e=a.position,d=o.position,f=t[0],h=e[0],p=d[0],m=t[1],g=e[1],_=d[1],v=t[2],y=e[2],b=d[2],x=0,M=u.length;x<M;x++){var w=u[x],T=w.weights,S=T[0],E=T[1],C=T[2],A=f*S+h*E+p*C,O=m*S+g*E+_*C,L=v*S+y*E+b*C;if(w.id=x,A!=f||O!=m||L!=v)if(A!=h||O!=g||L!=y)if(A!=p||O!=_||L!=b){var P=i.clone(),T=P.position;T[0]=A,T[1]=O,T[2]=L,P.uv[0]=w.x,P.uv[1]=w.y;for(var I=0;I<n.length;I++)for(var R=n[I],D=P[R],U=i[R],N=a[R],B=o[R],k=0;k<D.length;k++)D[k]=S*U[k]+E*N[k]+C*B[k];c.push(P)}else c.push(o);else c.push(a);else c.push(i)}return{triangles:l,vertices:c,uvMesh:r&&s}}}(e,T,y))){var r=t,e=r.invalidWeights,s=r.triangles,r=r.uvMesh;if(e)return v(i,a,o,!1),0;y&&P.push(r);for(var u=t.vertices,l=s.length,c=0;c<l;c++){var d=s[c],f=u[d.a.id].clone(),h=u[d.b.id].clone(),p=u[d.c.id].clone(),m=f.position,g=h.position,_=p.position;b.set(g[0]-m[0],g[1]-m[1],g[2]-m[2]),x.set(_[0]-g[0],_[1]-g[1],_[2]-g[2]),M.crossVectors(b,x);d=M.dot(n)<0;G(m=f.uv,g=h.uv,_=p.uv)&&(d?v(p,h,f):v(f,h,p))}u.length=0,s.length=0}}function n(){var r=new f;w.forEach(function(n){var e=_[n],t=e.itemSize,e=e.normalized,i=new Float32Array(E.length*t),a=0;E.forEach(function(e){for(var t=e[n],r=0;r<t.length;r++)i[a++]=t[r]});e=new d(i,t,e);r.setAttribute(n,e)});for(var e=-1,t=!0,n=0;n<C.length;n++){var i=C[n];i-e!=1&&(t=!1),e=i}return t?r.index=null:(C=new(65535<E.length?h:255<E.length?p:m)(C,1),r.setIndex(C)),r}if(e.getAttribute("uv")){var a,o=(t=t||{}).async,y=!!t.debug,s=t.angleEpsilon,u=t.rangeEpsilon,l=THREE,c=l.Vector3,d=l.BufferAttribute,f=l.BufferGeometry,h=l.Uint32BufferAttribute,p=l.Uint16BufferAttribute,m=l.Uint8BufferAttribute,g=X.default.genGeometryIndices(e,0,!0),l=e.getAttribute("position").array,b=new c,x=new c,M=new c,_=e.attributes,w=[],T=[];for(a in _)Object.hasOwnProperty.call(_,a)&&(w.push(a),"uv"!=a&&"position"!=a&&T.push(a));for(var S={},E=[],C=[],A=[],O=[],L=[],P=[],I=l.length,R=[],D=0;D<I;D+=3)R.push(new W(w,_,D/3));for(I=g.length,D=0;D<I;D+=3){var U=g[D],N=g[D+1],B=g[D+2],U=R[U],N=R[N],B=R[B];A.push(new H(U,N,B,u,s))}if(g=null,R.length=0,o){var k=t.batchSize||20,j=[],V=[];return(A.forEach(function(e){(j.length>=k||0==V.length)&&(j=[],V.push(j)),j.push(e)}),V.length)?new q.default(V,function(e){for(var t=0;t<e.length;t++)r(e[t]);e.length=0}).run(t.onProgress).then(function(){if(C.length&&E.length){var e=n();E.length=0,S=C=null;e={geometry:e,invalidTriangles:O,linearTriangles:L,uvMeshes:P};return y||delete e.uvMeshes,e}}):Promise.resolve(null)}for(D=0,I=A.length;D<I;)r(A[D++]);t=n(),S=C=null;E.length=0;t={geometry:t,invalidTriangles:O,linearTriangles:L,uvMeshes:P};return y||delete t.uvMeshes,t}}},{e_91:166,M_32:167,M_88:178,k_26:11}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.releaseResources=function(e){e&&e.traverse&&e.traverse(function(e){if(!e.isDestroyed||!e.isDestroyed()){if(e.destroy)return e.pickObject&&delete e.pickObject,e.pickId&&delete e.pickId,void e.destroy();if(!e.isScene&&e.dispose&&e.dispose(),e.dispatchEvent&&e.dispatchEvent({type:"dispose"},e),e.pickObject&&delete e.pickObject,e.pickId&&delete e.pickId,e._actualMesh&&(e._actualMesh.isDestroyed||e._actualMesh.destroy(),delete e._actualMesh.mesh3js,delete e._actualMesh),e.geometry){e.geometry.dispose();var t,r=e.geometry.attributes;for(t in r)r.hasOwnProperty(t)&&r[t]&&(delete r[t].array,r[t]);delete e.geometry.attributes,delete e.geometry}e.material&&(Array.isArray(e.material)?e.material.forEach(function(e){e.dispose()}):e.material.dispose(),delete e.material)}})},e("3_37")},{"3_37":25}],43:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}Object.defineProperty(r,"__esModule",{value:!0});var a=(n((e("W_93"),e("e_94"))),e("i_95")),b=n(a),g=n(e("M_96")),x=n(e("e_97")),_=n(e("s_98")),M=n(e("h_99")),v=n(e("-_100")),w=n(e("3_101")),f=n(e("d_102")),T=n(e("__103"));n(e("M_104")),i.freeCommand=function(e){e&&(e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram&&e.shaderProgram.destroy(),Cesium.destroyObject(e))},i.create3js=function(e,t,r,n,i,a,o,s){var u=t.context,l=r.renderer,c=l._uniforms,d=w.default.get(e.geometry),f=d.groups,h=e.material,p=Cesium,m=p.defined,g=p.Matrix4,_=(p.PrimitiveType,p.DrawCommand);p.Pass;var v=e.isMesh?h.wireframe?1:4:e.isLine?e.isLineSegments?1:e.isLineLoop?2:3:e.isPoints?0:4,y=e.instances,p=e._availableInstances,v=new _({modelMatrix:y&&0<y.length?void 0:g.clone(r.modelMatrix),owner:e,castShadows:!0,pickId:"czm_pickColor",receiveShadows:!0,primitiveType:v,cull:!1,instanceCount:y&&0<y.length?p.length:void 0}),y=x.default.create(d,e,t.context,a,o,s,r.useEncodedPosition),p=y._attributeLocations;y.instanceCount&&(v.instanceCount=y.instanceCount),v.vertexArray=y;o=a,y=null;Array.isArray(h)&&(h=h[o=!s?f[y=a].materialIndex:o]),v.shaderProgram=M.default.get(h,p,e,u,r,n,i);u=e.pass;return("number"!=typeof u||u<0||8<u)&&(u=h.translucent?8:4),v.pass=h.translucent?8:h.stencilWrite?5:4,v._v_pass=h.translucent||h.transparent?8:u,m(h.allowPick)||(h.allowPick=!0),v.renderState=b.default.create(h,e,l._capabilities,l._extensions),v._renderStateOptions=h._renderStateOptions,v.uniformMap=c.getUniformMap(h,e,t,n,i),e.uniformMapLoadedCallback&&e.uniformMapLoadedCallback(v.uniformMap,t,e),new T.default(v,h,o,e,d,r,y)},i.create=function(e,t,r,n,i,a,o,s){if(v.default.isMesh3js(e))return this.create3js(e,t,r,n,i,a,o,s);var u=t.context,l=e.geometry,c=e.material,d=Cesium,f=d.BoundingSphere,h=d.defined,p=d.Matrix4,n=(d.PrimitiveType,d.DrawCommand),i=(d.Pass,e.pickObject||{primitive:r,id:e,mesh:e}),m=(m=i.pickId)||u.createPickId(i);r._pickIds.includes(m)||r._pickIds.push(m),i.pickId=m,e.pickId=m,e.mesh3js&&(e.mesh3js.pickId=m);s=e.instances,d=e._availableInstances,i=(e.mesh3js||e).pass;("number"!=typeof i||i<0||8<i)&&(i=c.translucent?8:4);n=new n({modelMatrix:s&&0<s.length?void 0:p.clone(r.modelMatrix),owner:e,castShadows:!0,pickId:"czm_pickColor",receiveShadows:!0,primitiveType:l.primitiveType,cull:!1,instanceCount:s&&0<s.length?d.length:void 0});n.pass=c.translucent?8:4,n._v_pass=c.translucent||c.transparent?8:i;p=x.default.create(e.geometry,e,t.context,a,o,!1,!1),s=p._attributeLocations;p.instanceCount&&(n.instanceCount=p.instanceCount),n.vertexArray=p;d=r.renderer,o=r;(c.material3js||_.default.isMaterial3js(c))&&(p=c.material3js||c,Array.isArray(c)&&(p=c[a],(c=_.default.fromMaterial3js(p,d,o)).material3js=p,("number"!=typeof i||i<0||8<i)&&(i=c.translucent?8:4),n.pass=c.translucent?8:4,n._v_pass=c.translucent||c.transparent?8:i),c.material3js.isLineBasicMaterial&&(n.primitiveType=1)),n.shaderProgram=M.default.get(c,s,e,u,r),h(e.material.allowPick)||(e.material.allowPick=!0),n.renderState=b.default.create(c,e,d._capabilities,d._extensions),n._renderStateOptions=c._renderStateOptions,n.uniformMap=g.default.get(c,e,t,r),n.uniformMap.czm_pickColor=function(){return m.color};d=e.mesh3js||e;d.uniformMapLoadedCallback&&d.uniformMapLoadedCallback(n.uniformMap,t,d),e.needsUpdate=!1,e.geometry.needsUpdate=!1;r=new T.default(n,c,a,e,l,r);return l.boundingSphere?f.clone(l.boundingSphere,r.boundingSphere):(l=l.attributes.position,f.fromVertices(l.values||l.array,null,null,r.boundingSphere)),r},i.createArray=function(e,t,r,n,i){for(var a=[],o=w.default.get(e.geometry,e.material),s=o.groupsOptimized,u=0;u<s.length;u++){var l=s[u].materialIndex,c=f.default.computeBoundingSphereAndIndices(o,l,!0),d=c.boundingSphere,c=c.indices,c=this.create(e,t,r,n,i,l,c,!0);c.boundingSphere=d,a.push(c)}return a},i.update=function(n,e,i,a){var t=Cesium,o=t.BoundingSphere,s=t.Matrix4;a=a||n.geometry;var t=Array.isArray(n.renderItems)?n.renderItems:[n.renderItems],u=v.default.isMesh3js(n)?n:n.mesh3js;u&&(a.instanceCount=u.geometry.instanceCount);var l=Array.isArray(n.material);t.forEach(function(e){var t,r=e.drawCommand,e=e.material||n.material;n.isInstancedMesh?r.instanceCount=n.count:u&&u.isInstancedMesh&&(r.instanceCount=u.count),n.instances&&n.instances.length?(0==n.frustumCulled||r.boundingVolume||(t=o.clone(n._boundingSphere),r.boundingVolume=t),r.instanceCount=n._availableInstances.length):(0!=n.frustumCulled||e.translucent||e.transparent)&&((t=l&&r.__boundingSphere?r.__boundingSphere:a.boundingSphere)||(a.computeBoundingSphere?(a.computeBoundingSphere(),t=a.boundingSphere):(e=a.attributes.position,t=o.fromVertices(e.values||e.array),a.boundingSphere=t)),r.boundingVolume||(r.boundingVolume=o.clone(t)),!i._modelMatrixNeedsUpdate&&!n.modelMatrixNeedsUpdate&&r.boundingVolume._multiplyByModelMatrix||(s.multiplyByPoint(n.modelMatrix,t.center,r.boundingVolume.center),r.boundingVolume.radius=t.radius*s.getMaximumScale(n.modelMatrix),r.boundingVolume._multiplyByModelMatrix=!0),(t=a.maxInstancedCount||a.instanceCount)&&(r.instanceCount=t)),r.modelMatrix=n.modelMatrix}),l&&t.forEach(function(e){e=e.material,e=e.material3js||e;i.renderer._uniforms.refresh(e,u)})},r.default=i},{d_102:11,W_93:15,e_94:24,s_98:45,"-_100":46,i_95:47,h_99:49,M_96:54,e_97:55,"3_101":60,M_104:61,__103:67}],44:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var i=(function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}(a,null,[{key:"init",value:function(){var e;this.hasInit||(this.hasInit=!0,this._formatsMap=(n(e={},1022,6407),n(e,1023,6408),n(e,1026,6402),n(e,1021,6406),n(e,1027,34041),n(e,1024,6409),n(e,1025,6410),n(e,33777,33777),n(e,33778,33778),n(e,33779,33779),n(e,35843,35843),n(e,35842,35842),n(e,33776,33776),n(e,36196,36196),n(e,35841,35841),n(e,35840,35840),e),this._typesMap=(n(e={},1015,5126),n(e,1009,5121),n(e,1016,36193),n(e,1014,5125),n(e,1020,34042),n(e,1012,5123),n(e,1017,32819),n(e,1018,32820),n(e,1019,33635),e),this._minFilterMap=(n(e={},1006,9729),n(e,1008,9987),n(e,1005,9986),n(e,1003,9728),n(e,1007,9985),n(e,1004,9984),e),this._magFilterMap=(n(e={},1003,9728),n(e,1006,9729),e),this._textureWrapMap=(n(e={},1001,33071),n(e,1002,33648),n(e,1e3,10497),e),this._depthFuncMap=(n(e={},0,512),n(e,1,519),n(e,2,513),n(e,3,515),n(e,4,514),n(e,5,518),n(e,6,516),n(e,7,517),e),this._factorMap=(n(e={},200,0),n(e,201,1),n(e,202,768),n(e,204,770),n(e,210,776),n(e,208,774),n(e,206,772),n(e,203,769),n(e,205,771),n(e,209,775),n(e,207,773),e),this._equationMap=(n(e={},100,32774),n(e,101,32778),n(e,102,32779),n(e,103,32775),n(e,104,32776),e))}},{key:"formatsMap",get:function(){return this.init(),this._formatsMap}},{key:"typesMap",get:function(){return this.init(),this._typesMap}},{key:"magFilterMap",get:function(){return this.init(),this._magFilterMap}},{key:"minFilterMap",get:function(){return this.init(),this._minFilterMap}},{key:"textureWrapMap",get:function(){return this.init(),this._textureWrapMap}},{key:"depthFuncMap",get:function(){return this.init(),this._depthFuncMap}},{key:"factorMap",get:function(){return this.init(),this._factorMap}},{key:"equationMap",get:function(){return this.init(),this._equationMap}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=i},{}],45:[function(e,t,r){"use strict";function n(){}Object.defineProperty(r,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.isMaterial3js=function(e){return"undefined"!=typeof THREE&&(e instanceof THREE.Material||Array.isArray(e))},n.getMaterialKey=function(e){var t,r,n=[];for(t in e){var i=e[t],a=void 0===i?"undefined":o(i);"function"!=a&&("undefined"==a||null==i?n.push(i):i.isColor?n.push((r=i)&&r.getHex()):i.isTexture?n.push((r=i)&&r.uuid):"object"==a?i.toJSON?n.push(i.toJSON()):n.push(JSON.stringify(i)):n.push(i))}return n.join(",")},r.default=n},{}],46:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}Object.defineProperty(r,"__esModule",{value:!0});var c=n(e("d_102")),d=n(e("k_106"));i.trimEmptyGroup=function(e){var t=[],r=0;return e.traverse(function(e){e.geometry||0!=e.children.length||t.push(e)}),t.forEach(function e(t){r++,t.parent.remove(t);t=t.parent;t&&0==t.children.length&&e(t)}),r},i.ungroup=function(r){if(r.isMesh){var n=THREE,e=r.material,i=r.geometry,t=Array.isArray(e)?e:[e],e=r.parent,a=new n.Group;return a.name=r.name,a.frustumCulled=r.frustumCulled,a.matrixAutoUpdate=r.matrixAutoUpdate,a.up.copy(r.up),a.matrix=r.matrix.clone(),a.matrix.decompose(a.position,a.quaternion,a.scale),t.forEach(function(e,t){t=c.default.extractGeometry(i,t,!0),t=new n.Mesh(t,e);t.name=(r.name+" "+e.name).trim(),t.receiveShadow=r.receiveShadow,t.castShadow=r.castShadow,t.frustumCulled=r.frustumCulled,t.matrixAutoUpdate=r.matrixAutoUpdate,a.add(t)}),e.remove(r),e.add(a),e.updateMatrixWorld(),a}},i.isMesh3js=function(e){if("undefined"==typeof THREE)return!1;var t=THREE;return!e.isLight&&(e instanceof t.Mesh||e instanceof t.Object3D)},i.simplify=function(e,t){if("undefined"==typeof THREE)throw new Error("模型简化功能依赖threejs，但是上下文未找到THREE模块 ");if(!t||!t.simplifyFactor)throw new Error("缺少参数options.simplifyFactor");var r=t.simplifyFactor;e.geometry=c.default.simplify(e.geometry,r,t);var n,i=!1;for(n in s=e.material){var a=s[n];if("lightMap"!=n&&a&&a.isTexture){i=!0;break}}if(i&&t.resampleTexture){var o,s=e.material.clone(),u=t.texureScaleFactor||r,l=t.forcePowerOfTwo;for(o in s){a=s[o];"lightMap"!=o&&a&&a.isTexture&&(s[o]=d.default.resampleTexture(a.clone(),u,l))}e.material=s}return e},r.default=i},{d_102:11,k_106:53}],47:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}function o(e,t,r,n){var i=Cesium,a=(i.CullFace,i.BlendingState),i=(i.DepthFunction,i.RenderState);if(e.material3js)var t=(0,u.determinant)(t.matrixWorld.elements)<0,o=function(e,t,r,n){var i=f.default.equationMap,a=((c=Cesium).WebGLConstants,c.StencilFunction,c.StencilOperation,c.StencilConstants),o=c.defined,s=c.defaultValue,u=(c.CullFace,c.BlendingState),l=(THREE,f.default.factorMap),c=f.default.depthFuncMap,d=e,e=1===d.side;if(t&&(e=!e),r.isWebGL2?(i[103]=32775,i[104]=32776):null!==(n=n.get("EXT_blend_minmax"))&&(i[103]=n.MIN_EXT,i[104]=n.MAX_EXT),o(d.side)||(d.side=2),d.onCreateRenderState){o=d.onCreateRenderState();if(o)return o}return{frontFace:t&&e?2304:2305,cull:{enabled:2!=d.side,face:1==d.side?1028:1029},lineWidth:1,polygonOffset:{enabled:d.polygonOffset,factor:d.polygonOffsetFactor,units:d.polygonOffsetUnits},depthRange:d.depthRange||{near:0,far:1},depthTest:{enabled:d.depthTest,func:s(c[d.depthFunc],515)},colorMask:{red:d.colorWrite,green:d.colorWrite,blue:d.colorWrite,alpha:d.colorWrite},depthMask:s(d.depthWrite,!0),blending:function(){if(0==d.blending)return u.DISABLED;var e=d.blendEquation,t=d.blendEquationAlpha||d.blendEquation;if(5===d.blending)return{enabled:0==d.blending,equationRgb:i[e],equationAlpha:i[t],functionSourceRgb:l[d.blendSrc],functionSourceAlpha:l[d.blendSrcAlpha],functionDestinationRgb:l[d.blendDst],functionDestinationAlpha:l[d.blendDstAlpha]};if(d.premultipliedAlpha)switch(d.blending){case 1:return{enabled:!0,equationRgb:i[e],equationAlpha:i[t],functionSourceRgb:1,functionSourceAlpha:1,functionDestinationRgb:771,functionDestinationAlpha:771};case 2:return{enabled:!0,equationRgb:i[e],equationAlpha:i[t],functionDestinationAlpha:1,functionDestinationRgb:1,functionSourceAlpha:1,functionSourceRgb:770};case 3:return{enabled:!0,equationRgb:i[e],equationAlpha:i[t],functionSourceRgb:0,functionSourceAlpha:769,functionDestinationRgb:0,functionDestinationAlpha:771};case 4:return{enabled:!0,equationRgb:i[e],equationAlpha:i[t],functionSourceRgb:0,functionSourceAlpha:0,functionDestinationRgb:768,functionDestinationAlpha:770};default:console.error("RenderSateUtils: Invalid blending: ",d.blending)}else switch(d.blending){case 1:return{enabled:!0,equationRgb:i[e],equationAlpha:i[t],functionSourceRgb:770,functionSourceAlpha:1,functionDestinationRgb:771,functionDestinationAlpha:771};case 2:return u.ADDITIVE_BLEND;default:console.error("RenderSateUtils: Invalid blending: ",d.blending)}}(),stencilMask:d.stencilWrite?d.stencilWriteMask:a.CESIUM_3D_TILE_MASK,stencilTest:d.stencilWrite?{enabled:d.stencilWrite,frontFunction:d.stencilFunc,backFunction:d.stencilFunc,reference:s(d.stencilRef,0),mask:s(d.stencilFuncMask,-1),frontOperation:{fail:d.stencilFail,zFail:d.stencilZFail,zPass:d.stencilZPass},backOperation:{fail:d.stencilFail,zFail:d.stencilZFail,zPass:d.stencilZPass}}:{backFunction:519,backOperation:{fail:7680,zFail:7680,zPass:7681},enabled:!0,frontFunction:519,frontOperation:{fail:7680,zFail:7680,zPass:7681},mask:128,reference:128}}}(e.material3js,t,r,n);else switch(o={polygonOffset:{enabled:e.polygonOffset,factor:e.polygonOffsetFactor,units:e.polygonOffsetUnits},blending:e.blending?a.ALPHA_BLEND:a.DISABLED,depthTest:{enabled:e.depthTest,func:513},cull:{enabled:!1,face:1028},depthRange:{near:0,far:1},colorMask:{red:!0,green:!0,blue:!0,alpha:!0},depthMask:e.depthMask},o.cull.enabled=!0,e.side){case s.MeshMaterial.Sides.FRONT:o.cull.face=1029;break;case s.MeshMaterial.Sides.BACK:o.cull.face=1028;break;default:o.cull.enabled=!1}return e._renderStateOptions=o,i.fromCache(o)}Object.defineProperty(r,"__esModule",{value:!0});var s=(e("W_93"),e("s_108")),f=n(e("W_109")),u=e("e_110"),l=n(e("s_98")),c=new Map;i.create=function(e,t,r,n,i){var a;return l.default.isMaterial3js(e)&&(e={material3js:e}),i?(a=c.get(e))||(a=o(e,t,r,n),c.set(e,a),e.material3js&&e.material3js.addEventListener("dispose",function(){c.delete(e,a)})):a=o(e,t,r,n),a},i.update=function(e){return o(material,e,capabilities,extensions)},r.default=i},{e_110:173,W_93:15,s_108:22,W_109:44,s_98:45}],48:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}Object.defineProperty(r,"__esModule",{value:!0});var a=(n(e("e_94")),e("W_109")),h=n(a),p=n(e("k_106"));i.createFramebuffer=function(e,t,r,n){var i,a,o,s=Cesium,u=(s.WebGLConstants,s.Sampler),l=(s.RenderbufferFormat,s.Renderbuffer),c=s.Framebuffer,d=t.context,f=e.width||d.drawingBufferWidth,s=e.height||d.drawingBufferHeight;return r||(t=p.default.fromTexure3js(e.texture),(r=p.default.createTexture({target:3553,width:f,height:s,format:t.format,flipY:t.flipY,type:t.type,sampler:new u(t.sampler),preMultiplyAlpha:t.preMultiplyAlpha},d)).name=e.texture.name),e.depthTexture&&(i=p.default.fromTexure3js(e.depthTexture),i=p.default.createTexture({target:3553,width:f,height:s,format:i.format,flipY:i.flipY,type:i.type,sampler:new u(i.sampler),preMultiplyAlpha:i.preMultiplyAlpha},d)),e.stencilBuffer?o=new l({context:d,format:34041,width:f,height:s}):e.depthBuffer&&(a=new l({context:d,format:33189,width:f,height:s})),new c({context:d,colorTextures:[r],destroyAttachments:!1,depthTexture:i,depthRenderbuffer:a,depthStencilRenderbuffer:o})},i.set=function(r,e,n){var t=e.context,i=n._renderTargetFbs;if(n._renderTargetFbs||(n._renderTargetFbs=new WeakMap,i=n._renderTargetFbs),!i.has(r)){var a=r.texture,o=r.depthTexture,s=[];if(r.isWebGLCubeRenderTarget)for(var u=h.default.formatsMap[a.format],l={width:r.width,height:r.height,arrayBufferView:new Uint8Array(4*r.width*r.height)},u=new Cesium.CubeMap({context:t,source:{positiveX:l,negativeX:l,positiveY:l,negativeY:l,positiveZ:l,negativeZ:l},width:r.width,height:r.height,pixelDatatype:h.default.typesMap[a.type],pixelFormat:u,flipY:a.flipY,preMultiplyAlpha:a.premultiplyAlpha}),c=[(n._textureCache[a.uuid]=u).positiveX,u.negativeX,u.positiveY,u.negativeY,u.positiveZ,u.negativeZ],d=0;d<6;d++){var f=this.createFramebuffer(r,e,c[d],n);s.push(f)}else{u=this.createFramebuffer(r,e,null,n);n._textureCache[a.uuid]=u.getColorTexture(0),o&&(n._textureCache[o.uuid]=u.depthTexture),s.push(u)}i.set(r,s),r.addEventListener("dispose",function e(){s.forEach(function(e){e.destroy()}),i.delete(r);var t=n._textureCache[a.uuid];t&&(t.isDestroyed&&t.isDestroyed()||t.destroy(),delete n._textureCache[a.uuid]),r.removeEventListener("dispose",e)})}},i.get=function(e,t){var r=t._renderTargetFbs;return r||(t._renderTargetFbs=new WeakMap,r=t._renderTargetFbs),r.get(e)},r.default=i},{e_94:24,W_109:44,k_106:53}],49:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}Object.defineProperty(r,"__esModule",{value:!0});var u=n(e("s_98")),w=n(e("-_116")),a=(n(e("e_94")),e("d_118")),T=(n(a),e("__119")),a=(n(e("M_120")),e("M_104")),a=(n(a),e("k_122")),S=n(a),E=n(e("e_123")),C={directional:[],point:[],spot:[],rectArea:[],hemi:[],directionalShadowMap:[],pointShadowMap:[],spotShadowMap:[]};i._get3js=function(e,t,r,n,i,a,o){var s,u,l,c,d,f,h,p=Cesium,m=p.ShaderSource,g=p.ShaderProgram,_=r.instances,v=i.renderer,y=v._uniforms,b=i;s=e,l=b,c=a,d=o,f=u=r,M=(x=v)._programs,h=x._properties,p=M.getParameters(s,s.lightMap?C:c.state,d=d||null,l,f),u=M.getUniforms(s),p.uniforms=u,"function"==typeof s.onBeforeCompile&&s.onBeforeCompile(p,x),s.isNodeMaterial&&(u=p.uniforms,(p=M.getParameters(s,s.lightMap?C:c.state,d,l,f)).uniforms=u,(h=h.get(s)).needsLights=s.lights,h.clipping=s.clipping),M=M.getProgramCacheKey(p),(M=x._programs.acquireProgram(p,M)).uniforms=p.uniforms,w.default.processInstanceShader(r,s=M);var x=(_&&_.length?"varying":e.pickColorQualifier||"uniform")+" vec4 czm_pickColor;\n";s.vertexShader="\n            #define CESIUM_MESH_VISUALIZER\n            uniform vec3 u_cameraPositionLC;\n            uniform mat4 matrixWorld;\n            uniform mat3 normalMatrixWorld;\n            uniform mat4 viewMatrixThree;\n            uniform mat4 modelViewMatrixInverse;\n            uniform mat4 _CesiumModel2ThreeModel;\n            uniform mat3 _CesiumNormal2ThreeNormal;\n            uniform mat4 _ThreeModel2CesiumModel;\n            uniform mat3 _ThreeNormal2CesiumNormal;\n            "+s.vertexShader;var M,p="\n            #define CESIUM_MESH_VISUALIZER\n            uniform mat4 matrixWorld;\n            uniform mat3 normalMatrixWorld;\n            uniform mat4 viewMatrixThree;\n            uniform mat4 modelViewMatrixInverse;\n            uniform mat4 _CesiumModel2ThreeModel;\n            uniform mat3 _CesiumNormal2ThreeNormal;\n            uniform mat4 _ThreeModel2CesiumModel;\n            uniform mat3 _ThreeNormal2CesiumNormal;\n"+s.fragmentShader;s.fragmentShader=p,i.useEncodedPosition&&w.default.modifyEncodedPosition(r,s),w.default.modifyShadowWorldPosition(r,s),w.default.modifyEnvMapQueryVec(r,s),M=s,i=(_=b)._fixedWebGLLights,b=_._partialWebGLLights,_=i.state.point.length,i=b.state.point.length,(0<_||0<i)&&(b=M.fragmentShader,b=w.default.insertAfter(b,/uniform vec3 lightProbe\[ 9 \];/g,S.default.replace(/NUM_STATIC_POINT_LIGHTS/g,_).replace(/NUM_PAITIAL_POINT_LIGHTS/g,i)),b=w.default.insertAfter(b,/IncidentLight directLight;/g,E.default.replace(/NUM_STATIC_POINT_LIGHTS/g,_).replace(/NUM_PAITIAL_POINT_LIGHTS/g,i)),M.fragmentShader=b),s.fragmentShader=(0,T.unrollLoops)(s.fragmentShader),e.onAfterCompile&&e.onAfterCompile(s,v),y.set(e,s.uniforms,r,a,o);o=new m({sources:[s.vertexShader]}),p=new m({sources:[x+s.fragmentShader,"#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"]});return e.translucent||e.transparent||!n.fragmentDepth||p.defines.push("WRITE_DEPTH"),g.fromCache({context:n,fragmentShaderSource:p,vertexShaderSource:o,attributeLocations:t})},i.get=function(e,t,r,n,i,a,o){if(u.default.isMaterial3js(e))return this._get3js(e,t,r,n,i,a,o);var s=Cesium,i=s.ShaderSource,a=s.ShaderProgram,o=r.instances,s={fragmentShader:w.default.getFragmentShaderSource(e),vertexShader:w.default.getVertexShaderSource(r,e)};w.default.processInstanceShader(r,s);r=(o&&o.length?"varying":e.pickColorQualifier||"uniform")+" vec4 czm_pickColor;\n",o=new i({sources:[s.vertexShader]}),s=new i({sources:[r+s.fragmentShader,"#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"]});return!e.translucent&&n.fragmentDepth&&s.defines.push("WRITE_DEPTH"),a.fromCache({context:n,fragmentShaderSource:s,vertexShaderSource:o,attributeLocations:t})},r.default=i},{e_94:24,s_98:45,"-_116":50,k_122:51,e_123:52,M_104:61,__119:64,M_120:65,d_118:72}],50:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){}function a(e,t){return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t+"\nvoid main()")}function o(e,t){return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)\s*{/g,"void main(){\n"+t)}function s(e,t){if(!t)return e;var r,n=e.lastIndexOf("}");return 0<=n&&t.length&&(r=e.substring(0,n),n=e.substring(n),e="\n"!=t[t.length-1]?r+t+"\n"+n:r+t+n),e}function u(e,t,r){var n=t,n=(n="string"==typeof t?new RegExp(t,"g"):n).exec(e);return n&&(n=n.index,e=e.substring(0,n)+r+e.substring(n)),e}function l(e,t,r){var n=t,n=(n="string"==typeof t?new RegExp(t,"g"):n).exec(e);return n&&(n=n.index+n[0].length,e=e.substring(0,n)+r+e.substring(n)),e}Object.defineProperty(r,"__esModule",{value:!0}),r.insertBeforeMain=a,r.insertAfterMain=o,r.appendMain=s,r.insertBefore=u,r.insertAfter=l;var c=n(e("s_124")),d=n(e("-_100"));i.insertBeforeMain=a,i.insertAfterMain=o,i.appendMain=s,i.replaceIncludes=function(e,t,r){return e.replace(t,r)},i.insertBefore=u,i.insertAfter=l;var f=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;i._modifyShaderPosition=function(e,t,r){for(var n="",i="",a="";null!==(s=f.exec(t));){var o=s[1],s="vec4 czm_compute"+o[0].toUpperCase()+o.substr(1)+"()";"vec4 czm_computePosition()"!=s&&(n+=s+";\n"),defined(e.rtcCenter)?(n+="uniform mat4 u_modifiedModelView;\n",i+="attribute vec4 position;\n",a+=s+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=(t=(t=(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"")).replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"")).replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"")).replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):r?a+=s+"\n{\n    return czm_translateRelativeToEye("+o+"3DHigh, "+o+"3DLow);\n}\n\n":(i+="attribute vec3 "+o+"2DHigh;\nattribute vec3 "+o+"2DLow;\n",a+=s+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+o+"3DHigh, "+o+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+o+"2DHigh.zxy, "+o+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+o+"2DHigh.zxy, "+o+"2DLow.zxy),\n                czm_translateRelativeToEye("+o+"3DHigh, "+o+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[n,i,t,a].join("\n")},i.modifyShaderPosition=function(e,t){var r=t.vertexShader;r.includes("transformed")&&(r=r.replace("gl_Position = projectionMatrix * mvPosition","vec4 mvis_positionEC = vec4( transformed, 1.0 );\n        #ifdef USE_INSTANCING\n            mvis_positionEC = instanceMatrix * mvis_positionEC;\n        #endif\n        mvis_positionEC=vec4(mvis_positionEC.xyz - u_cameraPositionLC,1.);\n        gl_Position = czm_modelViewProjectionRelativeToEye * mvis_positionEC;\n        "),t.vertexShader=r)},i.modifyEncodedPosition=function(e,t){var r=(r=t.vertexShader).replace(/attribute\s?vec3\s?position\s?;/g,"         attribute vec3 positionHigh;\n         attribute vec3 positionLow;\n         vec3 position;\n        ");t.vertexShader=this.insertAfterMain(r,"position=(positionHigh+positionLow)*1e-6;\n")},i.modifyShadowWorldPosition=function(e,t){var r=t.vertexShader;(r=/vec4\s?shadowWorldPosition;/g.test(r)?(r=r.replace(/vec4\s?shadowWorldPosition;/g,"vec4 shadowWorldPosition;\n\t\tvec4 worldPositionThree = vec4( transformed, 1.0 );\n\t\t#ifdef USE_INSTANCING\n\t\t\tworldPositionThree = instanceMatrix * worldPositionThree;\n        #endif\n        // vec3 transformedNormalThree = objectNormal;\n        // #ifdef USE_INSTANCING\n        //     mat3 m = mat3( instanceMatrix );\n        //     transformedNormalThree /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n        //     transformedNormalThree = m * transformedNormalThree;\n        // #endif\n        // shadowWorldNormal= normalMatrixWorld*transformedNormalThree;\n        worldPositionThree=matrixWorld*worldPositionThree;\n")).replace(/shadowWorldPosition\s?=\s?worldPosition\s?\+\s?/g,"shadowWorldPosition = worldPositionThree + "):r).includes("#define DISTANCE")&&(r=r.replace(/vWorldPosition\s?=\s?worldPosition.xyz\s?;/g,"\n        vec4 worldPositionThree = vec4(transformed, 1.0 );\n        #ifdef USE_INSTANCING\n            worldPositionThree = instanceMatrix * worldPositionThree;\n        #endif\n        worldPositionThree = matrixWorld * worldPositionThree;\n        vWorldPosition=worldPositionThree.xyz;\n")),t.vertexShader=r},i.modifyEnvMapQueryVec=function(e,t){var r=t.fragmentShader;r=(r=(r=(r=(r=(r=r.replace(/textureCube\s?\(\s?envMap\s?,\s?vec3\s?\(\s?flipEnvMap\s?\*\s?reflectVec.x\s?,\s?reflectVec.yz\s?\)\s\)/g," textureCube( envMap,vec3( flipEnvMap *(_CesiumNormal2ThreeNormal* reflectVec).x, (_CesiumNormal2ThreeNormal*reflectVec).yz ) )")).replace(/\(\s?envMap\s?,\s?reflectVec/g,"( envMap,_CesiumNormal2ThreeNormal * reflectVec")).replace(/\(\s?envMap\s?,\s?queryVec/g,"( envMap,_CesiumNormal2ThreeNormal* queryVec")).replace(/\(\s?envMap\s?,\s?queryReflectVec/g,"( envMap,_CesiumNormal2ThreeNormal* queryReflectVec")).replace(/equirectUv\(\s?reflectVec\s?\)/g,"equirectUv( _CesiumNormal2ThreeNormal* reflectVec )")).replace(/equirectUv\(\s?direction\s?\)/g,"equirectUv( _CesiumNormal2ThreeNormal* direction )"),/textureCubeUV\s?\(\s?envMap\s?,\s?reflectVec/g.test(r)&&(r=r.replace(/textureCubeUV\s?\(\s?envMap\s?,\s?reflectVec/g,"textureCubeUV(envMap, _CesiumNormal2ThreeNormal* reflectVec")),/textureCubeUV\s?\(\s?envMap\s?,\s?worldNormal/g.test(r)&&(r=r.replace(/textureCubeUV\s?\(\s?envMap\s?,\s?worldNormal/g,"textureCubeUV(envMap, _CesiumNormal2ThreeNormal* worldNormal")),t.fragmentShader=r},i.getVertexShaderSource=function(e,t){var o=e.geometry,r="\n    uniform mat4 modelViewMatrix;\n    uniform mat4 viewMatrix;\n    uniform mat4 modelMatrix;\n    uniform mat4 projectionMatrix;\n    uniform mat3 normalMatrix;\n    uniform mat4 u_modelViewMatrix;\n    uniform mat4 u_viewMatrix;\n    uniform mat4 u_modelMatrix;\n    uniform mat4 u_projectionMatrix;\n    uniform mat3 u_normalMatrix;\n    uniform vec3 cameraPosition;\n    uniform vec3 u_cameraPosition;\n",e=[e._instances&&0<e._instances.length?"mat4 modelViewMatrix":"uniform mat4 modelViewMatrix",e._instances&&0<e._instances.length?"mat4 modelMatrix":"uniform mat4 modelMatrix","uniform mat4 projectionMatrix","uniform mat3 normalMatrix",e._instances&&0<e._instances.length?"mat4 u_modelViewMatrix":"uniform mat4 u_modelViewMatrix",e._instances&&0<e._instances.length?"mat4 u_modelMatrix":"uniform mat4 u_modelMatrix","uniform mat4 u_projectionMatrix","uniform mat3 u_normalMatrix","uniform mat4 u_viewMatrix","uniform mat4 viewMatrix","uniform vec3 cameraPosition","uniform vec3 u_cameraPosition"];if(t.vertexShader){r="",e.forEach(function(e){t.vertexShader.indexOf(e)<0&&(r+=e+";\n")});e=function(e){var t,r="",n=o.attributes;for(t in n)if(n.hasOwnProperty(t)){var i=n[t];if(i){var a=null;switch(i.componentsPerAttribute){case 1:a="float";break;case 2:a="vec2";break;case 3:a="vec3";break;case 4:a="vec4"}if(a){if(0<=e.indexOf("attribute "+a+" "+t))continue;r+="attribute "+a+" "+t+";\n"}}}return r}(t.vertexShader)+r+t.vertexShader;return c.default.parseIncludes(e)}throw new Error("material.vertexShader 是必须参数")},i.getFragmentShaderSource=function(e){e=e.fragmentShader;if(e)return c.default.parseIncludes(e);throw new Error("material.fragmentShader 是必须参数")},i.processInstanceShader=function(e,t){var r,n,i,a,o;e._instances&&e._instances.length&&(r=t.vertexShader,n=(n=Cesium.ShaderSource.replaceMain(r,"czm_instancing_main")).replace(/.*uniform\s+mat4\s+modelViewMatrix/g,"mat4 modelViewMatrix").replace(/.*uniform\s+mat4\s+u_modelViewMatrix/g,"mat4 u_modelViewMatrix").replace(/.*uniform\s+mat4\s+modelMatrix/g,"mat4 modelMatrix").replace(/.*uniform\s+mat4\s+u_modelMatrix/g,"mat4 u_modelMatrix"),a=[],o=i="",(e.mesh3js||d.default.isMesh3js(e))&&(i="\n        mat3 inverse_mat3(mat3 m)\n            {\n                float Determinant = \n                      m[0][0] * (m[1][1] * m[2][2] - m[2][1] * m[1][2])\n                    - m[1][0] * (m[0][1] * m[2][2] - m[2][1] * m[0][2])\n                    + m[2][0] * (m[0][1] * m[1][2] - m[1][1] * m[0][2]);\n                    \n                mat3 Inverse;\n                Inverse[0][0] = + (m[1][1] * m[2][2] - m[2][1] * m[1][2]);\n                Inverse[1][0] = - (m[1][0] * m[2][2] - m[2][0] * m[1][2]);\n                Inverse[2][0] = + (m[1][0] * m[2][1] - m[2][0] * m[1][1]);\n                Inverse[0][1] = - (m[0][1] * m[2][2] - m[2][1] * m[0][2]);\n                Inverse[1][1] = + (m[0][0] * m[2][2] - m[2][0] * m[0][2]);\n                Inverse[2][1] = - (m[0][0] * m[2][1] - m[2][0] * m[0][1]);\n                Inverse[0][2] = + (m[0][1] * m[1][2] - m[1][1] * m[0][2]);\n                Inverse[1][2] = - (m[0][0] * m[1][2] - m[1][0] * m[0][2]);\n                Inverse[2][2] = + (m[0][0] * m[1][1] - m[1][0] * m[0][1]);\n                Inverse /= Determinant;\n                \n                return Inverse;\n            }\n            \n           mat3 transpose (mat3 m) {\n            \n                float tmp;\n                 \n                tmp = m[0][ 1 ]; m[0][ 1 ] = m[1][ 0 ]; m[1][ 0 ] = tmp;\n                tmp = m[0][ 2 ]; m[0][ 2 ] = m[2][ 0 ]; m[2][ 0 ] = tmp;\n                tmp = m[1][ 2 ]; m[1][ 2 ] = m[2][ 1 ]; m[2][ 1 ] = tmp;\n                \n                return m;\n            }\n            \n            ",n=n.replace(/.*uniform\s+mat3\s+u_normalMatrix/g,"mat3 u_normalMatrix").replace(/.*uniform\s+mat3\s+normalMatrix/g,"mat3 normalMatrix"),/mat3\s+normalMatrix/g.test(n)||a.push("mat3 normalMatrix;"),/mat3\s+u_normalMatrix/g.test(n)||a.push("mat3 u_normalMatrix;"),o="\n                   normalMatrix=mat3(modelViewMatrix);\n                   normalMatrix=transpose(inverse_mat3(normalMatrix));\n                   u_normalMatrix=normalMatrix;\n                "),/mat4\s+u_modelMatrix/g.test(n)||a.push("mat4 u_modelMatrix;"),/mat4\s+u_modelViewMatrix/g.test(n)||a.push("mat4 u_modelViewMatrix;"),r="attribute vec4 czm_modelMatrixRow0;\nattribute vec4 czm_modelMatrixRow1;\nattribute vec4 czm_modelMatrixRow2;\nuniform mat4 czm_instanced_modifiedModelView;\n"+a.join("\n")+"attribute vec4 a_pickColor;\nvarying vec4 czm_pickColor;\n"+n+i+"void main()\n{\n    modelMatrix = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n    modelViewMatrix = czm_instanced_modifiedModelView * modelMatrix;\n    u_modelMatrix =modelMatrix;\n    u_modelViewMatrix = modelViewMatrix ;\n"+o+"    czm_instancing_main();\n    czm_pickColor = a_pickColor;\n}\n",t.vertexShader=r)},i.processOcclusionCulling=function(e,t){e.material.transparent||(t.fragmentShader=Cesium.ShaderSource.replaceMain(t.fragmentShader,"mvis_OcclusionCulling"),t.fragmentShader+="\n    uniform sampler2D occlusionCullingMap;\n    uniform bool occlusionCullingToggle;\n    uniform vec2 occlusionCullingResolution;\n    void main(){\n        if(occlusionCullingToggle){\n            vec4 tPkColor=texture2D(occlusionCullingMap,gl_FragCoord.xy/occlusionCullingResolution);\n            if(tPkColor.r!=czm_pickColor.r||tPkColor.g!=czm_pickColor.g||tPkColor.b!=czm_pickColor.b||tPkColor.a!=czm_pickColor.a){\n               discard;\n            }\n            // gl_FragColor=tPkColor;\n        }\n        else{\n            mvis_OcclusionCulling();\n        }\n    }")},r.default=i},{s_124:30,"-_100":46}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\n#if NUM_STATIC_POINT_LIGHTS > 0 || NUM_PAITIAL_POINT_LIGHTS > 0\n    struct ExtensionPointLight {\n        vec3 position;\n        vec3 color;\n        vec2 decayDist;\n    };\n\n    #if NUM_STATIC_POINT_LIGHTS > 0 \n        #if defined(OES_texture_float_linear) &&  NUM_STATIC_POINT_LIGHTS>100\n            uniform sampler2D fixedPointLightMap;\n        #else \n            uniform vec3 fixedPointLightPositions[NUM_STATIC_POINT_LIGHTS];\n            uniform vec3 fixedPointLightColors[NUM_STATIC_POINT_LIGHTS];\n            uniform vec2 fixedPointLightDecayDists[NUM_STATIC_POINT_LIGHTS];\n        #endif \n        uniform bool fixedPointLightVisibles[NUM_STATIC_POINT_LIGHTS];\n    #endif\n\n    #if NUM_PAITIAL_POINT_LIGHTS > 0 \n        #if defined(OES_texture_float_linear) &&  NUM_PAITIAL_POINT_LIGHTS>100\n            uniform sampler2D partialPointLightMap;\n        #else \n            uniform vec3 partialPointLightPositions[NUM_PAITIAL_POINT_LIGHTS];\n            uniform vec3 partialPointLightColors[NUM_PAITIAL_POINT_LIGHTS];\n            uniform vec2 partialPointLightDecayDists[NUM_PAITIAL_POINT_LIGHTS];\n        #endif\n        uniform bool partialPointLightVisibles[NUM_PAITIAL_POINT_LIGHTS];\n    #endif\n\n    // directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getExtPointDirectLightIrradiance( const in ExtensionPointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n        vec3 lVector = pointLight.position - geometry.position; \n        float lightDistance = length( lVector );\n\t\tdirectLight.direction = normalize( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.decayDist.y, pointLight.decayDist.x );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n    }\n    void getExtPointDirectLightIrradiance( const in vec4 posDecay,const in vec4 colorDist, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n        vec3 lVector = posDecay.xyz - geometry.position; \n        float lightDistance = length( lVector );\n\t\tdirectLight.direction = normalize( lVector );\n\t\tdirectLight.color = colorDist.rgb;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, colorDist.a, posDecay.w );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n    }\n#endif\n"},{}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="\n#if ( NUM_STATIC_POINT_LIGHTS > 0 || NUM_PAITIAL_POINT_LIGHTS > 0) && defined( RE_Direct )\n\n    ExtensionPointLight ex_pointLight;\n    vec2 ex_uv1=vec2(0.,0.8);\n    vec2 ex_uv2=vec2(0.,0.4);\n    vec2 ex_uv3=vec2(0.,0.15);\n    #if (NUM_STATIC_POINT_LIGHTS > 0) \n\n        #if defined(OES_texture_float_linear)&&  NUM_STATIC_POINT_LIGHTS>100\n            vec4 ex_fixed_posDecay;\n            vec4 ex_fixed_colorDist;\n            float ex_num=float(NUM_STATIC_POINT_LIGHTS);\n            for ( int i = 0; i < NUM_STATIC_POINT_LIGHTS; i ++ ) {\n                ex_uv1.x=(float(i)+0.5)/ex_num;\n                ex_uv3.x=ex_uv1.x; \n                #if NUM_STATIC_POINT_LIGHTS>200\n                   if(texture2D(fixedPointLightMap, ex_uv3).a==1.){\n                #else \n                  if(fixedPointLightVisibles[i]){ \n                #endif\n                    ex_uv2.x=ex_uv1.x;\n                    ex_fixed_posDecay=texture2D(fixedPointLightMap, ex_uv1);\n                    ex_fixed_colorDist=texture2D(fixedPointLightMap,ex_uv2);\n                    getExtPointDirectLightIrradiance( ex_fixed_posDecay,ex_fixed_colorDist, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #else\n            for ( int i = 0; i < NUM_STATIC_POINT_LIGHTS; i ++ ) {\n                if(fixedPointLightVisibles[i]){ \n                    ex_pointLight.position = fixedPointLightPositions[ i ];\n                    ex_pointLight.color = fixedPointLightColors[ i ];\n                    ex_pointLight.decayDist= fixedPointLightDecayDists[ i ];\n                    getExtPointDirectLightIrradiance( ex_pointLight, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #endif\n            \n\t#endif\n    \n    #if (NUM_PAITIAL_POINT_LIGHTS > 0) \n        #if defined(OES_texture_float_linear)&&  NUM_PAITIAL_POINT_LIGHTS>100\n            vec4 ex_partial_posDecay;\n            vec4 ex_partial_colorDist;\n            float ex_num=float(NUM_PAITIAL_POINT_LIGHTS);\n            for ( int i = 0; i < NUM_PAITIAL_POINT_LIGHTS; i ++ ) {\n                   ex_uv1.x=(float( i )+0.5)/ex_num;\n                   ex_uv3.x=ex_uv1.x; \n                #if NUM_PAITIAL_POINT_LIGHTS>200\n                  if(texture2D(partialPointLightMap, ex_uv3).a==1.){\n                #else \n                  if(partialPointLightVisibles[ i ]){ \n                #endif \n                    ex_uv2.x=ex_uv1.x;\n                    ex_partial_posDecay=texture2D(partialPointLightMap, ex_uv1);\n                    ex_partial_colorDist=texture2D(partialPointLightMap,ex_uv2);\n                    getExtPointDirectLightIrradiance( ex_partial_posDecay,ex_partial_colorDist, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #else\n            for ( int i = 0; i < NUM_PAITIAL_POINT_LIGHTS; i ++ ) {\n                if(partialPointLightVisibles[i]){ \n                    ex_pointLight.position = partialPointLightPositions[ i ];\n                    ex_pointLight.color = partialPointLightColors[ i ];\n                    ex_pointLight.decayDist= partialPointLightDecayDists[ i ];\n                    getExtPointDirectLightIrradiance( ex_pointLight, geometry, directLight );\n                    RE_Direct( directLight, geometry, material, reflectedLight );\n                }\n            }\n        #endif\n            \n    #endif\n     \n#endif\n"},{}],53:[function(e,t,r){"use strict";function m(){}Object.defineProperty(r,"__esModule",{value:!0});var n=e("W_109"),g=n&&n.__esModule?n:{default:n},_=e("i_127");m.getPixelDataType=function(e){return g.default.typesMap[e]},m.getPixelFormat=function(e){return g.default.formatsMap[e]},m.createTexture=function(e,t,r){var n=Cesium,i=n.Texture,a=(n.TextureMinificationFilter,n.TextureWrap,n.PixelFormat),o=(n.WebGLConstants,n.ContextLimits),s=Cesium.Math,u=e,l=u.sampler,c=9984===l.minificationFilter||9986===l.minificationFilter||9985===l.minificationFilter||9987===l.minificationFilter,d=c||10497===l.wrapS||33648===l.wrapS||10497===l.wrapT||33648===l.wrapT,f=u.source,h=u.width,n=u.height,e=f&&(!s.isPowerOfTwo(f.width)||!s.isPowerOfTwo(f.height));d&&e&&((p=document.createElement("canvas")).width=s.nextPowerOfTwo(f.width),p.height=s.nextPowerOfTwo(f.height),p.getContext("2d").drawImage(f,0,0,f.width,f.height,0,0,p.width,p.height),h=(f=p).width,n=p.height);var p,e=u.internalFormat||u.format,s=a.isCompressedFormat(e),a=s?_.DDSTexture:i,i=!1;return(r=r||o.maximumTextureSize)<h&&(h=r,i=!0,console.warn("Width should be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize.")),r<n?(console.warn("Height should be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize."),n=r,i||(h=r*(h/n)),i=!0):i&&(n=r*(n/h)),i&&(console.warn("Width and height must be less than or equal to the maximum texture size ("+r+").  Check maximumTextureSize."),f=p=m._resampleImage(f,h,n,c),h=p.width,n=p.height),u=new a({context:t,source:f,width:h,height:n,pixelFormat:e,pixelDatatype:u.type,sampler:l,flipY:u.flipY,preMultiplyAlpha:u.preMultiplyAlpha}),c&&!s&&u.generateMipmap(),u},m.createCubeTexture=function(e,t){var r=e.value;return new Cesium.CubeMap({context:t,source:{positiveX:r[0],negativeX:r[1],positiveY:r[2],negativeY:r[3],positiveZ:r[4],negativeZ:r[5]},pixelFormat:e.format,pixelDatatype:e.type,preMultiplyAlpha:e.preMultiplyAlpha,flipY:e.flipY})},m.fromTexure3js=function(e,t){if(e.isTexture){var r={};r.minificationFilter=g.default.minFilterMap[e.minFilter],r.magnificationFilter=g.default.magFilterMap[e.magFilter],r.wrapS=g.default.textureWrapMap[e.wrapS],r.wrapT=g.default.textureWrapMap[e.wrapT],r.maximumAnisotropy=e.anisotropy,t||((t={uuid:e.uuid})._disposeCallbacks=[],t.onDispose=function(e){-1==this._disposeCallbacks.indexOf(e)&&this._disposeCallbacks.push(e)},t.destroy=function(){for(var e=0;e<this._disposeCallbacks.length;e++)this._disposeCallbacks[e].call(this);this._disposeCallbacks.splice(0)}),t.getCacheKey||(t.getCacheKey=function(){var e=this,t=e.uuid||"string"!=typeof e.value?e.uuid:e.value;return t||e.value.uuid&&(e._value instanceof HTMLImageElement||e.value instanceof HTMLCanvasElement||e.value instanceof HTMLVideoElement||e.value instanceof OffscreenCanvas)&&(t=e._value.uuid),t}),t.value=e.image;var n=t.version!=e.version,i=t.getCacheKey();n||t.cacheKey==i||(n=!0);var a,o=!1;if(e.isDataTexture)t.width=e.image.width,t.height=e.image.height,t.source={arrayBufferView:e.image.data,width:e.image.width,height:e.image.height},t.needsUpdate=!!e.image.data;else if(e.isCompressedTexture)if(e.image.width&&e.image.height){if(t.width=e.image.width,t.height=e.image.height,t.value={width:e.image.width,height:e.image.height,arrayBufferView:e.image.data},n&&e.mipmaps&&0<e.mipmaps.length){for(var s=[],u=1;u<e.mipmaps.length;u++)s.push(e.mipmaps[u].data);t.source={arrayBufferView:e.mipmaps[0].data,width:e.image.width,height:e.image.height,mipLevels:s}}}else{var l=e.image;if(Array.isArray(l)&&0<l.length&&l[0].width&&l[0].width){if(n){t.value=l,t.source=[],t.width=l[0].width,t.height=l[0].height;for(var c=0;c<l.length;c++){for(var d=l[c],f=[],h=1;h<d.mipmaps.length;h++)f.push(d.mipmaps[h].data);var p={arrayBufferView:d.mipmaps[0].data,width:d.width,height:d.height,mipLevels:f};t.source.push(p)}}}else t.value=null,o=!(t.source=null)}else e.isCanvasTexture||e.image instanceof ImageData?(t.width=e.image.width,t.height=e.image.height,t.source=e.image):o=!Array.isArray(t.value)||(n=t.value,a=!1,!(n=n.map(function(e){return e||(a=!0),e.isDataTexture?{width:e.image.width,height:e.image.height,arrayBufferView:e.image.data}:e})).length&&!a);return t.type=g.default.typesMap[e.type],t.format=g.default.formatsMap[e.format],t.sampler=r,t.flipY=e.flipY,t.preMultiplyAlpha=e.premultiplyAlpha,t.needsUpdate=!0,t.isEmptyTextureUniform=o||!t.value&&!t.source,t.version=e.version,t.cacheKey=i,t}return e},m.initTexture=function(e,t,n,r,i,a,o){var s,u,l,c=Cesium,d=(c.WebGLConstants,c.Sampler),f=!0,h=[];return o=o||1024,t.traverse(function(e){var t,r;e.material&&((r=(t=e.material).map)&&(((e=r.image).width>=o||e.height>=o)&&(r.minFilter=1006),i&&!r.uuid.startsWith(i)&&(r.uuid=i+r.uuid),n[r.uuid]?(e=n[r.uuid]).referenceCount=(e.referenceCount||0)+1:h.push(r)),t.lightMap&&!n[t.lightMap.uuid]&&(t.lightMap.minFilter=1006,t.lightMap.__isLightMap=!0,h.push(t.lightMap)))}),0<h.length&&(s={},u=h.shift(),m.fromTexure3js(u,s),c=6407,((t=s.value)instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t.src&&0<=t.src.toLocaleLowerCase().indexOf(".png"))&&(c=6408),l=m.createTexture({context:e.context,source:s.source||t,width:s.width||t.width,height:s.height||t.height,format:s.format||c,flipY:s.flipY,type:s.type,sampler:new d(s.sampler),preMultiplyAlpha:s.preMultiplyAlpha},e.context,u.__isLightMap?void 0:a),delete u.__isLightMap,n[u.uuid]=l,f=0==h.length,u.addEventListener("dispose",function(){l.referenceCount?l.referenceCount--:(l.isDestroyed&&l.isDestroyed()||l.destroy(),delete n[u.uuid])}),r&&r.push(u.uuid)),f},m.clampToUV=function(e,t){var r=e.geometry,n=e.material,i=r.getAttribute("uv");if(i&&n.map&&n.map.image){for(var a=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=Number.MAX_VALUE,u=-Number.MAX_VALUE,l=0;l<i.array.length;l+=2)var c=i.array[l],d=i.array[l+1],o=Math.max(o,c),a=Math.min(a,c),u=Math.max(u,d),s=Math.min(s,d);var f=Cesium.Math,h=o-a,p=u-s;if((h<1||p<=1)&&0<=a&&f.lessThanOrEquals(o,1,f.EPSILON2)&&0<=s&&f.lessThanOrEquals(u,1,f.EPSILON2)){e=e.clone(),r=r.clone(),n=n.clone(),e.material=n,e.geometry=r,i=i.clone(),r.setAttribute("uv",i);for(var m=0;m<i.array.length;m+=2){var g=i.array[m],_=((_=i.array[m+1])-s)/p;i.array[m]=g=(g-a)/h,i.array[m+1]=_}var v=n.map.clone(),y=v.image;v.wrapT=v.wrapS=1001,v.uuid=THREE.Math.generateUUID();var b=Math.ceil(h*y.width),x=Math.ceil(p*y.height),M=-Math.floor(a*y.width),r=-Math.floor(s*y.height);!t||f.isPowerOfTwo(b)&&f.isPowerOfTwo(x)||(b=f.nextPowerOfTwo(b),x=f.nextPowerOfTwo(x));f=document.createElement("canvas");return f.width=b,f.height=x,f.getContext("2d").drawImage(y,M,r),f.src=y.src,v.image=f,n.map=v,e}}},m.resampleTexture=function(e,t,r){var n=e.image,i=e.minFilter;THREE;r=this.resampleImage(n,t,r=r||1006!=i&&1003!=i);return e.width=r.width,e.height=r.height,e.image=r,e},m.resampleImage=function(e,t,r){var n,i=Cesium.Math,a=e.width,o=e.height,s=parseInt(a*t),u=parseInt(o*t);return 1!=t?n=this._resampleImage(e,s,u,r):(r&&(s=i.nextPowerOfTwo(s),u=i.nextPowerOfTwo(u)),(n=document.createElement("canvas")).width=s,n.height=u,n.getContext("2d").drawImage(e,0,0,a,o,0,0,s,u)),n},m._resampleImage=function(e,t,r,n){var i=Cesium.Math,a=e.width,o=e.height,s=t,u=r,r=document.createElement("canvas");n&&(s=i.nextPowerOfTwo(s),u=i.nextPowerOfTwo(u)),r.width=s,r.height=u;var l,n=r.getContext("2d"),i=e;e instanceof HTMLCanvasElement?l=i.getContext("2d"):((i=document.createElement("canvas")).width=a,i.height=o,(l=i.getContext("2d")).drawImage(e,0,0));for(var c=l.getImageData(0,0,a,o),d=n.getImageData(0,0,s,u),f=0,h=a/s,p=o/u,m=0;m<u;m++)for(var g=0;g<s;g++){for(var _=4*(parseInt(m*p)*a+parseInt(g*h)),v=0;v<4;v++)d.data[f+v]=c.data[_+v];f+=4}return n.putImageData(d,0,0),r},m.copyFromCompressData=function(e,t){var r=(e._size,e._pixelFormat),n=e._pixelDatatype,i=(e._preMultiplyAlpha,e._flipY,e._gl||e._context._gl),a=e._textureTarget,o=e._texture,s="number"==typeof e._targetFace?e._targetFace:a,u=t.width,l=t.height;t.arrayBufferView;i.activeTexture(i.TEXTURE0),i.bindTexture(a,o),i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);var c=t.arrayBufferView,e=Cesium,o=e.PixelFormat,e=e.defined,d=o.isCompressedFormat(r);if(d?i.compressedTexImage2D(s,0,r,u,l,0,c):i.texImage2D(s,0,r,u,l,0,r,n,c),e(t.mipLevels))for(var f=u,h=l,p=0;p<t.mipLevels.length;++p)(f=0|Math.floor(f/2))<1&&(f=1),(h=0|Math.floor(h/2))<1&&(h=1),d?i.compressedTexImage2D(s,p+1,r,f,h,0,t.mipLevels[p]):i.texImage2D(s,p+1,r,f,h,0,r,n,t.mipLevels[p]);i.bindTexture(a,null)},r.default=m},{i_127:9,W_109:44}],54:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){}function u(o,s,u,e,t){function l(e,t){for(var r in t)t.hasOwnProperty(r)&&(N[e+"."+r]=function(e,t){return function(){return e[t]}}(t,r))}function i(e){var t=void 0===e?"undefined":$(e);return"number"==t||"boolean"==t||e instanceof S||e instanceof w||e instanceof M||e instanceof T||e instanceof n||e instanceof y||e instanceof v||e instanceof x||null!=e&&(e.isColor||e.isVector2||e.isVector3||e.isVector4||e.isCartesian2||e.isCartesian3||e.isCartesian4||e.isMatrix2||e.isMatrix3||e.isMatrix4)}function c(e){return Array.isArray(e)&&e.length&&!i(e[0])}function a(n,i){function a(){var e=i._texture3js;if(e)return"envMap"==i.name&&(e=R.renderer._cubemaps.get(e)),R.renderer._textures.get(e,u);if((!R._textureCache[i.uuid]||i.needsUpdate)&&!a.allLoaded&&!a.isLoading){for(var t=[],r=0;r<i._value.length;r++)if(i._value[r]instanceof HTMLCanvasElement||i._value[r]instanceof HTMLVideoElement||i._value[r]instanceof HTMLImageElement)t.push(i._value[r]);else{if("string"!=typeof i._value[r])throw Error(n+""+r+"给定值“ "+i[r]+"” 不是有效的纹理图片");t.push(P(i._value[r]))}i.needsUpdate=!(a.isLoading=!0),L.all(t,function(e){var t,r;t=e,r=(e=i).uuid,t=new A({source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]},width:e.width,height:e.height,context:u.context,pixelFormat:e.format,pixelDatatype:e.type,preMultiplyAlpha:e.preMultiplyAlpha,flipY:e.flipY}),r=r||e.uuid,e.onDispose&&e.onDispose(function(){R._textureCache[r]&&(R._textureCache[r].destroy(),delete R._textureCache[r])}),R._textureCache[r]=t,e.needsUpdate=!1,a.allLoaded=!0,a.isLoading=!1})}return a.allLoaded?R._textureCache[i.uuid]:R.defaultCubeMap}return a.allLoaded&&(a.allLoaded=!1,a.isLoading=!1),a}function d(e,t){var r,t=b(e.internalFormat)?new x({context:u.context,pixelFormat:e.internalFormat,width:e.width,height:e.height,source:{arrayBufferView:e.bufferView},flipY:t.flipY}):(r=6407,(e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e.src&&0<=e.src.toLocaleLowerCase().indexOf(".png"))&&(r=6408),t.sampler?ee.default.createTexture({context:u.context,source:t.source||e,target:3553,width:t.width||e.width,height:t.height||e.height,format:t.format||r,flipY:t.flipY,type:t.type,sampler:new O(t.sampler),preMultiplyAlpha:t.preMultiplyAlpha},u.context):new x({context:u.context,source:e,target:3553,width:t.width||e.width,height:t.height||e.height,pixelFormat:r,flipY:!b(t.flipY)||t.flipY}));return t}function f(e){var t=e.toLocaleLowerCase(),r=re.Path.GetExtension(t),t=W[r]||t.startsWith("data:");return t||!!/^https?:\/\//i.test(e)||!!/^(https?:)?\/\//i.test(e)||!!/^data:.*,.*$/i.test(e)||!!/^blob:.*$/i.test(e)||void 0}function h(e){return e._value instanceof HTMLImageElement||e._value instanceof HTMLCanvasElement||e._value instanceof HTMLVideoElement||e._value instanceof ImageData||e._value instanceof OffscreenCanvas||e.sampler&&e.source}function p(e){var t=e.uuid||"string"!=typeof e._value?e.uuid:e._value;return t||(e=e.value).uuid&&(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof OffscreenCanvas)&&(t=e.uuid),t}function m(o){var s=p(o);return R._textureCache[s]&&(o.needsUpdate=!1),function t(){var e=o._texture3js;if(e)return"envMap"==o.name&&(e=R.renderer._cubemaps.get(e)),R.renderer._textures.get(e,u);if(o.needsUpdate&&(s=p(o),o.needsUpdate=!1),R._textureCache[s])return R._textureCache[s];if(h(o)){var r=o._value;return r||null!=r.data?(o._value.id||(o._value.id=o.uuid),R._textureCache[s]=d(r,o),o.onDispose&&o.onDispose(function(){R._textureCache[s]&&(R._textureCache[s].destroy(),delete R._textureCache[s])}),o.needsUpdate=!1,o.setNeedsUpdate&&o.setNeedsUpdate(!1),R._textureCache[s]):R.defaultTexture}var n=o._value,e=void 0===n?"undefined":$(n);if(("string"===e||n&&n.fileName&&n.fileBuffer)&&!t.isLoading){o.needsUpdate=!(t.isLoading=!0),o.setNeedsUpdate&&o.setNeedsUpdate(!1);var i="string"!=e,r=(r=("string"==e?re.Path.GetExtension(n):re.Path.GetExtension(n.fileName)).slice(1)).toLocaleLowerCase(),a="string"==e?n:URL.createObjectURL(new Blob([n.fileBuffer],{type:"image/"+r}));"tif"==r?I(a).then(function(e){e=(new TIFFParser).parseTIFF(e);R._textureCache[s]&&R._textureCache[s].destroy&&R._textureCache[s].destroy(),R._textureCache[s]=d(e,o),o.onDispose&&o.onDispose(function(){R._textureCache[s]&&(R._textureCache[s].destroy(),delete R._textureCache[s])}),t.isLoading=!1}).otherwise(function(e){console.error(e)}):P(a).then(function(e){i&&URL.revokeObjectURL(a),R._textureCache[s]&&R._textureCache[s].destroy&&R._textureCache[s].destroy(),e.src&&/^blob:.*$/i.test(e.src)&&URL.revokeObjectURL(e.src),R._textureCache[s]=d(e,o),o.onDispose&&o.onDispose(function(){R._textureCache[s]&&(R._textureCache[s].destroy(),delete R._textureCache[s])}),t.isLoading=!1}).otherwise(function(e){console.error(e)})}else if(R._textureCache[s])return o.needsUpdate=!1,R._textureCache[s];return R.defaultTexture}}function g(e,t){N[e]=function(){return t._value}}function _(e,t){var r,n;null!=t&&(n=!1,(n="string"===(r=$(t._value))?!f(t._value)&&function(e){if("string"!=typeof e)return!1;try{return S.fromCssColorString(J._value),!0}catch(e){return!1}}(t._value):n)||i(t._value)||t._value instanceof Array&&t._value.length&&i(t._value[0])?(n&&(t._value=S.fromCssColorString(t._value)),g(e,t)):t._value instanceof Array&&6==t._value.length&&("string"==typeof t._value[0]||t._value[0]instanceof HTMLImageElement||t._value[0]instanceof HTMLVideoElement||t._value[0]instanceof HTMLCanvasElement||t._value[0]instanceof OffscreenCanvas||t._value[0].mipmaps)?N[e]=a(e,t):("string"==$((n=t)._value)?f(n._value||n):h(n)||n.isEmptyTextureUniform||n.sampler)||t.isEmptyTextureUniform?N[e]=m(t):t._value instanceof te.FramebufferTexture?(R._renderToTextureCommands||(R._renderToTextureCommands=[]),R._framebufferTextures[t.uuid]||(R._framebufferTextures[t.uuid]=t),N[e]=function(){return R._framebufferTextures[t.uuid]&&R._framebufferTextures[t.uuid].value.texture?R._framebufferTextures[t.uuid].value.texture:u.context.defaultTexture}):"object"==r&&l(e,t._value))}var r=Cesium,v=r.Matrix4,n=r.Matrix2,y=r.Matrix3,b=r.defined,x=r.Texture,M=r.Cartesian3,w=r.Cartesian2,T=r.Cartesian4,S=r.Color,E=r.Resource,C=r.OrthographicFrustum,A=r.CubeMap,O=(r.WebGLConstants,r.Sampler),L=r.when,P=E.fetchImage,I=E.fetchArrayBuffer,R=e,D=R._uniformMaps;R._materials=R._materials||[];var U=R._materials,N={},e=e.__version+"+"+o.version;if(t&&!o.needsUpdate&&D.has(o)){if((N=D.get(o)).version==e)return N;D.delete(o)}-1==U.indexOf(o)&&U.push(o),N.version=e,D.set(o,N),o.onDispose&&o.onDispose(function(){D.delete(o);for(var e=0;e<U.length;e++)if(U[e]==o){U.splice(e,1);break}});var B,k,j,V,F,G,z,W=(Q(e={".jpeg":!(o.needsUpdate=!1),".jpg":!0,".bmp":!0,".gif":!0,".tif":!0},".gif",!0),Q(e,".png",!0),e);if(function(){var e=s.mesh3js||s;N.cameraPosition=function(){var e=u.camera.customCamera;return e&&e.cameraPosition?e.cameraPosition:u.camera.position},N.u_cameraPosition=N.cameraPosition,N.normalMatrix=function(){var e=u.camera.customCamera;return e&&e.normalMatrix?e.normalMatrix:u.context.uniformState.normal},N.u_normalMatrix=N.normalMatrix,N.projectionMatrix=function(){var e=u.camera.customCamera;return e&&e.projectionMatrix?e.projectionMatrix:u.context.uniformState.projection},N.u_projectionMatrix=N.projectionMatrix,N.modelViewMatrix=function(){var e=u.camera.customCamera;return e&&e.modelViewMatrix?e.modelViewMatrix:u.context.uniformState.modelView},N.u_modelViewMatrix=N.modelViewMatrix;var t=new v;N.modelViewMatrixInverse=function(){var e=u.context.uniformState.modelView;return v.inverse(e,t)},N.modelMatrix=function(){var e=u.camera.customCamera;return e&&e.modelMatrix?e.modelMatrix:u.context.uniformState.model},N.u_modelMatrix=N.modelMatrix;var r=new v;N.matrixWorld=function(){var e=N._CesiumModel2ThreeModel();return v.multiply(e,u.context.uniformState.model,r)};var n=new y;N.normalMatrixWorld=function(){var e=N._CesiumNormal2ThreeNormal();return y.multiply(e,u.context.uniformState.normal,n)},N._CesiumModel2ThreeModel=function(){return(s.mesh3js||s).up.y?R._actualModelMatrixYupInverse:R._actualModelMatrixInverse},N._ThreeModel2CesiumModel=function(){return(s.mesh3js||s).up.y?R._actualModelMatrixYup:R._actualModelMatrix};var i=new y;N._CesiumNormal2ThreeNormal=function(){return(s.mesh3js||s).up.y?v.getMatrix3(R._actualModelMatrixYupInverse,i):v.getMatrix3(R._actualModelMatrixInverse,i)};var a=new y;N._ThreeNormal2CesiumNormal=function(){return(s.mesh3js||s).up.y?v.getMatrix3(R._actualModelMatrixYup,a):v.getMatrix3(R._actualModelMatrix,a)},N.viewMatrix=function(){return u.context.uniformState.view},N.u_viewMatrix=N.viewMatrix,N.logDepthBufFC=function(){return 2/(Math.log(u.camera.frustum.far+1)/Math.LN2)},N.isOrthographic=function(){var e=u.camera;return!0===e.isOrthographicCamera||e.frustum instanceof C},N.toneMappingExposure=function(){return R.renderer.toneMappingExposure},N.toneMappingWhitePoint=function(){return R.renderer.toneMappingWhitePoint},N.receiveShadow=function(){return!!e.receiveShadow},N.center=function(){return!!e.center},o.uniformStateUsed&&o.uniformStateUsed.length&&o.uniformStateUsed.forEach(function(e){if(!N[e.glslVarName]){if(!u.context.uniformState[e.uniformStateName])throw new Error(e.uniformStateName+"不是Cesium引擎的内置对象");N[e.glslVarName]=function(){return u.context.uniformState[e.uniformStateName]}}})}(),o.uniforms){var H,Y,X,q,K,Z=o.material3js;for(K in Z&&(((z=Z).isMeshLambertMaterial||z.isMeshToonMaterial||z.isMeshPhongMaterial||z.isMeshStandardMaterial||z.isShadowMaterial||z.isShaderMaterial&&!0===z.lights)&&(H=function(e){return function(){return Y[e].map(function(e){return R._textureCache[e.uuid]})}},q=o.uniforms,Y=R._lights.state,q.ambientLightColor&&(Z.lightMap?q.ambientLightColor.value=S.BLACK:q.ambientLightColor.value=Y.ambient),q.lightProbe&&(q.lightProbe.value=Y.probe),q.directionalLights&&(q.directionalLights.value=Y.directional),q.directionalLightShadows&&(q.directionalLightShadows.value=Y.directionalShadow),q.spotLights&&(q.spotLights.value=Y.spot),q.spotLightShadows&&(q.spotLightShadows.value=Y.spotShadow),q.rectAreaLights&&(q.rectAreaLights.value=Y.rectArea),q.pointLights&&(q.pointLights.value=Y.point),q.pointLightShadows&&(q.pointLightShadows.value=Y.pointShadow),q.hemisphereLights&&(q.hemisphereLights.value=Y.hemi),q.directionalShadowMap&&(N.directionalShadowMap=H("directionalShadowMap")),q.directionalShadowMatrix&&(q.directionalShadowMatrix.value=Y.directionalShadowMatrix),q.spotShadowMap&&(N.spotShadowMap=H("spotShadowMap")),q.spotShadowMatrix&&(q.spotShadowMatrix.value=Y.spotShadowMatrix),q.pointShadowMap&&(N.pointShadowMap=H("pointShadowMap")),q.pointShadowMatrix&&(q.pointShadowMatrix.value=Y.pointShadowMatrix)),(Z.isShaderMaterial||Z.isRawShaderMaterial)&&!0!==Z.clipping||(N.clippingPlanes=function(){return X=T.unpackArray(R.renderer._clipping.uniform.value,X)},N.viewMatrixThree=function(){var e={matrix:R._actualModelMatrixYup,inverseMatrix:R._actualModelMatrixYupInverse};return(u.camera.frustum instanceof C?ne.default.toOrthographicCamera3js(u.camera,null,e):ne.default.toPerspectiveCamera3js(u.camera,null,e)).matrixWorldInverse.elements})),function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(r._texture3js)N[t]=m(r);else{var n=r.value;if(b(n)&&null!=n||r.isEmptyTextureUniform){if(r.isEmptyTextureUniform){_(t,r);continue}if(Array.isArray(n)){if(0==n.length)continue;if(i(n[0])){g(t,r);continue}}if(c(n)){!function e(t,r){if(c(r))for(var n=0;n<r.length;n++){var i=r[n],a=t+"["+n+"]";(c(i)?e:l)(a,i)}else N[t]=function(){return r}}(t,n);continue}if(null==r)continue;_(t,r)}}}}(o.uniforms),q=o.uniforms){var J=q[K];J&&null==J.value&&!N[K]&&(N[K]=m(J))}}return(z=o.material3js)&&z.skinning&&(j=s.mesh3js||s,N.bindMatrix=function(){return j.bindMatrix.elements},N.bindMatrixInverse=function(){return j.bindMatrixInverse.elements},(V=j.skeleton)&&(H=V.bones,R.renderer._capabilities.floatVertexTextures?(F=function e(){G.destroy(),V.boneTexture.removeEventListener("dispose",e)},void 0===V.boneTexture&&(Z=THREE,z=Math.sqrt(4*H.length),z=Z.Math.ceilPowerOfTwo(z),z=Math.max(z,4),(H=new Float32Array(z*z*4)).set(V.boneMatrices),Z=new Z.DataTexture(H,z,z,1023,1015),V.boneMatrices=H,V.boneTexture=Z,V.boneTextureSize=z),(G=ee.default.fromTexure3js(V.boneTexture)).name="boneTexture",(V.boneTextureCesium=G).texture=d(G.value,G),V.boneTexture.addEventListener("dispose",F),N.boneTexture=function(){return G.needsUpdate&&G.texture.copyFrom(G.source),G.texture},N.boneTextureSize=function(){return V.boneTextureSize}):N.boneMatrices=function(){return V.boneMatrices.elements})),z=o.material3js,F=s.mesh3js||s,z&&(z.morphTargets||o.morphNormals)&&(k=R.renderer.morphtargets.getUniforms(F),N.morphTargetBaseInfluence=function(){return k.morphTargetBaseInfluence},N.morphTargetInfluences=function(){return k.morphTargetInfluences}),N.envMap||(B=o.uniforms.envMap,N.envMap=function(){return B&&R._textureCache[B.uuid]?R._textureCache[B.uuid]:R.environment?R.renderer._textures.get(R.environment):R.defaultCubeMap}),N}Object.defineProperty(r,"__esModule",{value:!0});var $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=(n(e("e_94")),e("k_106")),ee=n(a),te=e("s_130"),re=e("h_131"),ne=n((e("s_108"),e("3_133")));i.get=function(e,t,r,n,i){var a,o,s,i=u(e,t,r,n,0!=i);return t._instances&&(i.czm_instanced_modifiedModelView=(a=r.context,o=t,s=Cesium.Matrix4,function(){return o._rtcTransform||(o._rtcTransform=new s),o._rtcModelView||(o._rtcModelView=new s),s.multiplyByTranslation(o.modelMatrix,o._center,o._rtcTransform),s.multiply(a.uniformState.view,o._rtcTransform,o._rtcModelView)})),i},r.default=i},{h_131:169,"3_133":7,s_130:10,s_108:22,e_94:24,k_106:53}],55:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function I(){}function R(){var e;i||(i=!0,e=Cesium,B=e.Matrix4,b=e.defined,k=e.GeometryPipeline,e.BufferUsage,j=e.VertexArray,x=e.defaultValue,V=e.Cartesian3,F=e.Cartesian2,G=e.Cartesian4,z=e.Color,W=e.Buffer,H=e.ComponentDatatype,e.IndexDatatype,e.DrawCommand,Y=e.BoundingSphere,l=new B)}function D(e,t){var r=t?e._instances:e._availableInstances,n=r.length,i=e._center,a=e._vertexBufferTypedArray;(!b(a)||12*n>a.length)&&(a=new Float32Array(12*n)),e._vertexBufferTypedArray=a;for(var o=0;o<n;++o){var s=r[o].modelMatrix,u=B.clone(s,l);u[12]-=i.x,u[13]-=i.y,u[14]-=i.z;s=12*o;a[0+s]=u[0],a[1+s]=u[4],a[2+s]=u[8],a[3+s]=u[12],a[4+s]=u[1],a[5+s]=u[5],a[6+s]=u[9],a[7+s]=u[13],a[8+s]=u[2],a[9+s]=u[6],a[10+s]=u[10],a[11+s]=u[14]}return a}function U(e,t,r){var n,i=r?e._instances:e._availableInstances,a=i.length,o=e._pickIdBufferTypedArray;for((!o||4*a>o.length)&&(o=new Uint8Array(4*a)),e._pickIdBufferTypedArray=o,n=0;n<a;++n){var s=i[n],u=e._pickIds[s.instanceId];u||(u=t.createPickId(s),e._pickIds[s.instanceId]=u);s=u.color,u=4*n;o[u]=z.floatToByte(s.red),o[1+u]=z.floatToByte(s.green),o[2+u]=z.floatToByte(s.blue),o[3+u]=z.floatToByte(s.alpha)}return o}function N(e,t,r){var n,i,a=r?e._instances:e._availableInstances,o=a.length,s=t.name,r=t.default instanceof z;"number"==typeof t.default?i=1:t.default instanceof F?i=2:t.default instanceof V?i=3:(t.default instanceof G||r)&&(i=4);var u=e["_"+s+"BufferTypedArray"];if((!u||o*i>u.length)&&(u=new(r?Uint8Array:Float32Array)(o*i)),e["_"+s+"BufferTypedArray"]=u,r)for(n=0;n<o;++n){var l=a[n][s];u[c=n*i]=z.floatToByte(l.red),u[c+1]=z.floatToByte(l.green),u[c+2]=z.floatToByte(l.blue),u[c+3]=z.floatToByte(l.alpha)}else if("number"==typeof t.default)for(n=0;n<o;++n){l=a[n][s];u[n]=l}else if(t.default instanceof F)for(n=0;n<o;++n){l=a[n][s];u[c=n*i]=l.x,u[c+1]=l.y}else if(t.default instanceof V)for(n=0;n<o;++n){l=a[n][s];u[c=n*i]=l.x,u[c+1]=l.y,u[c+2]=l.z}else if(t.default instanceof G)for(n=0;n<o;++n){var c,l=a[n][s];u[c=n*i]=l.x,u[c+1]=l.y,u[c+2]=l.z,u[c+3]=l.w}return u}function _(e,t,r){r=r||0;var n=e._gl,r=e._bufferTarget;n.bindBuffer(r,e._buffer),n.bufferData(r,t,n.DYNAMIC_DRAW),n.bindBuffer(r,null)}function v(e,t,r){t=e._attributeLocations[t];if(null!=t){e=e._attributes[t].vertexBuffer,t=r.values||r.array,r=t.constructor.BYTES_PER_ELEMENT;return e._sizeInBytes==t.length*r&&(e.copyFromArrayView(t,0),1)}}Object.defineProperty(r,"__esModule",{value:!0});var B,b,k,j,x,V,F,G,z,W,H,l,Y,c=n(e("d_102")),X=n(e("-_100")),y=n(e("3_101")),M=new function(){var n=new WeakMap;this.get=function(e){return n.get(e)},this.set=function(t,e,r){r.addEventListener("dispose",function e(){n.delete(t),r.removeEventListener("dispose",e)}),n.set(t,e)},this.delete=function(e){n.delete(e)}},i=!1;I.createInterleavedAttribute3js=function(e,t,r,n){R();var i=t.data,a=i.stride,o=t.offset,s=i.array,u=s.constructor.BYTES_PER_ELEMENT,n=W.createVertexBuffer({context:n,typedArray:s,usage:i.usage}),u={index:r[e],vertexBuffer:n,componentDatatype:c.default.getAttributeComponentType(s),componentsPerAttribute:t.itemSize,normalize:t.normalized,offsetInBytes:o*u,strideInBytes:a*u};return i&&i.isInstancedInterleavedBuffer&&(u.instanceDivisor=i.meshPerAttribute||1),u},I.createAttribute3js=function(e,t,r,n,i,a){R();try{var o=t.array,s=W.createVertexBuffer({context:n,typedArray:o,usage:t.usage||i}),u={index:r[e],vertexBuffer:s,componentDatatype:c.default.getAttributeComponentType(o),componentsPerAttribute:t.itemSize,normalize:t.normalized};return t.isInstancedBufferAttribute&&(u.offsetInBytes=0,u.strideInBytes=0,u.instanceDivisor=t.meshPerAttribute||1),u}catch(e){throw e}},I.createIndexBuffer3js=function(e){R();var t,r=e.geometry,n=r.groups,i=x(e.bufferUsage,35048),a=e.context,o=e.group,s=e.groupOptimized,u=e.indices,e=r.index;return u||(void 0!==o&&1<n.length?u=c.default.genGeometryIndices(r,o,s):e&&(u=e.array)),u&&0<u.length&&(t=5123,u instanceof Uint8Array?t=5121:u instanceof Uint32Array&&(t=5125),t=W.createIndexBuffer({context:a,typedArray:u,usage:i,indexDatatype:t})),t},window.indexMemory=0,I.fromBufferGeometry3js=function(e){R();var t,r,n,i,a,o=e.geometry,s=o.groups,u=e.context,l=e.attributeLocations,c=e.group,d=e.groupOptimized,f=x(e.bufferUsage,35048),h=[].concat(e.vertexArrayAttributes||[]),p=o.attributes;e.useEncodedPosition&&(r=(t=(p=Object.assign({},o.attributes)).position).array,n=p.positionHigh=Object.assign({},t),i=p.positionLow=Object.assign({},t),n.array=new Float32Array(r.length),i.array=new Float32Array(r.length),a={high:0,low:0},r.forEach(function(e,t){Cesium.EncodedCartesian3.encode(1e6*e,a),n.array[t]=a.high,i.array[t]=a.low}),delete p.position);var m,g,_,v,e=this.createIndexBuffer3js({geometry:o,context:u,group:c,groupOptimized:d,bufferUsage:f,indices:e.indices}),y=c&&1<s.length;for(g in p)p.hasOwnProperty(g)&&b(p[g])&&(_=p[g],(v=y?M.get(_):void 0)||((v=_.isInterleavedBufferAttribute?this.createInterleavedAttribute3js(g,_,l,u):this.createAttribute3js(g,_,l,u,f,c)).instanceDivisor&&(m=v.instanceDivisor*_.count),M.set(_,v,o)),h.push(v));e=new j({context:u,attributes:h,indexBuffer:e});return e._attributeLocations=l,e.instanceCount=m,p=null,e},I.create=function(e,t,r,n,i,a,o){R();var s=X.default.isMesh3js(t)?t:t.mesh3js,u=e.attributes;s&&o&&((u=Object.assign({},e.attributes)).positionHigh=u.position,u.positionLow=u.position,delete u.position);var l,c,d,f,h,p,m,g,_,v=k.createAttributeLocations({attributes:u}),y=0;for(C in v)v.hasOwnProperty(C)&&(y=Math.max(y,v[C]));if(t._instances&&t._instances.length){(function(e){for(var t=e._instances.length,r=new Array(t),n=0;n<t;++n)r[n]=B.getTranslation(e._instances[n].modelMatrix,new V);e._boundingSphere=Y.fromPoints(r),V.clone(e._boundingSphere.center,e._center)})(t),M=[],t._pickIds=function(e,t){for(var r=e._instances,n=r.length,i=new Array(n),a=0;a<n;++a)i[a]=t.createPickId(r[a]);return i}(t,r),_=U(m=t,g=r,!0),m._pickIdBuffer=W.createVertexBuffer({context:g,typedArray:_,usage:35044}),_=D(m,!0),m._vertexBuffer=W.createVertexBuffer({context:g,typedArray:_,usage:35044});var b=12,x=H.getSizeInBytes(H.FLOAT);for(C in(S={czm_modelMatrixRow0:{index:y+1,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:H.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:x*b,instanceDivisor:1},czm_modelMatrixRow1:{index:y+2,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:H.FLOAT,normalize:!1,offsetInBytes:4*x,strideInBytes:x*b,instanceDivisor:1},czm_modelMatrixRow2:{index:y+3,vertexBuffer:t._vertexBuffer,componentsPerAttribute:4,componentDatatype:H.FLOAT,normalize:!1,offsetInBytes:8*x,strideInBytes:x*b,instanceDivisor:1}}).a_pickColor={index:y+4,vertexBuffer:t._pickIdBuffer,componentsPerAttribute:4,componentDatatype:H.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1},S)S.hasOwnProperty(C)&&(v[C]=++y,M.push(S[C]));d=r,f=M,h=v,p=y,(c=t).instancedAttributes.forEach(function(e){h[e.name]=++p;var t=W.createVertexBuffer({context:d,typedArray:N(c,e,!0),usage:35044});e._buffer=t;t={index:h[e.name],vertexBuffer:t,componentsPerAttribute:4,componentDatatype:H.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};"number"==typeof e.default?t.componentsPerAttribute=1:e.default instanceof F?t.componentsPerAttribute=2:e.default instanceof V?t.componentsPerAttribute=3:e.default instanceof G?t.componentsPerAttribute=4:e.default instanceof z&&(t.componentDatatype=H.UNSIGNED_BYTE,t.normalize=!0,t.componentsPerAttribute=4),f.push(t)}),y=p}else if(s&&s.isInstancedMesh){for(var M=[],t=s.instanceMatrix,w=s.instanceColor,b=16,x=H.getSizeInBytes(H.FLOAT),T=W.createVertexBuffer({context:r,typedArray:t.array,usage:35044}),S={},E=0;E<4;E++){var C="instanceMatrix"+(E||""),A=++y,O={index:A,vertexBuffer:T,componentsPerAttribute:4,componentDatatype:H.FLOAT,normalize:!1,offsetInBytes:E*b,strideInBytes:x*b,instanceDivisor:1};M.push(O),v[C]=A}s.instanceColor&&(v.instanceColor=++y,(w=this.createAttribute3js("instanceColor",s.instanceColor,v,r,n,35044)).instanceDivisor=1,M.push(w)),w=s.count}if(s&&e.isBufferGeometry)l=I.fromBufferGeometry3js({context:r,geometry:e,attributeLocations:v,bufferUsage:35044,vertexArrayAttributes:M,group:n,indices:i,groupOptimized:a,useEncodedPosition:o});else{for(var L in u=e.attributes){var P=u[L];P?P.componentDatatype==H.DOUBLE&&(P.values=new Float32Array(P.values)):delete u[L]}l=j.fromGeometry({context:r,geometry:e,attributeLocations:v,bufferUsage:35044,vertexArrayAttributes:M})}return M&&M.length&&(l._cacehVertexArrayAttributes=M),l._attributeLocations=v,w&&(l.instanceCount=w),l._attributes.sort(function(e,t){return e.index-t.index}),l},I.update=function(e,t,r,n,i){R();var a=X.default.isMesh3js(e)?e:e.mesh3js;!n&&a&&(n=y.default.get(a.geometry));var o,s,u=e.geometry,l=u.attributes,c=n&&n.attributes,d=r.vertexArray,f=!1,h=!1,n=!1;if(a&&(h=a.material.morphTargets||a.material.morphNormals,n=a.isSkinnedMesh),!n&&!h)for(var p in l){var m=l[p];if(m){var g=i||0!=m.needsUpdate;if(c||0!=g){if(!v(d,p,c&&c[p]||m)){f=!0;break}m.needsUpdate=!1}}}if(!f&&u.indexNeedsUpdate&&(s=d.indexBuffer,u.indexNeedsUpdate=!1,s.copyFromArrayView(u.indices,0)),!f&&e._instances&&e._instances.length&&(s=t,u=D(o=e),_(o._vertexBuffer,u),s=U(o,s),_(o._pickIdBuffer,s),o.instancedAttributes.forEach(function(e){var t=N(o,e);_(e._buffer,t)})),f){if(!(d=r.vertexArray).isDestroyed()&&(d.destroy(),M))for(var p in c)c.hasOwnProperty(p)&&c[p]&&M.delete(c[p]);for(p in r.vertexArray=this.create(e,t),l)l.hasOwnProperty(p)&&l[p]&&(l[p].needsUpdate=!1);e.geometry.indexNeedsUpdate=!1}else a&&a.isInstancedMesh&&(e=a.instanceMatrix,a=a.instanceColor,d._attributes[d._attributeLocations.instanceMatrix].version!=e.version&&v(d,"instanceMatrix",e),a&&d._attributes[d._attributeLocations.instanceColor].version!=a.version&&v(d,"instanceColor",a));return f},I.updateVerexBuffer=function(e,t,r){e=e.renderItems;e&&e.forEach(function(e){e&&v(e.drawCommand.vertexArray,t,r)})},I.delete=function(e){if(M){var t,r=e.attributes;for(t in r)r.hasOwnProperty(t)&&r[t]&&M.delete(r[t])}},r.default=I},{d_102:11,"-_100":46,"3_101":60}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t,r,e){function n(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var i,a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==e.precision?e.precision:"highp";(g=n(o))!==o&&(console.warn("WebGLRenderer:",o,"not supported, using",g,"instead."),o=g);var s=!0===e.logarithmicDepthBuffer,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),f=t.getParameter(t.MAX_VERTEX_ATTRIBS),h=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),p=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=0<l,e=a||!!r.get("OES_texture_float");return{gl:t,isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==i)return i;var e=r.get("EXT_texture_filter_anisotropic");return i=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:s,maxTextures:u,maxVertexTextures:l,maxTextureSize:c,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:h,maxVaryings:p,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:e,floatVertexTextures:g&&e,maxSamples:a?t.getParameter(t.MAX_SAMPLES):0}}},{}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(l,e){function c(){y.value!==h&&(y.value=h,y.needsUpdate=0<p),f.numPlanes=p,f.numIntersection=0}function d(e,t,r,n){var i=null!==e?e.length:0,a=null;if(0!==i){if(a=y.value,!0!==n||null===a){var n=r+4*i,o=t.matrixWorldInverse;v.getNormalMatrix(o),(null===a||a.length<n)&&(a=new Float32Array(n));for(var s=0,u=r;s!==i;++s,u+=4)_.copy(e[s]).applyMatrix4(o,v),_.normal.toArray(a,u),a[u+3]=_.constant}y.value=a,y.needsUpdate=!0}return f.numPlanes=i,f.numIntersection=0,a}var t=THREE,r=t.Matrix3,n=t.Plane,f=(t.Vector3,this),h=null,p=0,m=!1,g=!1,_=new n,v=new r,y={value:null,needsUpdate:!1};this.uniform=y,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,r){var n=0!==e.length||t||0!==p||m;return m=t,h=d(e,r,0),p=e.length,n},this.beginShadows=function(){g=!0,d(null)},this.endShadows=function(){g=!1,c()},this.setState=function(e,t,r){var n=e.clippingPlanes,i=e.clipIntersection,a=e.clipShadows,e=l.get(e);if(!m||null===n||0===n.length||g&&!a)g?d(null):c();else{var a=g?0:p,o=4*a,s=e.clippingState||null;y.value=s;for(var s=d(n,t,o,r),u=0;u!==o;++u)s[u]=h[u];e.clippingState=s,this.numIntersection=i?this.numPlanes:0,this.numPlanes+=a}}}},{}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a){function o(e,t){return t===u?e.mapping=r:t===l&&(e.mapping=n),e}function s(e){var t=e.target;t.removeEventListener("dispose",s);e=d.get(t);void 0!==e&&(d.delete(t),e.dispose())}if("undefined"==typeof THREE)return{get:function(e){return e},dispose:function(){}};var r=301,n=302,u=303,l=304,c=THREE.WebGLCubeRenderTarget,d=new WeakMap;return{get:function(e){if(e&&e.isTexture){var t=e.mapping;if(t===u||t===l){if(d.has(e))return o(d.get(e).texture,e.mapping);var r=e.image;if(r&&0<r.height){var n=a.getRenderTarget(),i=a.renderState,t=a.autoConvertCamera,r=new c(r.height/2);return a.autoConvertCamera=!0,r.fromEquirectangularTexture(a,e),d.set(e,r),a.autoConvertCamera=t,a.setRenderTarget(n),a.renderState=i,e.addEventListener("dispose",s),o(r.texture,e.mapping)}return null}}return e},dispose:function(){d=new WeakMap}}}},{}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(r){var n={};return{has:function(e){if(void 0!==n[e])return null!==n[e];var t=void 0;switch(e){case"WEBGL_depth_texture":t=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:t=r.getExtension(e)}return null!==(n[e]=t)},get:function(e){return this.has(e)||console.warn("WebGLRenderer: "+e+" extension not supported."),n[e]}}}},{}],60:[function(e,t,r){"use strict";function n(){}var u,f;function i(e){function t(){f.delete(e),e.addEventListener("dispose",t)}var r=[],n=e.index,i=e.attributes.position,a=0;if(null!==n)for(var o=n.array,a=n.version,s=0,u=o.length;s<u;s+=3){var l=o[s+0],c=o[s+1],d=o[s+2];r.push(l,c,c,d,d,l)}else{o=i.array;a=i.version;for(s=0,u=o.length/3-1;s<u;s+=3){l=s+0,c=s+1,d=s+2;r.push(l,c,c,d,d,l)}}n=THREE,i=n.Uint32BufferAttribute,n=n.Uint16BufferAttribute,n=new(65535<function(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}(r)?i:n)(r,1);n.version=a;a=f.get(e);a&&a.onGeometryDispose(),n.onGeometryDispose=t,e.addEventListener("dispose",t),f.set(e,n)}Object.defineProperty(r,"__esModule",{value:!0}),n.getWireframeAttribute=(f=new WeakMap,function(e){var t,r=f.get(e);return(!r||null!==(t=e.index)&&r.version<t.version)&&i(e),f.get(e)}),n.get=(u=new WeakMap,function(t,e){var r;t.isBufferGeometry||t instanceof Cesium.Geometry?r=t:(r=u.get(t))||(n=function e(){r.dispose(),u.delete(t),r.removeEventListener("dispose",e)},(r=new THREE.BufferGeometry).fromGeometry(t),r.addEventListener("dispose",n),u.set(t,r));var n,i,a,o,s=Cesium.BoundingSphere;return r.boundingSphere||(r.computeBoundingSphere?r.computeBoundingSphere():(n=r.attributes.position,t.boundingSphere=s.fromVertices(n.values||n.array))),r.boundingVolume||(r.boundingVolume=s.clone(r.boundingSphere)),(s=r.groups)&&0<s.length&&!r.groupsOptimized&&(i=[],a={},o=[],s.forEach(function(e,t){e=e.materialIndex;a[e]||(o.push(e),i.push({materialIndex:e,groupIndex:t}),a[e]=!0)}),r.groupsOptimized=i,r.materialIndicesUsed=o),r}),r.default=n},{}],61:[function(e,t,r){"use strict";function n(){var r={},e=Cesium,n=e.Cartesian2,i=e.Cartesian3,a=e.Color;return{get:function(e){if(void 0!==r[e.id])return r[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new i,color:new a,shadow:!1};break;case"SpotLight":t={position:new i,direction:new i,color:new a,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1};break;case"PointLight":t={position:new i,color:new a,distance:0,decay:0,shadow:!1,decalDist:new n,visible:1};break;case"HemisphereLight":t={direction:new i,skyColor:new a,groundColor:new a};break;case"RectAreaLight":t={color:new a,position:new i,halfWidth:new i,halfHeight:new i}}return r[e.id]=t}}}function i(){var r={},e=Cesium,n=(e.Cartesian3,e.Color,e.Cartesian2);return{get:function(e){if(void 0!==r[e.id])return r[e.id];var t=void 0;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new n,shadowCameraNear:1,shadowCameraFar:1e3}}return r[e.id]=t}}}function F(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function G(e,t){var r=e.x,n=e.y,i=e.z,t=t;return e.x=t[0]*r+t[4]*n+t[8]*i,e.y=t[1]*r+t[5]*n+t[9]*i,e.z=t[2]*r+t[6]*n+t[10]*i,Cesium.Cartesian3.normalize(e,e)}Object.defineProperty(r,"__esModule",{value:!0});var z=0;r.default=function(){function O(e){var t=U.point,r=t.map,n=t.array,i=N.hash.pointLength;if(e&&i){r&&t.length==i||(r&&!r.isDestroyed&&r.destroy(),t.length=i,r=new _({context:e.context,width:2*i,height:6,pixelDatatype:5126,pixelFormat:6408,sampler:new Cesium.Sampler({wrapS:33071,wrapT:33071,magnificationFilter:9729,minificationFilter:9729})}),t.map=r,n=new Float32Array(r.width*r.height*4),t.array=n),i*=2;for(var a=0;a<i;a+=2){for(var o=t.positions[a/2],s=t.decalDists[a/2],u=t.colors[a/2],l=t.visibles[a/2],c=0;c<2;c++)for(var d=0;d<2;d++)n[p=4*(i*c+a+d)]=o.x,n[p+1]=o.y,n[p+2]=o.z,n[p+3]=s.x;for(var f=2;f<4;f++)for(var h=0;h<2;h++)n[p=4*(i*f+a+h)]=u.red,n[p+1]=u.green,n[p+2]=u.blue,n[p+3]=s.y;for(var p,m=4;m<6;m++)for(var g=0;g<2;g++)n[p=4*(i*m+a+g)]=l,n[p+1]=l,n[p+2]=l,n[p+3]=l}r.copyFrom({width:r.width,height:r.height,arrayBufferView:n})}}for(var e=Cesium,L=e.Matrix4,t=e.Matrix3,P=e.Cartesian3,I=e.Color,_=e.Texture,R=(e.PixelDatatype,e.PixelFormat,new n),D=new i,U={point:{positions:[],colors:[],decalDists:[],visibles:[],map:null,array:null}},N={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:new I(0,0,0,1),probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},r=0;r<9;r++)N.probe.push(new P);var B=new P,k=new L,j=new L,V=new t;this.setup=function(e,t,r,n){for(var i=0,a=0,o=0,s=0;s<9;s++)N.probe[s].set(0,0,0);var u=0,l=0,c=0,d=0,f=0,h=0,p=0,m=0,g=r.viewMatrix;e.sort(F),U.point.positions.length=0;for(var s=U.point.colors.length=U.point.decalDists.length=0,_=e.length;s<_;s++){var v,y,b,x,M,w=e[s],T=w.color,S=w.intensity,E=w.distance,C=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)i+=T.red*S,a+=T.green*S,o+=T.blue*S;else if(w.isLightProbe)for(var A=0;A<9;A++)N.probe[A].x=w.sh.coefficients[A].x*S,N.probe[A].y=w.sh.coefficients[A].y*S,N.probe[A].z=w.sh.coefficients[A].z*S;else w.isDirectionalLight?(M=R.get(w),I.multiplyByScalar(T,S,M.color),L.getTranslation(w.modelMatrix,M.direction),L.getTranslation(w.target.modelMatrix,B),P.subtract(M.direction,B,M.direction),G(M.direction,g),M.shadow=w.castShadow,w.castShadow&&(v=w.shadow,(y=D.get(w)).shadowBias=v.bias,y.shadowNormalBias=v.normalBias,y.shadowRadius=v.radius,y.shadowMapSize=v.mapSize,N.directionalShadow[u]=y,N.directionalShadowMap[u]=C,y=w.shadow.matrix,N.directionalShadowMatrix[u]=L.clone(y.elements||y,N.directionalShadowMatrix[u]),h++),N.directional[u]=M,u++):w.isSpotLight?(M=R.get(w),L.getTranslation(w.modelMatrix,M.position),L.multiplyByPoint(g,M.position,M.position),I.multiplyByScalar(T,S,M.color),M.distance=E,L.getTranslation(w.modelMatrix,M.direction),L.getTranslation(w.target.modelMatrix,B),P.subtract(M.direction,B,M.direction),G(M.direction,g),M.coneCos=Math.cos(w.angle),M.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),M.decay=w.decay,M.shadow=w.castShadow,w.castShadow&&(b=w.shadow,(x=D.get(w)).shadowBias=b.bias,x.shadowNormalBias=b.normalBias,x.shadowRadius=b.radius,x.shadowMapSize=b.mapSize,N.spotShadow[c]=x,N.spotShadowMap[c]=C,b=w.shadow.matrix,N.spotShadowMatrix[c]=L.clone(b.elements||b,N.spotShadowMatrix[c]),m++),N.spot[c]=M,c++):w.isRectAreaLight?(M=R.get(w),I.multiplyByScalar(T,S,M.color),L.getTranslation(w.modelMatrix,M.position),L.multiplyByPoint(g,M.position,M.position),L.IDENTITY.clone(j),L.clone(w.modelMatrix,k),L.multiply(g,k,k),L.multiplyByMatrix3(j,L.getMatrix3(k,V),j),P.fromElements(.5*w.width,0,0,M.halfWidth),P.fromElements(0,.5*w.height,0,M.halfHeight),L.multiplyByPoint(j,M.halfWidth,M.halfWidth),L.multiplyByPoint(j,M.halfHeight,M.halfHeight),N.rectArea[d]=M,d++):w.isPointLight?(M=R.get(w),L.getTranslation(w.modelMatrix,M.position),L.multiplyByPoint(g,M.position,M.position),I.multiplyByScalar(T,S,M.color),M.distance=w.distance,M.decay=w.decay,M.shadow=w.castShadow,M.visible=w._exVisible?1:0,(x=U.point).positions[l]=M.position,x.colors[l]=M.color,x.decalDists[l]=M.decalDist,M.decalDist.x=w.decay,M.decalDist.y=w.distance,x.visibles[l]=M.visible,w.castShadow&&(b=w.shadow,(x=D.get(w)).shadowBias=b.bias,x.shadowNormalBias=b.normalBias,x.shadowRadius=b.radius,x.shadowMapSize.copy(b.mapSize),x.shadowCameraNear=b.camera.near,x.shadowCameraFar=b.camera.far,N.pointShadow[l]=x,N.pointShadowMap[l]=C,C=w.shadow.matrix,N.pointShadowMatrix[l]=L.clone(C.elements||C,N.pointShadowMatrix[l]),p++),N.point[l]=M,l++):w.isHemisphereLight&&(M=R.get(w),L.getTranslation(w.modelMatrix,M.direction),G(M.direction,g),P.normalize(M.direction,M.direction),I.multiplyByScalar(T,S,M.skyColor),I.multiplyByScalar(w.groundColor,S,M.groundColor),N.hemi[f]=M,f++)}N.ambient.red=i,N.ambient.green=a,N.ambient.blue=o,(r=N.hash).directionalLength===u&&r.pointLength===l&&r.spotLength===c&&r.rectAreaLength===d&&r.hemiLength===f&&r.numDirectionalShadows===h&&r.numPointShadows===p&&r.numSpotShadows===m||(N.directional.length=u,N.spot.length=c,N.rectArea.length=d,N.point.length=l,N.hemi.length=f,N.directionalShadowMap.length=h,N.pointShadowMap.length=p,N.spotShadowMap.length=m,N.directionalShadowMatrix.length=h,N.pointShadowMatrix.length=p,N.spotShadowMatrix.length=m,r.directionalLength=u,r.pointLength=l,r.spotLength=c,r.rectAreaLength=d,r.hemiLength=f,r.numDirectionalShadows=h,r.numPointShadows=p,r.numSpotShadows=m,N.version=z++),O(n),O(n)},this.state=N,this.uniforms={ambientLightColor:{value:N.ambient},directionalLights:{value:N.directional},spotLights:{value:N.spot},rectAreaLights:{value:N.rectArea},pointLights:{value:N.point},hemisphereLights:{value:N.hemi},directionalShadowMap:{value:N.directionalShadowMap},directionalShadowMatrix:{value:N.directionalShadowMatrix},spotShadowMap:{value:N.spotShadowMap},spotShadowMatrix:{value:N.spotShadowMatrix},pointShadowMap:{value:N.pointShadowMap},pointShadowMatrix:{value:N.pointShadowMatrix},lightProbe:{value:N.probe}},this.extensionState=U}},{}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(i){function p(e,t){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap);var r=i.get(t).envMap;r&&(e.envMap.value=r,e.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,void 0!==(n=i.get(r).__maxMipLevel)&&(e.maxMipLevel.value=n)),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var n=void 0;t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap?n=t.emissiveMap:t.clearcoatMap?n=t.clearcoatMap:t.clearcoatNormalMap?n=t.clearcoatNormalMap:t.clearcoatRoughnessMap&&(n=t.clearcoatRoughnessMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix));n=void 0;t.aoMap?n=t.aoMap:t.lightMap&&(n=t.lightMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),e.uv2Transform.value.copy(n.matrix))}function m(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===g&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===g&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),i.get(t).envMap&&(e.envMapIntensity.value=t.envMapIntensity)}if("undefined"==typeof THREE)return{refreshFogUniforms:function(){},refreshMaterialUniforms:function(){}};var g=(THREE,1);return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,t,r,n){var i,a,o,s,u,l,c,d,f,h;t.isMeshBasicMaterial?p(e,t):t.isMeshLambertMaterial?(p(e,t),f=e,(h=t).emissiveMap&&(f.emissiveMap.value=h.emissiveMap)):t.isMeshToonMaterial?(p(e,t),c=e,(d=t).gradientMap&&(c.gradientMap.value=d.gradientMap),d.emissiveMap&&(c.emissiveMap.value=d.emissiveMap),d.bumpMap&&(c.bumpMap.value=d.bumpMap,c.bumpScale.value=d.bumpScale,d.side===g&&(c.bumpScale.value*=-1)),d.normalMap&&(c.normalMap.value=d.normalMap,c.normalScale.value.copy(d.normalScale),d.side===g&&c.normalScale.value.negate()),d.displacementMap&&(c.displacementMap.value=d.displacementMap,c.displacementScale.value=d.displacementScale,c.displacementBias.value=d.displacementBias)):t.isMeshPhongMaterial?(p(e,t),c=t,(d=e).specular.value.copy(c.specular),d.shininess.value=Math.max(c.shininess,1e-4),c.emissiveMap&&(d.emissiveMap.value=c.emissiveMap),c.bumpMap&&(d.bumpMap.value=c.bumpMap,d.bumpScale.value=c.bumpScale,c.side===g&&(d.bumpScale.value*=-1)),c.normalMap&&(d.normalMap.value=c.normalMap,d.normalScale.value.copy(c.normalScale),c.side===g&&d.normalScale.value.negate()),c.displacementMap&&(d.displacementMap.value=c.displacementMap,d.displacementScale.value=c.displacementScale,d.displacementBias.value=c.displacementBias)):t.isMeshStandardMaterial?(p(e,t),t.isMeshPhysicalMaterial?(m(u=e,l=t),u.reflectivity.value=l.reflectivity,u.clearcoat.value=l.clearcoat,u.clearcoatRoughness.value=l.clearcoatRoughness,l.sheen&&u.sheen.value.copy(l.sheen),l.clearcoatMap&&(u.clearcoatMap.value=l.clearcoatMap),l.clearcoatRoughnessMap&&(u.clearcoatRoughnessMap.value=l.clearcoatRoughnessMap),l.clearcoatNormalMap&&(u.clearcoatNormalScale.value.copy(l.clearcoatNormalScale),u.clearcoatNormalMap.value=l.clearcoatNormalMap,l.side===g&&u.clearcoatNormalScale.value.negate()),u.transmission.value=l.transmission,l.transmissionMap&&(u.transmissionMap.value=l.transmissionMap)):m(e,t)):t.isMeshMatcapMaterial?(p(e,t),u=e,(l=t).matcap&&(u.matcap.value=l.matcap),l.bumpMap&&(u.bumpMap.value=l.bumpMap,u.bumpScale.value=l.bumpScale,l.side===g&&(u.bumpScale.value*=-1)),l.normalMap&&(u.normalMap.value=l.normalMap,u.normalScale.value.copy(l.normalScale),l.side===g&&u.normalScale.value.negate()),l.displacementMap&&(u.displacementMap.value=l.displacementMap,u.displacementScale.value=l.displacementScale,u.displacementBias.value=l.displacementBias)):t.isMeshDepthMaterial?(p(e,t),o=e,(s=t).displacementMap&&(o.displacementMap.value=s.displacementMap,o.displacementScale.value=s.displacementScale,o.displacementBias.value=s.displacementBias)):t.isMeshDistanceMaterial?(p(e,t),o=e,(s=t).displacementMap&&(o.displacementMap.value=s.displacementMap,o.displacementScale.value=s.displacementScale,o.displacementBias.value=s.displacementBias),o.referencePosition.value.copy(s.referencePosition),o.nearDistance.value=s.nearDistance,o.farDistance.value=s.farDistance):t.isMeshNormalMaterial?(p(e,t),i=e,(a=t).bumpMap&&(i.bumpMap.value=a.bumpMap,i.bumpScale.value=a.bumpScale,a.side===g&&(i.bumpScale.value*=-1)),a.normalMap&&(i.normalMap.value=a.normalMap,i.normalScale.value.copy(a.normalScale),a.side===g&&i.normalScale.value.negate()),a.displacementMap&&(i.displacementMap.value=a.displacementMap,i.displacementScale.value=a.displacementScale,i.displacementBias.value=a.displacementBias)):t.isLineBasicMaterial?(i=t,(a=e).diffuse.value.copy(i.color),a.opacity.value=i.opacity,t.isLineDashedMaterial&&(a=t,(i=e).dashSize.value=a.dashSize,i.totalSize.value=a.dashSize+a.gapSize,i.scale.value=a.scale)):t.isPointsMaterial?function(e,t,r,n){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*n,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap);n=void 0;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,t,r,n):t.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap);var r=void 0;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,t):t.isShadowMaterial?(e.color.value.copy(t.color),e.opacity.value=t.opacity):t.isShaderMaterial&&(t.uniformsNeedUpdate=!1)}}}},{}],63:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function w(e,t){return e[0]-t[0]}function T(e,t){return Math.abs(t[1])-Math.abs(e[1])}Object.defineProperty(r,"__esModule",{value:!0});var S=n(e("e_97")),E=n(e("3_101"));r.default=function(e){function r(e,t){var r=M.get(e);r||(r=[],M.set(e,r)),r.includes(t)||(r.push(t),t.geometry.addEventListener("dispose",function(){var e=r.indexOf(t);0<=e&&r.splice(e,1)}))}function y(e){var t=n.get(e);return t||(t={morphTargetBaseInfluence:1,morphTargetInfluences:new Float32Array(8)},e.geometry.addEventListener("dispose",function(){n.delete(e)}),n.set(e,t),r(t,e)),t}for(var b={},x=[],t=0;t<8;t++)x[t]=[t,0];var n=new WeakMap,M=new WeakMap;return{setUniforms:function(e,t){t&&e&&n.get(e)!=t&&(e.geometry.addEventListener("dispose",function(){n.delete(e)}),n.set(e,t),r(t,e))},getUniforms:y,update:function(e,t,r,n){t=E.default.get(t);var i=y(e),a=i.morphTargetInfluences,o=e.morphTargetInfluences,s=void 0===o?0:o.length;if(void 0===(u=b[t.id])){for(var u=[],l=0;l<s;l++)u[l]=[l,0];b[t.id]=u}for(var c=0;c<s;c++){var d=u[c];d[0]=c,d[1]=o[c]}u.sort(T);for(var f=0;f<8;f++)f<s&&u[f][1]?(x[f][0]=u[f][0],x[f][1]=u[f][1]):(x[f][0]=Number.MAX_SAFE_INTEGER,x[f][1]=0);x.sort(w);for(var h=r.morphTargets&&t.morphAttributes.position,p=r.morphNormals&&t.morphAttributes.normal,m=0,g=0;g<8;g++){var _=x[g],v=_[0],_=_[1];v!==Number.MAX_SAFE_INTEGER&&_?(h&&t.getAttribute("morphTarget"+g)!==h[v]&&(h[v].id=v,t.setAttribute("morphTarget"+g,h[v])),p&&t.getAttribute("morphNormal"+g)!==p[v]&&t.setAttribute("morphNormal"+g,p[v]),m+=a[g]=_):(h&&void 0!==t.getAttribute("morphTarget"+g)&&t.deleteAttribute("morphTarget"+g),p&&void 0!==t.getAttribute("morphNormal"+g)&&t.deleteAttribute("morphNormal"+g),a[g]=0)}r=t.morphTargetsRelative?1:1-m,i.morphTargetBaseInfluence=r,i.morphTargetInfluences=a,function(e,t){var r,n=M.get(e),i=t.attributes;for(r in i)!function(t){var r=i[t];(t.includes("morphTarget")||t.includes("morphNormal"))&&n.forEach(function(e){S.default.updateVerexBuffer(e,t,r)})}(r)}(i,t)}}}},{e_97:55,"3_101":60}],64:[function(e,t,r){"use strict";function p(e){switch(e){case H:return["Linear","( value )"];case W:return["sRGB","( value )"];case z:return["RGBE","( value )"];case G:return["RGBM","( value, 7.0 )"];case F:return["RGBM","( value, 16.0 )"];case V:return["RGBD","( value, 256.0 )"];case j:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Y:return["LogLuv","( value )"];default:return console.warn("WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function m(e,t){t=p(t);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function g(e){return""!==e}function _(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function v(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function y(e){return e.replace(o,n)}function n(e,t){var r;if(void 0===(r=M[t]))throw new Error("Can not resolve #include <"+t+">");return y(r)}function b(e){return e.replace(u,a).replace(s,i)}function i(e,t,r,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),a(0,t,r,n)}function a(e,t,r,n){for(var i="",a=parseInt(t);a<parseInt(r);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a).replace(/\(\s*i\s*\)/g," "+a+" ");return i}function x(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}Object.defineProperty(r,"__esModule",{value:!0});var M=void 0,w=void 0,T=void 0,S=void 0,E=void 0,C=void 0,A=void 0,O=void 0,L=void 0,P=void 0,I=void 0,R=void 0,D=void 0,U=void 0,N=void 0,B=void 0,k=void 0,j=void 0,V=void 0,F=void 0,G=void 0,z=void 0,W=void 0,H=void 0,Y=void 0,X=0,q=!1,o=/^[ \t]*#include +<([\w\d.\/]+)>/gm,s=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,u=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;r.unrollLoops=b,r.default=function(e,t,r){q||(q=!0,M=THREE.ShaderChunk,E=w=0,C=302,A=307,O=306,L=301,D=4,U=R=3,N=5,B=P=T=2,k=I=S=1,j=3007,V=3006,F=3005,G=3004,z=3002,W=3001,H=3e3,Y=3003);var n=r.defines,i=r.vertexShader,a=r.fragmentShader,o=(f="SHADOWMAP_TYPE_BASIC",(d=r).shadowMapType===I?f="SHADOWMAP_TYPE_PCF":d.shadowMapType===P?f="SHADOWMAP_TYPE_PCF_SOFT":d.shadowMapType===R&&(f="SHADOWMAP_TYPE_VSM"),f),s=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case L:case C:t="ENVMAP_TYPE_CUBE";break;case O:case A:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),u=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case C:case A:t="ENVMAP_MODE_REFRACTION"}return t}(r),l=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case E:t="ENVMAP_BLENDING_MULTIPLY";break;case S:t="ENVMAP_BLENDING_MIX";break;case T:t="ENVMAP_BLENDING_ADD"}return t}(r),c=0<e.gammaFactor?e.gammaFactor:1,d=r.isWebGL2?"":[(h=r).extensionDerivatives||h.envMapCubeUV||h.bumpMap||h.tangentSpaceNormalMap||h.clearcoatNormalMap||h.flatShading||"physical"===h.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(g).join("\n"),f=function(e){var t,r=[];for(t in e){var n=e[t];!1!==n&&r.push("#define "+t+" "+n)}return r.join("\n")}(n),e=void 0,h=void 0,n=r.glslVersion?"#version "+r.glslVersion+"\n":"";return r.isRawShaderMaterial?(0<(e=[f].filter(g).join("\n")).length&&(e+="\n"),0<(h=[d,f].filter(g).join("\n")).length&&(h+="\n")):(e=[x(r),"#define SHADER_NAME "+r.shaderName,f,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+c,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+o:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(g).join("\n"),h=[d,x(r),"#define SHADER_NAME "+r.shaderName,f,r.alphaTest?"#define ALPHATEST "+r.alphaTest+(r.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+c,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+s:"",r.envMap?"#define "+u:"",r.envMap?"#define "+l:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.sheen?"#define USE_SHEEN":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+o:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==w?"#define TONE_MAPPING":"",r.toneMapping!==w?M.tonemapping_pars_fragment:"",r.toneMapping!==w?function(e,t){var r=void 0;switch(t){case k:r="Linear";break;case B:r="Reinhard";break;case U:r="OptimizedCineon";break;case D:r="ACESFilmic";break;case N:r="Custom";break;default:console.warn("WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",M.encodings_pars_fragment,r.map?m("mapTexelToLinear",r.mapEncoding):"",r.matcap?m("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?m("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?m("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.lightMap?m("lightMapTexelToLinear",r.lightMapEncoding):"",(l="linearToOutputTexel",o=p(o=r.outputEncoding),"vec4 "+l+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(g).join("\n")),i=v(_(y(i),r),r),a=v(_(y(a),r),r),i=b(i),a=b(a),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(n="#version 300 es\n",e=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+e,h=["#define varying in",r.glslVersion===GLSL3?"":"out highp vec4 pc_fragColor;",r.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+h),i=n+e+i,a=n+h+a,this.name=r.shaderName,this.id=X++,this.cacheKey=t,this.usedTimes=1,this.vertexShader=i,this.fragmentShader=a,this}},{}],65:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=e("__119"),a=e&&e.__esModule?e:{default:e};r.default=function(d,f,h,p,m){function g(e){var t=void 0;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=n,t}var e=THREE,_=e.ShaderLib,r=e.UniformsUtils,n=3e3,t=[],v=p.isWebGL2,y=p.logarithmicDepthBuffer,b=p.floatVertexTextures,x=p.maxVertexUniforms,M=p.vertexTextures,w=p.precision,T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},i=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];return{getParameters:function(e,t,r,n,i){var a=n.fog,o=e.isMeshStandardMaterial?n.environment:null,s=f.get(e.envMap||o),n=T[e.type],o=i.isSkinnedMesh?(u=(l=i).skeleton.bones,b?1024:(l=Math.floor((x-20)/4),(l=Math.min(l,u.length))<u.length?(console.warn("WebGLRenderer: Skeleton has "+u.length+" bones. This GPU supports "+l+"."),0):l)):0;null!==e.precision&&(w=p.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",w,"instead.");var u=void 0,l=void 0;l=n?(u=(c=_[n]).vertexShader,c.fragmentShader):(u=e.vertexShader,e.fragmentShader);var c=d.getRenderTarget();return{isWebGL2:v,shaderID:n,shaderName:e.type,vertexShader:u,fragmentShader:l,defines:e.defines,isRawShaderMaterial:!0===e.isRawShaderMaterial,glslVersion:e.glslVersion,precision:w,instancing:!0===i.isInstancedMesh,instancingColor:!0===i.isInstancedMesh&&null!==i.instanceColor,supportsVertexTextures:M,outputEncoding:null!==c?g(c.texture):d.outputEncoding,map:!!e.map,mapEncoding:g(e.map),matcap:!!e.matcap,matcapEncoding:g(e.matcap),envMap:!!s,envMapMode:s&&s.mapping,envMapEncoding:g(s),envMapCubeUV:!!s&&(306===s.mapping||307===s.mapping),lightMap:!!e.lightMap,lightMapEncoding:g(e.lightMap),aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:g(e.emissiveMap),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:1===e.normalMapType,tangentSpaceNormalMap:0===e.normalMapType,clearcoatMap:!!e.clearcoatMap,clearcoatRoughnessMap:!!e.clearcoatRoughnessMap,clearcoatNormalMap:!!e.clearcoatNormalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,sheen:!!e.sheen,transmissionMap:!!e.transmissionMap,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,vertexUvs:!!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatMap||e.clearcoatRoughnessMap||e.clearcoatNormalMap||e.displacementMap||e.transmissionMap),uvsVertexOnly:!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatNormalMap||e.transmissionMap||!e.displacementMap),fog:!!a,useFog:e.fog,fogExp2:a&&a.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:y,skinning:e.skinning&&0<o,maxBones:o,useVertexTexture:b,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:d.maxMorphTargets,maxMorphNormals:d.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numDirLightShadows:t.directionalShadowMap.length,numPointLightShadows:t.pointShadowMap.length,numSpotLightShadows:t.spotShadowMap.length,numClippingPlanes:m.numPlanes,numClipIntersection:m.numIntersection,dithering:e.dithering,shadowMapEnabled:d.shadowMap.enabled&&0<r.length,shadowMapType:d.shadowMap.type,toneMapping:e.toneMapped?d.toneMapping:0,physicallyCorrectLights:d.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:2===e.side,flipSided:1===e.side,depthPacking:void 0!==e.depthPacking&&e.depthPacking,index0AttributeName:e.index0AttributeName,extensionDerivatives:e.extensions&&e.extensions.derivatives,extensionFragDepth:e.extensions&&e.extensions.fragDepth,extensionDrawBuffers:e.extensions&&e.extensions.drawBuffers,extensionShaderTextureLOD:e.extensions&&e.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||h.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||h.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||h.has("EXT_shader_texture_lod"),customProgramCacheKey:e.customProgramCacheKey()}},getProgramCacheKey:function(e){var t=[];if(e.shaderID?t.push(e.shaderID):(t.push(e.fragmentShader),t.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)t.push(r),t.push(e.defines[r]);if(!1===e.isRawShaderMaterial){for(var n=0;n<i.length;n++)t.push(e[i[n]]);t.push(d.outputEncoding),t.push(d.gammaFactor)}return t.push(e.customProgramCacheKey),t.join()},getUniforms:function(e){var t=T[e.type];return t?(t=_[t],r.clone(t.uniforms)):e.uniforms},acquireProgram:function(e,t){return new a.default(d,t,e)},releaseProgram:function(e){0==--e.usedTimes&&(t[t.indexOf(e)]=t[t.length-1],t.pop())},programs:t}}},{__119:64}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var i=new WeakMap;this.properties=i,this.get=function(t,e){var r,n=i.get(t);return void 0===n&&(r=function e(){i.delete(t),t.removeEventListener("dispose",e)},i.set(t,n=e||{}),t.addEventListener("dispose",r)),n},this.remove=function(e){i.delete(e)},this.update=function(e,t,r){i.get(e)[t]=r},this.dispose=function(){i=new WeakMap,this.properties=i}}},{}],67:[function(e,t,r){"use strict";function n(r,e,t,n,i,a,o){var s=Cesium,u=s.destroyObject,l=s.BoundingSphere,c=s.DrawCommand,d=s.RenderState;r.derivedProperties={},this.id=n?n.id:0,this.drawCommand=r,this.material=e||null,this.geometry=i,this.materialIndex=t,this.groupIndex=o,this.object=n||null,this.groupOrder=n&&function e(t){return!t.isGroup&&t.parent?e(t.parent):t.renderOrder}(n)||0,this.renderOrder=n&&n.renderOrder||0,this.visualizer=a,this.currentScene=null,this.currentCamera=null,this.boundingSphere=new l,this.boundingVolume=new l,this.materialVersion=-1,this.renderVersion=-1,this.programCacheKey=null,this.wireframeIndices=null,this.frustumCulled=!0,this.z=-1,this.distanceToCamera=-1,this.visible=void 0,this.loaded=!1,this.initialized=!1,this.destroy=function(){var e,t=a.renderer;for(e in t._cesiumRenderStateCache.delete(r),function e(t,r){var n=t.vertexArray,i=t.shaderProgram;n.isDestroyed()||n.destroy(),i.isDestroyed&&i.isDestroyed()||i.destroy(),t.isDestroyed=function(){return!0},t.uniformMap=void 0,t.renderState=d.removeFromCache(t.renderState);var a,o,s=t.derivedCommands;if(!s)return r.delete(t);for(a in s)s.hasOwnProperty(a)&&(!(o=(o=s[a]).drawCommand||o).isDestroyed&&o instanceof c&&(o.uniformMap=void 0,e(o,r)),s[a]=void 0);r.delete(t)}(r,t._cesiumRenderStateCache),u(r),this)this[e]=null}}Object.defineProperty(r,"__esModule",{value:!0});e=e("e_94");e&&e.__esModule,Object.defineProperties(n.prototype,{pass:{get:function(){return this.drawCommand._v_pass}},renderPass:{get:function(){return this.drawCommand.pass}},modelMatrix:{get:function(){return this.drawCommand.modelMatrix}}}),n.prototype.update=function(e,t,r,n){var i=Cesium,a=this.boundingVolume,o=e.isInstancedMesh,s=e.frustumCulled,u=e.modelMatrix;o?t.instanceCount=e.count:isFinite(r.instanceCount)&&(t.instanceCount=r.instanceCount),t.instanceCount?this.frustumCulled=!1:this.frustumCulled=s,e.isCustomInstancedMesh?(t.instanceCount=e._availableInstances.length,s&&i.BoundingSphere.clone(e._boundingSphere,a)):!n&&!e.modelMatrixNeedsUpdate&&this.initialized||(e=this.boundingSphere,(i=i.Matrix4).multiplyByPoint(u,e.center,a.center),a.radius=e.radius*i.getMaximumScale(u),this.initialized=!0),t.boundingVolume=s?a:void 0,t.modelMatrix=u},r.default=n},{e_94:24}],68:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function fe(){this.fog=null,this.environment=null,this.lightsStateVersion=0,this.numClippingPlanes=0,this.numIntersection=0,this.clippingUniform={value:[]},this.clippingState=[],this.outputEncoding=-1,this.envMap=null,this.version=0,this.renderVersion=0,this.wireframe=!1}Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("d_102")),he=n(e("e_142")),x=n(e("i_95")),pe=n(e("h_99")),me=n(e("e_97")),ge=n(e("3_101")),o=n(e("h_147")),a=(n(e("d_118")),e("__103")),e=(n(a),e("d_150")),_e=(n(e),i.default.computeBoundingSphereAndIndices);r.default=function(Q){function $(i,a,o){var s=ce.get(i),e=u.get(i);s||(s=new WeakMap,e=[],ce.set(i,s),u.set(i,e)),s.useTimes=s.useTimes||0,o.forEach(function(r){var n=r.material;n.addEventListener("dispose",function e(){r.destroy();var t=o.indexOf(r);0<=t&&o.splice(t,1),0==o.length&&(s.delete(a),0==--s.useTimes&&(ce.delete(i),u.delete(i))),n.removeEventListener("dispose",e)})}),s.useTimes++,s.set(a,o),e.push(a)}function ee(e,t,r,n,i){var a=Q._clipping,o=Q.getRenderTarget(),s=ae.fog,u=e.isMeshStandardMaterial?ae.environment:null,l=null===o?Q.outputEncoding:o.texture.encoding,c=ue.get(e.envMap||u),o=se.get(e,i?new fe:void 0);o.needsLights=(i=e).isMeshLambertMaterial||i.isMeshToonMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isShadowMaterial||i.isShaderMaterial&&!0===i.lights,o.fog=s,o.environment=u,o.lightsStateVersion=r.state.version,o.numClippingPlanes=a.numPlanes,o.numIntersection=a.numIntersection,o.outputEncoding=l,o.envMap=c,o.shadows=n.length,o.wireframe=t,o.version=e.version,o.shadowMapType=Q.shadowMap.type,o.rendererVersion=Q.version}function w(e,t,r){var n=e._attributeLocations[t],n=e._attributes[n].vertexBuffer;if(n._sizeInBytes!=r.length*r.constructor.BYTES_PER_ELEMENT)return console.warn("WebGLRenderItems:vertexBuffer ["+t+"] size has changed"),0;n.copyFromArrayView(r,0)}function te(e,t,r,n){var i=n.material,a=i.morphTargets||i.morphNormals,i=n.isSkinnedMesh,o=ae.useEncodedPosition;if(!i&&!a)for(var s in e){var u=t[s],l=e[s];if(u.version!=l.version){var c=l.array;if("position"==s&&o){for(var d=new Float32Array(c.length),f=new Float32Array(c.length),h={high:0,low:0},p=0;p<c.length;p++){var m=c[p];Cesium.EncodedCartesian3.encode(1e6*m,h),d[p]=h.high,f[p]=h.low}for(var g=0;g<r.length;g++){var _=r[g];w(_,"positionHigh",d),w(_,"positionLow",f)}}else for(var v=0;v<r.length;v++)w(r[v],s,c);u.version=l.version}}if(n.isInstancedMesh){a=n.instanceMatrix,n=n.instanceColor;if(t.instanceMatrix||(t.instanceMatrix={version:-1}),n&&!t.instanceColor&&(t.instanceColor={version:-1}),t.instanceMatrix.version!=a.version){for(var y=a.array,b=0;b<r.length;b++)w(r[b],"instanceMatrix",y);t.instanceMatrix.version=a.version}if(n&&t.instanceColor.version!=n.version){for(var x=n.array,M=0;M<r.length;M++)w(r[M],"instanceColor",x);t.instanceColor.version=n.version}}}function re(e,t,r,n){var i=Q._clipping;r=r&&e.id===a,se.get(e,n),i.setState(e,t,r),a=e.id}function ne(e,t){t=t||se.get(e);e=Q._clipping.uniform.value,t=t.clippingUniform.value;e?r.unpackArray(e,t):t.length=0}var ie,a,e=Cesium,b=e.DrawCommand,r=e.Cartesian4,ae=Q._visualizer,oe=Q._uniforms,se=Q._properties,ue=Q._cubemaps,le=new o.default,ce=new WeakMap,u=new WeakMap,de={frameNumber:-1,changingCount:0,maxChangingCount:ae.maxChangingCount};Object.defineProperties(this,{changingState:{get:function(){return de}},objectDrawAttributes:{get:function(){return le}},renderItemsCache:{get:function(){return ce}},materialsUsed:{get:function(){return u}}}),this.get=function(e){var t=se.get(e),r=e.material;if(t.material){if(t.material==r)return e.renderItems;e=ce.get(e);return e&&e.get(r)}},this.remove=function(e){var t=u.get(e),r=ce.get(e);t&&r&&t.forEach(function(e){e=r.get(e);e&&e.forEach(function(e){var t=e.wireframeIndexBuffer,r=t.isDestroyed;r&&r()||t.destroy(),delete e.wireframeIndexBuffer,delete e.indexBuffer})}),u.delete(e),ce.delete(e)},this.getAndUpdate=function(e,t,r,n,i){de.frameNumber!=t.frameNumber&&(de.changingCount=0,de.frameNumber=t.frameNumber);var a=r=!!r&&!e.isLine&&!e.isPoints,o=t.context,s=ge.default.get(e.geometry,e.material),u=(s.groupsOptimized,s.materialIndicesUsed),l=Q._programs,c=n.lights,d=Q._clipping,f=n.shadowsArray,h=e.material,p=s.attributes,m=se.get(e),g=le.get(e),_=s.drawRange;if(!p.position.count||0==h.visible||0==_.count)return[];var v,y=i!==ie,b=n.clippingEnabled,x=n.localClippingEnabled,M=!0!==b||!0!==x&&!y?!1:!0;ie=i,v=e,T=s,_=h,n=t,b=se.get(v),v.isSkinnedMesh&&b.skinningFrameNumber!=n.frameNumber&&(b.skinningFrameNumber=n.frameNumber,(x=v.skeleton).update(),x.boneTextureCesium&&(x.boneTextureCesium.needsUpdate=!0)),(v.material.morphTargets||v.material.morphNormals)&&b.morphtargetFrameNumber!=n.frameNumber&&(b.morphtargetFrameNumber=n.frameNumber,Q.morphtargets.update(v,T,_));var w=e.renderItems;m.material!=e.material&&(w=(S=ce.get(e))&&S.get(h),m.material=e.material);var T,S,E=s.index;if(null==w){T=o,S=(_=e).pickObject||{primitive:ae,id:_,mesh:_},null==(m=(_.pickObject=S).pickId)&&(m=T.createPickId(S)),(T=ae._pickIds).includes(m)||T.push(m),S.pickId=m,_.pickId=m,w=Array.isArray(h)?(u.forEach(function(e){h[e].wireframe&&(a=!0)}),u.forEach(function(e){e=h[e];M&&re(e,i,!y,new fe),ee(e,a,c,f,!M),ne(e)}),a&&(s.index=ge.default.getWireframeAttribute(s)),he.default.createArray(e,t,ae,c,f)):((a=a||!!h.wireframe)&&(s.index=ge.default.getWireframeAttribute(s)),M&&re(h,i,!y,new fe),ee(h,a,c,f,!0),ne(h),(B=he.default.create(e,t,ae,c,f)).boundingSphere=s.boundingSphere,[B]),s.index!=E&&(s.index=E);for(var C,A=0;A<w.length;A++){var O=w[A],L=O.drawCommand,P=O.material,I=l.getParameters(P,c.state,f,ae,e),I=l.getProgramCacheKey(I);a&&(O.primitiveType=L.primitiveType,L.primitiveType=1),O.renderVersion=se.get(P).renderVersion,O.programCacheKey=I,O.materialVersion=P.version,O.wireframe=a,O.update(e,L,s,ae.modelMatrixNeedsUpdate)}for(C in $(e,h,w),p)p.hasOwnProperty(C)&&(g[C]={version:p[C].version})}else{var R,D=!1;for(R in p)R in g||(D=!0,g[R]={version:p[R].version});var U=p.position.version!=g.position.version;U&&s.computeBoundingSphere();for(var N=[],B=Q.getRenderTarget(),k=ae.fog,j=null===B?Q.outputEncoding:B.texture.encoding,V=0;V<w.length;V++){var F=w[V],G=F.material,z=F.drawCommand,W=F.materialIndex,H=F.groupIndex,Y=se.get(G);M&&re(G,i,!y),ne(G,Y);var X=!1,q=G.isMeshStandardMaterial?ae.environment:null,K=ue.get(G.envMap||q);F.materialVersion==G.version?(X=G.fog&&Y.fog!==k||Y.environment!==q||Y.needsLights&&Y.lightsStateVersion!==c.state.version||void 0!==Y.numClippingPlanes&&(Y.numClippingPlanes!==d.numPlanes||Y.numIntersection!==d.numIntersection)||Y.outputEncoding!==j||Y.envMap!==K||Y.shadows!==f.length||Y.shadowMapType!=Q.shadowMap.type||Y.rendererVersion!=Q.version?!0:X)?(isFinite(Y.renderVersion),Y.renderVersion++):F.renderVersion!=Y.renderVersion&&(X=!0):X=!0,a=G.wireframe||r,X&&(de.maxChangingCount>de.changingCount?(ee(G,a,c,f),K=l.getParameters(G,c.state,f,ae,e),K=l.getProgramCacheKey(K),X=F.programCacheKey!==K,F.programCacheKey=K,F.renderVersion=Y.renderVersion,F.materialVersion=G.version,de.changingCount++):X=!1);var Z,J,Y=F.wireframe!=a;D||X||Y?(X=F.wireframeIndices,a&&!X?(s.index=ge.default.getWireframeAttribute(s),X=(J=_e(s,G.transparent?H:W,!G.transparent,F.boundingSphere)).indices,F.wireframeIndices=X,F.boundingSphere=J.boundingSphere,s.index=E):U&&(J=_e(s,G.transparent?H:W,!G.transparent,F.boundingSphere),F.boundingSphere=J.boundingSphere),(D||Y)&&((Z=z.vertexArray).isDestroyed()||Z.destroy(),Z=me.default.create(s,e,o,W,a?X:void 0),z.vertexArray=Z),(X=z.shaderProgram).isDestroyed&&X.isDestroyed()||X.destroy(),Z=z.vertexArray._attributeLocations,X=pe.default.get(G,Z,e,o,ae,c,f),z.shaderProgram=X,z.uniformMap=oe.getUniformMap(G,e,t,c),a?(F.primitiveType=z.primitiveType,z.primitiveType=1):null!=F.primitiveType&&(z.primitiveType=F.primitiveType),F.wireframe=a):(oe.refresh(G,e),N.push(z.vertexArray),U&&(J=_e(s,G.transparent?H:W,!G.transparent,F.boundingSphere),F.boundingSphere=J.boundingSphere)),F.update(e,z,s,ae.modelMatrixNeedsUpdate)}te(p,g,N,e)}return e.renderItems=w},this.getAndUpdateDerived=function(e,t,r,n,i,a,o,s){var u=o.lights,l=o.shadowsArray,c=(t=ge.default.get(t)).attributes,d=le.get(e),f=Q._clipping,h=s!==ie,p=o.clippingEnabled,m=o.localClippingEnabled,g=!0!==p||!0!==m&&!h?!1:!0;ie=s;var _=n.drawCommand,v=_.derivedCommands[i],y=_.vertexArray._attributeLocations;return(o=!v)||(o=v.vertexArray._attributeLocations!=y)&&v.onMaterialDispose&&v.onMaterialDispose(),p=_.derivedProperties,(m=p[i])||(p[i]=m={}),o?(o=function e(){v.shaderProgram.destroy();var t=_.isDestroyed;t&&t()||delete _.derivedCommands[i],r.removeEventListener("dispose",e)},g?re(r,s,!h,new fe):se.get(r,new fe),ne(r),v=b.shallowClone(_),(_.derivedCommands[i]=v).shaderProgram=pe.default.get(r,y,e,a.context,ae,u,l),v.uniformMap=oe.getUniformMap(r,e,a,u),v.renderState=x.default.create(r,e,Q._capabilities,Q._extensions,!1),r.addEventListener("dispose",o),v.onMaterialDispose=o):(g&&re(r,s,!h,new fe),ne(r),void 0===m.numClippingPlanes||m.numClippingPlanes===f.numPlanes&&m.numIntersection===f.numIntersection||((h=v.shaderProgram).isDestroyed&&h.isDestroyed()||h.destroy(),v.shaderProgram=pe.default.get(r,y,e,a.context,ae,u,l),v.uniformMap=oe.getUniformMap(r,e,a,u),v.renderState=x.default.create(r,e,Q._capabilities,Q._extensions,!1)),oe.refresh(r,e),v.vertexArray=_.vertexArray),m.numClippingPlanes=f.numPlanes,m.numIntersection=f.numIntersection,n.update(e,v,t,ae.modelMatrixNeedsUpdate),te(c,d,[v.vertexArray],e),v},this.dispose=function(){le=new o.default,ce=new WeakMap,u=new WeakMap}}},{d_102:11,e_142:43,i_95:47,h_99:49,e_97:55,"3_101":60,h_147:66,__103:67,d_150:70,d_118:72}],69:[function(e,t,r){"use strict";function n(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function i(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}Object.defineProperty(r,"__esModule",{value:!0});e=e("__103");e&&e.__esModule,r.default=function(){var u=[],l=[],c=[];this.environment=u,this.opaque=l,this.transparent=c,this.init=function(){u.length=0,l.length=0,c.length=0},this.push=function(e){var t;(0==e.pass?u:!0===(t=e.material).transparent||t.translucent?c:l).push(e)},this.unshift=function(e){var t;(0==e.pass?u:!0===(t=e.material).transparent||t.translucent?c:l).unshift(e)},this.sort=function(e,t){1<u.length&&u.sort(e||n),1<l.length&&l.sort(e||n),1<c.length&&c.sort(t||i)},this.getDrawCommands=function(e){for(var t=0,r=u.length;t<r;t++)e.push(u[t].drawCommand);for(var n=0,i=l.length;n<i;n++)e.push(l[n].drawCommand);for(var a=0,o=c.length;a<o;a++)e.push(c[a].drawCommand)},this.setCurrentScene=function(e,t){for(var r=0,n=u.length;r<n;r++)u[r].currentScene=e,u[r].currentCamera=t;for(var i=0,a=l.length;i<a;i++)l[i].currentScene=e,l[i].currentCamera=t;for(var o=0,s=c.length;o<s;o++)c[o].currentScene=e,c[o].currentCamera=t}}},{__103:67}],70:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var s=n(e("M_104")),u=n(e("i_153"));r.default=function(){var r=new u.default,t=[],e=[],n=[],i=[],a=new s.default,o=this;this.renderList=r,this.renderables=t,this.dynamicRenderables=e,this.shadowsArray=n,this.lightsArray=i,this.lights=a,this.init=function(){r.init(),t.length=0,e.length=0,i.length=0,n.length=0},this.pushRenderable=function(e){t.push(e)},this.setupLights=function(e){o.lights.setup(i,n,e)},this.pushShadow=function(e){n.push(e)},this.pushLight=function(e){i.push(e)},this.setCurrentScene=function(e,t){r.setCurrentScene(e,t)},this.getDrawCommands=function(e){r.getDrawCommands(e)}}},{M_104:61,i_153:69}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=e("d_150"),a=e&&e.__esModule?e:{default:e};r.default=function(){var i=new WeakMap;this.get=function(e,t){var r=i.get(e),n=void 0;return void 0===r?(n=new a.default,i.set(e,new WeakMap),i.get(e).set(t,n)):void 0===(n=r.get(t))&&((n=new a.default).camera=t,r.set(t,n)),n},this.dispose=function(){i=new WeakMap},Object.defineProperties(this,{states:{get:function(){return i}}})}},{d_150:70}],72:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){var i=new WeakMap;this.get=function(e,t){var r=i.get(e);null==r&&(r=new WeakMap,i.set(e,r));var n=r.get(t);return null==n&&(n=new Cesium.RenderState(e.renderState),r.set(t,n)),n},this.delete=function(e){i.delete(e)},this.dispose=function(){i=new WeakMap}}Object.defineProperty(r,"__esModule",{value:!0});var a,o=function(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),e},s=n(e("e_155")),u=n(e("s_156")),l=n(e("M_120")),y=n(e("e_158")),_=n(e("i_159")),c=n(e("M_160")),d=n(e("e_161")),b=n(e("3_133")),f=n(e("h_147")),h=n(e("-_164")),p=n(e("3_165")),v=e("d_166"),m=n(e("W_109")),g=n(e("M_168")),x=n(e("i_169")),M=n(e("k_170")),w=n(e("e_171")),T=(n(e("e_94")),e("W_173")),S=n(T),o=(n(e("d_150")),o(E,[{key:"init",value:function(e){var t=e.context._gl;this._capabilities||(this._extensions=new s.default(t),this._capabilities=new u.default(t,this._extensions,{}),!1===this._capabilities.isWebGL2&&(this._extensions.get("WEBGL_depth_texture"),this._extensions.get("OES_texture_float"),this._extensions.get("OES_texture_half_float"),this._extensions.get("OES_texture_half_float_linear"),this._extensions.get("OES_standard_derivatives"),this._extensions.get("OES_element_index_uint"),this._extensions.get("ANGLE_instanced_arrays")),this.shadowMap.maxTextureSize=this._capabilities.maxTextureSize,this._extensions.get("OES_texture_float_linear"),"undefined"!=typeof THREE&&(this._clipping=new h.default(this._properties,this._visualizer),this._programs=new l.default(this,this._cubemaps,this._extensions,this._capabilities,this._clipping)),this.morphtargets=new c.default(t)),this._pixelRatio=e.pixelRatio,this._frameState||(this._frameState=e)}},{key:"setRenderTarget",value:function(e,t,r){this._currentActiveCubeFace=t,this._currentActiveMipmapLevel=r,this._currentRenderTarget!=e&&(this._currentRenderTarget=e,this._frameState?(this._currentRenderTarget&&y.default.set(this._currentRenderTarget,this._frameState,this._visualizer),this._renderTargetChanged=!1):this._renderTargetChanged=!0)}},{key:"getClearAlpha",value:function(){return this._clearAlpha}},{key:"setClearAlpha",value:function(e){this._clearAlpha=e}},{key:"getClearColor",value:function(){return this._clearColor}},{key:"setClearColor",value:function(e){this._clearColor.isColor?this._clearColor.set(e):this._clearColor=e}},{key:"getRenderTarget",value:function(){return this._currentRenderTarget}},{key:"getActiveCubeFace",value:function(){return this._currentActiveCubeFace}},{key:"getActiveMipmapLevel",value:function(){return this._currentActiveMipmapLevel}},{key:"getContext",value:function(){if(this._frameState)return this._frameState.context._gl}},{key:"clear",value:function(e,t,r){var n=Cesium,i=n.ClearCommand,n=n.Color;a=a||new i({color:new n(0,0,0,0)}),e?n.clone(e,a.color):n.clone(n.TRANSPARENT,a.color),this._currentRenderTarget&&(!(i=y.default.get(this._currentRenderTarget,this._visualizer))||(e=i[this._currentActiveCubeFace||0])&&(n=this._frameState,(i=a).depth="number"==typeof t?t:this.autoClearDepth?1:void 0,i.stencil="number"==typeof r?r:this.autoClearStencil?0:void 0,i.framebuffer=e,i.renderState=n.context._defaultRenderState,i.execute(n.context)))}},{key:"compile",value:function(e,t){}},{key:"render",value:function(e,t,r){var a=this;if(r=r||this._frameState,!e)throw new Error("WebGLRenderer.render:缺少参数scene");if(!r)throw new Error("WebGLRenderer.render:MeshVisualizer未初始化，需要传递参数frameState");var n=Cesium,i=n.Camera,o=n.Matrix4,s=n.RenderState,u=this._currentRenderTarget,l=this._visualizer;if(!u)throw new Error("WebGLRenderer.render:未设置renderTarget");this._renderTargetChanged&&y.default.set(u,r,l),this.autoClear&&this.clear(null,1,0);var c=y.default.get(u,l)[this._currentActiveCubeFace||0],d=r.context,f=d.uniformState,h=r.camera,n=r.cullingVolume;this.autoConvertCamera&&((p={}).matrix=l._actualModelMatrixYup||l.modelMatrix,p.inverseMatrix=l._actualModelMatrixYupInverse||l._actualModelMatrixInverse);var p,m=void 0,g=(t=t&&!(t instanceof i)?t.isPerspectiveCamera?b.default.fromPerspectiveCamera3js(t,null,l._scene,p):t.isOrthographicCamera?b.default.fromOrthographicCamera3js(t,null,l._scene,p):(v.Object3D.traverse(e,function(e){e.currentFrustumCulled=e.frustumCulled,e.frustumCulled=!1,e.modelMatrixNeesUpdate=!1}),p=(g=THREE).Matrix3,g=g.Vector3,m={camera:t,_normalMatrix:new p,cameraPosition:new g},h.customCamera=m,null):t)||h,t=g!=h;r.camera=g,t&&f.update(r),this.overrideModelMatrix&&v.Object3D.traverse(e,function(e){e.currentFrustumCulled=e.frustumCulled,e.frustumCulled=!1,e.modelMatrix=o.multiply(e.matrixWorld.elements,a.overrideModelMatrix,e.modelMatrix||new o),e.up.y&&_.default.yUp2Zup(e.modelMatrix,e.modelMatrix),e.modelMatrixNeesUpdate=!1});g=[];l.update(r,e,g),g.forEach(function(e){m&&(n=(n=e.owner).mesh3js||n,m.modelMatrix=n.matrixWorld.elements,n.modelViewMatrix.multiplyMatrices(m.camera.matrixWorldInverse,n.matrixWorld),m.modelViewMatrix=n.modelViewMatrix.elements,m.projectionMatrix=m.camera.projectionMatrix.elements,m._normalMatrix.getNormalMatrix(n.modelViewMatrix),m.normalMatrix=m._normalMatrix.elements,m.cameraPosition.setFromMatrixPosition(m.camera.matrixWorld));var t=e.renderState,r=e.renderState,n=u.viewport,r=Object.assign({},r);a.renderState&&(r=Object.assign(r,a.renderState)),n&&(r.viewport=n),u.stencilBuffer||(r.stencilTest={enabled:!1}),u.depthBuffer||u.depthTexture||(r.depthTest={enabled:!1}),u.scissorTest?(i=u.scissor,r.scissorTest={enabled:!0,rectangle:{x:i.x,y:i.y,width:i.width,height:i.height}}):r.scissorTest={enabled:!1},r=new s(r);var i=e.framebuffer;e.renderState=r,e.framebuffer=c,e.execute(d),e.framebuffer=i,e.renderState=t}),(h.customCamera||this.overrideModelMatrix)&&v.Object3D.traverse(e,function(e){e.frustumCulled=e.currentFrustumCulled}),delete h.customCamera,r.camera=h,t&&(r.cullingVolume=n,f.update(r)),g.length=0}},{key:"renderBufferDirect",value:function(e,t,r,n,i,a,o,s,u,l){if(!(l=this._frameState||l))throw new Error("WebGLRenderer.renderBufferDirect:MeshVisualizer未初始化，需要传递参数frameState");var c=Cesium,d=c.Camera,f=(c.RenderState,c.Intersect,c.Cartesian3,this._webglRenderItems),h=f.get(i,o.camera);if(h){var p=this._currentRenderTarget,m=this._visualizer;if(!p)throw new Error("WebGLRenderer.renderBufferDirect:未设置renderTarget");this._renderTargetChanged&&y.default.set(p,l,m),this.autoClear&&this.clear();var g=y.default.get(p,m)[this._currentActiveCubeFace||0],_=l.context,v=_.uniformState,c=l.camera;if(e&&!(e instanceof d))if(e.isPerspectiveCamera)e=b.default.fromPerspectiveCamera3js(e,null,m._scene);else{if(!e.isOrthographicCamera)throw new Error("unsupport camera "+e.type);e=b.default.fromOrthographicCamera3js(e,null,m._scene)}e=e||c;(l.camera=e)!==c&&v.update(l),(i.modelMatrixNeesUpdate||i.needsUpdate)&&m.computeModelMatrix(i,l);a=1<h.length?a.renderItemIndex:0;u=u||["_renderBufferDirect",n.uuid,r.uuid,a].join("_");a=h[a],o=f.getAndUpdateDerived(i,r,n,a,u,l,o,s),s=!!o;s&&a.frustumCulled&&a.boundingVolume,s&&(a=o.renderState,s=p.viewport,(p=this._cesiumRenderStateCache.get(o,e)).depthMask=!0,p.depthTest.enabled=!0,p.stencilTest.enabled=!1,p.blending.enabled=!1,p.viewport=s,o.renderState=p,s=_._gl,Cesium.RenderState.apply(s,p,_._defaultPassState),o.framebuffer=g,o.execute(_),o.framebuffer=null,o.renderState=a),e!==(l.camera=c)&&v.update(l)}}},{key:"setSize",value:function(){}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e}},{key:"readPixels",value:function(e,t){e=e||this._currentRenderTarget,t=t||this._currentActiveCubeFace;var r=y.default.get(e,this._visualizer);if(r){t=r[t||0];return _.default.readPixels(this._frameState,{framebuffer:t,x:0,y:0,width:e.width,height:e.height})}}},{key:"readRenderTargetPixels",value:function(e,t,r,n,i,a,o){e=e||this._currentRenderTarget,o=o||this._currentActiveCubeFace;var s=e.texture,u=y.default.get(e,this._visualizer);if(u){o=u[o||0];return _.default.readPixels(this._frameState,{framebuffer:o,x:t||0,y:r||0,width:n||e.width,height:i||e.height,pixelFormat:m.default.formatsMap[s.format],pixelDatatype:m.default.typesMap[s.type]},a)}}},{key:"clearDepth",value:function(){}},{key:"copy",value:function(e){this.autoClear=e.autoClear,this.autoClearColor=e.autoClearColor,this.autoClearDepth=e.autoClearDepth,this.autoClearStencil=e.autoClearStencil,this.shadowMap.enabled=e.shadowMap.enabled,this.shadowMap.type=e.shadowMap.type,this.shadowMap.autoUpdate=e.shadowMap.autoUpdate,this.outputEncoding=e.outputEncoding,this.physicallyCorrectLights=e.physicallyCorrectLights,this.toneMapping=e.toneMapping,this.toneMappingExposure=e.toneMappingExposure,this.maxMorphTargets=e.maxMorphTargets,this.maxMorphNormals=e.maxMorphNormals,this.clippingPlanes=e.clippingPlanes,this.localClippingEnabled=e.localClippingEnabled}},{key:"dispose",value:function(){this._webglRenderItems.dispose()}},{key:"capabilities",get:function(){return this._capabilities}},{key:"extensions",get:function(){return this._extensions}},{key:"needsUpdate",set:function(e){e&&this.version++}},{key:"outputEncoding",get:function(){return this._outputEncoding},set:function(e){e!=this._outputEncoding&&(this._outputEncoding=e,this.needsUpdate=!0)}},{key:"toneMapping",get:function(){return this._toneMapping},set:function(e){e!=this._toneMapping&&(this._toneMapping=e,this.needsUpdate=!0)}},{key:"physicallyCorrectLights",get:function(){return this._physicallyCorrectLights},set:function(e){e!=this._physicallyCorrectLights&&(this._physicallyCorrectLights=e,this.needsUpdate=!0)}}]),E);function E(e){function n(){return t._capabilities.gl}!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E);var t=this;this.state={buffers:{color:{setMask:function(e){},setLocked:function(e){},setClear:function(e,t,r,n,i){},reset:function(){}},depth:{setTest:function(e){var t=n(),r=t.DEPTH_TEST;e?t.enable(r):t.disable(r)},setMask:function(e){},setFunc:function(e){},setLocked:function(e){},setClear:function(e){},reset:function(){}},stencil:{setTest:function(e){},setMask:function(e){},setFunc:function(e,t,r){},setOp:function(e,t,r){},setLocked:function(e){},setClear:function(e){},reset:function(){}}},viewport:function(e){n().viewport(e.x,e.y,e.width,e.height)}},this._visualizer=e,this.gammaOutput=!1,this.gammaInput=!1,this._nClipPlanes=0,this._nClipIntersection=0,this._currentRenderTarget=null,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this._outputEncoding=null,this._physicallyCorrectLights=!1,this._toneMapping=null,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var r="undefined"!=typeof THREE?THREE:void 0;r&&(this._outputEncoding=3e3,this._toneMapping=0),this.vr={enabled:!1},this.xr={enabled:!1},this.shadowMap=r?new d.default(this,null,16e3):{},this._cubemaps=new p.default(this),this._properties=new f.default,this._materials=new x.default(this._properties),this._textures=new M.default(e),this._uniforms=new g.default(this),this._webglRenderItems=new w.default(this),this._webglRenderStates=new S.default,this._cesiumRenderStateCache=new i,this._clipping=null,this._programs=null,this._capabilities=null,this._extensions=null,this._pixelRatio=1,this.morphtargets=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this._currentActiveCubeFace=0,this._currentActiveMipmapLevel=0,this.renderState=null,this.autoConvertCamera=!1,this.overrideModelMatrix=null,this._clearColor=r?new r.Color("black"):{r:0,g:0,b:0},this._clearAlpha=0,this.isCesiumRenderer=!0,this.version=0}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=o},{"3_133":7,e_94:24,d_166:25,i_159:27,W_109:44,e_158:48,s_156:56,"-_164":57,"3_165":58,e_155:59,i_169:62,M_160:63,M_120:65,h_147:66,e_171:68,d_150:70,W_173:71,e_161:73,k_170:74,M_168:75}],73:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var U=n(e("3_133")),i=(n(e("e_94")),e("3_101")),N=n(i);n(e("d_118"));r.default=function(b,e,y){function x(e,t){var r=_.get(e);void 0===r&&(r=new WeakMap,_.set(e,r),e.addEventListener("dispose",function(){_.delete(e)}));var n=r.get(t);return null==n&&(n=new s(e,t),t.addEventListener("dispose",function(){r.delete(t)}),r.set(t,n)),n}function f(e,t,r){var n=e<<0|t<<1|r<<2,r=c[n];return void 0===r&&(r=new a({depthPacking:i,morphTargets:e,skinning:t}),c[n]=r),r}function h(e,t,r){var n=e<<0|t<<1|r<<2,r=d[n];return void 0===r&&(r=new o({morphTargets:e,skinning:t}),d[n]=r),r}function M(e,t,r,n,i,a,o){var s,u,l=null,c=f,d=e.customDepthMaterial;return!0===n.isPointLight&&(c=h,d=e.customDistanceMaterial),l=void 0===d?(!(s=!1)===r.morphTargets&&(s=t.morphAttributes&&t.morphAttributes.position&&0<t.morphAttributes.position.length),!(u=!1)===e.isSkinnedMesh&&(!0===r.skinning?u=!0:console.warn("WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),c(s,u,!0===e.isInstancedMesh)):d,b.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length&&(u=l.uuid,e=r.uuid,void 0===(d=p[u])&&(p[u]=d={}),void 0===(u=d[e])&&(u=l.clone(),d[e]=u),l=u),l.visible=r.visible,l.wireframe=r.wireframe,l.side=o===w?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:m[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===n.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(n.matrixWorld),l.nearDistance=i,l.farDistance=a),l}var t,w,i,T,a,o,r,n,s,u,l,S,E,C,A,c,d,p,m,O,L,g,P,I,R,_,D;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.initialized=!1,"undefined"!=typeof THREE?(w=3,i=3201,T=(t=THREE).WebGLRenderTarget,a=t.MeshDepthMaterial,o=t.MeshDistanceMaterial,r=t.ShaderMaterial,n=t.BufferAttribute,g=t.BufferGeometry,s=t.Mesh,u=t.Vector4,l=t.Vector2,S=new t.Frustum,E=new l,C=new l,A=new u,c=[],d=[],p={},m={0:1,1:0,2:2},(O=new r({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new l},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONAL_PASS\n\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\tmean += distribution.x;\n\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\tmean += depth;\n\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"})).autoRefresh=!0,(L=O.clone()).defines.HORIZONAL_PASS=1,L.autoRefresh=!0,(g=new g)[g.setAttribute?"setAttribute":"addAttribute"]("position",new n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3)),P=new s(g,O),I=this,Object.defineProperty(this,"maxTextureSize",{get:function(){return y},set:function(e){y=e}}),this.type=1,R=new Cesium.RenderState({blending:{enabled:!1},scissorTest:{enabled:!1},depthTest:{enabled:!0},depthMask:!0,colorMask:{red:!0,green:!0,blue:!0,alpha:!0},stencilTest:{enabled:!1}}),this.render=function(u,e,l,c){var d=this;if((!1!==I.autoUpdate||!1!==I.needsUpdate)&&0!==u.length){u=u.slice();var f=l.context.uniformState,h=l.camera,p=l.cullingVolume,m=b._webglRenderStates.get(e,h),t=b.getRenderTarget(),r=b.getActiveCubeFace(),n=b.getActiveMipmapLevel(),i=b.autoClear,e=b.renderState;b.autoClear=!1;var g=R;b.renderState=g;var _=this._referenceFrame||{};(this._referenceFrame=_).matrix=c._actualModelMatrixYup||c.modelMatrix,_.inverseMatrix=c._actualModelMatrixYupInverse||c._actualModelMatrixInverse;for(var v=0,a=u.length;v<a;v++)!function(){var t=u[v],r=t.shadow,n=void 0,e=r.camera;if(!1===r.autoUpdate&&!1===r.needsUpdate)return;if(void 0===r)return console.warn("WebGLShadowMap:",t,"has no shadow.");if(!e.isPerspectiveCamera&&!e.isOrthographicCamera)return console.warn("WebGLShadowMap:",t,"camera is not supported.");E.copy(r.mapSize);var i=r.getFrameExtents();if(E.multiply(i),C.copy(r.mapSize),(E.x>y||E.y>y)&&(E.x>y&&(C.x=Math.floor(y/i.x),E.x=C.x*i.x,r.mapSize.x=C.x),E.y>y&&(C.y=Math.floor(y/i.y),E.y=C.y*i.y,r.mapSize.y=C.y)),!r.map||r.map.width==A.width&&r.map.height==A.height||(r.mapPass&&(r.mapPass.texture.dispose(),r.mapPass.dispose(),r.mapPass=null),r.map.dispose(),r.map.texture.dispose(),r.map=null),d.type!==w&&r.mapPass&&(r.map&&(r.map.texture.dispose(),r.map.dispose(),r.map=null),r.mapPass.dispose(),r.mapPass.texture.dispose(),r.mapPass=null),null!==r.mapPass||r.isPointLightShadow||d.type!==w||(r.map&&(r.map.texture.dispose(),r.map.dispose()),r.map=new T(E.x,E.y,i={minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1}),r.map.texture.name=t.name+".shadowMap",r.mapPass=new T(E.x,E.y,i),r.camera.updateProjectionMatrix()),null===r.map&&(r.map=new T(E.x,E.y,{minFilter:1003,magFilter:1003,format:1023,stencilBuffer:!1}),r.map.texture.name=t.name+".shadowMap",r.camera.updateProjectionMatrix()),b.setRenderTarget(r.map),b.clear(Cesium.Color.WHITE,1,0),d.enabled){for(var a=r.getViewportCount(),o=0;o<a;o++){var s=r.getViewport(o);A.set(C.x*s.x,C.y*s.y,C.x*s.z,C.y*s.w);s=r.map.viewport;r.map.viewport=A,r.updateMatrices(t,o),r.camera.isPerspectiveCamera?n=U.default.fromPerspectiveCamera3js(e,null,c._scene,_):r.camera.isOrthographicCamera&&(n=U.default.fromOrthographicCamera3js(e,null,c._scene,_)),S=r.getFrustum(),l.camera=n,f.update(l),g.viewport=A,m.renderables.forEach(function(e){!function e(t,r,n,i,a,o,s,u){if(!1!==t.visible){if((!t.layers||!r.layers||t.layers.test(r.layers))&&(t.isMesh||t.isLine||t.isPoints)&&(t.castShadow||t.receiveShadow&&a===w)){if("sunLight"!=i.name&&t.frustumCulled&&!S.intersectsObject(t))return;var l,c=N.default.get(t.geometry,t.material),d=t.material;if(Array.isArray(d))for(var f=c.groupsOptimized,h=0;h<f.length;h++){var p=f[h],m=p.materialIndex,g=p.groupIndex;(p=d[m]).visible&&(p=M(t,c,p,i,u.near,u.far,a),b.renderBufferDirect(n,null,c,p,t,{materialIndex:m,groupIndex:g,renderItemIndex:h},s,u,D))}else d.visible&&(l=M(t,c,d,i,u.near,u.far,a),b.renderBufferDirect(n,null,c,l,t,null,s,u,D))}var _=t.children;if(0!=o&&_)for(var v=0,y=_.length;v<y;v++)e(_[v],r,n,i,a,o,s,u)}}(e,h,n,t,d.type,!1,m,r.camera)}),l.camera=h,l.cullingVolume=p,f.update(l),r.map.viewport=s,r.camera._referenceFrame=null}r.isPointLightShadow||d.type!==w||function(e,t){var r=Cesium.Color,n=P.geometry;O.uniforms.shadow_pass.value=e.map.texture,O.uniforms.resolution.value=e.mapSize,O.uniforms.radius.value=e.radius,b.renderState.depthTest.enabled=!1,b.renderState.depthMask=!1,b.shadowMap.enabled=!1,b.setRenderTarget(e.mapPass),b.clear(r.WHITE,1,0);var i=x(n,O);i.frustumCulled=!1,b.render(i,t),L.uniforms.shadow_pass.value=e.mapPass.texture,L.uniforms.resolution.value=e.mapSize,L.uniforms.radius.value=e.radius,b.setRenderTarget(e.map),b.clear(r.WHITE,1,0),(i=x(n,L)).frustumCulled=!1,b.render(i,t),b.shadowMap.enabled=!0,b.renderState.depthTest.enabled=!0,b.renderState.depthMask=!0}(r,h),r.needsUpdate=!1,r.onCameraChanged&&r.onCameraChanged(r.map)}}();b.renderState=e,b.autoClear=i,I.needsUpdate=!1,b.setRenderTarget(t,r,n)}},_=new WeakMap,D="shadowMap"):this.render=function(){}}},{"3_133":7,e_94:24,"3_101":60,d_118:72}],74:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=e("W_109"),a=e&&e.__esModule?e:{default:e};r.default=function(w){function T(e,t){var r=(e._size,e._pixelFormat),n=e._pixelDatatype,i=(e._preMultiplyAlpha,e._flipY,e._gl||e._context._gl),a=e._textureTarget,o=e._texture,s="number"==typeof e._targetFace?e._targetFace:a,u=t.width,l=t.height,e=t.arrayBufferView;i.activeTexture(i.TEXTURE0),i.bindTexture(a,o),i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);var e=t.arrayBufferView,c=P.isCompressedFormat(r);if(c?i.compressedTexImage2D(s,0,r,u,l,0,e):i.texImage2D(s,0,r,u,l,0,r,n,e),m(t.mipLevels))for(var d=u,f=l,h=0;h<t.mipLevels.length;++h)(d=0|Math.floor(d/2))<1&&(d=1),(f=0|Math.floor(f/2))<1&&(f=1),c?i.compressedTexImage2D(s,h+1,r,d,f,0,t.mipLevels[h]):i.texImage2D(s,h+1,r,d,f,0,r,n,t.mipLevels[h]);i.bindTexture(a,null)}function S(e){var t={};return t.minificationFilter=a.default.minFilterMap[e.minFilter],t.magnificationFilter=a.default.magFilterMap[e.magFilter],t.wrapS=a.default.textureWrapMap[e.wrapS],t.wrapT=a.default.textureWrapMap[e.wrapT],t.maximumAnisotropy=e.anisotropy,new r(t)}function E(e,t){var r=O[e.format],n=L[e.type],i=e.premultiplyAlpha,a=e.flipY,o=S(e),s=e.image,u=e.mipmaps,l=s.width,c=s.height,d=u&&0<u.length,f=9984===o.minificationFilter||9986===o.minificationFilter||9985===o.minificationFilter||9987===o.minificationFilter,e=f||10497===o.wrapS||33648===o.wrapS||10497===o.wrapT||33648===o.wrapT,u=s,s=u&&(!g.isPowerOfTwo(u.width)||!g.isPowerOfTwo(u.height));e&&s&&((h=document.createElement("canvas")).width=g.nextPowerOfTwo(u.width),h.height=g.nextPowerOfTwo(u.height),h.getContext("2d").drawImage(u,0,0,u.width,u.height,0,0,h.width,h.height),l=(u=h).width,c=h.height);var h,s=!1;l>p.maximumTextureSize&&(l=p.maximumTextureSize,s=!0,console.warn("Width should be less than or equal to the maximum texture size ("+p.maximumTextureSize+").  Check maximumTextureSize.")),c>p.maximumTextureSize&&(console.warn("Height should be less than or equal to the maximum texture size ("+p.maximumTextureSize+").  Check maximumTextureSize."),c=p.maximumTextureSize,s=!0),s&&(console.warn("Width and height must be less than or equal to the maximum texture size ("+p.maximumTextureSize+").  Check maximumTextureSize."),(h=document.createElement("canvas")).width=l,h.height=c,h.getContext("2d").drawImage(u,0,0,u.width,u.height,0,0,h.width,h.height),l=(u=h).width,c=h.height);i=new I({context:t,source:d?void 0:u,width:l,height:c,pixelFormat:r,pixelDatatype:n,sampler:o,flipY:a,preMultiplyAlpha:i});return f&&i.generateMipmap(),i}function C(e,t){var r=O[e.format],n=L[e.type],i=e.premultiplyAlpha,a=e.flipY,o=S(e),s=e.image,u=e.mipmaps,l=s.width,e=s.height,s=P.isCompressedFormat(r),i=new I({context:t,width:l,height:e,pixelFormat:s?6408:r,pixelDatatype:n,sampler:o,flipY:a,preMultiplyAlpha:i}),e={width:l,height:e};if(e.arrayBufferView=u[0].data,1<u.length){for(var c=[],d=1;d<u.length;d++)c.push(u[d].data);e.mipLevels=c}return i._pixelFormat=r,T(i,e),i._initialized=!0,i}function A(e){var t=e.image,r=!0;if(t&&t.length){for(var n=0;n<t.length;n++)if(!t[n]){r=!1;break}return r}}var O,L,e=Cesium,p=(e.TextureMinificationFilter,e.TextureWrap,e.ContextLimits),r=e.Sampler,P=e.PixelFormat,m=e.defined,I=e.Texture,R=e.CubeMap,g=Cesium.Math,D=w._textureCache,U=new WeakMap,n=new WeakMap,i=new WeakMap;this.has=function(e){return U.has(e)},this.get=function(e,t,r){if(D[e.uuid])return D[e.uuid];var n,i,a,o,s,u,l,c,d,f,h,p,m,g,_,v=t.context,y=U.get(e);if(!(y=y&&y.version!=e.version?this.delete(e):y)){var b=w.defaultTexture,x=w.defaultCubeMap,M=e.image;if(e.isCanvasTexture||e.isVideoTexture){if(!M)return b;y=E(e,v)}else if(e.isDataTexture){if(!M)return r||b;y=function(e,t){var r=O[e.format],n=L[e.type],i=e.premultiplyAlpha,a=e.flipY,o=S(e),s=e.image,u=e.mipmaps,l=s.width,c=s.height,e=u&&0<u.length,i=new I({context:t,source:e?void 0:{arrayBufferView:s.data,width:s.width,height:s.height},width:l,height:c,pixelFormat:r,pixelDatatype:n,sampler:o,flipY:a,preMultiplyAlpha:i});if(e){c={width:l,height:c};if(c.arrayBufferView=u[0].data,1<u.length){for(var d=[],f=1;f<u.length;f++)d.push(u[f].data);c.mipLevels=d}i._pixelFormat=r,T(i,c),i._initialized=!0}return i}(e,v)}else if(e.isCubeTexture){if(6!=M.length||!A(e))return x;p=v,m=O[(h=e).format],g=L[h.type],_=h.image,t=h.mipmaps,_=_.map(function(e){return e.isDataTexture?{arrayBufferView:e.data,width:e.data,height:e.height}:e}),h=new R({context:p,source:{positiveX:_[0],negativeX:_[1],positiveY:_[2],negativeY:_[3],positiveZ:_[4],negativeZ:_[5]},pixelFormat:m,pixelDatatype:g,preMultiplyAlpha:h.preMultiplyAlpha,flipY:h.flipY}),t&&t.length,y=h}else if(e.isCompressedTexture){if(!M)return b;if(Array.isArray(M))if(e.mipmaps)y=C(e,v);else{if(!A(e))return r||x;i=v,a=O[(n=e).format],o=L[e.type],s=e.premultiplyAlpha,u=e.flipY,l=e.image,c=l.width||l[0].width,d=l.height||l[0].height,n=P.isCompressedFormat(a),f=new R({width:c,height:d,context:i,pixelFormat:n?6408:a,pixelDatatype:o,preMultiplyAlpha:s,flipY:u}),["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"].forEach(function(e,t){var e=f[e],r=l[t].mipmaps,t={width:c,height:d};if(t.arrayBufferView=r[0].data,1<r.length){for(var n=[],i=1;i<r.length;i++)n.push(r[i].data);t.mipLevels=n}e._pixelFormat=a,T(e,t),e._initialized=!0}),y=f}else y=C(e,v)}else if(Array.isArray(M)){if(!A(e))return r||x;i=v,o=O[(n=e).format],s=L[n.type],u=n.premultiplyAlpha,x=n.flipY,n=n.image.map(function(e){return e.isDataTexture?{width:e.image.width,height:e.image.height,arrayBufferView:e.image.data}:e}),y=new R({context:i,source:{positiveX:n[0],negativeX:n[1],positiveY:n[2],negativeY:n[3],positiveZ:n[4],negativeZ:n[5]},pixelFormat:o,pixelDatatype:s,preMultiplyAlpha:u,flipY:x})}else{if(!M||!(M instanceof HTMLCanvasElement||M instanceof HTMLVideoElement||M instanceof HTMLImageElement||M instanceof ImageData||M instanceof OffscreenCanvas||M instanceof ImageBitmap))return r||b;y=E(e,v)}this.set(e,y)}return y},this.set=function(t,e){function r(){var e=U.get(t);void 0!==e&&(e.isDestroyed&&e.isDestroyed()||e.destroy(),U.delete(t)),t.removeEventListener("dispose",r),i.delete(t)}e&&t?(e.version=t.version,U.set(t,e),t.addEventListener("dispose",r),i.set(t,r)):console.warn("texture3js or texture is empty")},this.delete=function(e){e=i.get(e);e&&e()},this.addReference=function(e){var t=n.get(e)||0;n.set(e,++t)},this.removeReference=function(e){var t=n.get(e);null!=t&&(0==--t?(this.delete(e),n.delete(e)):n.set(e,t))},Object.defineProperties(this,{textures:{get:function(){return U}},textureReferences:{get:function(){return n}}}),"undefined"!=typeof THREE&&(O=a.default.formatsMap,L=a.default.typesMap)}},{W_109:44}],75:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=(n(e("e_94")),e("M_104")),e=(n(i),e("d_118"));n(e),r.default=function(w){function s(e,t,r){for(var n in t)t.hasOwnProperty(n)&&(r[e+"."+n]=function(e,t){return function(){return e[t]}}(t,n))}function o(e){var t=void 0===e?"undefined":h(e);return"undefined"!=t&&null!=e&&("number"==t||"boolean"==t||e instanceof O||e instanceof i||e instanceof a||e instanceof c||e instanceof n||e instanceof A||e instanceof C||e instanceof r||e.isColor||e.isVector2||e.isVector3||e.isVector4||e.isCartesian2||e.isCartesian3||e.isCartesian4||e.isMatrix2||e.isMatrix3||e.isMatrix4)}function u(e){return Array.isArray(e)&&e.length&&!o(e[0])}function T(e,t,r){for(var n in e){var i,a=e[n];e.hasOwnProperty(n)&&a&&(i=a.value,(a=function(e,t,r){var n=t.value,i=void 0===n?"undefined":h(n);if("f"==t.type)return function(){return t.value||0};if("number"==i||"boolean"==i)return function(){return t.value};if(!n){var a="envMap"==e?L.defaultCubeMap:L.defaultTexture;return function(){var e=t.value;return e?P.get(e,r,a):a}}if(n.isTexture){a="envMap"==e?L.defaultCubeMap:L.defaultTexture;return function(){return P.get(t.value,r,a)}}return n.isVector2|n.isVector3|n.isVector4|n.isColor?function(){return t.value}:n.isMatrix2|n.isMatrix3|n.isMatrix4?function(){return t.value.elements}:Array.isArray(n)&&n.length&&o(n[0])?function(){return t.value}:void 0}(n,a,t))?r[n]=a:(u(i)?function e(t,r,n){if(u(r))for(var i=0;i<r.length;i++){var a=r[i],o=t+"["+i+"]";(u(a)?e:s)(o,a,n)}else n[t]=function(){return r}}:s)(n,i,r))}}var S,E,l,e=Cesium,r=(e.OrthographicFrustum,e.Texture),C=e.Matrix4,A=e.Matrix3,n=e.Matrix2,O=e.Color,i=e.Cartesian2,a=e.Cartesian3,c=e.Cartesian4,L=w._visualizer,P=w._textures,d=w._materials,I=w._properties,R=(L.occlusionCulling,w._capabilities),f=w._extensions,D=new WeakMap;Object.defineProperties(this,{uniforms:{get:function(){return D}}}),"undefined"!=typeof THREE&&(l=THREE.UniformsLib);var U=new a;this.getUniformMap=function(e,t,r,n){var i={},a=r.context,o=D.get(e);if(!o||!o.has(t))return i;var s,u,l,c,d,f,h,p,m,g,_,v,y,b,x,M=o.get(t);return T(M,r,i),function(e,r,n,t){var i=r.pickId;t.czm_pickColor=function(){return i.color},t.cameraPosition=function(){var e=n.camera.customCamera;return e&&e.cameraPosition?e.cameraPosition:n.camera.position},t.u_cameraPosition=t.cameraPosition,t.cameraPositionLC=function(){var e=n.camera,t=e.customCamera;return t&&t.cameraPosition?t.cameraPosition:(L.worldCoordinatesToLocal(e.position,U,r.up),U)},t.u_cameraPositionLC=t.cameraPositionLC,t.normalMatrix=function(){var e=n.camera.customCamera;return e&&e.normalMatrix?e.normalMatrix:n.context.uniformState.normal},t.u_normalMatrix=t.normalMatrix,t.projectionMatrix=function(){var e=n.camera.customCamera;return e&&e.projectionMatrix?e.projectionMatrix:n.context.uniformState.projection},t.u_projectionMatrix=t.projectionMatrix,t.modelViewMatrix=function(){var e=n.camera.customCamera;return e&&e.modelViewMatrix?e.modelViewMatrix:n.context.uniformState.modelView},t.u_modelViewMatrix=t.modelViewMatrix;var a=new C;t.modelViewMatrixInverse=function(){var e=n.context.uniformState.modelView;return C.inverse(e,a)},t.modelMatrix=function(){var e=n.camera.customCamera;return e&&e.modelMatrix?e.modelMatrix:n.context.uniformState.model},t.u_modelMatrix=t.modelMatrix;var o=new C;t.matrixWorld=function(){var e=t._CesiumModel2ThreeModel();return C.multiply(e,n.context.uniformState.model,o)};var s=new A;t.normalMatrixWorld=function(){var e=t._CesiumNormal2ThreeNormal();return A.multiply(e,n.context.uniformState.normal,s)};var u=1==r.up.y;t._CesiumModel2ThreeModel=function(){return u?L._actualModelMatrixYupInverse:L._actualModelMatrixInverse},t._ThreeModel2CesiumModel=function(){return u?L._actualModelMatrixYup:L._actualModelMatrix};var l=new A;t._CesiumNormal2ThreeNormal=function(){return u?C.getMatrix3(L._actualModelMatrixYupInverse,l):C.getMatrix3(L._actualModelMatrixInverse,l)};var c=new A;t._ThreeNormal2CesiumNormal=function(){return 1==r.up.y?C.getMatrix3(that._actualModelMatrixYup,c):C.getMatrix3(that._actualModelMatrix,c)},t.viewMatrix=function(){return n.context.uniformState.view},t.u_viewMatrix=t.viewMatrix,t.logDepthBufFC=function(){return 2/(Math.log(n.camera.frustum.far+1)/Math.LN2)},t.isOrthographic=function(){return 1==n.camera.isOrthographicCamera},t.toneMappingExposure=function(){return w.toneMappingExposure},t.toneMappingWhitePoint=function(){return w.toneMappingWhitePoint},t.receiveShadow=function(){return 1==r.receiveShadow},t.center=function(){return!!r.center},e.uniformStateUsed&&e.uniformStateUsed.length&&e.uniformStateUsed.forEach(function(e){if(!t[e.glslVarName]){if(!n.context.uniformState[e.uniformStateName])throw new Error(e.uniformStateName+"不是Cesium引擎的内置对象");t[e.glslVarName]=function(){return n.context.uniformState[e.uniformStateName]}}})}(e,t,r,i),g=e,_=r,v=i,o=M,M=n,I.get(g).needsLights&&(n=function(e){return function(){return y[e].map(function(e){return e?P.get(e):L.defaultShadowMap})}},y=M.state,(M={}).lightProbe={value:y.probe},M.directionalLights={value:y.directional},M.directionalLightShadows={value:y.directionalShadow},M.spotLights={value:y.spot},M.spotLightShadows={value:y.spotShadow},M.rectAreaLights={value:y.rectArea},M.pointLights={value:y.point},M.pointLightShadows={value:y.pointShadow},M.hemisphereLights={value:y.hemi},v.directionalShadowMap=n("directionalShadowMap"),v.directionalShadowMatrix=function(){return y.directionalShadowMatrix},v.spotShadowMap=n("spotShadowMap"),v.spotShadowMatrix=function(){return y.spotShadowMatrix},v.pointShadowMap=n("pointShadowMap"),v.pointShadowMatrix=function(){return y.pointShadowMatrix},T(M,_,v),o.ambientLightColor&&(g.lightMap?v.ambientLightColor=function(){return O.BLACK}:v.ambientLightColor=function(){return y.ambient}),v.ltc_1=function(){return P.get(S,_)||L.defaultTexture},v.ltc_2=function(){return P.get(E,_)||L.defaultTexture},b=L._fixedWebGLLights.extensionState,x=L._partialWebGLLights.extensionState,v.fixedPointLightMap=function(){return b.point.map},v.partialPointLightMap=function(){return x.point.map},v.fixedPointLightPositions=function(){return b.point.positions},v.fixedPointLightColors=function(){return b.point.colors},v.fixedPointLightDecayDists=function(){return b.point.decalDists},v.partialPointLightPositions=function(){return x.point.positions},v.partialPointLightColors=function(){return x.point.colors},v.partialPointLightDecayDists=function(){return x.point.decalDists},v.partialPointLightDecayDists=function(){return x.point.decalDists},v.fixedPointLightVisibles=function(){return b.point.visibles},v.partialPointLightVisibles=function(){return x.point.visibles}),M=i,((o=e).isShaderMaterial||o.isRawShaderMaterial)&&!0!==o.clipping||(m=I.get(o).clippingUniform,M.clippingPlanes=function(){return m?m.value:[]}),g=t,v=i,(o=e)&&(o.morphTargets||o.morphNormals)&&(p=w.morphtargets.getUniforms(g),v.morphTargetBaseInfluence=function(){return p.morphTargetBaseInfluence},v.morphTargetInfluences=function(){return p.morphTargetInfluences}),M=t,o=r,g=i,(v=e)&&v.skinning&&(c=M,g.bindMatrix=function(){return c.bindMatrix.elements},g.bindMatrixInverse=function(){return c.bindMatrixInverse.elements},(d=c.skeleton)&&(e=d.bones,R.floatVertexTextures?(f=d.boneTextureCesium,void 0===(h=d.boneTexture)&&(v=THREE,M=Math.sqrt(4*e.length),M=v.Math.ceilPowerOfTwo(M),M=Math.max(M,4),(e=new Float32Array(M*M*4)).set(d.boneMatrices),h=new v.DataTexture(e,M,M,1023,1015),d.boneMatrices=e,d.boneTexture=h,d.boneTextureSize=M,(f=P.get(d.boneTexture,o)).name="boneTexture",d.boneTextureCesium=f),g.boneTexture=function(){var e;return f.version!=h.version&&((e=h.image).arrayBufferView=e.data,f.copyFrom(e)),f.version=h.version,f},g.boneTextureSize=function(){return d.boneTextureSize}):g.boneMatrices=function(){return d.boneMatrices.elements})),t._instances&&(i.czm_instanced_modifiedModelView=(s=a,u=t,l,function(){return u._rtcTransform||(u._rtcTransform=new l),u._rtcModelView||(u._rtcModelView=new l),l.multiplyByTranslation(u.modelMatrix,u._center,u._rtcTransform),l.multiply(s.uniformState.view,u._rtcTransform,u._rtcModelView)})),t.uniformMapLoadedCallback&&t.uniformMapLoadedCallback(i,r,t),i},this.set=function(r,n,i){function a(){for(var e in o.delete(i),r.removeEventListener("dispose",a),0==--o.useTimes&&D.delete(r),n){var t=n[e];n.hasOwnProperty(e)&&t&&((t=t.value)&&t.isTexture&&P.removeReference(t))}}R=R||w.capabilities,f=f||w.extensions;var o=D.get(r);o||((o=new WeakMap).useTimes=0,D.set(r,o)),o.useTimes++;var e,t=o.get(i);for(e in t&&t.materialDisposeCallback(),r.addEventListener("dispose",a),n.materialDisposeCallback=a,o.set(i,n),this.refresh(r,i),n){var s=n[e];n.hasOwnProperty(e)&&s&&((s=s.value)&&s.isTexture&&P.addReference(s))}R.isWebGL2||!0===f.has("OES_texture_float_linear")?(S=l.LTC_FLOAT_1,E=l.LTC_FLOAT_2):!0===f.has("OES_texture_half_float_linear")?(S=l.LTC_HALF_1,E=l.LTC_HALF_2):console.error("WebGLUniforms: Unable to use RectAreaLight. Missing WebGL extensions.")},this.refresh=function(e,t,r){var n;!(r=r||D.get(e).get(t))||r.version==e.version&&0==e.autoRefresh||(L.fog&&r.fogColor&&d.refreshFogUniforms(r,L.fog),n=R.gl.canvas.height,t=w._pixelRatio,d.refreshMaterialUniforms(r,e,t,n),r.version=e.version)}}},{e_94:24,M_104:61,d_118:72}],76:[function(e,t,r){"use strict";function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}function s(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(l[n>>18&63]+l[n>>12&63]+l[n>>6&63]+l[63&n]);return i.join("")}Object.defineProperty(r,"__esModule",{value:!0});for(var l=[],c=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)l[i]=n[i],c[n.charCodeAt(i)]=i;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63,r.byteLength=function(e){var e=(t=u(e))[0],t=t[1];return 3*(e+t)/4-t},r.toByteArray=function(e){for(var t,r=(n=u(e))[0],n=n[1],i=new d(3*(r+n)/4-n),a=0,o=0<n?r-4:r,s=0;s<o;s+=4)t=c[e.charCodeAt(s)]<<18|c[e.charCodeAt(s+1)]<<12|c[e.charCodeAt(s+2)]<<6|c[e.charCodeAt(s+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=255&t;return 2===n&&(t=c[e.charCodeAt(s)]<<2|c[e.charCodeAt(s+1)]>>4,i[a++]=255&t),1===n&&(t=c[e.charCodeAt(s)]<<10|c[e.charCodeAt(s+1)]<<4|c[e.charCodeAt(s+2)]>>2,i[a++]=t>>8&255,i[a++]=255&t),i},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],a=0,o=r-n;a<o;a+=16383)i.push(s(e,a,o<a+16383?o:a+16383));return 1==n?(t=e[r-1],i.push(l[t>>2]+l[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+"=")),i.join("")}},{}],77:[function(e,t,r){"use strict";function g(){this.polygons=[]}Object.defineProperty(r,"__esModule",{value:!0}),g.fromPolygons=function(e){var t=new g;return t.polygons=e,t},g.prototype={clone:function(){var e=new g;return e.polygons=this.polygons.map(function(e){return e.clone()}),e},toPolygons:function(){return this.polygons},union:function(e){var t=new g.Node(this.clone().polygons),e=new g.Node(e.clone().polygons);return t.clipTo(e),e.clipTo(t),e.invert(),e.clipTo(t),e.invert(),t.build(e.allPolygons()),g.fromPolygons(t.allPolygons())},subtract:function(e){var t=new g.Node(this.clone().polygons),e=new g.Node(e.clone().polygons);return t.invert(),t.clipTo(e),e.clipTo(t),e.invert(),e.clipTo(t),e.invert(),t.build(e.allPolygons()),t.invert(),g.fromPolygons(t.allPolygons())},intersect:function(e){var t=new g.Node(this.clone().polygons),e=new g.Node(e.clone().polygons);return t.invert(),e.clipTo(t),e.invert(),t.clipTo(e),e.clipTo(t),t.build(e.allPolygons()),t.invert(),g.fromPolygons(t.allPolygons())},inverse:function(){var e=this.clone();return e.polygons.map(function(e){e.flip()}),e}},g.cube=function(e){var r=new g.Vector((e=e||{}).center||[0,0,0]),n=e.radius?e.radius.length?e.radius:[e.radius,e.radius,e.radius]:[1,1,1];return g.fromPolygons([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(t){return new g.Polygon(t[0].map(function(e){e=new g.Vector(r.x+n[0]*(2*!!(1&e)-1),r.y+n[1]*(2*!!(2&e)-1),r.z+n[2]*(2*!!(4&e)-1));return new g.Vertex(e,new g.Vector(t[1]))}))}))},g.sphere=function(e){function t(e,t){e*=2*Math.PI,t*=Math.PI;t=new g.Vector(Math.cos(e)*Math.sin(t),Math.cos(t),Math.sin(e)*Math.sin(t));r.push(new g.Vertex(n.plus(t.times(i)),t))}for(var r,n=new g.Vector((e=e||{}).center||[0,0,0]),i=e.radius||1,a=e.slices||16,o=e.stacks||8,s=[],u=0;u<a;u++)for(var l=0;l<o;l++)r=[],t(u/a,l/o),0<l&&t((u+1)/a,l/o),l<o-1&&t((u+1)/a,(l+1)/o),t(u/a,(l+1)/o),s.push(new g.Polygon(r));return g.fromPolygons(s)},g.cylinder=function(e){function t(e,t,r){t=t*Math.PI*2,t=u.times(Math.cos(t)).plus(l.times(Math.sin(t))),e=n.plus(i.times(e)).plus(t.times(a)),r=t.times(1-Math.abs(r)).plus(s.times(r));return new g.Vertex(e,r)}for(var n=new g.Vector((e=e||{}).start||[0,-1,0]),r=new g.Vector(e.end||[0,1,0]),i=r.minus(n),a=e.radius||1,o=e.slices||16,s=i.unit(),e=.5<Math.abs(s.y),u=new g.Vector(e,!e,0).cross(s).unit(),l=u.cross(s).unit(),c=new g.Vertex(n,s.negated()),d=new g.Vertex(r,s.unit()),f=[],h=0;h<o;h++){var p=h/o,m=(h+1)/o;f.push(new g.Polygon([c,t(0,p,-1),t(0,m,-1)])),f.push(new g.Polygon([t(0,m,0),t(0,p,0),t(1,p,0),t(1,m,0)])),f.push(new g.Polygon([d,t(1,m,1),t(1,p,1)]))}return g.fromPolygons(f)},(g.Vector=function(e,t,r){3==arguments.length?(this.x=e,this.y=t,this.z=r):"x"in e?(this.x=e.x,this.y=e.y,this.z=e.z):(this.x=e[0],this.y=e[1],this.z=e[2])}).prototype={clone:function(){return new g.Vector(this.x,this.y,this.z)},negated:function(){return new g.Vector(-this.x,-this.y,-this.z)},plus:function(e){return new g.Vector(this.x+e.x,this.y+e.y,this.z+e.z)},minus:function(e){return new g.Vector(this.x-e.x,this.y-e.y,this.z-e.z)},times:function(e){return new g.Vector(this.x*e,this.y*e,this.z*e)},dividedBy:function(e){return new g.Vector(this.x/e,this.y/e,this.z/e)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lerp:function(e,t){return this.plus(e.minus(this).times(t))},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.dividedBy(this.length())},cross:function(e){return new g.Vector(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}},(g.Vertex=function(e,t){this.pos=new g.Vector(e),this.normal=new g.Vector(t)}).prototype={clone:function(){return new g.Vertex(this.pos.clone(),this.normal.clone())},flip:function(){this.normal=this.normal.negated()},interpolate:function(e,t){return new g.Vertex(this.pos.lerp(e.pos,t),this.normal.lerp(e.normal,t))}},(g.Plane=function(e,t){this.normal=e,this.w=t}).EPSILON=1e-5,g.Plane.fromPoints=function(e,t,r){r=t.minus(e).cross(r.minus(e)).unit();return new g.Plane(r,r.dot(e))},g.Plane.prototype={clone:function(){return new g.Plane(this.normal.clone(),this.w)},flip:function(){this.normal=this.normal.negated(),this.w=-this.w},splitPolygon:function(e,t,r,n,i){for(var a=0,o=[],s=0;s<e.vertices.length;s++){var u=(d=this.normal.dot(e.vertices[s].pos)-this.w)<-g.Plane.EPSILON?2:d>g.Plane.EPSILON?1:0;a|=u,o.push(u)}switch(a){case 0:(0<this.normal.dot(e.plane.normal)?t:r).push(e);break;case 1:n.push(e);break;case 2:i.push(e);break;case 3:for(var l=[],c=[],s=0;s<e.vertices.length;s++){var d,f=(s+1)%e.vertices.length,h=o[s],p=o[f],m=e.vertices[s],f=e.vertices[f];2!=h&&l.push(m),1!=h&&c.push(2!=h?m.clone():m),3==(h|p)&&(d=(this.w-this.normal.dot(m.pos))/this.normal.dot(f.pos.minus(m.pos)),f=m.interpolate(f,d),l.push(f),c.push(f.clone()))}3<=l.length&&n.push(new g.Polygon(l,e.shared)),3<=c.length&&i.push(new g.Polygon(c,e.shared))}}},(g.Polygon=function(e,t){this.vertices=e,this.shared=t,this.plane=g.Plane.fromPoints(e[0].pos,e[1].pos,e[2].pos)}).prototype={clone:function(){var e=this.vertices.map(function(e){return e.clone()});return new g.Polygon(e,this.shared)},flip:function(){this.vertices.reverse().map(function(e){e.flip()}),this.plane.flip()}},(g.Node=function(e){this.plane=null,this.front=null,this.back=null,this.polygons=[],e&&this.build(e)}).prototype={clone:function(){var e=new g.Node;return e.plane=this.plane&&this.plane.clone(),e.front=this.front&&this.front.clone(),e.back=this.back&&this.back.clone(),e.polygons=this.polygons.map(function(e){return e.clone()}),e},invert:function(){for(var e=0;e<this.polygons.length;e++)this.polygons[e].flip();this.plane.flip(),this.front&&this.front.invert(),this.back&&this.back.invert();var t=this.front;this.front=this.back,this.back=t},clipPolygons:function(e){if(!this.plane)return e.slice();for(var t=[],r=[],n=0;n<e.length;n++)this.plane.splitPolygon(e[n],t,r,t,r);return this.front&&(t=this.front.clipPolygons(t)),r=this.back?this.back.clipPolygons(r):[],t.concat(r)},clipTo:function(e){this.polygons=e.clipPolygons(this.polygons),this.front&&this.front.clipTo(e),this.back&&this.back.clipTo(e)},allPolygons:function(){var e=this.polygons.slice();return this.front&&(e=e.concat(this.front.allPolygons())),e=this.back?e.concat(this.back.allPolygons()):e},build:function(e){if(e.length){this.plane||(this.plane=e[0].plane.clone());for(var t=[],r=[],n=0;n<e.length;n++)this.plane.splitPolygon(e[n],this.polygons,this.polygons,t,r);t.length&&(this.front||(this.front=new g.Node),this.front.build(t)),r.length&&(this.back||(this.back=new g.Node),this.back.build(r))}}},r._CSG=g},{}],78:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GLTFExporter=void 0;function w(){var e;n||(n=!0,e=THREE,Y=e.BufferAttribute,X=e.BufferGeometry,q=2,T=2300,g=2301,S=e.MathUtils,E=e.PropertyBinding,C=1023,a=e.Scene,K=e.Vector3,o[1003]=9728,o[1004]=9984,o[1005]=9986,o[1006]=9729,o[1007]=9985,o[1008]=9987,o[1001]=33071,o[1e3]=10497,o[1002]=33648)}var Y,X,q,T,g,S,E,C,a,K,A=e("__183"),O="undefined"==typeof Blob||"undefined"==typeof Image||"undefined"==typeof Document||"undefined"==typeof window,o={},L={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},n=!1;w.prototype={constructor:w,parse:function(e,_,N){function B(e){return t.has(e)||t.set(e,i++),t.get(e)}function k(e,r){return e.length===r.length&&e.every(function(e,t){return e===r[t]})}function v(e){if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var i=e.charCodeAt(r);t[r]=255<i?32:i}return t.buffer}function h(e){return 4*Math.ceil(e/4)}function y(e,t){t=t||0;var r=h(e.byteLength);if(r===e.byteLength)return e;var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n.buffer}function j(e,t){if(0!==Object.keys(e.userData).length)try{var r=JSON.parse(JSON.stringify(e.userData));if(N.includeCustomExtensions&&r.gltfExtensions){for(var n in void 0===t.extensions&&(t.extensions={}),r.gltfExtensions)t.extensions[n]=r.gltfExtensions[n],W[n]=!0;delete r.gltfExtensions}0<Object.keys(r).length&&(t.extras=r)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}function V(e,t){var r=!1,n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(n.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,W.KHR_texture_transform=!0)}function p(e){return z.buffers||(z.buffers=[{byteLength:0}]),x.push(e),0}function F(e,t,r,n){var i,a;if(e.array.constructor===Float32Array)i=5126;else if(e.array.constructor===Uint32Array)i=5125;else if(e.array.constructor===Uint16Array)i=5123;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");i=5121}if(void 0===r&&(r=0),void 0===n&&(n=e.count),N.truncateDrawRange&&void 0!==t&&null===t.index&&(a=r+n,o=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count,r=Math.max(r,t.drawRange.start),(n=Math.min(a,o)-r)<0&&(n=0)),0===n)return null;var o=function(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},i=t;i<t+r;i++)for(var a=0;a<e.itemSize;a++){var o=e.array[i*e.itemSize+a];n.min[a]=Math.min(n.min[a],o),n.max[a]=Math.max(n.max[a],o)}return n}(e,r,n),s=function(e,t,r,n,i){z.bufferViews||(z.bufferViews=[]);for(var a,o=h(n*e.itemSize*(a=5121===t?1:5123===t?2:4)),s=new DataView(new ArrayBuffer(o)),u=0,l=r;l<r+n;l++)for(var c=0;c<e.itemSize;c++){var d=e.array[l*e.itemSize+c];5126===t?s.setFloat32(u,d,!0):5125===t?s.setUint32(u,d,!0):5123===t?s.setUint16(u,d,!0):5121===t&&s.setUint8(u,d),u+=a}var f={buffer:p(s.buffer),byteOffset:m,byteLength:o};return void 0!==i&&(f.target=i),34962===i&&(f.byteStride=e.itemSize*a),m+=o,z.bufferViews.push(f),{id:z.bufferViews.length-1,byteLength:0}}(e,i,r,n,s=void 0!==t?e===t.index?34963:34962:s),e={bufferView:s.id,byteOffset:s.byteOffset,componentType:i,count:n,max:o.max,min:o.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return z.accessors||(z.accessors=[]),z.accessors.push(e),z.accessors.length-1}function r(e,t,r){if(e){H.images.has(e.src)||H.images.set(e.src,{});var n=H.images.get(e.src),i=t===C?"image/png":"image/jpeg",a=i+":flipY/"+r.toString();if(void 0!==n[a])return n[a];z.images||(z.images=[]);var o,s={mimeType:i},t=H.assetSrcs[e.src]||e.src||e;"undefined"!=typeof HTMLCanvasElement&&("string"!=typeof t||t.startsWith("blob:")||N.embedImages)?(e||((e=document.createElement("canvas")).width=2,e.height=2),(o=l=l||document.createElement("canvas")).width=Math.min(e.width,N.maxTextureSize),o.height=Math.min(e.height,N.maxTextureSize),!N.forcePowerOfTwoTextures||(u=o,S.isPowerOfTwo(u.width)&&S.isPowerOfTwo(u.height))||(console.warn("GLTFExporter: Resized non-power-of-two image.",e),o.width=S.floorPowerOfTwo(o.width),o.height=S.floorPowerOfTwo(o.height)),u=o.getContext("2d"),!0===r&&(u.translate(0,o.height),u.scale(1,-1)),u.drawImage(e,0,0,o.width,o.height),!0===N.binary?f.push(new Promise(function(r){o.toBlob(function(e){var t;t=e,z.bufferViews||(z.bufferViews=[]),new Promise(function(r){var n=new window.FileReader;n.readAsArrayBuffer(t),n.onloadend=function(){var e=y(n.result),t={buffer:p(e),byteOffset:m,byteLength:e.byteLength};m+=e.byteLength,z.bufferViews.push(t),r(z.bufferViews.length-1)}}).then(function(e){s.bufferView=e,r()})},i)})):s.uri=o.toDataURL(i)):s.uri=t,z.images.push(s);t=z.images.length-1;return n[a]=t}var u}function G(e){if(H.textures.has(e))return H.textures.get(e);z.textures||(z.textures=[]);t={sampler:(t=e,z.samplers||(z.samplers=[]),t={magFilter:o[t.magFilter],minFilter:o[t.minFilter],wrapS:o[t.wrapS],wrapT:o[t.wrapT]},z.samplers.push(t),z.samplers.length-1),source:r(e.image,e.format,e.flipY)};e.name&&(t.name=e.name),z.textures.push(t);var t=z.textures.length-1;return H.textures.set(e,t),t}function c(e){var t=[e.geometry.uuid];if(Array.isArray(e.material))for(var r=0,n=e.material.length;r<n;r++)t.push(e.material[r].uuid);else t.push(e.material.uuid);var i=t.join(":");if(H.meshes.has(i))return H.meshes.get(i);var a=e.geometry,o=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;a.isBufferGeometry||(console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use BufferGeometry instead."),a=(new X).setFromObject(e));var s={},u={},l=[],c=[],d={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},f=a.getAttribute("normal");void 0===f||function(e){if(!H.attributesNormalized.has(e)){for(var t=new K,r=0,n=e.count;r<n;r++)if(5e-4<Math.abs(t.fromArray(e.array,3*r).length()-1))return;return 1}}(f)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",function(e){if(H.attributesNormalized.has(e))return H.attributesNormalized.get(e);for(var t=e.clone(),r=new K,n=0,i=t.count;n<i;n++)r.fromArray(t.array,3*n),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),r.toArray(t.array,3*n);return H.attributesNormalized.set(e,t),t}(f)));var h,p=null;for(y in a.attributes)"morph"!==y.substr(0,5)&&(M=a.attributes[y],y=d[y]||y.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(y)||(y="_"+y),H.attributes.has(B(M))?u[y]=H.attributes.get(B(M)):(p=null,h=M.array,"JOINTS_0"!==y||h instanceof Uint16Array||h instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),p=new Y(new Uint16Array(h),M.itemSize,M.normalized)),null!==(h=F(p||M,a))&&(u[y]=h,H.attributes.set(B(M),h))));if(void 0!==f&&a.setAttribute("normal",f),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&0<e.morphTargetInfluences.length){var m=[],g=[],_={};if(void 0!==e.morphTargetDictionary)for(var v in e.morphTargetDictionary)_[e.morphTargetDictionary[v]]=v;for(r=0;r<e.morphTargetInfluences.length;++r){var y,b={},x=!1;for(y in a.morphAttributes)if("position"===y||"normal"===y){var M=a.morphAttributes[y][r],w=y.toUpperCase(),T=a.attributes[y];if(H.attributes.has(B(M)))b[w]=H.attributes.get(B(M));else{var S=M.clone();if(!a.morphTargetsRelative)for(var E=0,C=M.count;E<C;E++)S.setXYZ(E,M.getX(E)-T.getX(E),M.getY(E)-T.getY(E),M.getZ(E)-T.getZ(E));b[w]=F(S,a),H.attributes.set(B(T),b[w])}}else x||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),x=!0);c.push(b),m.push(e.morphTargetInfluences[r]),void 0!==e.morphTargetDictionary&&g.push(_[r])}s.weights=m,0<g.length&&(s.extras={},s.extras.targetNames=g)}var A=N.forceIndices,O=Array.isArray(e.material);if(O&&0===a.groups.length)return null;!A&&null===a.index&&O&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),A=!0);f=!1;if(null===a.index&&A){for(var L=[],r=0,P=a.attributes.position.count;r<P;r++)L[r]=r;a.setIndex(L),f=!0}for(var I=O?e.material:[e.material],R=O?a.groups:[{materialIndex:0,start:void 0,count:void 0}],r=0,P=R.length;r<P;r++){var D={mode:o,attributes:u};j(a,D),0<c.length&&(D.targets=c),null!==a.index&&(U=B(a.index),void 0===R[r].start&&void 0===R[r].count||(U+=":"+R[r].start+":"+R[r].count),H.attributes.has(U)?D.indices=H.attributes.get(U):(D.indices=F(a.index,a,R[r].start,R[r].count),H.attributes.set(U,D.indices)),null===D.indices&&delete D.indices);var U=function(e){if(H.materials.has(e))return H.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;z.materials||(z.materials=[]);var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},W.KHR_materials_unlit=!0):e.isGLTFSpecularGlossinessMaterial?(t.extensions={KHR_materials_pbrSpecularGlossiness:{}},W.KHR_materials_pbrSpecularGlossiness=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r,n,i,a=e.color.toArray().concat([e.opacity]);return k(a,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=a),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.isGLTFSpecularGlossinessMaterial&&(t.pbrMetallicRoughness.baseColorFactor&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor),e.specular.toArray(a=[1,1,1],0),t.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=a,t.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=e.glossiness),(e.metalnessMap||e.roughnessMap)&&(e.metalnessMap===e.roughnessMap?(V(r={index:G(e.metalnessMap)},e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=r):console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.")),e.map&&(V(r={index:G(e.map)},e.map),e.isGLTFSpecularGlossinessMaterial&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=r),t.pbrMetallicRoughness.baseColorTexture=r),e.isGLTFSpecularGlossinessMaterial&&e.specularMap&&(V(n={index:G(e.specularMap)},e.specularMap),t.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=n),e.emissive&&(k(n=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray(),[0,0,0])||(t.emissiveFactor=n),e.emissiveMap&&(V(n={index:G(e.emissiveMap)},e.emissiveMap),t.emissiveTexture=n)),e.normalMap&&(i={index:G(e.normalMap)},e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),i.scale=e.normalScale.x),V(i,e.normalMap),t.normalTexture=i),e.aoMap&&(i={index:G(e.aoMap),texCoord:1},1!==e.aoMapIntensity&&(i.strength=e.aoMapIntensity),V(i,e.aoMap),t.occlusionTexture=i),e.transparent?t.alphaMode="BLEND":0<e.alphaTest&&(t.alphaMode="MASK",t.alphaCutoff=e.alphaTest),e.side===q&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),j(e,t),z.materials.push(t),t=z.materials.length-1,H.materials.set(e,t),t}(I[R[r].materialIndex]);null!==U&&(D.material=U),l.push(D)}f&&a.setIndex(null),s.primitives=l,z.meshes||(z.meshes=[]),z.meshes.push(s);s=z.meshes.length-1;return H.meshes.set(i,s),s}function d(e){z.nodes||(z.nodes=[]);var t,r,n,i={};if(N.trs?(t=e.quaternion.toArray(),r=e.position.toArray(),n=e.scale.toArray(),k(t,[0,0,0,1])||(i.rotation=t),k(r,[0,0,0])||(i.translation=r),k(n,[1,1,1])||(i.scale=n)):(e.matrixAutoUpdate&&e.updateMatrix(),k(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(i.matrix=e.matrix.elements)),""!==e.name&&(i.name=String(e.name)),j(e,i),e.isMesh||e.isLine||e.isPoints){var a=c(e);null!==a&&(i.mesh=a)}else if(e.isCamera)i.camera=function(e){z.cameras||(z.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:S.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),z.cameras.push(r),z.cameras.length-1}(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)W.KHR_lights_punctual||(z.extensions=z.extensions||{},z.extensions.KHR_lights_punctual={lights:[]},W.KHR_lights_punctual=!0),i.extensions=i.extensions||{},i.extensions.KHR_lights_punctual={light:(n={},(a=e).name&&(n.name=a.name),n.color=a.color.toArray(),n.intensity=a.intensity,a.isDirectionalLight?n.type="directional":a.isPointLight?(n.type="point",0<a.distance&&(n.range=a.distance)):a.isSpotLight&&(n.type="spot",0<a.distance&&(n.range=a.distance),n.spot={},n.spot.innerConeAngle=(a.penumbra-1)*a.angle*-1,n.spot.outerConeAngle=a.angle),void 0!==a.decay&&2!==a.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!a.target||a.target.parent===a&&0===a.target.position.x&&0===a.target.position.y&&-1===a.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),(a=z.extensions.KHR_lights_punctual.lights).push(n),a.length-1)};else if(e.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e),null;if(e.isSkinnedMesh&&M.push(e),0<e.children.length){for(var o=[],s=0,u=e.children.length;s<u;s++){var l=e.children[s];!l.visible&&!1!==N.onlyVisible||null!==(l=d(l))&&o.push(l)}0<o.length&&(i.children=o)}z.nodes.push(i);i=z.nodes.length-1;return g.set(e,i),i}function n(e){z.scenes||(z.scenes=[],z.scene=0);var t={};""!==e.name&&(t.name=e.name),z.scenes.push(t);for(var r=[],n=0,i=e.children.length;n<i;n++){var a=e.children[n];!a.visible&&!1!==N.onlyVisible||null!==(a=d(a))&&r.push(a)}0<r.length&&(t.nodes=r),j(e,t)}function b(e){e=e.map(function(e){return e instanceof DataView||e instanceof Uint8Array?e.buffer:e});var t=0;e.forEach(function(e){return t+=e.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e),n),n+=e.byteLength}),r.buffer}0<(N=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1,includeCustomExtensions:!1},N)).animations.length&&(N.trs=!0);var l,z={asset:{version:"2.0",generator:"GLTFExporter"}},m=0,x=[],f=[],g=new Map,M=[],W={},H={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map,assetSrcs:N.assetSrcs||{}},t=new Map,i=0;try{!function(e){e=e instanceof Array?e:[e];for(var t=[],r=0;r<e.length;r++)e[r]instanceof a?n(e[r]):t.push(e[r]);0<t.length&&function(e){var t=new a;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);n(t)}(t);for(r=0;r<M.length;++r)!function(e){var t=z.nodes[g.get(e)],r=e.skeleton;if(void 0!==r){e=e.skeleton.bones[0];if(void 0!==e){for(var n=[],i=new Float32Array(16*r.bones.length),a=0;a<r.bones.length;++a)n.push(g.get(r.bones[a])),r.boneInverses[a].toArray(i,16*a);void 0===z.skins&&(z.skins=[]),z.skins.push({inverseBindMatrices:F(new Y(i,16)),joints:n,skeleton:g.get(e)}),t.skin=z.skins.length-1}}}(M[r]);for(r=0;r<N.animations.length;++r)!function(e,t){z.animations||(z.animations=[]);for(var r=(e=w.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,n=[],i=[],a=0;a<r.length;++a){var o=r[a],s=E.parseTrackName(o.name),u=E.findNode(t,s.nodeName),l=L[s.propertyName];if(!(u="bones"===s.objectName?!0===u.isSkinnedMesh?u.skeleton.getBoneByName(s.objectIndex):void 0:u)||!l)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',o.name);var c,s=o.values.length/o.times.length;l===L.morphTargetInfluences&&(s/=u.morphTargetInfluences.length),!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(c="CUBICSPLINE",s/=3):c=o.getInterpolation()===T?"STEP":"LINEAR",i.push({input:F(new Y(o.times,1)),output:F(new Y(o.values,s)),interpolation:c}),n.push({sampler:i.length-1,target:{node:g.get(u),path:l}})}z.animations.push({name:e.name||"clip_"+z.animations.length,samplers:i,channels:n}),z.animations.length}(N.animations[r],e[0])}(e)}catch(e){throw console.error(e),e}Promise.all(f).then(function(){var e,t,r,n,i,a,o,s,u,l,c,d,f,h,p,m,g;O?(e=b(x),0<(l=Object.keys(W)).length&&(z.extensionsUsed=l),z.buffers&&0<z.buffers.length&&(z.buffers[0].byteLength=e.byteLength),!0===N.binary?(c=12,d=1179937895,f=2,h=8,p=1313821514,m=5130562,t=y(e),(r=new DataView(new ArrayBuffer(h))).setUint32(0,t.byteLength,!0),r.setUint32(4,m,!0),n=y(v(JSON.stringify(z)),32),(i=new DataView(new ArrayBuffer(h))).setUint32(0,n.byteLength,!0),i.setUint32(4,p,!0),a=new ArrayBuffer(c),(o=new DataView(a)).setUint32(0,d,!0),o.setUint32(4,f,!0),s=c+i.byteLength+n.byteLength+r.byteLength+t.byteLength,o.setUint32(8,s,!0),_(b([a,i,n,r,t]))):(z.buffers&&0<z.buffers.length&&(u="data:application/octet-stream;base64,"+(0,A.fromByteArray)(new Uint8Array(e)),z.buffers[0].uri=u),_(z))):(u=new Blob(x,{type:"application/octet-stream"}),0<(l=Object.keys(W)).length&&(z.extensionsUsed=l),z.buffers&&0<z.buffers.length&&(z.buffers[0].byteLength=u.size),!0===N.binary?(c=12,d=1179937895,f=2,h=8,p=1313821514,m=5130562,(g=new window.FileReader).readAsArrayBuffer(u),g.onloadend=function(){var e=y(g.result),t=new DataView(new ArrayBuffer(h));t.setUint32(0,e.byteLength,!0),t.setUint32(4,m,!0);var r=y(v(JSON.stringify(z)),32),n=new DataView(new ArrayBuffer(h));n.setUint32(0,r.byteLength,!0),n.setUint32(4,p,!0);var i=new ArrayBuffer(c),a=new DataView(i);a.setUint32(0,d,!0),a.setUint32(4,f,!0);var o=c+n.byteLength+r.byteLength+t.byteLength+e.byteLength;a.setUint32(8,o,!0);var e=new Blob([i,n,r,t,e],{type:"application/octet-stream"}),s=new window.FileReader;s.readAsArrayBuffer(e),s.onloadend=function(){_(s.result)}}):z.buffers&&0<z.buffers.length?((g=new window.FileReader).readAsDataURL(u),g.onloadend=function(){var e=g.result;z.buffers[0].uri=e,_(z)}):_(z))})}},w.Utils={insertKeyframe:function(e,t){var r,n=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),a=new e.ValueBufferType(e.values.length+n),o=e.createInterpolant(new e.ValueBufferType(n));if(0===e.times.length){i[0]=t;for(var s=0;s<n;s++)a[s]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;i[0]=t,i.set(e.times,1),a.set(o.evaluate(t),0),a.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),a.set(e.values,0),a.set(o.evaluate(t),e.values.length),r=i.length-1}else for(s=0;s<e.times.length;s++){if(Math.abs(e.times[s]-t)<.001)return s;if(e.times[s]<t&&e.times[s+1]>t){i.set(e.times.slice(0,s+1),0),i[s+1]=t,i.set(e.times.slice(s+1),s+2),a.set(e.values.slice(0,(s+1)*n),0),a.set(o.evaluate(t),(s+1)*n),a.set(e.values.slice((s+1)*n),(s+2)*n),r=s+1;break}}return e.times=i,e.values=a,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},i=e.tracks,a=0;a<i.length;++a){var o=i[a],s=E.parseTrackName(o.name),u=E.findNode(t,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(g)}var l=u.morphTargetInfluences.length,c=u.morphTargetDictionary[s.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);if(void 0!==n[u.uuid]){for(var d=o.createInterpolant(new o.ValueBufferType(1)),f=n[u.uuid],h=0;h<f.times.length;h++)f.values[h*l+c]=d.evaluate(f.times[h]);for(h=0;h<o.times.length;h++){var p=this.insertKeyframe(f,o.times[h]);f.values[p*l+c]=o.values[h]}}else{for(var m=new(f=o.clone()).ValueBufferType(l*f.times.length),h=0;h<f.times.length;h++)m[h*l+c]=f.values[h];f.name=".morphTargetInfluences",f.values=m,n[u.uuid]=f,r.push(f)}}else r.push(o)}return e.tracks=r,e}},r.GLTFExporter=w},{__183:76}],79:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,b,x,M,w,T,i=!1;r.DDSLoader=function(e){var t;return i||(i=!0,n=THREE.CompressedTextureLoader,b=1023,x=33778,M=33779,w=36196,T=33776),(t=function(e){n.call(this,e)}).prototype=Object.assign(Object.create(n.prototype),{constructor:t,parse:function(h,e){function t(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},n=t("DXT1"),i=t("DXT3"),a=t("DXT5"),o=t("ETC1"),s=new Int32Array(h,0,31);if(542327876!==s[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),r;if(4&!s[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),r;var u,l=s[21],c=!1;switch(l){case n:u=8,r.format=T;break;case i:u=16,r.format=x;break;case a:u=16,r.format=M;break;case o:u=8,r.format=w;break;default:if(!(32===s[22]&&16711680&s[23]&&65280&s[24]&&255&s[25]&&4278190080&s[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(255&l,l>>8&255,l>>16&255,l>>24&255)),r;c=!0,u=64,r.format=b}r.mipmapCount=1,131072&s[2]&&!1!==e&&(r.mipmapCount=Math.max(1,s[7]));e=s[28];if(r.isCubemap=!!(512&e),r.isCubemap&&(!(1024&e)||!(2048&e)||!(4096&e)||!(8192&e)||!(16384&e)||!(32768&e)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),r;r.width=s[4],r.height=s[3];for(var d,f,p=s[1]+4,m=r.isCubemap?6:1,g=0;g<m;g++)for(var _=r.width,v=r.height,y=0;y<r.mipmapCount;y++)c?d=(f=function(e,t){for(var r=e*t*4,n=new Uint8Array(h,p,r),i=new Uint8Array(r),a=0,o=0,s=0;s<t;s++)for(var u=0;u<e;u++){var l=n[o],c=n[++o],d=n[++o],f=n[++o];o++,i[a]=d,i[++a]=c,i[++a]=l,i[++a]=f,a++}return i}(_,v)).length:(d=Math.max(4,_)/4*Math.max(4,v)/4*u,f=new Uint8Array(h,p,d)),r.mipmaps.push({data:f,width:_,height:v}),p+=d,_=Math.max(_>>1,1),v=Math.max(v>>1,1);return r}}),new t(e)}},{}],80:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o,s,u,n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=!1;r.DRACOLoader=function(e){function l(e){n.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,navigator&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency/2,this.workerLimit=Math.max(4,e),this.workerLimit=Math.min(e,8)),this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD",uv2:"GENERIC"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array",uv2:"Float32Array"}}return a||(a=!0,t=THREE,o=t.BufferAttribute,s=t.BufferGeometry,u=t.FileLoader,n=t.Loader),l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,r,t,n){var i=this,a=new u(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&a.setWithCredentials(!0),a.load(e,function(e){var t={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,t).then(r).catch(n)},t,n)},decodeDracoFile:function(e,t,r,n){r={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,r).then(t)},decodeGeometry:function(r,n){var e,t=this;for(e in n.attributeTypes){var i=n.attributeTypes[e];void 0!==i.BYTES_PER_ELEMENT&&(n.attributeTypes[e]=i.name)}var a=JSON.stringify(n);if(l.taskCache.has(r)){var o=l.taskCache.get(r);if(o.key===a)return o.promise;if(0===r.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var s,u=this.workerNextTaskID++,o=r.byteLength,o=this._getWorker(u,o).then(function(e){return s=e,new Promise(function(e,t){s._callbacks[u]={resolve:e,reject:t},s.postMessage({type:"decode",id:u,taskConfig:n,buffer:r},[r])})}).then(function(e){return t._createGeometry(e.geometry)});return o.finally(function(){s&&u&&t._releaseTask(s,u)}),l.taskCache.set(r,{key:a,promise:o}),o},_createGeometry:function(e){var t=new s;e.index&&t.setIndex(new o(e.index.array,1));for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r],i=n.name,a=n.array,n=n.itemSize;t.setAttribute(i,new o(a,n))}return t},_loadLibrary:function(r,e){var n=new u(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),new Promise(function(e,t){n.load(r,e,void 0,t)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var r=this;if(this.decoderPending)return this.decoderPending;var n="object"!==("undefined"==typeof WebAssembly?"undefined":i(WebAssembly))||"js"===this.decoderConfig.type,e=[];return n?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(function(e){var t=e[0];n||(r.decoderConfig.wasmBinary=e[1]);e=l.DRACOWorker.toString(),e=["/* draco decoder */",t,"","/* worker */",e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))].join("\n");r.workerSourceURL=URL.createObjectURL(new Blob([e]))}),this.decoderPending},_getWorker:function(e,t){var n=this;return this._initDecoder().then(function(){var r;return n.workerPool.length<n.workerLimit?((r=new Worker(n.workerSourceURL))._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},n.workerPool.push(r)):n.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1}),(r=n.workerPool[n.workerPool.length-1])._taskCosts[e]=t,r._taskLoad+=t,r})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map(function(e){return e._taskLoad}))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),l.DRACOWorker=function(){function u(e,t,r,n){var i,a,o=n.attributeIDs,s=n.attributeTypes,u=t.GetEncodedGeometryType(r);if(u===e.TRIANGULAR_MESH)i=new e.Mesh,a=t.DecodeBufferToMesh(r,i);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");i=new e.PointCloud,a=t.DecodeBufferToPointCloud(r,i)}if(!a.ok()||0===i.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var l,c={index:null,attributes:[]};for(l in o){var d,f,h=self[s[l]];if(n.useUniqueIDs)f=o[l],d=t.GetAttributeByUniqueId(i,f);else{if(-1===(f=t.GetAttributeId(i,e[o[l]])))continue;d=t.GetAttribute(i,f)}c.attributes.push(function(e,t,r,n,i,a){var o,s,u=a.num_components(),l=r.num_points()*u;switch(i){case Float32Array:o=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,a,o),s=new Float32Array(l);break;case Int8Array:o=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,a,o),s=new Int8Array(l);break;case Int16Array:o=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,a,o),s=new Int16Array(l);break;case Int32Array:o=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,a,o),s=new Int32Array(l);break;case Uint8Array:o=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,a,o),s=new Uint8Array(l);break;case Uint16Array:o=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,a,o),s=new Uint16Array(l);break;case Uint32Array:o=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,a,o),s=new Uint32Array(l);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var c=0;c<l;c++)s[c]=o.GetValue(c);return e.destroy(o),{name:n,array:s,itemSize:u}}(e,t,i,l,h,d))}if(u===e.TRIANGULAR_MESH){for(var p=i.num_faces(),m=new Uint32Array(3*p),g=new e.DracoInt32Array,_=0;_<p;++_){t.GetFaceFromMesh(i,_,g);for(var v=0;v<3;++v)m[3*_+v]=g.GetValue(v)}c.index={array:m,itemSize:1},e.destroy(g)}return e.destroy(i),c}var r,t;onmessage=function(e){var a=e.data;switch(a.type){case"init":r=a.decoderConfig,t=new Promise(function(t){r.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(r)});break;case"decode":var o=a.buffer,s=a.taskConfig;t.then(function(e){var t=e.draco,r=new t.Decoder,e=new t.DecoderBuffer;e.Init(new Int8Array(o),o.byteLength);try{var n=u(t,r,e,s),i=n.attributes.map(function(e){return e.array.buffer});n.index&&i.push(n.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:n},i)}catch(e){console.error(e),self.postMessage({type:"error",id:a.id,error:e.message})}finally{t.destroy(e),t.destroy(r)}})}}},l.taskCache=new WeakMap,l.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},l.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},l.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},l.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")},new l(e);var t}},{}],81:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var W,l,H,Y,X,i,q,a,K,Z,o,J,Q,$,ee,te,re,ne,ie,ae,oe,se,ue,le,ce,de,fe,he,pe,me,ge,_e,ve,ye,be,xe,Me,we,Te,Se,Ee,Ce,Ae,Oe,Le,Pe,Ie,Re,De,Ue,Ne,Be,ke,je,Ve,Fe,Ge,ze,We,He,Ye,Xe,qe,Ke,Ze,Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe=!1;r.GLTFLoader=function(e){var n,p,m,g,_,v,y,b,d,x,M,w,T,E,f,h,S,c,C,A,O,L,P,s,u,I,R,D,U,N,B,k,j,V,F,G,z,t;return Qe||(Qe=!0,t=THREE,W=t.AnimationClip,l=t.Bone,H=t.Box3,Y=t.BufferAttribute,X=t.BufferGeometry,i=1001,q=t.Color,a=t.DirectionalLight,K=2,Z=t.FileLoader,o=0,J=t.Group,Q=t.InterleavedBuffer,$=t.InterleavedBufferAttribute,ee=t.Interpolant,te=2300,re=2301,ne=t.Line,ie=t.LineBasicMaterial,ae=t.LineLoop,oe=t.LineSegments,se=1006,ue=1008,le=1007,ce=t.Loader,de=t.LoaderUtils,fe=t.Material,he=t.Math,pe=t.Matrix4,me=t.Matrix3,ge=t.Mesh,_e=t.MeshBasicMaterial,ve=t.MeshPhysicalMaterial,ye=t.MeshStandardMaterial,be=1002,xe=1003,Me=1005,we=1004,Te=t.NumberKeyframeTrack,Se=t.Object3D,Ee=t.OrthographicCamera,Ce=t.PerspectiveCamera,Ae=t.PointLight,Oe=t.Points,Le=t.PointsMaterial,Pe=t.PropertyBinding,Ie=t.QuaternionKeyframeTrack,Re=1023,De=1022,Ue=1e3,Ne=t.Skeleton,Be=t.SkinnedMesh,ke=t.Sphere,je=t.SpotLight,Ve=0,Fe=t.TextureLoader,Ge=2,ze=1,We=t.Vector2,He=t.Vector3,Ye=t.VectorKeyframeTrack,Xe=3001,qe=t.Texture,Ke=t.ShaderMaterial),Ze||(n=function(){var r={};return{get:function(e){return r[e]},add:function(e,t){r[e]=t},remove:function(e){delete r[e]},removeAll:function(){r={}}}},p=function(e){if(!e)throw new Error("THREE._GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=L.MSFT_TEXTURE_DDS,this.ddsLoader=e},m=function(e){this.name=L.KHR_LIGHTS_PUNCTUAL;e=e.extensions&&e.extensions[L.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=e.lights||[]},g=function(){this.name=L.KHR_MATERIALS_UNLIT},_=function(){this.name=L.KHR_MATERIALS_CLEARCOAT},v=function(e){this.name=L.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,s);if(this.header={magic:de.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==P)throw new Error("THREE._GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE._GLTFLoader: Legacy binary file detected.");for(var r=new DataView(e,s),n=0;n<r.byteLength;){var i=r.getUint32(n,!0);if((n+=4)>=r.byteLength)break;var a,o=r.getUint32(n,!0);if((n+=4)>=r.byteLength)break;o===u.JSON?(a=new Uint8Array(e,s+n,i),this.content=de.decodeText(a)):o===u.BIN&&(this.body=e.slice(o=s+n,o+i)),n+=i}if(null===this.content)throw new Error("THREE._GLTFLoader: JSON content not found.")},y=function(e,t){if(!t)throw new Error("THREE._GLTFLoader: No DRACOLoader instance provided.");this.name=L.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()},b=function(){this.name=L.KHR_TEXTURE_TRANSFORM},d=function(e){ye.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var r=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),a=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),s={specular:{value:(new q).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var t in s)e.uniforms[t]=s[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",a),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){(s.glossinessMap.value=e)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)},x=function(){return{name:L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new q(1,1,1),e.opacity=1;var i=[];return Array.isArray(n.diffuseFactor)&&(t=n.diffuseFactor,e.color.fromArray(t),e.opacity=t[3]),void 0!==n.diffuseTexture&&i.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new q(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new q(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture&&(n=n.specularGlossinessTexture,i.push(r.assignTexture(e,"glossinessMap",n)),i.push(r.assignTexture(e,"specularMap",n))),Promise.all(i)},createMaterial:function(e){var t=new d(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=Ve,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}},M=function(){this.name=L.KHR_MESH_QUANTIZATION},w=function(p){this.name=L.KHR_TECHNIQUES_WEBGL,this.getMaterialType=function(){return Ke},this.getUniformTexture=function(t,e,r){return r.loadTexture(e).then(function(e){t.value=e})},this.extendParams=function(e,t,r){var n=p.extensions[this.name],i=t.extensions[this.name],a=n.techniques[i.technique];e.name=a.name;var o,t=n.programs[a.program],s=a.uniforms,u={},l=[];for(o in i.values)if(i.values.hasOwnProperty(o)&&s[o]){var c=i.values[o],d=s[o].type;u[o]={value:null};var f=u[o];switch(d){case I.FLOAT:f.value={value:c};break;case I.FLOAT_VEC2:f.value=(new We).fromArray(c);break;case I.FLOAT_VEC3:f.value=(new He).fromArray(c);break;case I.FLOAT_VEC4:f.value=(new q).fromArray(c);break;case I.FLOAT_MAT3:f.value=(new me).fromArray(c);break;case I.FLOAT_MAT4:f.value=(new pe).fromArray(c);break;case I.SAMPLER_2D:var h=c.index;l.push(this.getUniformTexture(f,h,r))}}return e.uniforms=u,n.shaders[t.fragmentShader],n.shaders[t.vertexShader],Promise.all(l)},this.createMaterial=function(e){return new Ke(e)}},T=function(e){this.name=L.CESIUM_RTC;e=(new He).fromArray(e.extensions[this.name].center);this.rtcCenterTransform=(new pe).setPosition(e)},E=function(e,t,r,n){ee.call(this,e,t,r,n)},f=function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)},h=function(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])},S=function(e,t){void 0!==t.extras&&("object"===Je(t.extras)?Object.assign(e.userData,t.extras):console.warn("THREE._GLTFLoader: Ignoring primitive type .extras, "+t.extras))},c=function(e){for(var t="",r=Object.keys(e).sort(),n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t},C=function(e,t,r){this.json=e||{},this.extensions=t||{},this.options=r||{},this.cache=new n,this.primitiveCache={},this.textureLoader=new Fe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Z(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)},A=function(r,e,n){var t,i,a=e.attributes,o=[];for(t in a){var s=B[t]||t.toLowerCase();s in r.attributes||o.push(function(e,t){return n.getDependency("accessor",e).then(function(e){r.setAttribute(t,e)})}(a[t],s))}return void 0===e.indices||r.index||(i=n.getDependency("accessor",e.indices).then(function(e){r.setIndex(e)}),o.push(i)),S(r,e),function(e,t,r){var n=t.attributes,i=new H;if(void 0!==n.POSITION){var a=(f=r.json.accessors[n.POSITION]).min,o=f.max;if(void 0!==a&&void 0!==o){i.set(new He(a[0],a[1],a[2]),new He(o[0],o[1],o[2]));var s=t.targets;if(void 0!==s){for(var u=new He,l=new He,c=0,d=s.length;c<d;c++){var f,h=s[c];void 0!==h.POSITION&&(a=(f=r.json.accessors[h.POSITION]).min,o=f.max,void 0!==a&&void 0!==o?(l.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),l.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),l.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),u.max(l)):console.warn("THREE._GLTFLoader: Missing min/max properties for accessor POSITION."))}i.expandByVector(u)}e.boundingBox=i;t=new ke;i.getCenter(t.center),t.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=t}else console.warn("THREE._GLTFLoader: Missing min/max properties for accessor POSITION.")}}(r,e,n),Promise.all(o).then(function(){return void 0!==e.targets?function(r,e,t){for(var n=!1,i=!1,a=0,o=e.length;a<o;a++)if(void 0!==(c=e[a]).POSITION&&(n=!0),void 0!==c.NORMAL&&(i=!0),n&&i)break;if(!n&&!i)return Promise.resolve(r);for(var s=[],u=[],a=0,o=e.length;a<o;a++){var l,c=e[a];n&&(l=void 0!==c.POSITION?t.getDependency("accessor",c.POSITION):r.attributes.position,s.push(l)),i&&(l=void 0!==c.NORMAL?t.getDependency("accessor",c.NORMAL):r.attributes.normal,u.push(l))}return Promise.all([Promise.all(s),Promise.all(u)]).then(function(e){var t=e[0],e=e[1];return n&&(r.morphAttributes.position=t),i&&(r.morphAttributes.normal=e),r.morphTargetsRelative=!0,r})}(r,e.targets,n):r})},O=function(e,t){var r=e.getIndex();if(null===r){var n=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE._GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)n.push(a);e.setIndex(n),r=e.getIndex()}var o=r.count-2,s=[];if(t===Ge)for(a=1;a<=o;a++)s.push(r.getX(0)),s.push(r.getX(a)),s.push(r.getX(a+1));else for(a=0;a<o;a++)a%2==0?(s.push(r.getX(a)),s.push(r.getX(a+1)),s.push(r.getX(a+2))):(s.push(r.getX(a+2)),s.push(r.getX(a+1)),s.push(r.getX(a)));s.length/3!=o&&console.error("THREE._GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");e=e.clone();return e.setIndex(s),e},(Ze=function(e){ce.call(this,e),this.dracoLoader=null,this.ddsLoader=null}).prototype=Object.assign(Object.create(ce.prototype),{constructor:Ze,load:function(r,n,e,t,i,a){var o=this,s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:de.extractUrlBase(r);o.manager.itemStart(r);function u(e){t?t(e):console.error(e),o.manager.itemError(r),o.manager.itemEnd(r)}var l=new Z(o.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&l.setWithCredentials(!0),l.load(r,function(e){try{var t;!i||(t=i(e))&&(e=t),o.parse(e,s,function(e){n(e),o.manager.itemEnd(r)},u,a)}catch(e){u(e)}},e,u)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,r,n,i){var a,o,s,u,l=Cesium,c={};if("string"==typeof e)a=e,o=JSON.parse(a);else if(e instanceof ArrayBuffer||e instanceof Uint8Array)if(e instanceof Uint8Array&&(e=e.slice().buffer),de.decodeText(new Uint8Array(e,0,4))===P)try{c[L.KHR_BINARY_GLTF]=new v(e),a=c[L.KHR_BINARY_GLTF].content,o=JSON.parse(a)}catch(t){try{o=l.parseGlb(new Uint8Array(e))}catch(e){return void(n&&n(e))}}else a=de.decodeText(new Uint8Array(e)),o=JSON.parse(a);else o=e;try{!(void 0===o.asset||o.asset.version[0]<2||o.asset.version<2)||1==(s=(o=l.updateVersion(o)).buffers).length&&s[0].extras&&s[0].extras._pipeline&&s[0].extras._pipeline.source&&(u=20+new Uint32Array(e.buffer||e,0,5)[3],o.binaryStart=u)}catch(e){return void(n&&n(e))}if(o.extensionsUsed)for(var d=0;d<o.extensionsUsed.length;++d){var f=o.extensionsUsed[d],h=o.extensionsRequired||[];switch(f){case L.KHR_LIGHTS_PUNCTUAL:c[f]=new m(o);break;case L.KHR_MATERIALS_CLEARCOAT:c[f]=new _;break;case L.KHR_MATERIALS_UNLIT:c[f]=new g;break;case L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:c[f]=new x;break;case L.KHR_DRACO_MESH_COMPRESSION:c[f]=new y(o,this.dracoLoader);break;case L.MSFT_TEXTURE_DDS:c[f]=new p(this.ddsLoader);break;case L.KHR_TEXTURE_TRANSFORM:c[f]=new b;break;case L.KHR_MESH_QUANTIZATION:c[f]=new M;break;case L.KHR_TECHNIQUES_WEBGL:c[f]=new w(o);break;case L.CESIUM_RTC:c[f]=new T(o);break;default:0<=h.indexOf(f)&&console.warn('THREE._GLTFLoader: Unknown extension "'+f+'".')}}new C(o,c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,loadTexture:i?i.loadTexture:void 0}).parse(r,n)}}),L={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds",KHR_TECHNIQUES_WEBGL:"KHR_techniques_webgl",CESIUM_RTC:"CESIUM_RTC"},m.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new q(16777215);void 0!==r.color&&n.fromArray(r.color);var i=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new a(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new Ae(n)).distance=i;break;case"spot":(t=new je(n)).distance=i,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE._GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},g.prototype.getMaterialType=function(){return _e},g.prototype.extendParams=function(e,t,r){var n=[];e.color=new q(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;return i&&(Array.isArray(i.baseColorFactor)&&(t=i.baseColorFactor,e.color.fromArray(t),e.opacity=t[3]),void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture))),Promise.all(n)},_.prototype.getMaterialType=function(){return ve},_.prototype.extendParams=function(e,t,r){var n=[],t=t.extensions[this.name];return void 0!==t.clearcoatFactor&&(e.clearcoat=t.clearcoatFactor),void 0!==t.clearcoatTexture&&n.push(r.assignTexture(e,"clearcoatMap",t.clearcoatTexture)),void 0!==t.clearcoatRoughnessFactor&&(e.clearcoatRoughness=t.clearcoatRoughnessFactor),void 0!==t.clearcoatRoughnessTexture&&n.push(r.assignTexture(e,"clearcoatRoughnessMap",t.clearcoatRoughnessTexture)),void 0!==t.clearcoatNormalTexture&&(n.push(r.assignTexture(e,"clearcoatNormalMap",t.clearcoatNormalTexture)),void 0!==t.clearcoatNormalTexture.scale)&&(t=t.clearcoatNormalTexture.scale,e.clearcoatNormalScale=new We(t,t)),Promise.all(n)},P="glTF",s=12,u={JSON:1313821514,BIN:5130562},y.prototype.decodePrimitive=function(e,t){var r,n=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,s={},u={},l={};for(r in o){var c=B[r]||r.toLowerCase();s[c]=o[r]}for(r in e.attributes){var d,f,c=B[r]||r.toLowerCase();void 0!==o[r]&&(d=n.accessors[e.attributes[r]],f=R[d.componentType],l[c]=f,u[c]=!0===d.normalized)}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(n){i.decodeDracoFile(e,function(e){for(var t in e.attributes){var r=e.attributes[t],t=u[t];void 0!==t&&(r.normalized=t)}n(e)},s,l)})})},b.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE._GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},((d.prototype=Object.create(ye.prototype)).constructor=d).prototype.copy=function(e){return ye.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},((E.prototype=Object.create(ee.prototype)).constructor=E).prototype.beforeStart_=E.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n,a=0;a!==n;a++)t[a]=r[i+a];return t},E.prototype.afterEnd_=E.prototype.copySampleValue_,E.prototype.interpolate_=function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,l=n-t,n=(r-t)/l,r=n*n,t=r*n,c=e*u,d=c-u,f=-2*t+3*r,h=t-r,p=1-f,m=h-r+n,g=0;g!==o;g++){var _=a[d+g+o],v=a[d+g+s]*l,y=a[c+g+o],b=a[c+g]*l;i[g]=p*_+m*v+f*y+h*b}return i},I={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},R={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},D={9728:xe,9729:se,9984:we,9985:le,9986:Me,9987:ue},U={33071:i,33648:be,10497:Ue},N={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},B={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},k={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},j={CUBICSPLINE:void 0,LINEAR:re,STEP:te},V="OPAQUE",F="MASK",G="BLEND",z={"image/png":Re,"image/jpeg":De},C.prototype.parse=function(t,r){var n=this,i=this,a=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(e){e={scene:e[0][a.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:a.asset,parser:i,userData:{}};h(o,e,a),S(e,a),o[L.CESIUM_RTC]&&(e.CESIUM_RTC=a.extensions[L.CESIUM_RTC].center),t(e)}).catch(function(e){n.cache.removeAll(),r(e)})},C.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},i={},a=0,o=t.length;a<o;a++)for(var s=t[a].joints,u=0,l=s.length;u<l;u++)e[s[u]].isBone=!0;for(var c=0,d=e.length;c<d;c++){var f=e[c];void 0!==f.mesh&&(void 0===n[f.mesh]&&(n[f.mesh]=i[f.mesh]=0),n[f.mesh]++,void 0!==f.skin&&(r[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=i},C.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;case"light":n=this.extensions[L.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},C.prototype.getDependencies=function(r){var n,e,t=this.cache.get(r);return t||(e=(n=this).json[r+("mesh"===r?"es":"s")]||[],t=Promise.all(e.map(function(e,t){return n.getDependency(r,t)})),this.cache.add(r,t)),t},C.prototype.loadBuffer=function(e){var r=this.json.buffers[e],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE._GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===e)return r.extras&&r.extras._pipeline?Promise.resolve(r.extras._pipeline.source.buffer):Promise.resolve(this.extensions[L.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,t){r.extras&&r.extras._pipeline?e(r.extras._pipeline.source.buffer):n.load(f(r.uri,i.path),e,void 0,function(){t(new Error('THREE._GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},C.prototype.loadBufferView=function(e){var n=this.json.bufferViews[e],i=this.json.binaryStart||0;return this.getDependency("buffer",n.buffer).then(function(e){var t=n.byteLength||0,r=n.byteOffset||0;return e.slice(i+r,i+r+t)})},C.prototype.loadAccessor=function(e){var v=this,y=this.json,b=this.json.accessors[e];if(void 0===b.bufferView&&void 0===b.sparse)return Promise.resolve(null);e=[];return void 0!==b.bufferView?e.push(this.getDependency("bufferView",b.bufferView)):e.push(null),void 0!==b.sparse&&(e.push(this.getDependency("bufferView",b.sparse.indices.bufferView)),e.push(this.getDependency("bufferView",b.sparse.values.bufferView))),Promise.all(e).then(function(e){var t,r,n,i=e[0],a=N[b.type],o=R[b.componentType],s=o.BYTES_PER_ELEMENT,u=b.byteOffset||0,l=void 0!==b.bufferView?y.bufferViews[b.bufferView].byteStride:void 0,c=!0===b.normalized,d=l&&l!==s*a?(t=Math.floor(u/l),r="InterleavedBuffer:"+b.bufferView+":"+b.componentType+":"+t+":"+b.count,(n=v.cache.get(r))||(f=new o(i,t*l,b.count*l/s),n=new Q(f,l/s),v.cache.add(r,n)),new $(n,a,u%l/s,c)):(f=null===i?new o(b.count*a):new o(i,u,b.count*a),new Y(f,a,c));if(void 0!==b.sparse){var u=R[b.sparse.indices.componentType],f=b.sparse.indices.byteOffset||0,c=b.sparse.values.byteOffset||0,h=new u(e[1],f,b.sparse.count*N.SCALAR),p=new o(e[2],c,b.sparse.count*a);null!==i&&(d=new Y(d.array.slice(),d.itemSize,d.normalized));for(var m=0,g=h.length;m<g;m++){var _=h[m];if(d.setX(_,p[m*a]),2<=a&&d.setY(_,p[m*a+1]),3<=a&&d.setZ(_,p[m*a+2]),4<=a&&d.setW(_,p[m*a+3]),5<=a)throw new Error("THREE._GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d})},C.prototype.loadTexture=function(e){var t=this,r=this.json,s=this.options,n=this.textureLoader,i=self.URL||self.webkitURL,a=r.textures[e],u=a.extensions||{},o=u[L.MSFT_TEXTURE_DDS]?r.images[u[L.MSFT_TEXTURE_DDS].source]:r.images[a.source],e="texture-"+JSON.stringify(a),e=this.cache.get(e);if(a.name&&e)return e;var l=o.uri,c=!1;return void 0!==o.bufferView&&(l=t.getDependency("bufferView",o.bufferView).then(function(e){c=!0;e=new Blob([e],{type:o.mimeType});return l=i.createObjectURL(e)})),e=Promise.resolve(l).then(function(a){var o=(o=s.manager.getHandler(a))||(u[L.MSFT_TEXTURE_DDS]?t.extensions[L.MSFT_TEXTURE_DDS].ddsLoader:n);return new Promise(function(e,t){if(0==s.loadTexture){var r=new qe,n=f(a,s.path),i=0<n.search(/\.jpe?g($|\?)/i)||0===n.search(/^data\:image\/jpeg/);return r.format=i?De:Re,r.image=n,void e(r)}o.load(f(a,s.path),e,void 0,function(e){t("Failed to load image "+a)})})}).then(function(e){!0===c&&i.revokeObjectURL(l),e.flipY=!1,a.name&&(e.name=a.name),o.mimeType in z&&(e.format=z[o.mimeType]);var t=(r.samplers||{})[a.sampler]||{};return e.magFilter=D[t.magFilter]||se,e.minFilter=D[t.minFilter]||ue,e.wrapS=U[t.wrapS]||Ue,e.wrapT=U[t.wrapT]||Ue,e}),this.cache.add("texture-"+a.name,e),e},C.prototype.assignTexture=function(r,n,i){var a=this;return this.getDependency("texture",i.index).then(function(e){if(!e.isCompressedTexture)switch(n){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":e.format=De}var t;void 0===i.texCoord||0==i.texCoord||"aoMap"===n&&1==i.texCoord||console.warn("THREE._GLTFLoader: Custom UV set "+i.texCoord+" for texture "+n+" not yet supported."),a.extensions[L.KHR_TEXTURE_TRANSFORM]&&(t=void 0!==i.extensions?i.extensions[L.KHR_TEXTURE_TRANSFORM]:void 0)&&(e=a.extensions[L.KHR_TEXTURE_TRANSFORM].extendTexture(e,t)),r[n]=e})},C.prototype.assignFinalMaterial=function(e){var t,r,n,i=e.geometry,a=e.material,o=void 0!==i.attributes.tangent,s=void 0!==i.attributes.color,u=void 0===i.attributes.normal,l=!0===e.isSkinnedMesh,c=0<Object.keys(i.morphAttributes).length,d=c&&void 0!==i.morphAttributes.normal;e.isPoints?(r="PointsMaterial:"+a.uuid,(t=this.cache.get(r))||(t=new Le,fe.prototype.copy.call(t,a),t.color.copy(a.color),t.map=a.map,t.sizeAttenuation=!1,this.cache.add(r,t)),a=t):e.isLine&&(r="LineBasicMaterial:"+a.uuid,(n=this.cache.get(r))||(n=new ie,fe.prototype.copy.call(n,a),n.color.copy(a.color),this.cache.add(r,n)),a=n),(o||s||u||l||c)&&(r="ClonedMaterial:"+a.uuid+":",a.isGLTFSpecularGlossinessMaterial&&(r+="specular-glossiness:"),l&&(r+="skinning:"),o&&(r+="vertex-tangents:"),s&&(r+="vertex-colors:"),u&&(r+="flat-shading:"),c&&(r+="morph-targets:"),d&&(r+="morph-normals:"),(n=this.cache.get(r))||(n=a.clone(),l&&(n.skinning=!0),o&&(n.vertexTangents=!0),s&&(n.vertexColors=!0),u&&(n.flatShading=!0),c&&(n.morphTargets=!0),d&&(n.morphNormals=!0),this.cache.add(r,n)),a=n),a.aoMap&&void 0===i.attributes.uv2&&void 0!==i.attributes.uv&&i.setAttribute("uv2",new Y(i.attributes.uv.array,2)),a.normalScale&&!o&&(a.normalScale.y=-a.normalScale.y),a.clearcoatNormalScale&&!o&&(a.clearcoatNormalScale.y=-a.clearcoatNormalScale.y),e.material=a},C.prototype.loadMaterial=function(e){var t,r,n,i,a=this,o=this.json,s=this.extensions,u=o.materials[e],l={},o=u.extensions||{},e=[];o[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?((t=s[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS])||(t=new x,s[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=t),r=t.getMaterialType(),e.push(t.extendParams(l,u,a))):o[L.KHR_MATERIALS_UNLIT]?(t=s[L.KHR_MATERIALS_UNLIT],r=t.getMaterialType(),e.push(t.extendParams(l,u,a))):(o[L.KHR_TECHNIQUES_WEBGL]&&(n={},i=s[L.KHR_TECHNIQUES_WEBGL],e.push(i.extendParams(n,u,a))),r=ye,c=u.pbrMetallicRoughness||{},l.color=new q(1,1,1),l.opacity=1,Array.isArray(c.baseColorFactor)&&(i=c.baseColorFactor,l.color.fromArray(i),l.opacity=i[3]),void 0!==c.baseColorTexture&&e.push(a.assignTexture(l,"map",c.baseColorTexture)),l.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,l.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture&&(e.push(a.assignTexture(l,"metalnessMap",c.metallicRoughnessTexture)),e.push(a.assignTexture(l,"roughnessMap",c.metallicRoughnessTexture)))),!0===u.doubleSided&&(l.side=K);var c=u.alphaMode||V;return c===G?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,c===F&&(l.alphaTest=void 0!==u.alphaCutoff?u.alphaCutoff:.5)),void 0!==u.normalTexture&&r!==_e&&(e.push(a.assignTexture(l,"normalMap",u.normalTexture)),l.normalScale=new We(1,1),void 0!==u.normalTexture.scale&&l.normalScale.set(u.normalTexture.scale,u.normalTexture.scale)),void 0!==u.occlusionTexture&&r!==_e&&(e.push(a.assignTexture(l,"aoMap",u.occlusionTexture)),void 0!==u.occlusionTexture.strength&&(l.aoMapIntensity=u.occlusionTexture.strength)),void 0!==u.emissiveFactor&&r!==_e&&(l.emissive=(new q).fromArray(u.emissiveFactor)),void 0!==u.emissiveTexture&&r!==_e&&e.push(a.assignTexture(l,"emissiveMap",u.emissiveTexture)),o[L.KHR_MATERIALS_CLEARCOAT]&&(c=s[L.KHR_MATERIALS_CLEARCOAT],r=c.getMaterialType(),e.push(c.extendParams(l,{extensions:o},a))),Promise.all(e).then(function(){var e=r===d?s[L.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):(n&&((e=n.uniforms.u_diffuse)&&(e.value.isTexture?l.map=e.value:l.color=e.value),(e=n.uniforms.u_emission)&&(e.value.isTexture?l.emissiveMap=e.value:l.emissive=e.value),(e=n.uniforms.u_shininess)&&(l.shininess=e.value)),new r(l));return u.name&&(e.name=u.name),e.map&&(e.map.encoding=Xe),e.emissiveMap&&(e.emissiveMap.encoding=Xe),S(e,u),u.extensions&&h(s,e,u),e})},C.prototype.loadGeometries=function(e){for(var r=this,n=this.extensions,t=this.primitiveCache,i=[],a=0,o=e.length;a<o;a++){var s=e[a],u=(u=void 0,(u=(l=s).extensions&&l.extensions[L.KHR_DRACO_MESH_COMPRESSION])?"draco:"+u.bufferView+":"+u.indices+":"+c(u.attributes):l.indices+":"+c(l.attributes)+":"+l.mode),l=t[u];l?i.push(l.promise):(l=s.extensions&&s.extensions[L.KHR_DRACO_MESH_COMPRESSION]?function(t){return n[L.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,r).then(function(e){return A(e,t,r)})}(s):A(new X,s,r),t[u]={primitive:s,promise:l},i.push(l))}return Promise.all(i)},C.prototype.loadMesh=function(d){for(var f=this,h=this.json.meshes[d],p=h.primitives,e=[],t=0,r=p.length;t<r;t++){var n=void 0===p[t].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new ye({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:o})),n.DefaultMaterial):this.getDependency("material",p[t].material);e.push(n)}return e.push(f.loadGeometries(p)),Promise.all(e).then(function(e){for(var t=e.slice(0,e.length-1),r=e[e.length-1],n=[],i=0,a=r.length;i<a;i++){var o,s=r[i],u=p[i],l=t[i];if(u.mode===I.TRIANGLES||u.mode===I.TRIANGLE_STRIP||u.mode===I.TRIANGLE_FAN||void 0===u.mode)!0!==(o=new(!0===h.isSkinnedMesh?Be:ge)(s,l)).isSkinnedMesh||o.geometry.attributes.skinWeight.normalized||o.normalizeSkinWeights(),u.mode===I.TRIANGLE_STRIP?o.geometry=O(o.geometry,ze):u.mode===I.TRIANGLE_FAN&&(o.geometry=O(o.geometry,Ge));else if(u.mode===I.LINES)o=new oe(s,l);else if(u.mode===I.LINE_STRIP)o=new ne(s,l);else if(u.mode===I.LINE_LOOP)o=new ae(s,l);else{if(u.mode!==I.POINTS)throw new Error("THREE._GLTFLoader: Primitive mode unsupported: "+u.mode);o=new Oe(s,l)}0<Object.keys(o.geometry.morphAttributes).length&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(r=0,n=i.length;r<n;r++)e.morphTargetDictionary[i[r]]=r}else console.warn("THREE._GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(o,h),o.name=h.name||"mesh_"+d,1<r.length&&(o.name+="_"+i),S(o,h),f.assignFinalMaterial(o),n.push(o)}if(1===n.length)return n[0];for(var c=new J,i=0,a=n.length;i<a;i++)c.add(n[i]);return c})},C.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],e=r[r.type];return e?("perspective"===r.type?t=new Ce(he.radToDeg(e.yfov),e.aspectRatio||1,e.znear||1,e.zfar||2e6):"orthographic"===r.type&&(t=new Ee(e.xmag/-2,e.xmag/2,e.ymag/2,e.ymag/-2,e.znear,e.zfar)),r.name&&(t.name=r.name),S(t,r),Promise.resolve(t)):void console.warn("THREE._GLTFLoader: Missing camera parameters.")},C.prototype.loadSkin=function(e){var e=this.json.skins[e],t={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(t):this.getDependency("accessor",e.inverseBindMatrices).then(function(e){return t.inverseBindMatrices=e,t})},C.prototype.loadAnimation=function(T){for(var S=this.json.animations[T],e=[],t=[],r=[],n=[],i=[],a=0,o=S.channels.length;a<o;a++){var s=S.channels[a],u=S.samplers[s.sampler],l=s.target,c=void 0!==l.node?l.node:l.id,d=void 0!==S.parameters?S.parameters[u.input]:u.input,s=void 0!==S.parameters?S.parameters[u.output]:u.output;e.push(this.getDependency("node",c)),t.push(this.getDependency("accessor",d)),r.push(this.getDependency("accessor",s)),n.push(u),i.push(l)}return Promise.all([Promise.all(e),Promise.all(t),Promise.all(r),Promise.all(n),Promise.all(i)]).then(function(e){for(var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=[],s=0,u=t.length;s<u;s++){var l,c=t[s],d=r[s],f=n[s],h=i[s],p=a[s];if(void 0!==c){switch(c.updateMatrix(),c.matrixAutoUpdate=!0,k[p.path]){case k.weights:l=Te;break;case k.rotation:l=Ie;break;default:l=Ye}var m=c.name||c.uuid,g=void 0!==h.interpolation?j[h.interpolation]:re,_=[];k[p.path]===k.weights?c.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&_.push(e.name||e.uuid)}):_.push(m);var v,y=f.array;if(f.normalized){if(y.constructor===Int8Array)v=1/127;else if(y.constructor===Uint8Array)v=1/255;else if(y.constructor==Int16Array)v=1/32767;else{if(y.constructor!==Uint16Array)throw new Error("THREE._GLTFLoader: Unsupported output accessor component type.");v=1/65535}for(var b=new Float32Array(y.length),x=0,M=y.length;x<M;x++)b[x]=y[x]*v;y=b}for(x=0,M=_.length;x<M;x++){var w=new l(_[x]+"."+k[p.path],d.array,y,g);"CUBICSPLINE"===h.interpolation&&(w.createInterpolant=function(e){return new E(this.times,this.values,this.getValueSize()/3,e)},w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),o.push(w)}}}return new W(S.name||"animation_"+T,void 0,o)})},C.prototype.loadNode=function(e){var t=this.json,a=this.extensions,r=this,n=t.meshReferences,i=t.meshUses,o=t.nodes[e];return e=[],void 0!==o.mesh&&e.push(r.getDependency("mesh",o.mesh).then(function(e){var t,r;return 1<n[o.mesh]?(t=i[o.mesh]++,(r=e.clone()).name+="_instance_"+t):r=e,void 0!==o.weights&&r.traverse(function(e){if(e.isMesh)for(var t=0,r=o.weights.length;t<r;t++)e.morphTargetInfluences[t]=o.weights[t]}),r})),void 0!==o.camera&&e.push(r.getDependency("camera",o.camera)),o.extensions&&o.extensions[L.KHR_LIGHTS_PUNCTUAL]&&void 0!==o.extensions[L.KHR_LIGHTS_PUNCTUAL].light&&e.push(r.getDependency("light",o.extensions[L.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e).then(function(e){var t,r;if((t=!0===o.isBone?new l:1<e.length?new J:1===e.length?e[0]:new Se)!==e[0])for(var n=0,i=e.length;n<i;n++)t.add(e[n]);return o.name&&(t.userData.name=o.name,t.name=Pe.sanitizeNodeName(o.name)),S(t,o),o.extensions&&h(a,t,o),void 0!==o.matrix?((r=new pe).fromArray(o.matrix),t.applyMatrix4(r)):(void 0!==o.translation&&t.position.fromArray(o.translation),void 0!==o.rotation&&t.quaternion.fromArray(o.rotation),void 0!==o.scale&&t.scale.fromArray(o.scale)),t})},C.prototype.loadScene=function(e){var t=this.json,r=this.extensions,e=this.json.scenes[e],n=new J;e.name&&(n.name=e.name),S(n,e),e.extensions&&h(r,n,e);for(var i=e.nodes||[],a=[],o=0,s=i.length;o<s;o++)a.push(function o(e,s,u,l){var c=u.nodes[e];return l.getDependency("node",e).then(function(e){return void 0===c.skin?e:l.getDependency("skin",c.skin).then(function(e){for(var t=[],r=0,n=(s=e).joints.length;r<n;r++)t.push(l.getDependency("node",s.joints[r]));return Promise.all(t)}).then(function(o){return e.traverse(function(e){if(e.isMesh){for(var t=[],r=[],n=0,i=o.length;n<i;n++){var a=o[n];a?(t.push(a),a=new pe,void 0!==s.inverseBindMatrices&&a.fromArray(s.inverseBindMatrices.array,16*n),r.push(a)):console.warn('THREE._GLTFLoader: Joint "%s" could not be found.',s.joints[n])}e.bind(new Ne(t,r),e.matrixWorld)}}),e});var s}).then(function(e){s.add(e);var t=[];if(c.children)for(var r=c.children,n=0,i=r.length;n<i;n++){var a=r[n];t.push(o(a,e,u,l))}return Promise.all(t)})}(i[o],n,t,this));return Promise.all(a).then(function(){return n})}),new Ze(e)}},{}],82:[function(e,t,r){!function(l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=(function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}(t,null,[{key:"decodeArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)return new l(0);for(var r,n=[],i=0,a=0;a<e.length;a++)i+=(r="function"==typeof l.from?l.from(e[a],"base64"):new l(e[a],"base64")).length,t.push(i),n.push(r);if(1===e.length)return n[0];for(var o=new l(i),s=0,u=0;u<e.length;u++)n[u].copy(o,s),s+=n[u].length;return o}}]),t);function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.Base64Encoder=e}.call(this,e("buffer").Buffer)},{buffer:206}],83:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Constants={INDENT_VALUE:2,Sizes:{BOOL_SIZE:1,CHAR_SIZE:1,SHORT_SIZE:2,INT_SIZE:4,LONG_SIZE:4,INT64_SIZE:8,FLOAT_SIZE:4,DOUBLE_SIZE:8,GLENUM_SIZE:4},TypeIds:{ID_BYTE_ARRAY:0,ID_UBYTE_ARRAY:1,ID_SHORT_ARRAY:2,ID_USHORT_ARRAY:3,ID_INT_ARRAY:4,ID_UINT_ARRAY:5,ID_FLOAT_ARRAY:6,ID_DOUBLE_ARRAY:7,ID_VEC2B_ARRAY:8,ID_VEC3B_ARRAY:9,ID_VEC4B_ARRAY:10,ID_VEC4UB_ARRAY:11,ID_VEC2S_ARRAY:12,ID_VEC3S_ARRAY:13,ID_VEC4S_ARRAY:14,ID_VEC2_ARRAY:15,ID_VEC3_ARRAY:16,ID_VEC4_ARRAY:17,ID_VEC2D_ARRAY:18,ID_VEC3D_ARRAY:19,ID_VEC4D_ARRAY:20,ID_VEC2UB_ARRAY:21,ID_VEC3UB_ARRAY:22,ID_VEC2US_ARRAY:23,ID_VEC3US_ARRAY:24,ID_VEC4US_ARRAY:25,ID_VEC2I_ARRAY:26,ID_VEC3I_ARRAY:27,ID_VEC4I_ARRAY:28,ID_VEC2UI_ARRAY:29,ID_VEC3UI_ARRAY:30,ID_VEC4UI_ARRAY:31,ID_UINT64_ARRAY:32,ID_INT64_ARRAY:33,ID_DRAWARRAYS:50,ID_DRAWARRAY_LENGTH:51,ID_DRAWELEMENTS_UBYTE:52,ID_DRAWELEMENTS_USHORT:53,ID_DRAWELEMENTS_UINT:54}}},{}],84:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e},a=r.ObjectGLEnum=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;n(this,e),this.value=t},o=r.ObjectMark=function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;n(this,e),this.name=t,this.indent=r},i=r.ObjectProperty=(i(s,[{key:"set",value:function(e){return"string"==typeof e?this.name=e:"number"==typeof e&&(this.value=e),this}}]),s);function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];n(this,s),this.name=e,this.value=t,this.mapProperty=r}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.DataTypes={ObjectProperty:i,ObjectMark:o,ObjectGLEnum:a}},{}],85:[function(e,t,r){"use strict";function n(e,t){var r="";if(t>i.LOG&&(r=Object.keys(i).filter(function(e){return i[e]===t})+" : "),t>o.level&&console.log(r+e),a)try{a(e,t)}catch(e){}}Object.defineProperty(r,"__esModule",{value:!0});var i={LOG:1,WARN:2,ERROR:3,FATAL:4},a=null,o=function(e){return n(e,i.LOG)};o.log=function(e){return n(e,i.LOG)},o.warn=function(e){return n(e,i.WARN)},o.error=function(e){return n(e,i.ERROR)},o.fatal=function(e){return n(e,i.FATAL)},o.setLogLog=function(){o.level=i.LOG},o.setLogWarn=function(){o.level=i.WARN},o.setLogError=function(){o.level=i.ERROR},o.setLogFatal=function(){o.level=i.FATAL},o.setLogOff=function(){o.level=Number.MAX_VALUE},o.level=i.WARN,r.Log=o},{}],86:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ArrayTableEnum={ByteArray:0,UByteArray:1,ShortArray:2,UShortArray:3,IntArray:4,UIntArray:5,FloatArray:6,DoubleArray:7,Vec2bArray:8,Vec3bArray:9,Vec4bArray:10,Vec2ubArray:21,Vec3ubArray:22,Vec4ubArray:11,Vec2sArray:12,Vec3sArray:13,Vec4sArray:14,Vec2usArray:23,Vec3usArray:24,Vec4usArray:25,Vec2fArray:15,Vec3fArray:16,Vec4fArray:17,Vec2dArray:18,Vec3dArray:19,Vec4dArray:20,Vec2iArray:26,Vec3iArray:27,Vec4iArray:28,Vec2uiArray:29,Vec3uiArray:30,Vec4uiArray:31}},{}],87:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.AttributeBinding={BIND_OFF:0,BIND_OVERALL:1,BIND_PER_PRIMITIVE_SET:2,BIND_PER_PRIMITIVE:3,BIND_PER_VERTEX:4}},{}],88:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CenterMode={USE_BOUNDING_SPHERE_CENTER:0,USER_DEFINED_CENTER:1,UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED:2}},{}],89:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FaceMode=void 0;e=e("M_184"),e={FRONT:e.GLEnum.FRONT,BACK:e.GLEnum.BACK,FRONT_AND_BACK:e.GLEnum.FRONT_AND_BACK};r.FaceMode=e},{M_184:91}],90:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EnumToString=function(e,t){for(var r in e)if(e[r]==t)return r}},{}],91:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GLEnum={GL_ALPHA_TEST:3008,GL_BLEND:3042,GL_COLOR_LOGIC_OP:3058,GL_COLOR_MATERIAL:2903,GL_CULL_FACE:2884,GL_DEPTH_TEST:2929,GL_FOG:2912,GL_FRAGMENT_PROGRAM_ARB:34820,GL_LINE_STIPPLE:2852,GL_POINT_SMOOTH:2832,GL_POINT_SPRITE_ARB:34913,GL_POLYGON_OFFSET_FILL:32823,GL_POLYGON_OFFSET_LINE:10754,GL_POLYGON_OFFSET_POINT:10753,GL_POLYGON_STIPPLE:2882,GL_SCISSOR_TEST:3089,GL_STENCIL_TEST:2960,GL_STENCIL_TEST_TWO_SIDE:35088,GL_VERTEX_PROGRAM_ARB:34336,GL_COLOR_SUM:33880,GL_LIGHTING:2896,GL_NORMALIZE:2977,GL_RESCALE_NORMAL:32826,GL_TEXTURE_1D:3552,GL_TEXTURE_2D:3553,GL_TEXTURE_3D:32879,GL_TEXTURE_CUBE_MAP:34067,GL_TEXTURE_RECTANGLE:34037,GL_TEXTURE_GEN_Q:3171,GL_TEXTURE_GEN_R:3170,GL_TEXTURE_GEN_S:3168,GL_TEXTURE_GEN_T:3169,GL_CLIP_PLANE0:12288,GL_CLIP_PLANE1:12289,GL_CLIP_PLANE2:12290,GL_CLIP_PLANE3:12291,GL_CLIP_PLANE4:12292,GL_CLIP_PLANE5:12293,GL_LIGHT0:16384,GL_LIGHT1:16385,GL_LIGHT2:16386,GL_LIGHT3:16387,GL_LIGHT4:16388,GL_LIGHT5:16389,GL_LIGHT6:16390,GL_LIGHT7:16391,GL_VERTEX_PROGRAM_POINT_SIZE:34370,GL_VERTEX_PROGRAM_TWO_SIDE:34371,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,REPLACE:7681,MODULATE:8448,ADD:260,ADD_SIGNED:34164,INTERPOLATE:34165,SUBTRACT:34023,DOT3_RGB:34478,DOT3_RGBA:34479,CONSTANT:34166,PRIMARY_COLOR:34167,PREVIOUS:34168,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,CLAMP:10496,CLAMP_TO_EDGE:33071,CLAMP_TO_BORDER:33069,REPEAT:10497,MIRROR:33648,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,GL_INTENSITY:32841,GL_LUMINANCE:6409,GL_ALPHA:6406,GL_LUMINANCE_ALPHA:6410,GL_RGB:6407,GL_RGBA:6408,GL_COMPRESSED_ALPHA_ARB:34025,GL_COMPRESSED_LUMINANCE_ARB:34026,GL_COMPRESSED_INTENSITY_ARB:34028,GL_COMPRESSED_LUMINANCE_ALPHA_ARB:34027,GL_COMPRESSED_RGB_ARB:34029,GL_COMPRESSED_RGBA_ARB:34030,GL_COMPRESSED_RGB_S3TC_DXT1_EXT:33776,GL_COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,GL_COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,GL_COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,GL_ETC1_RGB8_OES:36196,GL_COMPRESSED_RGB8_ETC2:37492,GL_COMPRESSED_SRGB8_ETC2:37493,GL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,GL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,GL_COMPRESSED_RGBA8_ETC2_EAC:37496,GL_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,GL_COMPRESSED_R11_EAC:37488,GL_COMPRESSED_SIGNED_R11_EAC:37489,GL_COMPRESSED_RG11_EAC:37490,GL_COMPRESSED_SIGNED_RG11_EAC:37491,GL_BYTE:5120,GL_SHORT:5122,GL_INT:5124,GL_FLOAT:5126,GL_DOUBLE:5130,GL_UNSIGNED_BYTE:5121,GL_UNSIGNED_SHORT:5123,GL_UNSIGNED_INT:5125,DST_ALPHA:772,DST_COLOR:774,ONE:1,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,ZERO:0,COORDINATE:33873,DEPTH:33874,FOG_HINT:3156,GENERATE_MIPMAP_HINT:33170,LINE_SMOOTH_HINT:3154,PERSPECTIVE_CORRECTION_HINT:3152,POINT_SMOOTH_HINT:3153,POLYGON_SMOOTH_HINT:3155,TEXTURE_COMPRESSION_HINT:34031,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,POINT:6912,LINE:6913,FILL:6912,BACK:1029,FRONT:1028,FRONT_AND_BACK:1032,FIXED_ONLY:35101,FASTEST:4353,NICEST:4353,DONT_CARE:4352}},{}],92:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ImageType={IMAGE_INLINE_DATA:0,IMAGE_INLINE_FILE:1,IMAGE_EXTERNAL:2}},{}],93:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ColorMode={AMBIENT:4608,DIFFUSE:4609,SPECULAR:4610,EMISSION:5632,AMBIENT_AND_DIFFUSE:5634,OFF:5635}},{}],94:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectDataVariance={DYNAMIC:0,STATIC:1,UNSPECIFIED:2}},{}],95:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PrimitiveMode={POINTS:0,LINES:1,LINE_STRIP:3,LINE_LOOP:2,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,GL_QUADS:7}},{}],96:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PrimitiveTableEnum={DrawArrays:50,DrawArraysLength:51,DrawElementsUByte:52,DrawElementsUShort:53,DrawElementsUInt:54,GL_POINTS:0,GL_LINES:1,GL_LINE_STRIP:3,GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6,GL_QUADS:7,GL_QUAD_STRIP:8,GL_POLYGON:9,GL_LINES_ADJACENCY:10,GL_LINES_ADJACENCY_EXT:10,GL_LINE_STRIP_ADJACENCY_EXT:11,GL_LINE_STRIP_ADJACENCY:11,GL_TRIANGLES_ADJACENCY:12,GL_TRIANGLES_ADJACENCY_EXT:12,GL_TRIANGLE_STRIP_ADJACENCY:13,GL_TRIANGLE_STRIP_ADJACENCY_EXT:13,GL_PATCHES:14}},{}],97:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RangeMode={DISTANCE_FROM_EYE_POINT:0,PIXEL_SIZE_ON_SCREEN:1}},{}],98:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadeModelMode={ConstantsFLAT:7424,SMOOTH:7425}},{}],99:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StateAttributeValue={OFF:0,ON:1,OVERRIDE:2,PROTECTED:4,INHERIT:8}},{}],100:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RenderBinMode={INHERIT_RENDERBIN_DETAILS:0,USE_RENDERBIN_DETAILS:1,OVERRIDE_RENDERBIN_DETAILS:2,PROTECTED_RENDERBIN_DETAILS:4,OVERRIDE_PROTECTED_RENDERBIN_DETAILS:6}},{}],101:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RenderingHint={DEFAULT_BIN:0,OPAQUE_BIN:1,TRANSPARENT_BIN:2}},{}],102:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InternalFormatMode={USE_IMAGE_DATA_FORMAT:0,USE_USER_DEFINED_FORMAT:1,USE_ARB_COMPRESSION:2,USE_S3TC_DXT1_COMPRESSION:3,USE_S3TC_DXT3_COMPRESSION:4,USE_S3TC_DXT5_COMPRESSION:5,USE_PVRTC_2BPP_COMPRESSION:6,USE_PVRTC_4BPP_COMPRESSION:7,USE_ETC_COMPRESSION:8,USE_ETC2_COMPRESSION:9,USE_RGTC1_COMPRESSION:10,USE_RGTC2_COMPRESSION:11,USE_S3TC_DXT1c_COMPRESSION:12,USE_S3TC_DXT1a_COMPRESSION:13}},{}],103:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadowCompareFunc={NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519}},{}],104:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadowTextureMode={LUMINANCE:6409,INTENSITY:32841,ALPHA:6406,NONE:0}},{}],105:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ReferenceFrame={RELATIVE_RF:0,ABSOLUTE_RF:1,ABSOLUTE_RF_INHERIT_VIEWPOINT:2}},{}],106:[function(g,e,_){!function(n){"use strict";function r(e,t){return e.bufferToString("ASCII",t,t+1)}function i(e,t){return t=t||0,"string"==typeof e?f[e.charCodeAt(t)]:f[e[t]]}function a(e){for(;e._position<=e._buffer.byteLength&&i(e._buffer,e._position);)e._position++}function e(e){e=e.readString();return parseInt(e)}function t(e){e=e.readString();return parseFloat(e)}Object.defineProperty(_,"__esModule",{value:!0}),_.AsciiStreamOperator=void 0;for(var o=function(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),e},s=g("i_185"),u=g("k_186"),l=g("e_187"),c=g("s_188"),d="\0\t\r\n\f ",f={},h=0;h<d.length;h++)f[d.charCodeAt(h)]=!0;function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(m,s.StreamOperator),o(m,[{key:"isBinary",value:function(){return!1}},{key:"bufferToString",value:function(e,t,r){r=this._buffer.subarray(t,r);return String.fromCharCode.apply(null,r)}},{key:"advanceToCurrentEndBracket",value:function(){for(var e,t=0;this._position<this._buffer.byteLength;)if("}"===(e=this.readString())){if(t<=0)return;t--}else"{"===e&&t++}},{key:"readBool",value:function(){return"TRUE"===this.readString()}},{key:"readUInt",value:function(){return e(this)}},{key:"readInt",value:function(){return e(this)}},{key:"readUShort",value:function(){return e(this)}},{key:"readShort",value:function(){return e(this)}},{key:"readUByte",value:function(){return e(this)}},{key:"readByte",value:function(){return e(this)}},{key:"readFloat",value:function(){return t(this)}},{key:"readDouble",value:function(){return t(this)}},{key:"readHex",value:function(){var e=(e=this.readString()).reaplace("0x","");return parseInt(e,16)}},{key:"matchString",value:function(e){var t=this._position;return e===this.readString()||(this._position=t,!1)}},{key:"lookForward",value:function(){var e=this._position,t=this.readString();return this._position=e,t}},{key:"goToNextRow",value:function(){for(;this._position<=this._buffer.byteLength&&(e=this._buffer,t=(t=this._position)||0,10!==(t="string"==typeof e?e.charCodeAt(t):e[t])&&13!==t);)this._position++;var e,t}},{key:"readChar",value:function(){return a(this),this._position+=1,this.bufferToString("ASCII",this._position-1,this._position)}},{key:"readString",value:function(){a(this);for(var e=this._position;e<=this._buffer.byteLength&&!i(this._buffer,e);)e++;var t=this.bufferToString("ASCII",this._position,e);return this._position=e,t}},{key:"readWrappedString",value:function(){if(a(this),'"'!==r(this,this._position))return this.readString();this._position++;for(var e=this._position;e<=this._buffer.byteLength&&'"'!==r(this,e);)e++;var t=this.bufferToString("ASCII",this._position,e);return this._position=e+1,t}},{key:"readGLEnum",value:function(e){var t=this.readString();e.hasOwnProperty(t)||c.Log.warn("readGLEnum: "+t+" enum not found"),e.value=l.GLEnum[t]}},{key:"readObjectMark",value:function(e){var t=this.readString();e.name!==t&&c.Log.warn("AsciiStreamOperator.readObjectMark mismatch: expecting "+e.name+", actual: "+t)}},{key:"readObjectProperty",value:function(e){var t=0,r=this.readString();if(e.mapProperty)t=u.ObjectWrapperManager.getValue(e.name,r);else if(e.name!==r)throw"Unmatched property "+e.name+" != "+r;e.set(t)}}]),o=m;function m(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(m.__proto__||Object.getPrototypeOf(m)).call(this,"AsciiStreamOperator"));return(void 0!==n&&e instanceof n||e instanceof ArrayBuffer)&&(e=new Uint8Array(e)),r._buffer=e,r._position=t,r.version=-1,r}_.AsciiStreamOperator=o}.call(this,g("buffer").Buffer)},{s_188:85,e_187:91,k_186:141,i_185:110,buffer:206}],107:[function(o,e,s){!function(n){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BinaryStreamOperator=void 0;var e=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},t=o("i_185"),r=o("s_188"),e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,t.StreamOperator),e(i,[{key:"isBinary",value:function(){return!0}},{key:"advanceToCurrentEndBracket",value:function(){var e;this.supportBinaryBrackets&&0<this._beginPositions.length&&(e=this._beginPositions.pop(),e+=this._blockSizes.pop(),this._position=e)}},{key:"readObjectProperty",value:function(e){var t=0;e.mapProperty&&(t=this.readInt()),e.set(t)}},{key:"readObjectMark",value:function(e){if(this.supportBinaryBrackets)if("{"===e.name)if(this._beginPositions.push(this._position),-1!==this.version&&148<this.version){var t=this.readInt(),r=this.readInt();if(r>Math.pow(2,21))throw"Too high value - size of file. nodeJS can manage 2^53 numbers only";t=Math.pow(2,32)*r+t;this._blockSizes.push(t)}else{t=this.readInt();this._blockSizes.push(t)}else"}"===e.name&&0<this._beginPositions.length&&(this._beginPositions.pop(),this._blockSizes.pop())}},{key:"readBool",value:function(){var e=this.readChar().charCodeAt(0);return 1<e&&r.Log.warn("found boolean who is not 0 or 1 - "+e+". may indicate failure in reading binary"),0!==e}},{key:"readByte",value:function(){return this._position+=1,this._dv.getInt8(this._position-1)}},{key:"readUByte",value:function(){return this._position+=1,this._dv.getUint8(this._position-1)}},{key:"readShort",value:function(){return this._position+=2,this._dv.getInt16(this._position-2,!0)}},{key:"readUShort",value:function(){return this._position+=2,this._dv.getUint16(this._position-2,!0)}},{key:"readInt",value:function(){return this._position+=4,this._dv.getInt32(this._position-4,!0)}},{key:"readUInt",value:function(){return this._position+=4,this._dv.getUint32(this._position-4,!0)}},{key:"readFloat",value:function(){return this._position+=4,this._dv.getFloat32(this._position-4,!0)}},{key:"readDouble",value:function(){return this._position+=8,this._dv.getFloat64(this._position-8,!0)}},{key:"readChar",value:function(){var e=this.readUByte();return String.fromCharCode(e)}},{key:"readString",value:function(){var e=this.readUInt();this._position+=e;e=new Uint8Array(this._buffer,this._position-e,e);return String.fromCharCode.apply(null,e)}},{key:"readWrappedString",value:function(){return this.readString()}},{key:"readGLEnum",value:function(e){e.value=this.readUInt()}},{key:"readBuffer",value:function(e){var t=new Uint8Array(this._buffer,this._position,e);return this._position+=e,t}}]),i);function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,"BinaryStreamOperator"));return void 0!==n&&e instanceof n&&(e=new Uint8Array(e).buffer),r.supportBinaryBrackets=!1,r.version=-1,r._buffer=e,r._dv=new DataView(e),r._position=t,r._beginPositions=[],r._blockSizes=[],r}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}s.BinaryStreamOperator=e}.call(this,o("buffer").Buffer)},{s_188:85,i_185:110,buffer:206}],108:[function(e,t,r){"use strict";function L(e,t){e.inputOperator.readObjectProperty(e.PROPERTY.set(t))}function P(e,t){if(e.typeReaderMap[t])return e.typeReaderMap[t];var r="read"+t,n=void 0,i=e.inputOperator[r];if(i&&(n=i.bind(e.inputOperator)),n=(i=e[r])?i.bind(e):n)return e.typeReaderMap[t]=n;throw"reader type: "+t+" not found"}function I(e,t){for(var r=[],n=0;n<e;n++)r.push(t());return r}function R(e,t,r,n){var i=e.inputOperator.readInt();e.readBeginBracket();var a={Value:[],Type:r.name,Count:i,ItemSize:n};if(0<i)if(e.isBinary()){var o=r.BYTES_PER_ELEMENT,o=(o=e.inputOperator.readBuffer(i*n*o)).slice().buffer;a.Value=new r(o)}else{a.Value=new r(i*n);for(var s=0,u=0;u<i;u++)for(var l=t(),c=0;c<n;c++)a.Value[s++]=l[c]}return e.readEndBracket(),a}Object.defineProperty(r,"__esModule",{value:!0}),r.InputStream=void 0;var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e("i_191");var s=e("k_186"),D=e("e_193"),a=e("s_194"),M=e("h_195"),w=e("s_188"),T=e("3_197"),S=e("d_198"),U=a.Constants.TypeIds,n=(n(o,[{key:"readObject",value:function(e){var t=this.inputOperator.readString();if("NULL"===t)return null;if(this.readBeginBracket(),L(this,"UniqueID"),!s.ObjectWrapperManager.findWrapper(t))return console.warn(t+": wrapper for class not found"),this.advanceToCurrentEndBracket(),e;var r=void 0,n=this.inputOperator.readUInt();return this._identifierMap[n]?(this.advanceToCurrentEndBracket(),r=this._identifierMap[n]):(r=this.readObjectFields(t,n,e),this.advanceToCurrentEndBracket()),r}},{key:"readObjectOfType",value:function(){return this.readObject()}},{key:"readBeginBracket",value:function(){this.inputOperator.readObjectMark(this.BEGIN_BRACKET)}},{key:"readEndBracket",value:function(){this.inputOperator.readObjectMark(this.END_BRACKET)}},{key:"readMatrix",value:function(e){for(var t=P(this,e),r=[],n=0;n<16;n++)r.push(t());return r}},{key:"readPrimitiveSet",value:function(){if(112<=this.getVersion())return this.readObjectOfType("osg::PrimitiveSet");var e=0,t=null,r=new D.ObjectProperty("PrimitiveType",0,!0),n=new D.ObjectProperty("PrimitiveType",0,!0),i=this.inputOperator;if(i.readObjectProperty(r),i.readObjectProperty(n),96<this.getVersion()&&(e=i.readUInt()),r.value===U.ID_DRAWARRAYS)t={First:i.readInt(),Count:i.readInt(),Mode:n.value,NumInstances:e};else if(r.value===U.ID_DRAWARRAY_LENGTH){var a=i.readInt(),o=i.readUInt();this.readBeginBracket();var s=Int32Array,t={First:a,Mode:n.value,Indices:{ItemSize:1,Type:s.name,Value:[],Count:o},NumInstances:e};if(this.isBinary())t.Indices.Value=new s(i._buffer,i._position,o),i._position+=o;else{t.Indices.Value=new s(o);for(var u=0;u<o;u++)t.Indices.Value[u]=i.readInt()}this.readEndBracket()}else if(r.value===U.ID_DRAWELEMENTS_UBYTE){var l=Uint8Array,c=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:l.name,Value:[],Count:c},NumInstances:e},this.readBeginBracket(),this.isBinary())t.Indices.Value=new l(i._buffer,i._position,c),i._position+=c;else{t.Indices.Value=new l(c);for(var d=0;d<c;d++)t.Indices.Value[d]=i.readUByte()}this.readEndBracket()}else if(r.value===U.ID_DRAWELEMENTS_USHORT){var s=Uint16Array,f=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:s.name,Value:[],Count:f},NumInstances:e},this.readBeginBracket(),this.isBinary()){var h=s.BYTES_PER_ELEMENT,l=(l=i.readBuffer(f*h)).slice().buffer;t.Indices.Value=new s(l)}else{t.Indices.Value=new s(f);for(var p=0;p<f;p++)t.Indices.Value[p]=i.readUShort()}this.readEndBracket()}else{if(r.value!==U.ID_DRAWELEMENTS_UINT)throw"InputStream.readPrimitiveSet: "+r.value+" ID not found";var r=Uint32Array,m=i.readUInt();if(t={Mode:n.value,Indices:{ItemSize:1,Type:r.name,Value:[],Count:m},NumInstances:e},this.readBeginBracket(),this.isBinary()){h=r.BYTES_PER_ELEMENT,h=(h=i.readBuffer(m*h)).slice().buffer;t.Indices.Value=new r(h)}else{t.Indices.Value=new r(m);for(var g=0;g<m;g++)t.Indices.Value[g]=i.readUInt()}this.readEndBracket()}return t}},{key:"readProperty",value:function(e){return L(this,e)}},{key:"readVectorOfType",value:function(e,t){return I(e,P(this,t))}},{key:"readArray",value:function(){var e=this,t=null;L(this,"ArrayID");var r=this.inputOperator,n=r.readUInt("ArrayID");if(this._arrayMap[n])return this._arrayMap[n];var i=new D.ObjectProperty("ArrayType",0,!0);r.readObjectProperty(i);var a=r,r=1;if(i.value===U.ID_BYTE_ARRAY)t=R(e,function(){return a.readByte()},Int8Array,r);else if(i.value===U.ID_UBYTE_ARRAY)t=R(e,function(){return a.readUByte()},Uint8Array,r);else if(i.value===U.ID_SHORT_ARRAY)t=R(e,function(){return a.readShort()},Int16Array,r);else if(i.value===U.ID_USHORT_ARRAY)t=R(e,function(){return a.readUShort()},Uint16Array,r);else if(i.value===U.ID_INT_ARRAY)t=R(e,function(){return a.readInt()},Int32Array,r);else if(i.value===U.ID_UINT_ARRAY)t=R(e,function(){return a.readUInt()},Uint32Array,r);else if(i.value===U.ID_FLOAT_ARRAY)t=R(e,function(){return a.readFloat()},Float32Array,r);else if(i.value===U.ID_DOUBLE_ARRAY)t=R(e,function(){return a.readDouble()},Float64Array,r);else if(i.value===U.ID_VEC2B_ARRAY)var r=2,o=P(e,"Byte"),t=R(e,function(){return I(2,o)},Int8Array,r);else if(i.value===U.ID_VEC3B_ARRAY){r=3;var s=P(e,"Byte");t=R(e,function(){return I(3,s)},Int8Array,r)}else if(i.value===U.ID_VEC4B_ARRAY){r=4;var u=P(e,"Byte");t=R(e,function(){return I(4,u)},Int8Array,r)}else if(i.value===U.ID_VEC2UB_ARRAY){r=2;var l=P(e,"UByte");t=R(e,function(){return I(2,l)},Uint8Array,r)}else if(i.value===U.ID_VEC3UB_ARRAY){r=3;var c=P(e,"UByte");t=R(e,function(){return I(3,c)},Uint8Array,r)}else if(i.value===U.ID_VEC4UB_ARRAY){r=4;var d=P(e,"UByte");t=R(e,function(){return I(4,d)},Uint8Array,r)}else if(i.value===U.ID_VEC2S_ARRAY){r=2;var f=P(e,"Short");t=R(e,function(){return I(2,f)},Int16Array,r)}else if(i.value===U.ID_VEC3S_ARRAY){r=3;var h=P(e,"Short");t=R(e,function(){return I(3,h)},Int16Array,r)}else if(i.value===U.ID_VEC4S_ARRAY){r=4;var p=P(e,"Short");t=R(e,function(){return I(4,p)},Int16Array,r)}else if(i.value===U.ID_VEC2US_ARRAY){r=2;var m=P(e,"UShort");t=R(e,function(){return I(2,m)},Uint16Array,r)}else if(i.value===U.ID_VEC3US_ARRAY){r=3;var g=P(e,"UShort");t=R(e,function(){return I(3,g)},Uint16Array,r)}else if(i.value===U.ID_VEC4US_ARRAY){r=4;var _=P(e,"UShort");t=R(e,function(){return I(4,_)},Uint16Array,r)}else if(i.value===U.ID_VEC2_ARRAY){r=2;var v=P(e,"Float");t=R(e,function(){return I(2,v)},Float32Array,r)}else if(i.value===U.ID_VEC3_ARRAY){r=3;var y=P(e,"Float");t=R(e,function(){return I(3,y)},Float32Array,r)}else if(i.value===U.ID_VEC4_ARRAY){r=4;var b=P(e,"Float");t=R(e,function(){return I(4,b)},Float32Array,r)}else if(i.value===U.ID_VEC2D_ARRAY){r=2;var x=P(e,"Double");t=R(e,function(){return I(2,x)},Float64Array,r)}else if(i.value===U.ID_VEC3D_ARRAY){r=3;var M=P(e,"Double");t=R(e,function(){return I(3,M)},Float64Array,r)}else if(i.value===U.ID_VEC4D_ARRAY){r=4;var w=P(e,"Double");t=R(e,function(){return I(4,w)},Float64Array,r)}else if(i.value===U.ID_VEC2I_ARRAY){r=2;var T=P(e,"Int");t=R(e,function(){return I(2,T)},Int32Array,r)}else if(i.value===U.ID_VEC3I_ARRAY){r=3;var S=P(e,"Int");t=R(e,function(){return I(3,S)},Int32Array,r)}else if(i.value===U.ID_VEC4I_ARRAY){r=4;var E=P(e,"Int");t=R(e,function(){return I(4,E)},Int32Array,r)}else if(i.value===U.ID_VEC2UI_ARRAY){r=2;var C=P(e,"UInt");t=R(e,function(){return I(2,C)},Uint32Array,r)}else if(i.value===U.ID_VEC3UI_ARRAY){r=3;var A=P(e,"UInt");t=R(e,function(){return I(3,A)},Uint32Array,r)}else{if(i.value!==U.ID_VEC4UI_ARRAY)throw"InputStream.readArray(): Unsupported array type.";r=4;var O=P(e,"UInt");t=R(e,function(){return I(4,O)},Uint32Array,r)}return this._arrayMap[n]=t}},{key:"getVersion",value:function(){return this.inputOperator.version}},{key:"advanceToCurrentEndBracket",value:function(){this.inputOperator.advanceToCurrentEndBracket()}},{key:"isBinary",value:function(){return this.inputOperator.isBinary()}},{key:"readObjectFields",value:function(e,t,r){var n=this,i=s.ObjectWrapperManager.findWrapper(e);if(!i)return console.warn(e+": wrapper for class not found"),void this.advanceToCurrentEndBracket();var a=this.inputOperator.version,o=r||i.createInstance();return this._identifierMap[t]=o,i.associates.forEach(function(e){var t;e.minVersion<=a&&e.maxVersion>=a&&((t=s.ObjectWrapperManager.findWrapper(e.name))?(n._fields.push(t.getName()),t.read(n,o),n._fields.pop()):w.Log.warn(e.name+": wrapper for associate not found. continuing to next associate"))}),o}},{key:"readImage",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=this,r=t.inputOperator;94<t.getVersion()&&(L(t,"ClassName"),r.readString()),L(t,"UniqueID");var n=r.readUInt();if(t._identifierMap[n])return t._identifierMap[n];L(t,"FileName");var i=r.readWrappedString();L(t,"WriteHint");var a=(r.readInt(),r.readInt()),o=null;if(0===a)if(this.isBinary()){var s=r.readInt(),u=r.readInt(),l=r.readInt(),c=r.readInt(),d=r.readInt(),f=r.readInt(),h=r.readInt(),p=(r.readInt(),r.readInt(),r.readUInt());0<p&&(x=r.readBuffer(p),(o=new M.Image).setProperty("ImageType",S.ImageType.IMAGE_INLINE_DATA),o.setProperty("Origin",s),o.setImage(u,l,c,d,f,h,x,1));for(var m=r.readUInt(),g=[],_=0;_<m;_++)g.push(r.readUInt());o&&0<m&&o.setProperty("Levels",g),e=!1}else{L(t,"Origin");p=r.readInt();L(t,"Size");s=r.readInt(),u=r.readInt(),l=r.readInt();L(t,"InternalTextureFormat");c=r.readInt();L(t,"PixelFormat");d=r.readInt();L(t,"DataType");f=r.readInt();L(t,"Packing");h=r.readInt();L(t,"AllocationMode"),L(t,"Data");var v=r.readUInt()-1;t.readBeginBracket();for(var y=[],b=0;b<=v;b++)y.push(r.readWrappedString());var x=[];T.Base64Encoder.decodeArray(y,x),x.pop(),t.readEndBracket(),(o=new M.Image).setProperty("ImageType",S.ImageType.IMAGE_INLINE_DATA),o.setProperty("Origin",p),o.setImage(s,u,l,c,d,f,data,mode,h),0<v&&o.setProperty("Levels",x),e=!1}else 1===a&&t.isBinary()&&(a=r.readUInt(),a=r.readBuffer(a),(o=new M.Image).setProperty("ImageType",S.ImageType.IMAGE_INLINE_FILE),o.setProperty("Data",a),e=!1);return e&&""!==i&&((o=new M.Image).setProperty("ImageType",S.ImageType.IMAGE_EXTERNAL),o.FileName=i,w.Log.warn("InputStream,readImage - reading from external file - not implemented")),(o=t.readObjectFields("osg::Object",n,o)).setProperty("Name",i),o.setProperty("WriteHint",i),t._identifierMap[n]=o}}]),o);function o(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,o),this.inputOperator=e,this._identifierMap={},this._arrayMap={},this._fields=[],this.typeReaderMap={},this.PROPERTY=new D.DataTypes.ObjectProperty,this.BEGIN_BRACKET=new D.DataTypes.ObjectMark("{",+a.Constants.INDENT_VALUE),this.END_BRACKET=new D.DataTypes.ObjectMark("}",-a.Constants.INDENT_VALUE)}r.InputStream=n},{"3_197":82,s_194:83,e_193:84,s_188:85,d_198:92,h_195:118,k_186:141,i_191:163}],109:[function(require,module,exports){!function(Buffer){"use strict";function readBuffer(e){void 0!==Buffer&&e instanceof Buffer&&(e=new Uint8Array(e).buffer);var t=new _BinaryStreamOperator.BinaryStreamOperator(e,0),r=t.readUInt(),n=t.readUInt();t._position=0;var i=e.byteLength>=OSGT_HEADER.length;i&&(s=t.readBuffer(OSGT_HEADER.length),i=String.fromCharCode.apply(null,s)===OSGT_HEADER);var a=void 0,o=void 0,s=void 0;if(r===OSG_HEADER_LOW&&n===OSG_HEADER_HIGH){t._position=8;a=t.readUInt(),o=t.readUInt(),n=t.readUInt(),s=0!=(1&n);if(t.supportBinaryBrackets=0!=(4&n),"0"!==t.readString())throw"compresses data not supported"}else{if(!i)return console.warn("osg-serializer-js: osg format not supported. use  `parseOsg` instead"),!1;(0,_Log.Log)("OSGT File"),a=(t=new _AsciiStreamOperator.AsciiStreamOperator(e,OSGT_HEADER.length)).readString(),t.goToNextRow(),a=WriteType["WRITE_"+a.toUpperCase()]||0,t.readObjectProperty(PROPERTY.set("#Version")),o=t.readUInt(),t.goToNextRow(),t.readObjectProperty(PROPERTY.set("#Generator")),t.readString(),t.goToNextRow(),s="#CustomDomain"===t.lookForward()}if(s)throw new Error("osg DomainVersion not supported.");t.version=o;o=new _InputStream.InputStream(t),t=(new Date).getTime(),o=o.readObject();return(0,_Log.Log)("timeElapsed:",(new Date).getTime()-t),o}function readFile(path,cb){if(!cb)throw"Call back required";var req="require",fs=eval("require('fs');");fs.readFile(path,function(e,t){e&&cb(e);var r=void 0;try{console.log(e,t),r=readBuffer(t)}catch(e){return console.trace(e),cb(e)}if(!r)return cb("Failed to convert file");cb(null,r)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.readFile=exports.readBuffer=void 0;var _InputStream=require("__199"),_DataTypes=require("e_193"),_BinaryStreamOperator=require("i_201"),_AsciiStreamOperator=require("k_202"),_Log=require("s_188"),PROPERTY=new _DataTypes.DataTypes.ObjectProperty,OSG_HEADER_LOW=1821445793,OSG_HEADER_HIGH=452674885,OSGT_HEADER="#Ascii",WriteType={WRITE_UNKNOWN:0,WRITE_SCENE:1,WRITE_IMAGE:2,WRITE_OBJECT:3};exports.readBuffer=readBuffer,exports.readFile=readFile}.call(this,require("buffer").Buffer)},{e_193:84,s_188:85,k_202:106,i_201:107,__199:108,buffer:206}],110:[function(e,t,r){"use strict";function n(e,t){throw"function "+t+" Not Implemented in "+e}Object.defineProperty(r,"__esModule",{value:!0});var i=(function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}(a,[{key:"readChar",value:function(){n(this.name,"readChar")}},{key:"readUByte",value:function(){n(this.name,"readUByte")}},{key:"readByte",value:function(){n(this.name,"readByte")}},{key:"readShort",value:function(){n(this.name,"readShort")}},{key:"readUShort",value:function(){n(this.name,"readUShort")}},{key:"readInt",value:function(){n(this.name,"readInt")}},{key:"readUInt",value:function(){n(this.name,"readUInt")}},{key:"readBool",value:function(){n(this.name,"readBool")}},{key:"readString",value:function(){n(this.name,"readString")}},{key:"readObjectProperty",value:function(e){n(this.name,"readObjectProperty")}},{key:"readObjectMark",value:function(e){n(this.name,"readObjectMark")}},{key:"advanceToCurrentEndBracket",value:function(){n(this.name,"advanceToCurrentEndBracket")}},{key:"isBinary",value:function(){n(this.name,"isBinary")}},{key:"readWrappedString",value:function(){n(this.name,"readWrappedString")}},{key:"readGLEnum",value:function(e){n(this.name,"readGLenum")}},{key:"readFloat",value:function(){n(this.name,"readFloat")}},{key:"readDouble",value:function(){n(this.name,"readDouble")}},{key:"readBuffer",value:function(e){n(this.name,"readBuffer")}}]),a);function a(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.name=e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.StreamOperator=i},{}],111:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BufferData=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("s_204").ObjectClass),e=n;function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))}r.BufferData=e},{s_204:123}],112:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CullFace=void 0;var n=e("W_205"),i=e("e_206"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,n.StateAttribute),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return e.Type="osg::CullFace",e.Mode=i.FaceMode.BACK,e}r.CullFace=n},{e_206:89,W_205:127}],113:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultUserDataContainer=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("i_207").UserDataContainer),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Type="Osg::DefaultUserDataContainer",e}r.DefaultUserDataContainer=e},{i_207:132}],114:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Drawable=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("M_208").Node),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.InitialBound=null,e.BoundingBox=null,e.Shape=null,e.SupportsDisplayList=!0,e.UseDisplayList=!0,e.UseVertexBufferObjects=!1,e.Type="osg::Drawable",e}r.Drawable=e},{M_208:122}],115:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Geode=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("e_209").Group),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Type="Osg::Geode",e}r.Geode=e},{e_209:117}],116:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Geometry=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("s_210").Drawable),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Type="Osg::Geometry",e.InitialBound=null,e.BoundingBox=null,e.PrimitiveSetList=[],e.TexCoordArray=[],e.VertexAttribArray=[],e}r.Geometry=e},{s_210:114}],117:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Group=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("M_208").Node),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Children=[],e.Type="Osg::Group",e}r.Group=e},{M_208:122}],118:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Image=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("-_212").BufferData),n(i,[{key:"setImage",value:function(e,t,r,n,i,a,o,s){var u=8<arguments.length&&void 0!==arguments[8]?arguments[8]:1,l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0;this.S=e,this.T=t,this.R=r,this.InternalTextureFormat=n,this.PixelFormat=i,this.DataType=a,this.Data=o,this.Packing=u,this.Mode=s,this.RowLength=l}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.S=0,e.T=0,e.R=0,e.InternalTextureFormat=0,e.PixelFormat=0,e.DataType=0,e.Data=null,e.Mode=0,e.Packing=1,e.RowLength=0,e.Origin=0,e.FileName="",e.Levels=null,e.WriteHint=null,e.Type="Osg::Image",e.FromExternal=!1,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.Image=n},{"-_212":111}],119:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LOD=void 0;var n=e("M_208"),i=e("d_214"),a=e("__215"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,n.Node),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.CenterMode=i.CenterMode.USE_BOUNDING_SPHERE_CENTER,e.RangeMode=a.RangeMode.DISTANCE_FROM_EYE_POINT,e.UserCenter={center:[],radius:0},e.RangeList=[],e.Type="Osg::LOD",e}r.LOD=n},{d_214:88,__215:97,M_208:122}],120:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Material=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("W_205").StateAttribute),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.AmbientFrontAndBack=!0,e.AmbientFront=null,e.AmbientBack=null,e.DiffuseFrontAndBack=!0,e.DiffuseFront=null,e.DiffuseBack=null,e.SpecularFrontAndBack=!0,e.SpecularFront=null,e.SpecularBack=null,e.EmissionFrontAndBack=!0,e.EmissionFront=null,e.EmissionBack=null,e.ShininessFrontAndBack=!0,e.ShininessFront=0,e.ShininessBack=0,e.Type="Osg::Material",e}r.Material=e},{W_205:127}],121:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MatrixTransform=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("i_217").Transform),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Type="Osg::MatrixTransform",e.Matrix=null,e}r.MatrixTransform=e},{i_217:131}],122:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Node=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("s_204").ObjectClass),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.CullingActive=!0,e.NodeMask=4294967295,e.Descriptions=[],e.InitialBound=null,e.StateSet=null,e.Type="Osg::Node",e}r.Node=e},{s_204:123}],123:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectClass=void 0;var n=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e},i=e("s_188"),n=(n(a,[{key:"setProperty",value:function(e,t){void 0===this[e]&&i.Log.warn("setProperty: "+this.Type+"."+e+" have not been defined"),this[e]=t}},{key:"getProperty",value:function(e){return void 0===this[e]&&i.Log.warn("getProperty: "+this.Type+"."+e+" have not been defined"),this[e]}}]),a);function a(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.Name="",this.DataVariance=null,this.UserDataContainer=null,this.Type="Osg::Object"}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.ObjectClass=n},{s_188:85}],124:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OsgArray=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("-_212").BufferData),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Binding=null,e.Normalize=!1,e}r.OsgArray=e},{"-_212":111}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PagedLOD=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("i_57").LOD),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.DatabasePath="",e.FileNames=[],e.PriorityOffset=[],e.PriorityScale=[],e.FrameNumberOfLastTraversal=0,e.NumChildrenThatCannotBeExpired=0,e.DisableExternalChildrenPaging=!1,e.Children=[],e.Type="Osg::PagedLOD",e}r.PagedLOD=e},{i_57:119}],126:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ShadeModel=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("W_205").StateAttribute),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Mode=null,e.Type="Osg::ShadeModel",e}r.ShadeModel=e},{W_205:127}],127:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StateAttribute=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("s_204").ObjectClass),n(i,[{key:"getMember",value:function(){return 0}},{key:"getTypeMemberPair",value:function(){return{type:this.Type,member:this.getMember()}}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.Type="Osg::StateAttribute",e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.StateAttribute=n},{s_204:123}],128:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StateSet=void 0;var n=e("s_204"),i=e("e_225"),a=e("s_226"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,n.ObjectClass),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.ModeList=[],e.AttributeList=[],e.TextureModeList=[],e.TextureAttributeList=[],e.UniformList=[],e.RenderingHint=i.RenderingHint.DEFAULT_BIN,e.RenderBinMode=a.RenderBinMode.INHERIT_RENDERBIN_DETAILS,e.BinNumber=0,e.BinName="",e.NestRenderBins=!0,e.DefineList={},e.Type="Osg::StateSet",e}r.StateSet=n},{s_226:100,e_225:101,s_204:123}],129:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Texture=void 0;var n=function(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e},i=e("W_205"),a=e("-_228"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,i.StateAttribute),n(o,[{key:"computeInternalFormatType",value:function(){}},{key:"setInternalFormat",value:function(e){this.InternalFormatMode=a.InternalFormatMode.USE_USER_DEFINED_FORMAT,this.InternalFormat=e,computeInternalFormatType()}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.InternalFormatMode=0,e.InternalFormat=0,e.Type="Osg::Texture",e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.Texture=n},{"-_228":102,W_205:127}],130:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Texture2D=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("3_229").Texture),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Image=null,e.TextureWidth=0,e.TextureHeight=0,e.Type="Osg::Texture2D",e}r.Texture2D=e},{"3_229":129}],131:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Transform=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("e_209").Group),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.Type="Osg::Transform",e.ReferenceFrame=0,e}r.Transform=e},{e_209:117}],132:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UserDataContainer=void 0;(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(n,e("s_204").ObjectClass),e=n;function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.DescriptionList=[],e.ObjectList=[],e.UserData=null,e.Type="Osg::UserDataContainer",e}r.UserDataContainer=e},{s_204:123}],133:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Associate=function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.name=t,this.minVersion=r.minVersion||0,this.maxVersion=r.maxVersion||1e8}},{}],134:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}(i,[{key:"getName",value:function(){return this._name}},{key:"getMinVersion",value:function(){return this._options.minVersion||0}},{key:"getMaxVersion",value:function(){return this._options.maxVersion||1e9}},{key:"read",value:function(e,t){throw"BaseSerializer.read not implemented"}}]),i);function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this._options=t,this._name=e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.BaseSerializer=n},{}],135:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EnumSerializer=void 0;var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e},o=e("s_188"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,e("i_233").BaseSerializer),n(s,[{key:"read",value:function(e,t){var r;e.isBinary()?(r=e.inputOperator.readInt(),this._reverseMap.hasOwnProperty(r)||(o.Log.warn("EnumSerializer: failed to find ENUM value "+r+" for serializer "+this.getName()+". Setting to default value."),r=this._defaultValue),t.setProperty(this.getName(),r)):e.inputOperator.matchString(this.getName())&&(r=e.inputOperator.readString(),e=this._enumMap[r],this._enumMap.hasOwnProperty(r)||(o.Log.warn("EnumSerializer: failed to find ENUM key "+r+" for serializer "+this.getName()+". Setting to default value."),e=this._defaultValue),t.setProperty(this.getName(),e))}}]),s);function s(e,t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var i,a,n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,n));return n._defaultValue=r,n._enumMap=t,n._reverseMap=(i=t,a={},Object.keys(i).forEach(function(e){var t=i[e];a[t]&&o.Log.warn("EnumSerializer: Duplicate value: "+a[t]+", "+e),a[t]=e}),a),n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.EnumSerializer=n},{s_188:85,i_233:134}],136:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ImageSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){var r,n;e.isBinary()?e.inputOperator.readBool()&&(r=this.getName(),n=e.readImage(),t.setProperty(r,n)):e.inputOperator.matchString(this.getName())&&e.inputOperator.readBool()&&(e.readBeginBracket(),t.setProperty(this.getName(),e.readImage()),e.readEndBracket())}}]),i);function i(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,r));return r._defaultValue=t,r}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.ImageSerializer=n},{i_233:134}],137:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MatrixSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){var r=[];(e.isBinary()||e.inputOperator.matchString(this.getName()))&&e.readMatrix(this._type),t.setProperty(this.getName(),r)}}]),i);function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return e._type=t.type||"Double",e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.MatrixSerializer=n},{i_233:134}],138:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectCallbackSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){var r=!1;if(r=e.isBinary()||e.inputOperator.matchString(this.getName())?e.inputOperator.readBool():r)throw"callback object serializing is NOT SUPPORTED - property: "+this.getName()}}]),i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t))}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.ObjectCallbackSerializer=n},{i_233:134}],139:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){e.isBinary()?e.inputOperator.readBool()&&(t[this._name]=e.readObjectOfType()):e.inputOperator.matchString(this._name)&&e.inputOperator.readBool()&&(e.readBeginBracket(),t[this._name]=e.readObjectOfType(),e.readEndBracket())}}]),i);function i(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,r));return r._defaultValue=t,r}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.ObjectSerializer=n},{i_233:134}],140:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectWrapper=void 0;var n=function(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e},i=e("e_238"),a=e("s_188"),n=(n(o,[{key:"read",value:function(e,r){var n=this,i=e.getVersion();this._serializers.forEach(function(t){if(t.getMinVersion()<=i&&i<=t.getMaxVersion())try{t.read(e,r)}catch(e){throw e.stack&&(e=e.toString()+"\n"+e.stack),a.Log.fatal(e),"ObjectWrapper.read: Error reading property "+n._name+"."+t.getName()}})}},{key:"addSerializer",value:function(e){this._serializers.push(e)}},{key:"createInstance",value:function(){var e=this._typeCtor;return e?new e:null}},{key:"getName",value:function(){return this._name}}]),o);function o(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,o),this._name=e,this._typeCtor=r,this.associates=t.map(function(e){return"string"==typeof e?new i.Associate(e):e}),this._serializers=n.serializers||[]}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.ObjectWrapper=n},{s_188:85,e_238:133}],141:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ObjectWrapperManager=void 0;var n=e("e_187"),i=e("e_241"),e=e("s_242"),a={ArrayType:i.ArrayTableEnum,PrimitiveType:e.PrimitiveTableEnum,GL:n.GLEnum},o={};r.ObjectWrapperManager={getValue:function(e,t){return(a[e]||n.GLEnum)[t]},findWrapper:function(e){return o[e]},addWrapper:function(e){o[e.getName()]=e},readWrapperObject:function(r){return function(e,t){if(wrapperObject=o[r],!wrapperObject)throw"ObjectWrapperManager.readWrapperObject : "+r}}}},{e_241:86,e_187:91,s_242:96}],142:[function(e,t,r){"use strict";function n(e,t){var r=e["read"+t];if(!r)throw new Error("reader type: "+t+" not found");return r.bind(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.PropByValSerializer=void 0;var i=function(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e},e=e("i_233"),a={HEXINT:"UInt",GLInt:"Int"},o={Vec4d:{size:4,type:"Double"}},i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,e.BaseSerializer),i(s,[{key:"read",value:function(e,t){var r=void 0;0<this._vectorSize?r=e.readVectorOfType(this._vectorSize,this._type):e.isBinary()?r=n(e.inputOperator,this._type)():e.inputOperator.matchString(this._name)&&(r=this._useHex?e.inputOperator.readHex():n(e.inputOperator,this._type)()),t.setProperty(this._name,r)}}]),s);function s(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,t,n));return n._defaultValue=r,n._useHex=!1,n._vectorSize=0,o[e]?(n._vectorSize=o[e].size,n._type=o[e].type):a[e]?(n._type=a[e],n._useHex=!0):n._type=e,n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.PropByValSerializer=i},{i_233:134}],143:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UserSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){if(e.isBinary()){if(!e.inputOperator.readBool())return}else if(!e.inputOperator.matchString(this.getName()))return;this._reader(e,t)}}]),i);function i(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,r));return r._reader=t,r}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.UserSerializer=n},{i_233:134}],144:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VectorSerializer=void 0;var n=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e("i_233").BaseSerializer),n(i,[{key:"read",value:function(e,t){var r=function(e,t){var r="read"+t,n=e.inputOperator[r];if(n)return n.bind(e.inputOperator);if(n=e[r])return n.bind(e);throw"reader type: "+t+" not found"}(e,this._type),n=[];if(e.isBinary())for(var i=e.inputOperator.readUInt(),a=0;a<i;a++)n.push(r());else if(e.inputOperator.matchString(this.getName())){var o=e.inputOperator.readUInt();if(0<o){e.readBeginBracket();for(var s=0;s<o;s++)n.push(r());e.readEndBracket()}}0<n.length&&t.setProperty(this._name,n)}}]),i);function i(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,r));return r._type=t,r}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.VectorSerializer=n},{i_233:134}],145:[function(e,t,r){"use strict";var n=e("k_186"),i=e("__247"),a=e("M_248"),o=e("i_249"),e=e("e_206"),o=new a.ObjectWrapper("osg::CullFace",["osg::Object","osg::StateAttribute","osg::CullFace"],o.CullFace);o.addSerializer(new i.EnumSerializer("Mode",e.FaceMode,e.FaceMode.BACK)),n.ObjectWrapperManager.addWrapper(o)},{e_206:89,i_249:112,__247:135,M_248:140,k_186:141}],146:[function(e,t,r){"use strict";var n=e("k_186"),i=e("s_252"),a=e("W_253"),o=e("e_254"),s=e("i_255"),u=e("M_248"),l=e("e_257"),e=e("s_258"),e=new u.ObjectWrapper("osg::Drawable",["osg::Object",new l.Associate("osg::Node",{minVersion:154}),"osg::Drawable"],e.Drawable);e.addSerializer(new i.ObjectSerializer("StateSet",null)),e.addSerializer(new a.UserSerializer("InitialBound",function(){throw"InitialBound not yet implemented"})),e.addSerializer(new o.ObjectCallbackSerializer("ComputeBoundingBoxCallback")),e.addSerializer(new i.ObjectSerializer("Shape",null)),e.addSerializer(new s.PropByValSerializer("Bool","SupportsDisplayList",!0)),e.addSerializer(new s.PropByValSerializer("Bool","UseDisplayList",!0)),e.addSerializer(new s.PropByValSerializer("Bool","UseVertexBufferObjects",!1)),e.addSerializer(new o.ObjectCallbackSerializer("UpdateCallback")),e.addSerializer(new o.ObjectCallbackSerializer("EventCallback")),e.addSerializer(new o.ObjectCallbackSerializer("CullCallback")),e.addSerializer(new o.ObjectCallbackSerializer("DrawCallback")),e.addSerializer(new s.PropByValSerializer("HEXINT","NodeMask",4294967295,{minVersion:142})),e.addSerializer(new s.PropByValSerializer("Bool","CullingActive",!0,{minVersion:145})),n.ObjectWrapperManager.addWrapper(e)},{s_258:114,e_257:133,e_254:138,s_252:139,M_248:140,k_186:141,i_255:142,W_253:143}],147:[function(e,t,r){"use strict";var n=e("k_186"),i=e("W_253"),a=e("M_248"),e=e("d_262"),e=new a.ObjectWrapper("osg::Geode",["osg::Object","osg::Node","osg::Geode"],e.Geode);e.addSerializer(new i.UserSerializer("Drawables",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::Drawable");i&&t.Children.push(i)}e.readEndBracket()})),n.ObjectWrapperManager.addWrapper(e)},{d_262:115,M_248:140,k_186:141,W_253:143}],148:[function(e,t,r){"use strict";function s(e){var t,r=new f.OsgArray;return e.readProperty("Array"),e.inputOperator.readBool()&&(r=e.readArray()),e.readProperty("Indices"),e.inputOperator.readBool()&&(t=e.readArray())&&(r.UserDataContainer||(r.UserDataContainer=new p.DefaultUserDataContainer),r.UserDataContainer.UserData=t),e.readProperty("Binding"),r.Binding=(t=e).isBinary()?t.inputOperator.readInt():(t=t.inputOperator.readString(),m.AttributeBinding[t]),e.readProperty("Normalize"),r.Normalize=0!==e.inputOperator.readInt(),r}function n(n){return function(e,t){e.readBeginBracket();var r=s(e);t.setProperty(n,r),e.readEndBracket()}}function i(o){return function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=[],i=0;i<r;i++){e.readProperty("Data"),e.readBeginBracket();var a=s(e);n.push(a),e.readEndBracket()}e.readEndBracket(),t.setProperty(o,n),e.readEndBracket()}}var a=e("k_186"),o=e("M_264"),u=e("s_252"),l=e("W_253"),c=e("M_248"),d=e("s_268"),f=e("W_269"),h=e("e_257"),p=e("i_271"),m=e("M_272"),d=new c.ObjectWrapper("osg::Geometry",["osg::Object",new h.Associate("osg::Node",{minVersion:154}),"osg::Drawable","osg::Geometry"],d.Geometry);d.addSerializer(new o.VectorSerializer("PrimitiveSetList","PrimitiveSet")),d.addSerializer(new l.UserSerializer("VertexData",n("VertexArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("NormalData",n("NormalArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("ColorData",n("ColorArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("SecondaryColorData",n("SecondaryColorArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("FogCoordData",n("FogCoordArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("TexCoordData",i("TexCoordArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("VertexAttribData",i("VertexAttribArray"),{maxVersion:111})),d.addSerializer(new l.UserSerializer("FastPathHint ",function(e,t){if(!e.isBinary())return e.inputOperator.readBool()},{maxVersion:111})),d.addSerializer(new u.ObjectSerializer("VertexArray",null,{minVersion:112})),d.addSerializer(new u.ObjectSerializer("NormalArray",null,{minVersion:112})),d.addSerializer(new u.ObjectSerializer("ColorArray",null,{minVersion:112})),d.addSerializer(new u.ObjectSerializer("SecondaryColorArray",null,{minVersion:112})),d.addSerializer(new u.ObjectSerializer("FogCoordArray",null,{minVersion:112})),d.addSerializer(new o.VectorSerializer("TexCoordArrayList","Array",{minVersion:112})),d.addSerializer(new o.VectorSerializer("VertexAttribArrayList","Array",{minVersion:112})),a.ObjectWrapperManager.addWrapper(d)},{M_272:87,i_271:113,s_268:116,W_269:124,e_257:133,s_252:139,M_248:140,k_186:141,W_253:143,M_264:144}],149:[function(e,t,r){"use strict";var n=e("k_186"),i=e("W_253"),a=e("M_248"),e=e("-_276"),e=new a.ObjectWrapper("osg::Group",["osg::Object","osg::Node","osg::Group"],e.Group);e.addSerializer(new i.UserSerializer("Children",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObject();i&&t.Children.push(i)}e.readEndBracket()})),n.ObjectWrapperManager.addWrapper(e)},{"-_276":117,M_248:140,k_186:141,W_253:143}],150:[function(e,t,r){"use strict";var n=e("k_186"),i=e("W_253"),a=e("__247"),o=e("M_248"),s=e("i_281"),u=e("d_214"),e=e("__215"),s=new o.ObjectWrapper("osg::LOD",["osg::Object","osg::Node","osg::LOD"],s.LOD);s.addSerializer(new a.EnumSerializer("CenterMode",u.CenterMode,u.CenterMode.USE_BOUNDING_SPHERE_CENTER)),s.addSerializer(new i.UserSerializer("UserCenter",function(e,t){var r=e.readVectorOfType(3,"Double"),e=e.inputOperator.readDouble();t.setProperty("UserCenter",{center:r,radius:e})})),s.addSerializer(new a.EnumSerializer("RangeMode",e.RangeMode,e.RangeMode.DISTANCE_FROM_EYE_POINT)),s.addSerializer(new i.UserSerializer("RangeList",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=[],i=0;i<r;i++){var a=e.inputOperator.readFloat(),o=e.inputOperator.readFloat();n.push([a,o])}e.readEndBracket(),t.setProperty("RangeList",n)})),n.ObjectWrapperManager.addWrapper(s)},{d_214:88,__215:97,i_281:119,__247:135,M_248:140,k_186:141,W_253:143}],151:[function(e,t,r){"use strict";function n(a,o){return function(e,t){var r=void 0;if("Float"===o)r=e.inputOperator.readFloat.bind(e.inputOperator);else{if("Vec4f"!==o)throw"serializeMaterial - type not supported";r=function(){return e.readVectorOfType(4,"Float")}}var n=e.inputOperator.readBool();e.readProperty("Front");var i=r();e.readProperty("Back"),r=r(),n?(t[a+"FrontAndBack"]=!0,t[a+"Front"]=i,t[a+"Back"]=i):(t[a+"FrontAndBack"]=!1,t[a+"Front"]=i,t[a+"Back"]=r)}}var i=e("k_186"),a=e("__247"),o=e("W_253"),s=e("M_248"),u=e("M_288"),e=e("e_289"),u=new s.ObjectWrapper("osg::Material",["osg::Object","osg::StateAttribute","osg::Material"],u.Material);u.addSerializer(new a.EnumSerializer("ColorMode",e.ColorMode,e.ColorMode.OFF)),u.addSerializer(new o.UserSerializer("Ambient",n("Ambient","Vec4f"))),u.addSerializer(new o.UserSerializer("Diffuse",n("Diffuse","Vec4f"))),u.addSerializer(new o.UserSerializer("Specular",n("Specular","Vec4f"))),u.addSerializer(new o.UserSerializer("Emission",n("Emission","Vec4f"))),u.addSerializer(new o.UserSerializer("Shininess",n("Shininess","Float"))),i.ObjectWrapperManager.addWrapper(u)},{e_289:93,M_288:120,__247:135,M_248:140,k_186:141,W_253:143}],152:[function(e,t,r){"use strict";var n=e("k_186"),i=e("h_291"),a=e("M_248"),e=e("3_293"),e=new a.ObjectWrapper("osg::MatrixTransform",["osg::Object","osg::Node","osg::Group","osg::Transform","osg::MatrixTransform"],e.MatrixTransform);e.addSerializer(new i.MatrixSerializer("Mode")),n.ObjectWrapperManager.addWrapper(e)},{"3_293":121,h_291:137,M_248:140,k_186:141}],153:[function(e,t,r){"use strict";var n=e("k_186"),i=e("e_254"),a=e("s_252"),o=e("W_253"),s=e("i_255"),u=e("M_248"),e=e("s_300"),e=new u.ObjectWrapper("osg::Node",["osg::Object","osg::Node"],e.Node);e.addSerializer(new o.UserSerializer("InitialBound",function(e,t){var r,n;e.readBeginBracket(),e.readProperty("Center"),r=e.readVectorOfType(3,"Double"),e.readProperty("Radius"),n=e.inputOperator.readDouble(),e.readEndBracket(),t.InitialBound={center:r,radius:n}})),e.addSerializer(new i.ObjectCallbackSerializer("ComputeBoundingSphereCallback")),e.addSerializer(new i.ObjectCallbackSerializer("UpdateCallback")),e.addSerializer(new i.ObjectCallbackSerializer("EventCallback")),e.addSerializer(new i.ObjectCallbackSerializer("CullCallback")),e.addSerializer(new s.PropByValSerializer("Bool","CullingActive",!0)),e.addSerializer(new s.PropByValSerializer("HEXINT","NodeMask",4294967295)),e.addSerializer(new o.UserSerializer("Descriptions",function(e,t){for(var r=e.inputOperator.readUInt(),n=0;n<r;++n){var i=e.inputOperator.readWrappedString();t.descriptions.push(i)}e.readEndBracket()},{maxVersion:76})),e.addSerializer(new a.ObjectSerializer("StateSet",null)),n.ObjectWrapperManager.addWrapper(e)},{s_300:122,e_254:138,s_252:139,M_248:140,k_186:141,i_255:142,W_253:143}],154:[function(e,t,r){"use strict";var n=e("k_186"),i=e("__247"),a=e("s_252"),o=e("W_253"),s=e("i_255"),u=e("M_248"),l=e("h_307"),e=e("-_308"),l=new u.ObjectWrapper("osg::Object",["osg::Object"],l.ObjectClass);l.addSerializer(new s.PropByValSerializer("String","Name","")),l.addSerializer(new i.EnumSerializer("DataVariance",e.ObjectDataVariance,e.ObjectDataVariance.UNSPECIFIED)),l.addSerializer(new o.UserSerializer("UserData",function(){throw"UserDataReader not yet supported"},{maxVersion:76})),l.addSerializer(new a.ObjectSerializer("UserDataContainer",null,{minVersion:77})),n.ObjectWrapperManager.addWrapper(l)},{"-_308":94,h_307:123,__247:135,s_252:139,M_248:140,k_186:141,i_255:142,W_253:143}],155:[function(e,t,r){"use strict";var n=e("k_186"),i=e("W_253"),a=e("i_255"),o=e("M_248"),e=e("i_313"),e=new o.ObjectWrapper("osg::PagedLOD",["osg::Object","osg::Node","osg::LOD","osg::PagedLOD"],e.PagedLOD);e.addSerializer(new i.UserSerializer("DatabasePath",function(e,t){e.inputOperator.readBool()&&(e=e.inputOperator.readWrappedString(),t.setProperty("DatabasePath",e))})),e.addSerializer(new a.PropByValSerializer("UInt","FrameNumberOfLastTraversal",0,{maxVersion:69})),e.addSerializer(new a.PropByValSerializer("UInt","NumChildrenThatCannotBeExpired",0)),e.addSerializer(new a.PropByValSerializer("Bool","DisableExternalChildrenPaging",!1)),e.addSerializer(new i.UserSerializer("RangeDataList",function(e,t){var r=[],n=[],i=[],a=e.inputOperator.readUInt();e.readBeginBracket();for(var o=0;o<a;o++){var s=e.inputOperator.readWrappedString();r.push(s)}e.readEndBracket(),e.readProperty("PriorityList"),a=e.inputOperator.readUInt(),e.readBeginBracket();for(var u=0;u<a;u++)n.push(e.inputOperator.readFloat()),i.push(e.inputOperator.readFloat());e.readEndBracket(),t.setProperty("RangeDataList",r),t.setProperty("PriorityOffsets",n),t.setProperty("PriorityScales",i)})),e.addSerializer(new i.UserSerializer("Children",function(e,t){var r=e.inputOperator.readUInt();if(0<r){var n=[];e.readBeginBracket();for(var i=0;i<r;i++){var a=e.readObjectOfType("osg::Node");a&&n.push(a)}e.readEndBracket(),t.setProperty("Children",n)}})),n.ObjectWrapperManager.addWrapper(e)},{i_313:125,M_248:140,k_186:141,i_255:142,W_253:143}],156:[function(e,t,r){"use strict";var n=e("k_186"),i=e("__247"),a=e("M_248"),o=e("W_317"),e=e("e_318"),o=new a.ObjectWrapper("osg::ShadeModel",["osg::Object","osg::StateAttribute","osg::ShadeModel"],o.ShadeModel);o.addSerializer(new i.EnumSerializer("Mode",e.ShadeModelMode,e.ShadeModelMode.SMOOTH)),n.ObjectWrapperManager.addWrapper(o)},{e_318:98,W_317:126,__247:135,M_248:140,k_186:141}],157:[function(e,t,r){"use strict";var n=e("k_186"),i=e("e_254"),a=e("M_248"),e=e("s_322"),e=new a.ObjectWrapper("osg::StateAttribute",["osg::Object","osg::StateAttribute"],e.StateAttribute);e.addSerializer(new i.ObjectCallbackSerializer("UpdateCallback")),e.addSerializer(new i.ObjectCallbackSerializer("EventCallback")),n.ObjectWrapperManager.addWrapper(e)},{s_322:127,e_254:138,M_248:140,k_186:141}],158:[function(e,t,r){"use strict";function i(e,t){Array.prototype.push.apply(e,t)}function a(e){var t=e.inputOperator.readUInt(),r=[];if(0<t){e.readBeginBracket();for(var n=0;n<t;n++){var i=new _.DataTypes.ObjectGLEnum;e.inputOperator.readGLEnum(i),r.push({key:i.value,value:s(e)})}e.readEndBracket()}return r}function o(e){var t=[],r=e.inputOperator.readUInt();if(0<r){e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::StateAttribute");e.readProperty("Value");var a=s(e);i&&t.push({key:i.getTypeMemberPair(),value:{StateAttribute:i,Value:a}})}e.readEndBracket()}return t}function s(e){if(e.isBinary())return e.inputOperator.readInt();var t=e.inputOperator.readString(),e=0;return 0<=t.indexOf("OFF")&&(e=g.StateAttributeValue.OFF),0<=t.indexOf("ON")&&(e=g.StateAttributeValue.ON),0<=t.indexOf("OVERRIDE")&&(e|=g.StateAttributeValue.OVERRIDE),0<=t.indexOf("PROTECTED")&&(e|=g.StateAttributeValue.PROTECTED),0<=t.indexOf("INHERIT")&&(e|=g.StateAttributeValue.INHERIT),e}var n=e("k_186"),u=e("W_253"),l=e("__247"),c=e("i_255"),d=e("e_254"),f=e("M_248"),h=e("i_329"),p=e("e_225"),m=e("s_226"),g=e("s_332"),_=e("e_193"),h=new f.ObjectWrapper("osg::StateSet",["osg::Object","osg::StateSet"],h.StateSet);h.addSerializer(new u.UserSerializer("ModeList",function(e,t){return e=a(e),i(t.ModeList,e),!0})),h.addSerializer(new u.UserSerializer("AttributeList",function(e,t){e=o(e),i(t.AttributeList,e)})),h.addSerializer(new u.UserSerializer("TextureModeList",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++)e.readProperty("Data"),i(t.TextureModeList,a(e));e.readEndBracket()})),h.addSerializer(new u.UserSerializer("TextureAttributeList",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++)e.readProperty("Data"),i(t.TextureAttributeList,o(e));e.readEndBracket()})),h.addSerializer(new u.UserSerializer("UniformList",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.readObjectOfType("osg::Uniform");e.inputOperator.readObjectProperty(e.PROPERTY.set("Value"));var a=s(e);i&&t.UniformList.push({Uniform:i,Value:a})}e.readEndBracket()})),h.addSerializer(new c.PropByValSerializer("Int","RenderingHint",p.RenderingHint.DEFAULT_BIN)),h.addSerializer(new l.EnumSerializer("RenderBinMode",m.RenderBinMode,m.RenderBinMode.DEFAULT_BIN)),h.addSerializer(new c.PropByValSerializer("Int","BinNumber",0)),h.addSerializer(new c.PropByValSerializer("String","BinName","")),h.addSerializer(new c.PropByValSerializer("Bool","NestRenderBins",!0)),h.addSerializer(new d.ObjectCallbackSerializer("UpdateCallback")),h.addSerializer(new d.ObjectCallbackSerializer("EventCallback")),h.addSerializer(new u.UserSerializer("DefineList",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString(),a=e.inputOperator.readWrappedString();e.inputOperator.readObjectProperty(e.PROPERTY.set("Value"));var o=s(e);t.DefineList[i]={DefineValue:a,OverrideValue:o}}e.readEndBracket()},{minVersion:151})),n.ObjectWrapperManager.addWrapper(h)},{e_193:84,s_332:99,s_226:100,e_225:101,i_329:128,__247:135,e_254:138,M_248:140,k_186:141,i_255:142,W_253:143}],159:[function(e,t,r){"use strict";function n(n){return function(e,t){var r=new d.ObjectGLEnum;e.inputOperator.readGLEnum(r),t.setProperty(n,r)}}var i=e("W_253"),a=e("i_255"),o=e("__247"),s=e("e_337"),u=e("-_228"),l=e("h_339"),c=e("-_340"),d=e("e_193"),f=e("M_248"),e=e("k_186"),s=new f.ObjectWrapper("osg::Texture",["osg::Object","osg::StateAttribute","osg::Texture"],s.Texture),h={R:6403,G:6404,B:6405,A:6406,0:0,1:1};s.addSerializer(new i.UserSerializer("WRAP_S",n("WrapS"))),s.addSerializer(new i.UserSerializer("WRAP_T",n("WrapT"))),s.addSerializer(new i.UserSerializer("WRAP_R",n("WrapR"))),s.addSerializer(new i.UserSerializer("MIN_FILTER",n("MinFilter"))),s.addSerializer(new i.UserSerializer("MAG_FILTER",n("MagFilter"))),s.addSerializer(new a.PropByValSerializer("Float","MaxAnisotropy",1)),s.addSerializer(new a.PropByValSerializer("Bool","UseHardwareMipMapGeneration",!0)),s.addSerializer(new a.PropByValSerializer("Bool","UnRefImageDataAfterApply",!1)),s.addSerializer(new a.PropByValSerializer("Bool","ClientStorageHint",!1)),s.addSerializer(new a.PropByValSerializer("Bool","ResizeNonPowerOfTwoHint",!0)),s.addSerializer(new a.PropByValSerializer("Vec4d","BorderColor",[0,0,0,0],{minVersion:79})),s.addSerializer(new a.PropByValSerializer("GLInt","BorderWidth",0,{minVersion:79})),s.addSerializer(new o.EnumSerializer("InternalFormatMode",u.InternalFormatMode,u.InternalFormatMode.USE_IMAGE_DATA_FORMAT,{minVersion:79})),s.addSerializer(new i.UserSerializer("InternalFormat",function(e,t){var r=new d.ObjectGLEnum;e.inputOperator.readGLEnum(r),t.getProperty("InternalFormatMode")===u.InternalFormatMode.USE_USER_DEFINED_FORMAT&&t.setInternalFormat(r.value)},{minVersion:79})),s.addSerializer(new i.UserSerializer("SourceFormat",n("SourceFormat"),{minVersion:79})),s.addSerializer(new i.UserSerializer("SourceType",n("SourceType"),{minVersion:79})),s.addSerializer(new a.PropByValSerializer("Bool","ShadowComparison",!1,{minVersion:79})),s.addSerializer(new o.EnumSerializer("ShadowCompareFunc",l.ShadowCompareFunc,l.ShadowCompareFunc.LEQUAL,{minVersion:79})),s.addSerializer(new o.EnumSerializer("ShadowTextureMode",c.ShadowTextureMode,c.ShadowTextureMode.LUMINANCE,{minVersion:79})),s.addSerializer(new a.PropByValSerializer("Float","ShadowAmbient",0,{minVersion:79})),s.addSerializer(new i.UserSerializer("ImageAttachment",function(e){e.inputOperator.readUInt(),e.inputOperator.readInt(),e.inputOperator.readBool(),e.inputOperator.readInt(),e.inputOperator.readInt(),e.inputOperator.readInt()},{minVersion:95,maxVersion:152})),s.addSerializer(new i.UserSerializer("Swizzle",function(e,t){for(var r=e.inputOperator.readString(),n=[],i=0;i<4;i++)n.push(h[r.charAt(i)]);t.setProperty("Swizzle",n)},{minVersion:98})),s.addSerializer(new a.PropByValSerializer("Float","MinLOD",0,{minVersion:155})),s.addSerializer(new a.PropByValSerializer("Float","MaxLOD",-1,{minVersion:155})),s.addSerializer(new a.PropByValSerializer("Float","LODBias",0,{minVersion:155})),e.ObjectWrapperManager.addWrapper(s)},{e_193:84,"-_228":102,h_339:103,"-_340":104,e_337:129,__247:135,M_248:140,k_186:141,i_255:142,W_253:143}],160:[function(e,t,r){"use strict";var n=e("k_186"),i=e("i_255"),a=e("k_346"),o=e("M_248"),e=e("s_348"),e=new o.ObjectWrapper("osg::Texture2D",["osg::Object","osg::StateAttribute","osg::Texture","osg::Texture2D"],e.Texture2D);e.addSerializer(new a.ImageSerializer("Image",null)),e.addSerializer(new i.PropByValSerializer("Int","TextureWidth",0)),e.addSerializer(new i.PropByValSerializer("Int","TextureHeight",0)),n.ObjectWrapperManager.addWrapper(e)},{s_348:130,k_346:136,M_248:140,k_186:141,i_255:142}],161:[function(e,t,r){"use strict";var n=e("k_186"),i=e("__247"),a=e("M_248"),o=e("M_352"),e=e("e_353"),o=new a.ObjectWrapper("osg::Transform",["osg::Object","osg::Node","osg::Group","osg::Transform"],o.Transform);o.addSerializer(new i.EnumSerializer("Mode",e.ReferenceFrame,e.ReferenceFrame.RELATIVE_RF)),n.ObjectWrapperManager.addWrapper(o)},{e_353:105,M_352:131,__247:135,M_248:140,k_186:141}],162:[function(e,t,r){"use strict";var n=e("k_186"),i=e("W_253"),a=e("M_248"),o=e("i_271"),e=new a.ObjectWrapper("osg::UserDataContainer",["osg::Object","osg::UserDataContainer"],null),o=new a.ObjectWrapper("osg::DefaultUserDataContainer",["osg::Object","osg::UserDataContainer","osg::DefaultUserDataContainer"],o.DefaultUserDataContainer);o.addSerializer(new i.UserSerializer("UDC_UserData",function(e,t){e.readBeginBracket(),t.UserData=e.readObject(),e.readEndBracket()})),o.addSerializer(new i.UserSerializer("UDC_Descriptions",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString();t.DescriptionList.push(i)}e.readEndBracket()})),o.addSerializer(new i.UserSerializer("UDC_UserObjects",function(e,t){var r=e.inputOperator.readUInt();e.readBeginBracket();for(var n=0;n<r;n++){var i=e.inputOperator.readWrappedString();t.ObjectList.push(i)}e.readEndBracket()})),n.ObjectWrapperManager.addWrapper(o),n.ObjectWrapperManager.addWrapper(e)},{i_271:113,M_248:140,k_186:141,W_253:143}],163:[function(e,t,r){"use strict";e("d_358"),e("s_210"),e("M_360"),e("i_361"),e("e_209"),e("e_363"),e("s_364"),e("M_208"),e("s_204"),e("i_367"),e("W_205"),e("e_369"),e("3_229"),e("h_371"),e("i_217"),e("i_207"),e("i_57"),e("__375")},{d_358:145,s_210:146,M_360:147,i_361:148,e_209:149,i_57:150,e_363:151,s_364:152,M_208:153,s_204:154,__375:155,i_367:156,W_205:157,e_369:158,"3_229":159,h_371:160,i_217:161,i_207:162}],164:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Geometry=r.ObjectClass=r.StateSet=r.Texture=r.Texture2D=r.StateAttribute=r.Material=r.MatrixTransform=r.OsgArray=r.Geode=r.Image=r.Drawable=r.Group=r.Node=r.EnumToString=r.readFile=r.readBuffer=r.Log=r.ImageType=r.PrimitiveTable=r.RangeMode=r.CenterMode=r.ShadeModelMode=r.AttributeBinding=r.GLEnum=r.PrimitiveMode=r.InternalFormatMode=r.ReferenceFrame=r.RenderingHint=r.StateAttributeValue=r.ColorMode=r.FaceMode=r.ShadowTextureMode=r.RenderBinMode=void 0;var n=e("M_376");Object.defineProperty(r,"RenderBinMode",{enumerable:!0,get:function(){return n.RenderBinMode}});var i=e("i_377");Object.defineProperty(r,"ShadowTextureMode",{enumerable:!0,get:function(){return i.ShadowTextureMode}});var a=e("k_378");Object.defineProperty(r,"FaceMode",{enumerable:!0,get:function(){return a.FaceMode}});var o=e("e_379");Object.defineProperty(r,"ColorMode",{enumerable:!0,get:function(){return o.ColorMode}});var s=e("s_380");Object.defineProperty(r,"StateAttributeValue",{enumerable:!0,get:function(){return s.StateAttributeValue}});var u=e("W_381");Object.defineProperty(r,"RenderingHint",{enumerable:!0,get:function(){return u.RenderingHint}});var l=e("e_382");Object.defineProperty(r,"ReferenceFrame",{enumerable:!0,get:function(){return l.ReferenceFrame}});var c=e("i_383");Object.defineProperty(r,"InternalFormatMode",{enumerable:!0,get:function(){return c.InternalFormatMode}});var d=e("M_384");Object.defineProperty(r,"PrimitiveMode",{enumerable:!0,get:function(){return d.PrimitiveMode}});var f=e("e_385");Object.defineProperty(r,"GLEnum",{enumerable:!0,get:function(){return f.GLEnum}});var h=e("s_386");Object.defineProperty(r,"AttributeBinding",{enumerable:!0,get:function(){return h.AttributeBinding}});var p=e("h_387");Object.defineProperty(r,"ShadeModelMode",{enumerable:!0,get:function(){return p.ShadeModelMode}});var m=e("-_388");Object.defineProperty(r,"CenterMode",{enumerable:!0,get:function(){return m.CenterMode}});var g=e("3_389");Object.defineProperty(r,"RangeMode",{enumerable:!0,get:function(){return g.RangeMode}});var _=e("d_390");Object.defineProperty(r,"ImageType",{enumerable:!0,get:function(){return _.ImageType}});var v=e("__391");Object.defineProperty(r,"Log",{enumerable:!0,get:function(){return v.Log}});var y=e("M_392");Object.defineProperty(r,"readBuffer",{enumerable:!0,get:function(){return y.readBuffer}}),Object.defineProperty(r,"readFile",{enumerable:!0,get:function(){return y.readFile}});var b=e("i_393");Object.defineProperty(r,"EnumToString",{enumerable:!0,get:function(){return b.EnumToString}}),r.traverse=function e(t,r){r&&r(t);var n=t.Children;if(n&&n.length)for(var i=0;i<n.length;i++)e(n[i],r)};var x=e("k_394");Object.defineProperty(r,"Node",{enumerable:!0,get:function(){return x.Node}});var M=e("e_395");Object.defineProperty(r,"Group",{enumerable:!0,get:function(){return M.Group}});var w=e("s_396");Object.defineProperty(r,"Drawable",{enumerable:!0,get:function(){return w.Drawable}});var T=e("W_397");Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return T.Image}});var S=e("e_398");Object.defineProperty(r,"Geode",{enumerable:!0,get:function(){return S.Geode}});var E=e("i_399");Object.defineProperty(r,"OsgArray",{enumerable:!0,get:function(){return E.OsgArray}});var C=e("M_400");Object.defineProperty(r,"MatrixTransform",{enumerable:!0,get:function(){return C.MatrixTransform}});var A=e("e_401");Object.defineProperty(r,"Material",{enumerable:!0,get:function(){return A.Material}});var O=e("s_402");Object.defineProperty(r,"StateAttribute",{enumerable:!0,get:function(){return O.StateAttribute}});var L=e("h_403");Object.defineProperty(r,"Texture2D",{enumerable:!0,get:function(){return L.Texture2D}});var P=e("-_404");Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return P.Texture}});var I=e("3_405");Object.defineProperty(r,"StateSet",{enumerable:!0,get:function(){return I.StateSet}});var R=e("d_406");Object.defineProperty(r,"ObjectClass",{enumerable:!0,get:function(){return R.ObjectClass}});var D=e("__407");Object.defineProperty(r,"Geometry",{enumerable:!0,get:function(){return D.Geometry}});e=e("M_408");r.PrimitiveTable=e.PrimitiveTableEnum},{__391:85,s_386:87,"-_388":88,k_378:89,i_393:90,e_385:91,d_390:92,e_379:93,M_384:95,M_408:96,"3_389":97,h_387:98,s_380:99,M_376:100,W_381:101,i_383:102,i_377:104,e_382:105,M_392:109,s_396:114,e_398:115,__407:116,e_395:117,W_397:118,e_401:120,M_400:121,k_394:122,d_406:123,i_399:124,s_402:127,"3_405":128,"-_404":129,h_403:130}],165:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CSG=void 0;var p=e("i_409")._CSG;p.toCSG=function(e,t){var r=Cesium,n=r.GeometryPipeline;if(r.PrimitiveType,t=t||{x:0,y:0,z:0},4!==(e=!e.attributes.normal?n.computeNormal(e):e).primitiveType)throw new Error("暂不支持此类几何体");for(var i=[],a=[],o=e.attributes.position.values,s=e.attributes.normal.values,u=0;u<e.indices.length;u+=3){var a=[],l=e.indices[u],c=e.indices[u+1],d=e.indices[u+2],f=3*l,h=3*l;a.push(new p.Vertex([o[f++]+t.x,o[f++]+t.y,o[+f]+t.z],[s[h++],s[h++],s[+h]])),h=f=3*c,a.push(new p.Vertex([o[f++]+t.x,o[f++]+t.y,o[+f]+t.z],[s[h++],s[h++],s[+h]])),h=f=3*d,a.push(new p.Vertex([o[f++]+t.x,o[f++]+t.y,o[+f]+t.z],[s[h++],s[h++],s[+h]])),i.push(new p.Polygon(a))}return p.fromPolygons(i)},p.fromCSG=function(e){var t,r=e.toPolygons();if(!p)throw new Error("CSG 库未加载。请从 https://github.com/evanw/csg.js 获取");for(var n=[],i=[],a=[],o=0;o<r.length;o++){for(t=[],s=0;s<r[o].vertices.length;s++)t.push(this.getGeometryVertice(n,i,r[o].vertices[s].pos,r[o].plane.normal));t[0]===t[t.length-1]&&t.pop();for(var s=2;s<t.length;s++)a.push(t[0],t[s-1],t[s])}var u=Cesium,l=u.GeometryAttribute,c=u.ComponentDatatype,e=u.Geometry;u.PrimitiveType;n=new Float32Array(n),i=new Float32Array(i),a=new Int32Array(a),u={};return u.position=new l({componentDatatype:c.FLOAT,componentsPerAttribute:3,values:n}),u.normal=new l({componentDatatype:c.FLOAT,componentsPerAttribute:3,values:i}),new e({attributes:u,indices:a,primitiveType:4})},p.getGeometryVertice=function(e,t,r,n){for(var i=0,a=0;a<e.length;a+=3){if(e[a]===r.x&&e[a+1]===r.y&&e[a+2]===r.z)return i;i++}return e.push(r.x,r.y,r.z),t.push(n.x,n.y,n.z),i},r.CSG=p},{i_409:77}],166:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}(i,[{key:"run",value:function(d){var f=this;return new Promise(function(o,s){var u=f.dataList.length,l=0,c=[];!function t(){try{var e,r,n,i,a;0==f.dataList.length?(d&&d(100,null),o(c)):(r=100*(e=u-f.dataList.length)/u,n=f.dataList.shift(),d&&d(r,n,e,u),i=f.workFunc(n,l),(a=Array.isArray(i))||(i=[i]),Promise.all(i).then(function(e){a||!e?c.push(e):c.push(e[0]),l++,requestAnimationFrame(t)}).catch(function(e){c.splice(0),s(e)}))}catch(e){c.splice(0),s(e)}}()})}}]),i);function i(e,t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),!e||!e.length)throw new Error("dataList is required");if("function"!=typeof t)throw new Error("workFunc is required");this.dataList=e,this.workFunc=t}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{}],167:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}r.MathUtils=(n(a,null,[{key:"add",value:function(e,t){var r,n;try{r=e.toString().split(".")[1].length,n=t.toString().split(".")[1].length}catch(e){n=r=0}return(e*(n=Math.pow(10,Math.max(r,n)))+t*n)/n}},{key:"sub",value:function(e,t){return this.add(e,-t)}},{key:"mul",value:function(e,t){var r,n;try{r=e.toString().split(".")[1].length,n=t.toString().split(".")[1].length}catch(e){n=r=0}return e*(n=Math.pow(10,Math.max(r,n)))*(t*n)/(n*n)}},{key:"div",value:function(e,t){if(0==t)return 0;var r=0,n=0;try{r=e.toString().split(".")[1].length,n=t.toString().split(".")[1].length}catch(e){}return Number(e.toString().replace(".",""))/Number(t.toString().replace(".",""))*Math.pow(10,n-r)}},{key:"minmax",value:function(e,t,r){t=t||0,r=r||1;for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,a=t;a<e.length;a+=r){var o=e[a];isNaN(o)||o==1/0||o==-1/0||(n=Math.min(n,o),i=Math.max(i,o))}return{min:n,max:i}}},{key:"findCrossPoint",value:function(e,t,r,n,i,a){var o=e.x,s=t.x,u=r.x,l=n.x,c=e.y,d=t.y,f=r.y,h=n.y,p=d-c,m=o-s,g=o*d-s*c,e=h-f,t=u-l,r=u*h-l*f,n=p*t-e*m;if(0==n)return n;if(i.x=(g*t-r*m)/n,i.y=(p*r-e*g)/n,!a)return n;a=Math.abs;return a(i.x-(o+s)/2)<=a(s-o)/2&&a(i.y-(c+d)/2)<=a(d-c)/2&&a(i.x-(u+l)/2)<=a(l-u)/2&&a(i.y-(f+h)/2)<=a(h-f)/2?n:0}},{key:"getDigits",value:function(e){e=e.toString().split(".")[1];return e?e.length:0}},{key:"clampToLine",value:function(e,t,r){var n=Cesium.Cartesian2,i=n.subtract(e,t,new n),a=n.subtract(r,t,new n),r=i.x*a.y-a.x*i.y;if(Math.abs(r)<1e-16)return e;r=n.magnitude(i);return n.angleBetween(i,a)<1e-16?e:(n.normalize(a,a),n.multiplyByScalar(a,r,a),n.add(t,a,e))}},{key:"distanceToSegment",value:function(e,t,r){var n=Cesium.Cartesian2,e=(Cesium.Math,n.subtract(e,t,new n)),r=n.subtract(r,t,new n),t=n.magnitude(e);if(Math.abs(t)<=1e-16)return t;r=n.angleBetween(e,r);return Math.sin(r)*t}},{key:"circumcircle",value:function(e,t,r){var n=t.x-e.x,i=t.y-e.y,a=r.x-e.x,o=r.y-e.y,s=n*(e.x+t.x)+i*(e.y+t.y),u=a*(e.x+r.x)+o*(e.y+r.y),t=2*(n*(r.y-t.y)-i*(r.x-t.x)),i=(o*s-i*u)/t,s=(n*u-a*s)/t,t=i-e.x,e=s-e.y,e=t*t+e*e;return{x:i,y:s,r:Math.sqrt(e),r2:e}}},{key:"pointOnSegment",value:function(e,t,r,n,i){var a=Math.min,o=Math.max,s=Math.abs;n=null==n?1e-8:n,i=null==i?1:i;var u=a(t.x,r.x),l=o(t.x,r.x),a=a(t.y,r.y),o=o(t.y,r.y);if(u-n<=e.x&&e.x<=l+n&&a-n<=e.y&&e.y<=o+n){o=Cesium.Cartesian2,n=Cesium.Math,e=o.subtract(e,t,new o),t=o.subtract(r,t,new o);if(s(e.x*t.y-t.x*e.y)<1e-16)return!0;t=o.angleBetween(e,t);return(t=n.toDegrees(t))<=i}return!1}},{key:"pointInPolygon",value:function(e,t){for(var r=t.length,n=e.x,i=e.y,a=!1,o=0,s=r-1;o<r;s=o++){var u=t[o].x,l=t[o].y,c=t[s].x,d=t[s].y;i<l!=i<d&&n<(c-u)*(i-l)/(d-l)+u&&(a=!a)}return a}},{key:"pointOnTriangle",value:function(e,t,r,n){var i=a.pointOnSegment(e,t,r);return!!i&&!!(i=a.pointOnSegment(e,t,n))&&a.pointOnSegment(e,r,n)}}]),a)},{}],168:[function(e,t,r){"use strict";function l(e,t,r){var n=r.length;return t.has(e)?n=t.get(e):(t.set(e,n),r.push(e)),n}function c(e,t,r){for(var n in e)if(e.hasOwnProperty(n)){if(!Object.isExtensible(e))continue;var i=e[n],a=r[n],o=r.length.toString();if("string"==typeof i&&i.length>o.length||"color"==a||"matrix"==a)"matrix"==a&&(i=i.join(",")),i=t.has(i)?"$"+t.get(i):"$"+l(i,t,r);else if(Array.isArray(i))for(var s=0;s<i.length;s++){var u=i[s];"object"==(void 0===u?"undefined":d(u))&&c(u,t,r)}else"object"==(void 0===i?"undefined":d(i))&&c(i,t,r);e[n]=i}}function a(e,t){for(var r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?"number"!=typeof n[0]&&a(n,t):"object"==(void 0===n?"undefined":d(n))&&f(n,t)}}function o(e,t,r){var n,i,a=!1;for(n in t||(t=new Map,r=[],a=!0),e)e.hasOwnProperty(n)&&(i=e[n],(0,g.isTypedArray)(i)?i=Array.from(i):Array.isArray(i)?function e(t,r,n){for(var i=0;i<t.length;i++){var a=t[i];Array.isArray(a)?"number"!=typeof a[0]&&e(a,r,n):"object"==(void 0===a?"undefined":d(a))&&o(a,r,n)}}(i,t,r):"object"==(void 0===i?"undefined":d(i))?o(i,t,r):"type"!=n&&"uuid"!=n||(i=l(i,t,r)),e[l(n,t,r)]=i,delete e[n]);return a&&(c(e,t,r),e.codeBook=r,t.clear()),e}function f(e,t){for(var r in t||(t=e.codeBook,delete e.codeBook),e){var n,i;e.hasOwnProperty(r)&&(n=e[r],"uuid"==(i=t[r])||"type"==i?n=t[n]:"string"==typeof n&&"$"==n[0]?(n=t[n.slice(1)],"matrix"==i?n=JSON.parse("["+n+"]"):Array.isArray(n)?a(n,t):"object"==(void 0===n?"undefined":d(n))&&f(n,t)):Array.isArray(n)?a(n,t):"object"==(void 0===n?"undefined":d(n))&&f(n,t),e[i||r]=n,i&&delete e[r])}return e}function s(e,t){if("number"==typeof e[0][0]){0==t.length&&(t.byteLength=0);var r=e.length,n=[];e.forEach(function(e){n.push(e[0],e[1])});var i=(n=new Float32Array(n).buffer).byteLength,a=t.byteLength;return t.push(n),t.byteLength+=i,{byteOffset:a,count:r}}for(var o=0;o<e.length;o++)e[o]=s(e[o],t);return e}function u(e,t){if("number"==typeof e.byteOffset){var r=e,n=r.byteOffset,r=r.count,i=new Float32Array(t.buffer||t,n,2*r);e=[];for(var a=0;a<i.length;a+=2)e.push([i[a],i[a+1]])}else for(var o=0;o<e.length;o++)e[o]=u(e[o],t);return e}function h(e,t,r){r=r||0;var n=e.buffer;if(delete e.buffer,console.time("toByteArray"),n=(0,p.toByteArray)(n),console.timeEnd("toByteArray"),console.time("decodeGeojsonCoords"),"FeatureCollection"!=e.type)return"Feature"!=e.type||(i=e.geometry)&&(i.coordinates=u(i.coordinates,n)),console.timeEnd("decodeGeojsonCoords"),Promise.resolve(e);var i=e.features,a=[],o=[],s=1e4<i.length?i.length/80:i.length/40;return a.push(o),i.forEach(function(e,t){e.geometry&&(o.length>s&&(o=[],a.push(o)),o.push(e))}),new m.default(a,function(e){e.forEach(function(e){e=e.geometry;e.coordinates=u(e.coordinates,n)})}).run(function(e){t&&t(r+.5*e)}).then(function(){return console.timeEnd("decodeGeojsonCoords"),r=100,t&&t(r),e})}Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.encodeObjectValues=c,r.encodeObject=o,r.decodeObject=f,r.encodeGeojsonCoords=s,r.decodeGeojsonCoords=u,r.encodeGeojson=function(e){console.time("encodeGeojsonCoords");var t=[];return"FeatureCollection"==e.type?e.features.forEach(function(e){e.geometry&&s(e.geometry.coordinates,t)}):"Feature"==e.type&&e.geometry&&s(e.geometry.coordinates,t),console.timeEnd("encodeGeojsonCoords"),console.time("encodeObject"),e=o(e),console.timeEnd("encodeObject"),console.time("mergeBuffers"),e.buffer=(0,n.mergeBuffers)(t),console.timeEnd("mergeBuffers"),console.time("fromByteArray"),e.buffer=(0,p.fromByteArray)(new Uint8Array(e.buffer)),console.timeEnd("fromByteArray"),e},r.decodeGeojson=function(e){if(console.time("decodeObject"),e.codeBook){var t,r,n=e.codeBook;for(t in e)!e.hasOwnProperty(t)||(r=n[t])&&(e[r]=e[t],delete e[t]);f(e)}console.timeEnd("decodeObject");var i,a=e.buffer;return delete e.buffer,a&&(console.time("toByteArray"),a=(0,p.toByteArray)(a),console.timeEnd("toByteArray"),console.time("decodeGeojsonCoords"),"FeatureCollection"==e.type?e.features.forEach(function(e,t){e=e.geometry;e&&(e.coordinates=u(e.coordinates,a))}):"Feature"!=e.type||(i=e.geometry)&&(i.coordinates=u(i.coordinates,a)),console.timeEnd("decodeGeojsonCoords"),delete e.buffer),e},r.decodeGeojsonCoordsAsync=h,r.decodeGeojsonAsync=function(e,t){if(e.codeBook){console.time("decodeObject");var r,n,i,a=e.codeBook;for(r in delete e.codeBook,e)e.hasOwnProperty(r)&&(n=a[r],i=e[r],void 0!==(i=a[i])&&(e[r]=i),n&&(e[n]=e[r],delete e[r]));if("Feature"!=e.type){var o=e.features,s=[],u=[],l=0,c=1e4<o.length?o.length/80:o.length/40;s.push(u);var d=a.indexOf("geometry");return o.forEach(function(e,t){e[d]&&(u.length>c&&(u=[],s.push(u)),u.push(e))}),new m.default(s,function(e){e.forEach(function(e){f(e,a)})}).run(function(e){l=.5*e,t&&t(l)}).then(function(){return console.timeEnd("decodeObject"),l=50,t&&t(l),h(e,t,l)})}f(e)}return e.buffer?h(e):Promise.resolve(e)};var p=e("k_410"),r=e("e_411"),m=r&&r.__esModule?r:{default:r},g=e("s_412"),n=e("W_413")},{k_410:76,e_411:166,s_412:175,W_413:176}],169:[function(e,t,r){"use strict";function n(){}Object.defineProperty(r,"__esModule",{value:!0}),n.GetExtension=function(e){var t=e.lastIndexOf(".");return 0<=t?e.substring(t,e.length):""},n.GetFileName=function(e){var t=e.lastIndexOf("/");return t<0&&(t=e.lastIndexOf("\\"))<0?e:e.substring(t+1,e.length)},n.GetDirectoryName=function(e){var t=e.lastIndexOf("/");return t<0?"":e.substring(0,t)},n.Combine=function(e,t){return e+t},n.ChangeExtension=function(e,t){return e.replace(n.GetExtension(e),t)},r.Path=n},{}],170:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}r.StringUtil=(n(a,null,[{key:"trim",value:function(e,t){var r=0,n=e.length;for(t=t||"(\\s|\\t)+",t=new RegExp(t);t.test(e[r])&&r<e.length;)r++;for(var i=e[n-1];t.test(i)&&0<n;)i=e[--n-1];return e.substring(r,n)}},{key:"paddingStart",value:function(e,t){t-=(e+="").length;return new Array(t).fill("0").join("")+e}}]),a)},{}],171:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.computeArea=function(e,t,r){if(!e||!t||!r)return console.warn(e,t,r),0;var n=Cesium.Cartesian3,i=n.distance(e,t),t=n.distance(t,r),e=n.distance(e,r),r=(i+t+e)/2;return Math.sqrt(r*(r-i)*(r-t)*(r-e))}},{}],172:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._defineProperty=function(n,e,t,i){var a="_"+e;n[a]=t;var r={get:function(){return this[a]},set:function(e){var t=e!=this[a];this[a]&&this[a].equals&&e&&(t=this[a].equals(e));var r=this[a];this[a]=e,"function"==typeof i&&t&&i(t,n,e,r)}};(t={})[e]=r,Object.defineProperties(n,t)}},{}],173:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.determinant=function(e){var t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],d=e[10],f=e[14];return e[3]*(+i*s*c-n*u*c-i*o*d+r*u*d+n*o*f-r*s*f)+e[7]*(+t*s*f-t*u*d+i*a*d-n*a*f+n*u*l-i*s*l)+e[11]*(+t*u*c-t*o*f-i*a*c+r*a*f+i*o*l-r*u*l)+e[15]*(-n*o*l-t*s*c+t*o*d+n*a*c-r*a*d+r*s*l)}},{}],174:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}r.geojsonHelper=(n(a,null,[{key:"featureEach",value:function(e,t){if("Feature"==e.type)t(e,0);else{e.features;for(var r=0;r<e.features.length;r++)t(e.features[r],r)}}},{key:"geometryEach",value:function(e,n){var t=e.type;"Feature"==t||"FeatureCollection"==t?this.featureEach(e,function(e,r){e=e.geometry;"MultiGeometry"==e.type?e.geometry.forEach(function(e,t){n(e,r,t)}):n(e,r,0)}):(e=e,"MultiGeometry"==t?e.geometry.forEach(function(e,t){n(e,0,t)}):n(e,0,0))}},{key:"coordinateEach",value:function(e,i){this.geometryEach(e,function(e,t,r){var n=e.type,e=e.coordinates;"LineString"==n||"MultiPoint"==n?e.forEach(i):"MultiLineString"==n||"Polygon"==n?e.forEach(function(e){e.forEach(i)}):"Point"==n?i(e):"MultiPolygon"==n&&e.forEach(function(e){e.forEach(function(e){e.forEach(i)})})})}},{key:"calcBBox",value:function(e){var i=this,a=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE];return this.featureEach(e,function(e){var t,r,n;e&&e.geometry&&((t=e.geometry.bbox)&&0==t.filter(function(e){if(!isNaN(e))return e}).length||(r=[],n=[],i.coordinateEach(e,function(e){0<r.length?(r[0]=Math.min(e[0],r[0]),r[1]=Math.min(e[1],r[1]),n[0]=Math.max(e[0],n[0]),n[1]=Math.max(e[1],n[1])):(r[0]=e[0],r[1]=e[1],n[0]=e[0],n[1]=e[1])}),e.geometry.bbox=[r[0],r[1],n[0],n[1]],a[0]=Math.min(a[0],r[0]),a[1]=Math.min(a[1],r[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])))}),a}}]),a)},{}],175:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isTypedArray=function(e){return e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}},{}],176:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mergeBuffers=function(e){e=e.map(function(e){return e instanceof DataView||e instanceof Uint8Array?e.buffer:e});var t=0;e.forEach(function(e){return t+=e.byteLength});var r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(new Uint8Array(e),n),n+=e.byteLength}),r.buffer}},{}],177:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseDefines=function(e){var t,r,n=[];for(t in e.defines)e.defines.hasOwnProperty(t)&&(r=e.defines[t],n.push("#define "+t+" "+r));return n=n.join("\n")+"\n",e.fragmentShader&&(e.fragmentShader=n+e.fragmentShader),e.vertexShader&&(e.vertexShader=n+e.vertexShader),e}},{}],178:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var v,n=(v=function(e,t,r){this.a=e,this.b=t,this.c=r;var n=t.x-e.x,i=t.y-e.y,a=r.x-e.x,o=r.y-e.y,s=n*(e.x+t.x)+i*(e.y+t.y),u=a*(e.x+r.x)+o*(e.y+r.y),t=2*(n*(r.y-t.y)-i*(r.x-t.x));this.x=(o*s-i*u)/t,this.y=(n*u-a*s)/t,t=this.x-e.x,e=this.y-e.y,this.r=t*t+e*e},function(e){if(e.length<3)return[];e.sort(y);for(var t,r,n,i,a,o=e[_=e.length-1].x,s=e[0].x,u=e[_].y,l=u;_--;)e[_].y<u&&(u=e[_].y),e[_].y>l&&(l=e[_].y);for(var c,d=s-o,f=l-u,h=f<d?d:f,p=[new v({__sentinel:!0,x:(s=.5*(s+o))-20*h,y:(o=.5*(l+u))-h},{__sentinel:!0,x:s,y:o+20*h},{__sentinel:!0,x:s+20*h,y:o-h})],m=[],g=[],_=e.length;_--;){for(g.length=0,c=p.length;c--;)0<(d=e[_].x-p[c].x)&&d*d>p[c].r?(m.push(p[c]),p.splice(c,1)):d*d+(f=e[_].y-p[c].y)*f>p[c].r||(g.push(p[c].a,p[c].b,p[c].b,p[c].c,p[c].c,p[c].a),p.splice(c,1));for(function(e){var t,r,n,i,a,o=e.length;e:for(;o;)for(r=e[--o],t=e[--o],n=o;n;)if(a=e[--n],i=e[--n],t===i&&r===a||t===a&&r===i){e.splice(o,2),e.splice(n,2),o-=2;continue e}}(g),c=g.length;c;)r=g[--c],t=g[--c],n=e[_],i=r.x-t.x,a=r.y-t.y,a=2*(i*(n.y-r.y)-a*(n.x-r.x)),1e-12<Math.abs(a)&&p.push(new v(t,r,n))}for(Array.prototype.push.apply(m,p),_=m.length;_--;)(m[_].a.__sentinel||m[_].b.__sentinel||m[_].c.__sentinel)&&m.splice(_,1);return m});function y(e,t){return t.x-e.x}r.default=n},{}],179:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{e_75:180,dup:25}],180:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],181:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExtrudedPolygonGeometry=void 0;var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e},e=e("e_414"),k=e&&e.__esModule?e:{default:e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.options=e,t}r.ExtrudedPolygonGeometry=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,Cesium.PolygonGeometry),n(a,[{key:"generateExtrudedUvNormal",get:function(){return this.options.generateExtrudedUvNormal},set:function(e){this.options.generateExtrudedUvNormal=e}}],[{key:"createGeometry",value:function(e){var t=Cesium.PolygonGeometry;return e.options.generateExtrudedUvNormal?this.createGeometryWithExtrudedUvNormal(e):t.createGeometry(e)}},{key:"createGeometryWithExtrudedUvNormal",value:function(e){for(var t=Cesium,r=t.PolygonGeometry,n=t.GeometryAttribute,i=t.ComponentDatatype,a=t.Cartesian3,o=t.Cartesian2,s=t.Geometry,u=t.Cartographic,l=t.Ellipsoid,c=t.BoundingSphere,d=(t.PrimitiveType,t.Math.EPSILON5),f=e.options.height||0,r=r.createGeometry(e),e=k.default.cloneGeometryAttributes(r.attributes),h=r.indices,r=r.attributes,p=a.unpackArray(r.position.values),m=a.unpackArray(r.normal.values),g=o.unpackArray(r.st.values),_=new u,v=new u,y=new u,b=l.WGS84,x=[],M=[],w=[],T=[],S=[],E=0;E<h.length;E+=3){var C=h[E],A=h[E+1],O=h[E+2],L=p[C],P=p[A],I=p[O],R=m[C],D=m[A],U=m[O],C=g[C],A=g[A],O=g[O];u.fromCartesian(L,b,_),u.fromCartesian(P,b,v),u.fromCartesian(I,b,y),x.push(L,P,I),M.push(R,D,U),w.push(C,A,O),C=C.clone(),A=A.clone(),O=O.clone(),T.push(C,A,O);var N,B,U={position:[L,P,I],st:[C,A,O],normal:[0,0,0]},L=[],P=[];(_.height-f>=d?L:P).push(0),(v.height-f>=d?L:P).push(1),(y.height-f>=d?L:P).push(2),2==L.length?(I=L[0],N=L[1],B=P[0],C=U.st[I],A=U.st[N],O=U.st[B],C.x=0,A.x=1,O.x=0,C.y=1,A.y=1,O.y=0):2==P.length?(N=P[0],B=P[1],L=L[0],C=U.st[N],A=U.st[B],O=U.st[L],C.x=0,A.x=1,O.x=1,C.y=0,A.y=0,O.y=1):3==P.length?(U.normal.fill(-1),C.x=0,A.x=0,O.x=0,C.y=0,A.y=0,O.y=0):(U.normal.fill(1),C.x=1,A.x=1,O.x=1,C.y=1,A.y=1,O.y=1),S.push(U.normal[0],U.normal[1],U.normal[2])}return x=a.packArray(x,new Float32Array(3*x.length)),M=a.packArray(M,new Float32Array(3*M.length)),w=o.packArray(w,new Float32Array(2*w.length)),S=new Int8Array(S),T=o.packArray(T,new Float32Array(2*T.length)),e.position.values=x,e.normal.values=M,e.st.values=w,e.extrudedNormal=new n({componentDatatype:i.BYTE,componentsPerAttribute:1,values:S,normalize:!1}),e.extrudedUv=new n({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:T,normalize:!1}),new s({attributes:e,primitiveType:4,boundingSphere:c.fromVertices(x)})}}]),a)},{e_414:11}],182:[function(e,t,r){"use strict";function n(e,t,r){this.contour=e||[],this.holes=t||0,this.height=r||0}function o(e,t){var r=THREE,n=r.BufferGeometry,r=r.BufferAttribute,i=new Float32Array(3*e.length),a=0;e.forEach(function(e){i[a++]=e.x,i[a++]=e.y,i[a++]=e.z});n=new n;return n.setAttribute("position",new r(i,3,!1)),n.setIndex(t),n.computeVertexNormals(),n}function a(e,t,r,n){for(var i=THREE.Vector3,a=e[0],o=[],s=1;s<e.length;s++)o.push(e[s]);a=a.map(function(e){return Array.isArray(e)?new i(e[0],e[1],t):e}),o=o.map(function(e){return e.map(function(e){return Array.isArray(e)?new i(e[0],e[1],t):e})}),u(a,o,r,n)}Object.defineProperty(r,"__esModule",{value:!0});var e=e("e_414"),u=(e&&e.__esModule?e:{default:e}).default.triangulateShape;n.createGeometry=function(e){var t=THREE.Vector3,r=e.contour,n=e.holes,i=e.height,a=[],e=[],r=r.map(function(e){return Array.isArray(e)?new t(e[0],e[1],i):e}),n=n.map(function(e){return e.map(function(e){return Array.isArray(e)?new t(e[0],e[1],i):e})});return u(r,n,a,e),o(a,e)},n.fromFeatures=function(e,r){var n=[],i=[];if(r=r||.1,e.forEach(function(e){var t=e.geometry,e=t.type,t=t.coordinates;"Polygon"==e?a(t,r,n,i):"MultiPolygon"==e&&t.forEach(function(e){a(e,r,n,i)})}),n.length)return o(n,i)},r.default=n},{e_414:11}],183:[function(e,t,r){"use strict";function h(e,t){t=Cesium.Cartesian2.subtract(e,t,new Cesium.Cartesian2);return Cesium.Cartesian2.normalize(t,t),new Cesium.Cartesian2(-t.y,t.x)}function p(e,t){return e=Cesium.Cartesian2.divideByScalar(e,t,new Cesium.Cartesian2),Cesium.Cartesian2.magnitude(e)>2*t}function S(e,t,r,n){var i;return r?t?function(e,t,r,n){var i=h(t,e),a=h(e,r);Cesium.Cartesian2.multiplyByScalar(i,n,i),Cesium.Cartesian2.multiplyByScalar(a,n,a);var o,s=Cesium.Cartesian2.add(i,e,new Cesium.Cartesian2),u=Cesium.Cartesian2.add(a,e,new Cesium.Cartesian2),l=Cesium.Cartesian2.add(i,t,new Cesium.Cartesian2),c=Cesium.Cartesian2.add(a,r,new Cesium.Cartesian2),d=new Cesium.Cartesian2;if(o=l,i=u,a=c,r=d,u=(l=s).y-o.y,c=o.x-l.x,s=o.x*l.y-l.x*o.y,l=a.y-i.y,o=i.x-a.x,a=i.x*a.y-a.x*i.y,0==(i=u*o-l*c)||(r.x=(s*o-a*c)/i,r.y=(u*a-l*s)/i),i)return p(f=Cesium.Cartesian2.subtract(d,e,new Cesium.Cartesian2),n)?(f=h(t,e),Cesium.Cartesian2.multiplyByScalar(f,n,f)):f;var f=h(t,e);return Cesium.Cartesian2.multiplyByScalar(f,n,f)}(e,t,r,n):(i=h(r,e),Cesium.Cartesian2.multiplyByScalar(i,n,i),p(i,n),i):(i=h(t,e),Cesium.Cartesian2.multiplyByScalar(i,n,i),p(i,n),i)}function _(e){if(Cesium.defined(e.featureId)&&65535<e.featureId)throw Cesium.DeveloperError("FeatureId must less than or eaqual to 65535.");this.featureId=Cesium.defaultValue(e.featureId,0),this.primitiveType=e.line?1:4,Cesium.defined(e.primitiveType)&&(this.primitiveType=e.primitiveType),this.coordinates=[];for(var t,r=0;r<e.coordinates.length;r++){var n=e.coordinates[r];Array.isArray(n)&&(n=new Cesium.Cartesian2(n[0],n[1])),t&&t.equals(n)||(this.coordinates.push(n),t=n.clone())}}Object.defineProperty(r,"__esModule",{value:!0}),r.VectorPolylineGeometry=void 0;var e=e("e_414"),v=e&&e.__esModule?e:{default:e};_.createGeometry=function(e){for(var t=Cesium,r=t.Cartesian2,n=(t.PrimitiveType,t.ComponentDatatype),i=n.FLOAT,t=n.UNSIGNED_SHORT,n=n.BYTE,a=e.coordinates,o=e.primitiveType,s=e.featureId,u=[],l=[],c=[],d=[],f=[],h=[],p=4<=e.coordinates.length&&a[a.length-1].equals(a[0]),m=0,g=0;g<a.length;g++){var _=a[g],v=null,y=null,b=-1;m+=0<g?r.distance(_,a[g-1]):0,0==g?p?(v=a[a.length-2],y=a[1]):(y=a[1],b=1):g==a.length-1?p?(v=a[a.length-2],y=a[1]):v=a[a.length-2]:(v=a[g-1],y=a[g+1]);y=S(_,v,y,1);l.push(b*y.x,b*y.y,b*y.x,b*y.y),u.push(_.x,_.y,0,_.x,_.y,0),c.push(s,s),d.push(-1,1),f.push(m,m)}for(g=1;g<a.length;g++){var x=2*(g-1),M=2*(g-1)+1,w=2*g+1,T=2*g;1==o?h.push(x,T,M,w):h.push(x,M,T,M,w,T)}return h=new(u.length/3<65535?Uint16Array:Uint32Array)(h),new Cesium.Geometry({attributes:{position:{values:new Float32Array(u),componentsPerAttribute:3,componentDatatype:i},bufferDir:{values:new Float32Array(l),componentsPerAttribute:2,componentDatatype:i},featureId:{values:new Uint16Array(c),componentsPerAttribute:1,componentDatatype:t},distanceToStart:{values:new Float32Array(f),componentsPerAttribute:1,componentDatatype:i},sideMask:{values:new Int8Array(d),componentsPerAttribute:1,componentDatatype:n}},indices:h,primitiveType:o})},_.fromFeatures=function(e,a,t){function r(e,t,r){r=new _({coordinates:e,primitiveType:a,featureId:r}),r=_.createGeometry(r);if(u.push(r),s)for(var n=0;n<e.length;n++){var i=e[n];t[0]=Math.min(t[0],i[0]),t[1]=Math.min(t[1],i[1]),t[2]=Math.max(t[2],i[0]),t[3]=Math.max(t[3],i[1])}}t||"function"!=typeof a||(t=a);var n=Cesium,i=n.defaultValue;n.PrimitiveType,a=i(a,4);for(var o=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],s=!1,u=[],l=0;l<e.length;l++){var c=e[l],d=c.geometry;if((!t||t(c))&&d){var f=d.bbox,s=!1;if(c.geometry.bbox||(f=[Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],s=!0,c.geometry.bbox=f),"MultiPolygon"==d.type)for(var h=0;h<d.coordinates.length;h++)for(var p=d.coordinates[h],m=0;m<p.length;m++)r(p[m],f,l);else if("Polygon"==d.type||"MultiLineString"==d.type)for(var g=0;g<d.coordinates.length;g++)r(d.coordinates[g],f,l);else"LineString"==d.type&&r(d.coordinates,f,l);c.geometry.bbox&&(o[0]=Math.min(o[0],c.geometry.bbox[0]),o[1]=Math.min(o[1],c.geometry.bbox[1]),o[2]=Math.max(o[2],c.geometry.bbox[2]),o[3]=Math.max(o[3],c.geometry.bbox[3]))}}return{geometry:v.default.mergeGeometries(u),bbox:o}},r.VectorPolylineGeometry=_},{e_414:11}],184:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("e_417"),o=e("s_418"),e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,a.MeshMaterial),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);var t=(e=e||{}).uniforms||{},r=document.createElement("canvas");r.width=64,r.height=64;var n=r.getContext("2d");n.fillStyle="black",n.fillRect(0,0,r.width,r.height),n.fillStyle="cyan",n.fillRect(0,0,r.width,r.height/4),n.fillStyle="white",n.fillRect(0,r.height/2,r.width,r.height/4);var i=Cesium,n=i.Color;i.TextureWrap,i.TextureMinificationFilter,i.TextureMagnificationFilter,e.uniforms=Object.assign({bottomColor:n.DARKBLUE,topColor:n.CYAN,repeat:1,repeatX:!1,extrudedMap:{value:r,sampler:{wrapS:10497,wrapT:10497,minificationFilter:9985,magnificationFilter:9729}}},t);n=(e=Object.assign({defaultColor:n.CYAN,side:a.MeshMaterial.Sides.DOUBLE,vertexShader:"\n    varying vec2 v_st;\n    varying vec3 v_normal;\n \n    #ifdef EXTRUDED_UV_NORMAL \n        varying vec2 v_extrudedUv;\n        varying vec3 v_extrudedNormal;\n    #endif\n\n    void main(){\n        \n        v_st=st;\n        v_normal=normal;\n\n        #ifdef EXTRUDED_UV_NORMAL\n            v_extrudedUv=extrudedUv;\n            v_extrudedNormal=vec3(0.,0.,extrudedNormal);\n        #endif\n\n        gl_Position=projectionMatrix* modelViewMatrix*vec4(position,1.);\n    }\n    ",fragmentShader:"\n    uniform vec4 bottomColor;\n    uniform vec4 topColor; \n    uniform float repeat;\n    uniform bool repeatX;\n\n    #ifdef EXTRUDED_MAP\n        uniform sampler2D extrudedMap; \n    #endif\n    \n    varying vec2 v_st;\n    varying vec3 v_normal;\n\n    #ifdef EXTRUDED_UV_NORMAL \n        varying vec2 v_extrudedUv;\n        varying vec3 v_extrudedNormal;\n    #endif\n\n    void main(){\n        vec2 extrudedUv=v_st;\n        vec3 extrudedNormal=v_normal;\n\n        #ifdef EXTRUDED_UV_NORMAL \n             extrudedUv=v_extrudedUv;\n             extrudedNormal=v_extrudedNormal; \n        #endif\n\n        #ifdef EXTRUDED_MAP \n            if(extrudedNormal.z==1.||extrudedNormal.z==-1.){  \n                gl_FragColor=texture2D(extrudedMap,v_st);;  \n            }else{\n                gl_FragColor= texture2D(extrudedMap,extrudedUv);//vec2(v_st.x,extrudedUv.y));\n            }\n        #else \n           \n            float stCoord=repeatX?extrudedUv.x:extrudedUv.y;\n\n            if(extrudedNormal.z==1.){\n                gl_FragColor=mix(bottomColor,topColor, stCoord);\n\n            }else if(extrudedNormal.z==-1.){  \n                gl_FragColor=bottomColor;  \n\n            }else{  \n                gl_FragColor= mix(bottomColor,topColor,fract(stCoord*repeat));\n            } \n        #endif\n    }\n    "},e)).defines||{};return e.defines=n,e.useExtrudedUvNormal&&!n.EXTRUDED_UV_NORMAL&&(n.EXTRUDED_UV_NORMAL=""),e.useExtrudedMap&&!n.EXTRUDED_MAP&&(n.EXTRUDED_MAP=""),e.defines&&(0,o.parseDefines)(e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e))}r.default=e},{e_417:22,s_418:177}],185:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var s;return e=e||{},n||(s=THREE.ShaderMaterial,(n=function(e){s.call(this,{uniforms:{uIntensity:{value:e.intensity||1},diffuseColor:{value:e.diffuse||new THREE.Color},uLightColor:{value:e.lightColor||new THREE.Color},uLineWidth:{value:e.lineWidth||5},uDecay:{value:e.decay||.5},uDistance:{value:e.distance||20}},side:2,fragmentShader:u,vertexShader:l,transparent:!0}),this.type="LineGlowMaterial",this.isLineGlowMaterial=!0;var e=this.uniforms,t=e.uIntensity,r=e.uDistance,n=e.uDecay,i=e.uLineWidth,a=e.uLightColor,o=e.diffuseColor;Object.defineProperties(this,{intensity:{get:function(){return t.value},set:function(e){t.value=e}},distance:{get:function(){return r.value},set:function(e){r.value=e}},decay:{get:function(){return n.value},set:function(e){n.value=e}},lineWidth:{get:function(){return i.value},set:function(e){i.value=e}},lightColor:{get:function(){return a.value},set:function(e){a.value=e}},diffuse:{get:function(){return o.value},set:function(e){o.value=e}}})}).prototype=Object.create(s.prototype)),new n(e)};var n,u="\n#include <common>\nvarying float v_featureId;\nvarying float v_sideMask; \nvarying float v_distanceToStart; \n\nvarying vec3 vViewPosition;\nvarying vec3 vLightPosition;\n\nuniform float uLineWidth;\nuniform vec3 uLightColor;\nuniform float uIntensity;\nuniform vec3 diffuseColor;\nuniform float uDecay;\nuniform float uDistance;\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n    #if defined ( PHYSICALLY_CORRECT_LIGHTS )\n        float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n        if( cutoffDistance > 0.0 ) {\n            distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n        }\n        return distanceFalloff;\n    #else\n        if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n            return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n        }\n        return 1.0;\n    #endif\n}\nvoid main(){\n    vec3 lVector = vLightPosition + vViewPosition;\n    float lineWidth= uLineWidth * 0.5;\n    float lightDistance =  length( lVector );\n    if( lightDistance >= lineWidth )lightDistance -= lineWidth;\n    else lightDistance = 0.;\n    float a =1.0 - ( lightDistance/uDistance );\n    if(a==0.){ discard; return;};\n    vec3 lightColor = uIntensity * uLightColor * punctualLightIntensityToIrradianceFactor( lightDistance , uDistance, uDecay );\n    a*= length( lightColor );\n    gl_FragColor=vec4( lightDistance==0.?diffuseColor: diffuseColor * lightColor , a );\n}\n",l="\nattribute float featureId;\nattribute vec2 bufferDir;\nattribute float distanceToStart;\nattribute float sideMask;\n\nuniform float uLineWidth;\nuniform float uDistance;\n\nvarying float v_featureId;\nvarying float v_sideMask;\nvarying float v_distanceToStart; \n\nvarying vec3 vViewPosition;\nvarying vec3 vLightPosition;\nvoid main(){\n    v_featureId=featureId;\n    v_sideMask= sideMask;\n    v_distanceToStart=distanceToStart;\n    \n    float lineWidth = uDistance + uLineWidth * 0.5;\n    vec2  offset=bufferDir * lineWidth;\n    vec2 xy = position.xy + sideMask *offset;\n    vec3 positionWorld = vec3( xy , 0.05 );\n    vViewPosition = -positionWorld;\n    vLightPosition = vec3( position.xy , 0.05 );\n    vec4 mvpPosition = projectionMatrix * modelViewMatrix * vec4( positionWorld , 1. );\n    gl_Position = mvpPosition;\n}\n"},{}],186:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=Cesium,n=r.BoxOutlineGeometry,i=r.Color,e=(r.ComponentDatatype,n.fromAxisAlignedBoundingBox(e)),e=n.createGeometry(e),i=new o.MeshMaterial({defaultColor:i.CYAN.clone(),wireframe:!0,allowPick:!0});i.allowPick=!0;i=new s.Mesh(e,i);return i.pickObject={id:i,mesh:i,primitive:t},i.up.copy(t.root.up),i.frustumCulled=!1,i.isDebugVolume=!0,i}function f(e){var t=E[e];return t||(t=new u.DRACOLoader,(E[e]=t).setDecoderPath(e),t.preload()),t}Object.defineProperty(r,"__esModule",{value:!0});var d,i=function(e,t,r){return t&&A(e.prototype,t),r&&A(e,r),e},h=e("h_419"),o=e("e_417"),s=e("3_421"),u=e("d_422"),p=e("__423"),m=e("M_424"),g=n(e("i_425")),_=e("W_29"),v=n(e("e_427")),l=e("s_428"),c=e("W_429"),y=e("e_430"),b=n(e("i_431")),x=e("M_432"),M=e("e_433"),w=n(e("e_91")),T=n(e("h_435")),e=(n(e("-_436")),e("3_437")),S=n(e),E={},c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(C,c.IRenderable),i(C,[{key:"getMagic",value:function(e){for(var t=[],r=0;r<4;r++)t.push(e[r]);return String.fromCharCode.apply(null,t)}},{key:"traverse",value:function(e){this.root&&e&&this.root.traverse(e)}},{key:"traverseGeometry",value:function(t){t&&this.traverse(function(e){e=e.geometry;e&&t(e)})}},{key:"traverseMaterial",value:function(t){t&&this.traverse(function(e){e=e.material;e&&(Array.isArray(e)?e.forEach(t):t(e))})}},{key:"load",value:function(e){var t,r=this,n=Cesium,i=n.defaultValue,a=n.Resource,o=(e=e||this._options).manager||this.manager,s=e.dracoDecoderPath||this.dracoDecoderPath,n=e.gltf||e.buffer;if("string"!=typeof e.url||(d=_.Path.GetExtension(e.url).toLowerCase())&&(t=d.slice(1)),n&&(n instanceof ArrayBuffer?n=new Uint8Array(n):n instanceof Uint8Array&&(n=n.slice()),t=t||this.getMagic(n)),!(l=e.loader||this.loader))switch(t){case"osgb":case"osgt":case"osg":case"osgjson":l=new g.default(o);break;case"vism":l=new M.VISMLoader(o);break;default:var u,l=new h.GLTFLoader(o);s&&"string"==typeof s&&(u=f(s),l.setDRACOLoader(u));var c=new p.DDSLoader(o);l.setDDSLoader(c)}"vism"==t&&!l.dracoLoader&&s&&"string"==typeof s&&(u=f(s),l.setDRACOLoader(u));var d=this.basePath||this.url;return d&&(d instanceof a&&(d=d.url),d=THREE.LoaderUtils.extractUrlBase(d)),n?("b3dm"==t&&(n=(a=v.default.parseB3DM(n.buffer)).gltfView,delete a.gltfView,this.b3dmHeader=a),l.parse(n,d,function(e){r.onload(e)},function(e){console.error(e),r.readyPromise.reject(e)},{loadTexture:i(e.preloadTexture,!0)})):"string"==typeof e.url&&(d="x"==t?[e.url,e]:e.url,l.load(d,function(e){r.onload(e)},function(e){r.onLoadProgress.raiseEvent(e)},function(e){console.error(e),r.readyPromise.reject("Failed to load model "+r.url+":"+e)},"b3dm"==t?function(e){var t=v.default.parseB3DM(e),e=t.gltfView;return delete t.gltfView,r.b3dmHeader=t,e}:null,{loadTexture:i(e.preloadTexture,!0)})),this.readyPromise}},{key:"onload",value:function(l){var c,t,r,n,i=this,e=Cesium,a=e.Axis,o=e.Cartesian3,s=e.RequestType,e=e.defined,u=(this._model3js=l).scene||l;l.models&&(u=new THREE.Object3D,l.models.forEach(function(e){u.add(e)}),l.scene=u),this.modelScene=u,this.modelScene.visible=this._show,this.b3dmHeader&&!l.CESIUM_RTC&&(l.CESIUM_RTC=this.b3dmHeader.CESIUM_RTC),this._requestType!=s.TILES3D&&!l.CESIUM_RTC||(l.CESIUM_RTC&&(l._rtcCenter=o.fromArray(l.CESIUM_RTC),t=function(e,t,r){var n,i,a,o,s,u;c||(n=t.context.uniformState,i=l,t=Cesium,a=t.Matrix4,o=t.defined,s=t.Cartesian3,u=new a,d=d||new a,c=function(){return o(i._rtcCenter)?(a.getTranslation(n.model,d),s.add(d,i._rtcCenter,d),a.multiplyByPoint(n.view,d,d),a.setTranslation(n.modelView,d,u)):n.modelView}),e.modelView=c,e.u_modelView=c,e.modelViewMatrix=c,e.u_modelViewMatrix=c}),r=new o(0,0,1),this.upAxis==a.Y&&(r=new o(0,1,0)),m.Object3D.traverse(u,function(e){e.up.set(r.x,r.y,r.z),e.frustumCulled=!1,e.isMesh&&(l.CESIUM_RTC&&(e.uniformMapLoadedCallback=t),i.pickObject&&(e.pickObject=i.pickObject))}),u.updateMatrixWorld(),this.computeModelMatrix()),this._requestType!=s.TILES3D&&(r=new o(0,1,0),this.upAxis==a.Z?r=new o(0,0,1):this.upAxis==a.X&&(r=new o(1,0,0)),n=e(this.overrideTextureEncoding),u.traverse(function(e){e.frustumCulled=i.cull,e.up.set(r.x,r.y,r.z),e.isMesh&&(e.pickObject={id:e,mesh:e,primitive:i},(Array.isArray(e.material)?e.material:[e.material]).forEach(function(e){e.transparent&&i.translucent&&(e.translucent=!0),n&&e.map&&(e.map.encoding=i.overrideTextureEncoding)}))}),this.onModelLoaded.raiseEvent(this),this.createBoudingVolume(),this.updateBoudingVolume()),u.instances=this.instances,u.instancedAttributes=this.instancedAttributes,this.modelMatrixNeedsUpdate=!0,this.ready=!0,this.readyPromise.resolve(this)}},{key:"createBoudingVolume",value:function(e){var r,t,n,i;!this.root||this.boundingSphere&&!e||(n=this.root,r=[],n.updateMatrixWorld(),n.traverse(function(e){var t;e.isMesh&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),(t=e.geometry.boundingBox.clone()).applyMatrix4(e.matrixWorld),r.push(t.min,t.max))}),i=(t=Cesium).BoundingSphere,e=t.AxisAlignedBoundingBox,t=(n=THREE).Box3,n=n.Vector3,e=e.fromPoints(r),i=i.fromPoints(r),r.splice(0),this.boundingSphere=i,this.boundingBox=e,this.boundingBox3js=new t((new n).copy(e.minimum),(new n).copy(e.maximum)),this.boundingBoxWC3js=(new t).copy(this.boundingBox3js),this.modelMatrixNeedsUpdate=!0,this.createDebugVolume())}},{key:"updateBoudingVolume",value:function(){var e,t,r=this.visualizer,n=this.boundingSphere,i=this._boundingSphereWC,a=this.boundingBox,o=this.boundingBoxWC;n&&r&&(t=(e=Cesium).Axis,e=e.Matrix4,0==this.modelMatrixNeedsUpdate&&!r.modelMatrixNeedsUpdate||(this.upAxis==t.Y?this.modelMatrix=r._actualModelMatrixYup:this.upAxis==t.X?this.modelMatrix=r._actualModelMatrixXup:this.modelMatrix=r._actualModelMatrix,this.root.modelMatrix||(this.root.modelMatrix=new e),t=this.root.modelMatrix,e.multiply(this.modelMatrix,this.root.matrixWorld.elements,t),r=i.center,e.multiplyByPoint(t,n.center,r),i.radius=n.radius*e.getMaximumScale(t),r=o.center,e.multiplyByPoint(t,a.center,r)))}},{key:"createDebugVolume",value:function(){var i=this;this.debugVolume&&this.boundingBox&&(this.debugVolume.isMesh&&(this.debugVolume.destroy(),this.debugVolume=!0),this.debugVolume=a(this.boundingBox,this),this.root.traverse(function(t){var e,r,n;!t.isDebugVolume&&t.isMesh&&t.geometry&&(e=function e(){n.destroy(),delete t.__debugVolume,t.removeEventListener("dispose",e)},(r=t.geometry).boundingBox||r.computeBoundingBox(),r=r.boundingBox.clone().applyMatrix4(t.matrixWorld),n=a(r=Cesium.AxisAlignedBoundingBox.fromPoints([r.min,r.max]),i),t.addEventListener("dispose",e),t.__debugVolume=n)}))}},{key:"computeRange",value:function(e,t){this._distanceToCamera=e.camera.distanceToBoundingSphere(this._boundingSphereWC);var r=Math.max(this._distanceToCamera,Cesium.Math.EPSILON7);if("PIXEL_ON_SCREEN"!=this.rangeMode)return r;var n=this._boundingSphereWC.radius;return S.default.computeRange(r,n,e,t)}},{key:"computeVisibility",value:function(e){this.boundingSphere&&(this.range=this.computeRange(e),this.visibility=this.visible=!0,this.range<this.minRange?this.visibility=this.visible=!1:(e=e.cullingVolume.computeVisibility(this._boundingSphereWC),this.visibility=this.visible=-1!=e))}},{key:"createOrUpdateLod",value:function(){var u=this;this._lodNeedsUpdate&&this.root&&(this._lods.sort(function(e,t){return e.maxRange-t.maxRange}),this._lods.forEach(function(o){var s,e;o.root||(1<=(s=o.simplifyOptions).simplifyFactor?o.root=u.root:((e=u.root.clone(!0)).traverse(function(e){if(e.instances=u.instances,e.instancedAttributes=u.instancedAttributes,e.frustumCulled=!1,e.isMesh){var t=e,r=t.geometry,e=r.attributes.position.count,e=o.simplifyFactor*e;if(t.geometry=(0,y.simplify_three)(r,e,s),s.resampleTexture){var n,i=t.material.clone();for(n in i){var a=i[n];"lightMap"!=n&&a&&a.isTexture&&(i[n]=b.default.resampleTexture(a.clone(),o.simplifyFactor,s.forcePowerOfTwo))}t.material=i}}}),o.root=e))}),this._lodNeedsUpdate=!1)}},{key:"initializeCommands",value:function(s,u){var i=this;this.commandInitializing=!0;var e=u.renderer,l=e._webglRenderStates.get(u,s.camera),c=s.context,d=e._webglRenderItems,t=[],r=[t],n=0;return this.root.updateMatrixWorld(),this.root.traverse(function(e){(e.isMesh||e.isLine||e.isPoints||e.isSprite)&&(t.push(e),e=T.default.get(e.geometry).materialIndicesUsed,10<(n+=e?e.length:1)&&(t=[],r.push(t),n=0))}),new w.default(r,function(e){for(var t=0;t<e.length;t++){var r=e[t];u.computeModelMatrix(r,s),u.computeObjectVisibility(r,s,!0);var n=d.getAndUpdate(r,s,!1,l);if(n)for(var i=0;i<n.length;i++){var a=n[i],o=a.drawCommand;o.framebuffer=u.defaultFramebuffer,o.execute(c),o.framebuffer=void 0,a.loaded=!0}}}).run(function(e,t,r,n){i.onInitProgress.raiseEvent({progress:e,message:"Initializing drawCommands",loaded:r,total:n})}).then(function(){i.commandInitializing=!1,i.commandInitialized=!0,i.onInitInitialized.raiseEvent(i)})}},{key:"render",value:function(e,t,r){if(this.root&&this.visualizer){if(this.preInitialize){if(this.commandInitializing)return;if(!this.commandInitialized)return void this.initializeCommands(e,this.visualizer)}var n=this._cacheRenderList||[];if(this._cacheRenderList=n,e.frameNumber!=this.frameNumber){n.splice(0);var i=this.editable,a=this.castShadow,o=this.receiveShadow,s=this.root;if(i==s._editable&&a==s._castShadow&&o==s._receiveShadow||(s._editable=i,s._castShadow=a,s._receiveShadow=o,s.traverse(function(e){var t=e.material;null!=t&&(e.castShadow=a,e.receiveShadow=o,(Array.isArray(t)?t:[t]).forEach(function(e){e.autoRefresh=i}))})),this.editable&&s.updateMatrixWorld(),this.updateBoudingVolume(),this.computeVisibility(e,r),!this.visible)return;r=C._loadTaskList;if(!this._lazyLoad||this.root||this._isLazyLoading||(this._isLazyLoading=!0,this.tileId=Cesium.createGuid(),r.add(this)),r.frameNumber&&r.frameNumber==e.frameNumber||(r.frameNumber=e.frameNumber,r.update()),this.root&&this.show&&!this.debugVolumeOnly){var u=null;if(0<this._lods.length){this.createOrUpdateLod();for(var l=0;l<this._lods.length;l++){var c=this._lods[l];if(this.range<=c.maxRange){u=c.root;break}}}u=u||this.root,n.push(u)}this.debugVolume&&this.debugVolume.isMesh&&this.showDebugVolume&&(n.push(this.debugVolume),this.root.traverse(function(e){e.__debugVolume&&n.push(e.__debugVolume)})),this.root&&(this.modelMatrixNeedsUpdate=!1)}n.forEach(function(e){t.push(e)}),this.addedInScene||(this.addedInScene=!0,this.modelLoadFun&&this.modelLoadFun(this))}}},{key:"update",value:function(e){(this._requestType==Cesium.RequestType.TILES3D||this.model3js&&this.model3js.CESIUM_RTC)&&this.computeModelMatrix()}},{key:"computeModelMatrix",value:function(){var e,t,r,n,i=this;this._model3js&&(n=(e=Cesium).Axis,t=e.Matrix4,(r=this._computedModelMatrix)||(r=new t,this._computedModelMatrix=r),this.modelMatrixNeedsUpdate&&(this.upAxis===n.Y?t.multiplyTransformation(this.modelMatrix,n.Y_UP_TO_Z_UP,r):this.upAxis===n.X&&t.multiplyTransformation(this.modelMatrix,n.X_UP_TO_Z_UP,r),this.forwardAxis==n.Z&&t.multiplyTransformation(this.modelMatrix,n.Z_UP_TO_X_UP,r),this.modelMatrixNeedsUpdate=!1),n=this.modelScene,m.Object3D.traverse(n,function(e){e.isMesh&&(e.frustumCulled=i.cull,e.modelMatrix=t.multiply(r,e.matrixWorld.elements,e.modelMatrix||new Cesium.Matrix4)),e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1}),n.modelMatrixNeedsUpdate=!1,n.matrixAutoUpdate=!1)}},{key:"updateCommands",value:function(e,t){}},{key:"addLod",value:function(e,t,r){r=r||{};r={maxRange:e,simplifyFactor:t,simplifyOptions:r=Object.assign({agressiveness:4,update:5,resampleTexture:!1,forcePowerOfTwo:!1},r)};return this._lods.push(r),this._lodNeedsUpdate=!0,r}},{key:"clearLods",value:function(){return this._lods.forEach(function(e){e.root&&((0,x.releaseResources)(e.root),e.root=null)}),this._lods.splice()}},{key:"getNodeByName",value:function(t){var r;if(this.ready)return this.root.traverse(function(e){r||e.name==t&&(r=e)}),r}},{key:"getObjectByName",value:function(e){return this.getNodeByName(e)}},{key:"exportGLTF",value:function(e){return!(e=e||{}).animations&&this.model3js.animations&&(e.animations=this.model3js.animations),v.default.exportGLTF(this.root,e)}},{key:"exportB3DM",value:function(e){return!(e=e||{}).animations&&this.animations&&(e.animations=this.animations),v.default.exportB3DM(this.root,e)}},{key:"destroy",value:function(){var e;this._model3js&&(e=this.root,this.visualizer.remove(e,!0),(0,x.releaseResources)(e),this._model3js=null,this.modelScene=null),this.debugVolume&&this.debugVolume.isObject3D&&(this.debugVolume.destroy(),this.debugVolume=null),this.loader=null,this.visualizer=null,this.manager=null,this._boundingBox=null,this._boundingBoxWC=null,this._boundingSphere=null,this._boundingSphereWC=null,this._instances=null,this._instancedAttributes=null,this._cacheRenderList&&this._cacheRenderList.splice(0),this._cacheRenderList=null,Cesium.destroyObject(this)}}]),C);function C(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(C.__proto__||Object.getPrototypeOf(C)).call(this)),r=Cesium,n=r.when,i=r.Matrix4,a=r.Axis,o=r.defaultValue,r=r.Event;if(t.ready=!1,t.readyPromise=n.defer(),t.translucent=o(e.translucent,!1),t._modelMatrix=e.modelMatrix||i.IDENTITY.clone(),t.upAxis=void 0===e.upAxis?a.Z:e.upAxis,t.forwardAxis=e.forwardAxis||a.X,t.cull=o(e.cull,!0),t._show=o(e.show,!0),t._requestType=e.requestType,t.pickObject=e.pickObject,t.manager=e.manager,t.loader=e.loader,t.dracoDecoderPath=e.dracoDecoderPath,t.url=e.url,t.basePath=e.basePath,t._instances=e.instances,t._instancedAttributes=e.instancedAttributes,t._boundingSphere=null,t._boundingSphereWC=null,t.boundingSphere=e.boundingSphere,t._boundingBox=null,t._boundingBoxWC=null,t.boundingBox=e.boundingBox,t.debugVolume=e.debugVolume,t.showDebugVolume=e.showDebugVolume,t.debugVolumeOnly=e.debugVolumeOnly,t._lazyLoad=e.lazyLoad,t._options=e,t.editable=o(e.editable,!1),t.castShadow=o(e.castShadow,!0),t.receiveShadow=o(e.receiveShadow,!0),t.preInitialize=o(e.preInitialize,!1),t.overrideTextureEncoding=e.overrideTextureEncoding,t.minRange=e.minRange||4,t.rangeMode="PIXEL_ON_SCREEN",t._lods=[],t._lodNeedsUpdate=!1,t.onModelLoaded=new r,t.onLoadProgress=new r,t.onInitInitialized=new r,t.onInitProgress=new r,e.lods&&0<e.lods.length&&e.lods.forEach(function(e){t.addLod(e.maxRange,e.simplifyFactor,e.simplifyOptions)}),C._loadTaskList||(C._loadTaskList=new l.TaskList(10,"load")),t._lazyLoad){if(!t.boundingSphere)throw new Error("When lazyLoad is true, boundingSphere is required.")}else t.load(e);return t.createDebugVolume(),t}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperties(c.prototype,{instances:{get:function(){return this._instances}},instancedAttributes:{get:function(){return this._instancedAttributes}},modelMatrix:{set:function(e){var t=Cesium.Matrix4;this._model3js||(this.modelMatrixNeedsUpdate=!0),e.elements&&(e=e.elements),t.equals(e,this._modelMatrix)||(this._modelMatrix=t.clone(e,this._modelMatrix),this.modelMatrixNeedsUpdate=!0)},get:function(){return this._modelMatrix}},show:{set:function(e){this._show=e,this.modelScene&&(this.modelScene.visible=e)},get:function(){return this._show}},model3js:{get:function(){return this._model3js}},root:{get:function(){return this._model3js&&(this._model3js.scene||this._model3js)}},gltf:{get:function(){return this.model3js&&this.parser?this.model3js.parser.json:null}},osg:{get:function(){return this.model3js&&this.model3js.osgRoot?this.model3js.osgRoot:null}},animations:{get:function(){return this.model3js?this.model3js.animations:[]}},boundingSphere:{set:function(e){e&&(this._boundingSphere=e,this._boundingSphereWC=Cesium.BoundingSphere.clone(e))},get:function(){return this._boundingSphere}},boundingSphereWC:{get:function(){return this._boundingSphereWC}},boundingBox:{get:function(){return this._boundingBox},set:function(e){e&&(this._boundingBox=e,this._boundingBoxWC=Cesium.AxisAlignedBoundingBox.clone(this.boundingBox))}},boundingBoxWC:{get:function(){return this._boundingBoxWC}}});i=v.default;c.exportGLTF=i.exportGLTF,c.exportB3DM=i.exportB3DM,c.parseB3DM=i.parseB3DM,c.prototype.type="MeshVisModel",c.prototype.isMeshVisModel=!0,r.default=c},{W_429:13,"3_421":15,e_430:19,e_417:22,"-_436":24,M_424:25,"3_437":27,M_432:42,i_431:53,h_435:60,__423:79,d_422:80,h_419:81,e_91:166,W_29:169,s_428:204,e_427:187,i_425:188,e_433:189}],187:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e},a=e("d_438"),n=(n(i,null,[{key:"exportGLTF",value:function(n,i){return new Promise(function(t,r){try{var e=new a.GLTFExporter;i=i||{},i=Object.assign({embedImages:!1,trs:!1,onlyVisible:!1,binary:!1,maxTextureSize:1/0},i),e.parse(n,function(e){t(e)},i)}catch(e){r(e)}})}},{key:"getPaddedBufferSize",value:function(e){return 4*Math.ceil(e/4)}},{key:"getPaddedBuffer",value:function(e,t){t=t||0;var r=this.getPaddedBufferSize(e.byteLength);if(r===e.byteLength)return e;var n=new Uint8Array(r);if(n.set(e),0!==t)for(var i=e.byteLength;i<r;i++)n[i]=t;return n}},{key:"exportB3DM",value:function(e,t){var r=t.properties,n=t.featureTableJson||{BATCH_LENGTH:0};if((h=t.batchTableJson)&&n.BATCH_LENGTH&&r){var i=Object.keys(h),a=Object.keys(r),o=i.length==a.length;if(o=o&&i.length==n.BATCH_LENGTH)for(var s=0;s<a.length;s++){var u=a[s];if(-1==i.indexOf(u)){o=!1;break}}o?(h=null,n.BATCH_LENGTH=0):console.warn("batchTableJson&featureTableJson.BATCH_LENGTH&properties donot have same length")}else(n.BATCH_LENGTH||h&&0<Object.keys(h)||r&&0<Object.keys(r))&&console.warn("batchTableJson&featureTableJson.BATCH_LENGTH&properties donot have same length");for(var n=JSON.stringify(n),l=new Uint8Array(n.length),c=0;c<n.length;c++)l[c]=n.charCodeAt(c);var l=this.getPaddedBuffer(l," ".charCodeAt(0)),d=new Uint8Array(0);t.featureTableBinary&&(d=this.getPaddedBuffer(t.featureTableBinary));var f=new Uint8Array(0),r=new Uint8Array(0);if(h){for(var h=JSON.stringify(h),f=new Uint8Array(h.length),p=0;p<h.length;p++)f[p]=h.charCodeAt(p);f=this.getPaddedBuffer(f," ".charCodeAt(0)),t.batchTableBinary&&(r=this.getPaddedBuffer(t.batchTableBinary))}var m={magic:"b3dm",version:1,byteLength:0,featureTableJSONByteLength:l.length,featureTableBinaryByteLength:d.length,batchTableJSONByteLength:f.length,batchTableBinaryByteLength:r.length};return(t=t||{}).binary=!0,this.exportGLTF(e,t).then(function(e){m.byteLength=e.byteLength+28+m.featureTableJSONByteLength+m.featureTableBinaryByteLength+m.batchTableJSONByteLength+m.batchTableBinaryByteLength;for(var t=0,r=new Uint8Array(m.byteLength),n=new DataView(r.buffer),i=0;i<m.magic.length;i++)n.setUint8(t,m.magic.charCodeAt(i)),t++;return n.setUint32(t,m.version,!0),n.setUint32(t+=4,m.byteLength,!0),n.setUint32(t+=4,m.featureTableJSONByteLength,!0),n.setUint32(t+=4,m.featureTableBinaryByteLength,!0),n.setUint32(t+=4,m.batchTableJSONByteLength,!0),n.setUint32(t+=4,m.batchTableBinaryByteLength,!0),r.set(l,t+=4),t+=l.length,r.set(f,t),t+=f.length,e=new Uint8Array(e),r.set(e,t),r})}},{key:"parseB3DM",value:function(e,t){var r=Cesium,n=r.defaultValue,i=r.getStringFromTypedArray,a=r.Cesium3DTileFeatureTable,o=r.ComponentDatatype,s=n(t,0);t=s;var u=new Uint8Array(e),l=new DataView(e);if("b3dm"!=i(u,t,4))throw new Error("not b3dm");var c=l.getUint32(t+=4,!0);if(1!==c)throw new Error("Only Batched 3D Model version 1 is supported.  Version "+c+" is not.");var d,f=l.getUint32(t+=4,!0),h=l.getUint32(t+=4,!0),r=l.getUint32(t+=4,!0),c=l.getUint32(t+=4,!0),l=l.getUint32(t+=4,!0);t+=4,570425344<=c?(t-=8,p=h,c=r,r=h=l=0,console.warn("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):570425344<=l&&(t-=4,p=c,c=h,l=r,r=h=0,console.warn("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")),0===h?d={BATCH_LENGTH:n(p,0)}:(n=i(u,t,h),d=JSON.parse(n),t+=h);h=new Uint8Array(e,t,r);t+=r;var h=new a(d,h),p=h.getGlobalProperty("BATCH_LENGTH");h.featuresLength=p;var m,o=h.getGlobalProperty("RTC_CENTER",o.FLOAT,3);0<c&&(m=i(u,t,c),m=JSON.parse(m),t+=c,0<l&&(g=new Uint8Array(e,t,l),g=new Uint8Array(g),t+=l));var g={batchLength:p,batchTableJson:m,batchTableBinary:g},f=s+f-t;if(0==f)throw new Error("glTF byte length must be greater than 0.");return{gltfView:t%4==0?new Uint8Array(e,t,f):(console.warn("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),new Uint8Array(u.subarray(t,t+f))),featureTable:h,batchTable:g,CESIUM_RTC:o}}}]),i);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{d_438:78}],188:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var g,y,i,l,d,c,b,a,o,s,u,f,x,h,p,m,M,w,T,S,E,C,A,O,L,P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("__439")),I=e("M_440"),R="undefined"==typeof Blob||"undefined"==typeof Image||"undefined"==typeof Document||"undefined"==typeof window,D=!1,U=!1;r.default=function(e){var t,_,v,r;return D||(D=!0,r=THREE,g=r.BufferAttribute,y=r.BufferGeometry,i=1001,l=r.Color,d=2,c=r.FileLoader,b=r.Group,a=1006,s=1008,o=1007,u=r.Loader,f=r.LoaderUtils,x=r.Mesh,h=r.MeshStandardMaterial,p=1002,m=1003,M=1005,w=1004,T=1023,S=1022,E=1e3,C=r.TextureLoader,A=r.Texture,O=r.VertexColors,U="undefined"!=typeof createImageBitmap),L||(n(t={},(r=P.GLEnum).MIRROR,p),n(t,r.CLAMP_TO_EDGE,i),n(t,r.REPEAT,E),_=t,n(t={},r.LINEAR,a),n(t,r.LINEAR_MIPMAP_LINEAR,s),n(t,r.LINEAR_MIPMAP_NEAREST,o),n(t,r.NEAREST,m),n(t,r.NEAREST_MIPMAP_LINEAR,M),n(t,r.NEAREST_MIPMAP_NEAREST,w),v=t,(L=function(e){u.call(this,e)}).prototype=Object.assign(Object.create(u.prototype),{constructor:L,load:function(t,r,e,n,i){var a=this;this.options=Object.assign({loadTexture:!0},i);var o=this,s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:f.extractUrlBase(t);o.manager.itemStart(t);function u(e){n?n(e):(console.trace(e),console.error(e)),o.manager.itemError(t),o.manager.itemEnd(t)}i=new c(o.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&i.setWithCredentials(!0),i.load(t,function(e){try{if("osgjson"==t.substr(t.lastIndexOf(".")+1))return"string"!=typeof e&&(e=f.decodeText(e)),e=JSON.parse(e),(e=(0,I.parseOsg)(e,s,a.options.loadTexture,a.manager,a.options.imageCache,a.options.textureCache,!1)).then?e.then(r):r(e);o.parse(e,s,function(e){r(e)},u,a.options),o.manager.itemEnd(t)}catch(e){u(e)}},e,u)},parse:function(e,t,r,n,i){var a;if(this.options=Object.assign({loadTexture:!0},i),e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer){if(0==(a=P.readBuffer(e))){var o=(0,I.parseOsg)(e,t,this.options.loadTexture,this.manager,this.options.imageCache,this.options.textureCache,!1);return o.then?o.then(r):r(o)}}else a=e;this.parseObject(a,t,{},i).then(function(e){r(e)}).catch(function(e){})},setRGBLoader:function(e){return this.rgbLoader=e,this},setTGALoader:function(e){return this.tgaLoader=e,this},setBMPLoader:function(e){return this.bmpLoader=e,this},parseObject:function(e,t,r,n){switch(!this.options&&n&&(n=n||{},this.options=Object.assign({loadTexture:!0},n)),e.Type){case"Osg::Geode":case"Osg::Group":case"Osg::Node":case"Osg::MatrixTransform":return this.parseNode(e,t,r);case"Osg::PagedLOD":return this.parsePagedLOD(e,t,r);case"Osg::Geometry":return this.pareseGeometry(e,t,r)}},parsePagedLOD:function(e,t,r){var n=this,i=new b;i.name=e.Name;e=e.Children.map(function(e){return n.parseObject(e,t,r)});return i.up.set(0,0,1),i.frustumCulled=!1,Promise.all(e).then(function(e){return e.forEach(function(e){i.add(e)}),i})},parseNode:function(e,t,r){var n=this,i=new b;i.name=e.Name;e=e.Children.map(function(e){return n.parseObject(e,t,r)});return i.up.set(0,0,1),i.frustumCulled=!1,Promise.all(e).then(function(e){return e.forEach(function(e){i.add(e)}),i})},pareseGeometry:function(e,t,r){var n=this,d=new b;d.name=e.Name,d.up.set(0,0,1),d.frustumCulled=!1;var i=e.VertexArray,a=e.NormalArray,o=e.ColorArray,s=e.TexCoordArray,f=void 0,h=void 0,p=void 0,m=new g(i.Value,i.ItemSize);o&&(o.Binding==P.AttributeBinding.BIND_PER_VERTEX?p=new g(o.Value,o.ItemSize):(f=(new l).fromArray(o.Value),o[3])),a&&(h=new g(a.Value,a.ItemSize,a.Normalize));var u=e.StateSet,e=e.PrimitiveSetList.map(function(l,e){var c=s[e];return n.parseMaterial(u,t,r).then(function(e){var t=new y;if(t.setAttribute("position",m),c&&t.setAttribute("uv",new g(c.Value,c.ItemSize)),p?(t.setAttribute("color",p),e.vertexColors=O):f&&(e.color=f),l.Indices){var r=l.Indices.Value;if(l.Mode==P.PrimitiveMode.GL_QUADS){for(var n=[],i=0;i<r.length;i+=4){var a=r[i],o=r[i+1],s=r[i+2],u=r[i+3];n.push(a,o,u,o,s,u)}r=new r.constructor(n)}else t.GeometryMode=l.Mode;t.setIndex(new g(r,1))}else t.addGroup(l.First,l.Count),t.GeometryMode=l.Mode;h?t.setAttribute("normal",h):t.computeVertexNormals();e=new x(t,e);e.vertexColors=!!p,e.up.set(0,0,1),e.frustumCulled=!1,d.add(e)})});return Promise.all(e).then(function(){return d})},parseMaterial:function(s,u,l){var c=this;return new Promise(function(t,e){var r,n,i,a,o=new h({side:d});s?(null!=(i=s.RenderingHint)&&(o.transparent=i==P.RenderingHint.TRANSPARENT_BIN),r=s.AttributeList,n=s.ModeList,i=s.TextureAttributeList,r&&r.forEach(function(e){var t=e.key,r=e.value.StateAttribute;switch(t.type){case"Osg::Material":c.setMaterialAttribute(o,r);break;case"Osg::StateAttribute":break;case"Osg::ShadeModel":o.flatShading=r.Mode==P.ShadeModelMode.ConstantsFLAT}}),n&&n.forEach(function(e){var t=e.key,r=e.value;switch(P.EnumToString(P.GLEnum,t),t){case P.GLEnum.GL_DEPTH_TEST:o.depthTest=r!=P.StateAttributeValue.OFF;break;case P.GLEnum.GL_BLEND:o.blending=r!=P.StateAttributeValue.OFF}}),i&&0<i.length&&(1<i.length&&console.warn("only handle textureAttributeList[0]"),a=i[0].value.StateAttribute,a=c.parseTexture(a,u,l)),a?a.then(function(e){o.map=e,t(o)}).catch(e):t(o)):t(o)})},setMaterialAttribute:function(e,t){var r=t.EmissionFront||t.EmissionBack;r&&(e.emissive=(new l).fromArray(r),e.emissiveIntensity=r[3],t.EmissionFrontAndBack||console.warn("only support EmissionFrontAndBack=true"));r=t.DiffuseFront||t.DiffuseBack;r&&(e.color=(new l).fromArray(r),e.opacity=r[3],t.DiffuseFrontAndBack||console.warn("only support DiffuseFrontAndBack=true"));r=t.SpecularFront||t.SpecularBack;r&&(e.specular=(new l).fromArray(r),t.SpecularFrontAndBack||console.warn("only support SpecularFrontAndBack=true"));r=t.ShininessFront||t.ShininessBack;null!=r&&(e.shininess=r,t.SpecularFrontAndBack||console.warn("only support SpecularFrontAndBack=true"))},resolveURL:function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:(t+"/"+e).replace("//","/"))},getExtension:function(e){var t=e.lastIndexOf(".");return 0<=t?e.substring(t,e.length):""},parseTexture:function(h,p,m){var g=this;return new Promise(function(e,t){function r(){s.anisotropy=h.MaxAnisotropy,s.format=a?S:T,s.wrapS=_[h.WrapS.value],s.wrapT=_[h.WrapT.value],s.magFilter=v[h.MagFilter.value],s.minFilter=v[h.MinFilter.value],u&&URL.revokeObjectURL(c),e(s)}function n(e){t(e)}var i,a,o,s,u,l,c,d,f=h.Image;f&&(i=f.Name,m[i]?e(m[i]):(a=0<i.search(/\.jpe?g($|\?)/i)||0===i.search(/^data\:image\/jpeg/),"."==(o=g.getExtension(i).toLowerCase())[0]&&(o=o.slice(1)),f.ImageType==P.ImageType.IMAGE_EXTERNAL?(c=g.resolveURL(i,p),R&&(c={src:i,fileName:c})):f.ImageType==P.ImageType.IMAGE_INLINE_FILE?c="bmp"==o||"tga"==o?h.Image.Data:(l="image/"+o,R||!g.options.loadTexture?{src:i,fileName:g.resolveURL(i,p),fileBuffer:f.Data}:new Blob([h.Image.Data],{type:l})):(s=new DataTexture(f.Data,h.TextureWidth,h.TextureHeight),console.warn("image file "+f.Name+"：unsupport imageType "+P.EnumToString(P.ImageType,f.ImageType))),R||!g.options.loadTexture?(s=s||new A(c),m[i]=s,r()):("dds"==o?s=g.ddsLoader.load(c,r,null,n):"rgb"==o?s=g.rgbLoader.load(c,r,null,n):"tga"==o?s=g.tgaLoader.load(c,r,null,n):"bmp"==o&&(s=g.bmpLoader.load(c,r,null,n)),s=s||(c instanceof Blob?(U?createImageBitmap(c,{imageOrientation:"flipY",premultiplyAlpha:"none"}).then(function(e){s.image=e,r()}).catch(n):(c=URL.createObjectURL(c),(d=new Image).onload=function(){d.a_src=i,s.image=d;try{f.Data=null,URL.revokeObjectURL(c),r()}catch(e){n(e)}f=null},d.onerror=n,d.src=c),new A):new C(g.manager).load(c,r,null,n)),m[i]=s)))})}})),new L(e)}},{__439:164,M_440:190}],189:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VISMLoader=void 0;var n,h=e("k_410"),i=e("d_422"),a=e("e_91"),p=a&&a.__esModule?a:{default:a},m=e("M_32"),s=e("W_445"),o={};r.VISMLoader=function(e){var a,f=THREE,d=f.ObjectLoader;return n||(a={Float64Array:Float64Array,Float32Array:Float32Array,Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array},n={load:function(r,n,e,t,i){this.options=Object.assign({loadTexture:!0},i);var a=this,o=f.LoaderUtils.extractUrlBase(r);this.resourcePath=o,r=a.manager.resolveURL(r),a.manager.itemStart(r);function s(e){t?t(e):(console.trace(e),console.error(e)),a.manager.itemError(r),a.manager.itemEnd(r)}o=new f.FileLoader(a.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===a.crossOrigin&&o.setWithCredentials(!0),o.load(r,function(t){try{a.parse(t,function(e){e._memorySize=t.byteLength,n(e)},s,i),a.manager.itemEnd(r)}catch(e){s(e)}},e,s)},setDracoDecoderPath:function(e){var t;this.dracoLoader?this.dracoDecoderPath!=e&&(this.dracoDecoderPath=e,this.dracoLoader.setDecoderPath(e),this.dracoLoader.preload()):this.dracoLoader=((e=o[t=e])||(e=new i.DRACOLoader,(o[t]=e).setDecoderPath(t),e.preload()),e)},setDRACOLoader:function(e){this.dracoLoader=e,this.dracoDecoderPath&&(this.dracoLoader.preload(),this.dracoLoader.setDecoderPath(this.dracoDecoderPath))},parse:function(t,r,n,e){(e=e||{}).imageCache=e.imageCache||{},e.textureCache=e.textureCache||{},this._preloadTexture="boolean"!=typeof e.loadTexture||e.loadTexture,t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i=this.getMagic(t);if("vism"!=i&&"json"!=i)n(new Error("Invalid magic  :"+i));else{var a=t.buffer.byteLength,o=void 0,e=void 0;try{return t=(o=("vism"==i?(a=this.getHeaderLength(t),o=t.buffer.slice(8,a),e=t.buffer.slice(a)):o=t.buffer.slice(8,a),f.LoaderUtils.decodeText(o)),JSON.parse(o)),(0,s.decodeObject)(t),t.animations&&this._parseAnimations(t.animations,e),this._parse(t.scene||t,e,function(e){return e.traverse(function(e){!e.geometry||(e=e.geometry.userData)&&e.draco}),t.scene&&(t.scene=e,e=t),r&&r(e),e},function(e){n(e)})}catch(t){n(t)}}},_parseAnimations:function(e,t){for(var r=0;r<e.length;r++)for(var n=e[r].tracks,i=0;i<n.length;i++){var a=n[i],o=a.times,s=a.values,u=o.count,o=o.byteOffset;u&&(a.times=new Float32Array(t,o,u)),u=s.count,o=s.byteOffset,u&&(a.values=new Float32Array(t,o,u))}},_parse:function(r,e,n,t){function i(t){return a.parseImages(r.images,e).then(function(e){e=a.parseTextures(r.textures,e),e=a.parseMaterials(r.materials,e),e=a.parseObject(r.object,t,e);return r.animations&&(e.animations=a.parseAnimations(r.animations)),void 0!==n&&n(e),e})}var a=this,o=a.parseShapes(r.shapes),o=a.parseGeometries(r.geometries,o,e);return(o.then?o.then(i):i(o)).catch(t)},getHeaderLength:function(e){return new DataView(e.buffer).getUint32(4)},getMagic:function(e){for(var t=[],r=0;r<4;r++)t.push(e[r]);return String.fromCharCode.apply(null,t)},parseImages:function(e,a){var o=this,s={},u=void 0,l=o.options.imageCache||{},c=o._preloadTexture;if(void 0!==e&&0<e.length){var t=function(n){if(l[n.uuid])s[n.uuid]=l[n.uuid];else{var e,t,r=n.url;if(Array.isArray(r))return s[n.uuid]=[],new p.default(r,function(e){var r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:o.resourcePath+e;if(c)return new Promise(function(e,t){t=u.load(r,e,void 0,t);s[n.uuid].push(t)});s[n.uuid].push(r)}).run();r=n.buffer?(e=(t=n.buffer).byteOffset,t=t.count,t=new Uint8Array(a,e,t),"data:"+n.mimeType+";base64,"+(0,h.fromByteArray)(t)):n.url;var i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r)?r:o.resourcePath+r;if(c)return new Promise(function(e,t){t=u.load(i,e,void 0,t);(s[n.uuid]=t).uuid=n.uuid});s[n.uuid]=i,l[n.uuid]=s[n.uuid]}},r=o.manager||new f.LoadingManager;(u=new f.ImageLoader(r)).setCrossOrigin(o.crossOrigin);var n=[],i=[],d={};return e.forEach(function(e){l[e.uuid]?s[e.uuid]=l[e.uuid]:d[e.uuid]||(d[e.uuid]=!0,(0==i.length||200<=n.length)&&(n=[],i.push(n)),n.push(e))}),d=null,new p.default(i,function(e){e=e.map(t);return Promise.all(e)}).run().then(function(){return s})}return Promise.resolve(s)},parseAttributeArray:function(e,t){var r,n,i;t&&(r=(i=e.array).byteOffset,n=i.count,i=a[e.type],e.array=new i(t,r,n))},parseDracoGeometries:function(s,r){var t=this;if(0<(s=s.filter(function(e){try{if(!t.isBufferGeometry(e))return e}catch(e){}})).length){var n=this.dracoLoader,i={attributeIDs:n.defaultAttributeIDs,attributeTypes:n.defaultAttributeTypes,useUniqueIDs:!1},a=[];return s.forEach(function(e){var t=e.userData.draco,e=t.byteOffset,t=t.count,t=(t=new Uint8Array(r,e,t)).slice().buffer,t=n.decodeGeometry(t,i);a.push(t)}),Promise.all(a).then(function(e){var o={};return e.forEach(function(e,t){var r=s[t];e.name=r.name,e.userData=r.userData,e.uuid=r.uuid,delete r.userData.draco;t=e.attributes;if(!t.normal&&r.userData&&r.userData.NormalBinding){for(var t=e.index?3*(m.MathUtils.minmax(e.index.array).max+1):t.position.array.length,n=r.userData.NormalArray,i=new Float32Array(3*t),a=0;a<i.length;a+=3)i[a]=n[0],i[a+1]=n[1],i[a+2]=n[2];t=new f.BufferAttribute(i,3,!1);e.setAttribute("normal",t)}o[e.uuid]=e}),o})}return Promise.resolve({})},isBufferGeometry:function(e){var t;if(!(t=!!e.data))return!1;var r,n=e.data.attributes;for(r in n)if(n.hasOwnProperty(r)&&n[r])if(!n[r].array){t=!1;break}return t},parseBufferGeometries:function(e,t,l){function r(e){var t,r,n,i=e.data,a=i.attributes;for(t in a)a.hasOwnProperty(t)&&a[t]&&(r=a[t],c.parseAttributeArray(r,l));if(i.index&&(n=i.index,c.parseAttributeArray(n,l)),!a.normal&&e.userData&&e.userData.NormalBinding){for(var i=i.index?3*(m.MathUtils.minmax(i.index.array).max+1):a.position.array.length,o=e.userData.NormalArray,s=new Float32Array(i),u=0;u<s.length;u+=3)s[u]=o[0],s[u+1]=o[1],s[u+2]=o[2];a.normal={type:"Float32Array",itemSize:3,normalize:!1,array:s}}}for(var n=this,c=this,i=[],a=void 0,o=[],s=0;s<e.length;s++){var u=e[s];this.isBufferGeometry(u)&&((0==i.length||500<=a.length)&&i.push(a=[]),o.push(u),a.push(u))}return 0==i.length?Promise.resolve({}):new p.default(i,function(e){e.forEach(r)}).run().then(function(){return o=d.prototype.parseGeometries.call(n,o,t)})},parseGeometries:function(e,t,r){r=[this.parseDracoGeometries(e,r),this.parseBufferGeometries(e,t,r)];return Promise.all(r).then(function(e){return Object.assign({},e[0],e[1])})}}),e=new d(e),Object.assign(e,n),e}},{k_410:76,d_422:80,e_91:166,M_32:167,W_445:168}],190:[function(c,e,d){!function(r){"use strict";function g(e){for(var t=0,r=e.length;/(\s|\t)+/g.test(e[t])&&t<e.length;)t++;for(var n=e[r-1];/(\s|\t)+/g.test(n)&&0<r;)n=e[--r-1];return e.substring(t,r)}function _(e){var t=/\s+/.exec(e),r="",n=e;n[0];return t?{name:r=e.substr(0,t.index),dataType:(n=e.substr(t.index+t.length))[n.length-1],value:n,row:e}:"}"==e?{name:r,dataType:"}",value:n,row:e}:void 0}function o(){return _(g(b.nextRow()))}function v(e){var t=b.nextBlock();t="["+(t=g(t)).replace(/(\s|\t)+/g,",")+"]";t=JSON.parse(t);return new(l[e]||Float32Array)(t)}function s(){for(var e=[];;){b.nextRow();var t=(t=void 0,"DrawArrays"!=(t={DrawFunc:(t=g(b.nextRow()).split(/\s+/))[0],Mode:t[1],First:parseInt(t[2]),Count:parseInt(t[3]),Indices:null}).DrawFunc&&(t.Indices=v()),t);if(e.push(t),"PrimitiveSets"!=_(g(b.nextRow())).name)break}return e}function u(){var e={},t={VertexArray:"VertexIndices",TexCoordArray:"TexCoordIndices"},r=o(),n=r.dataType,i=r.name,a=r.value.replace(/\"/g,"");if("Matrix"==i)return v();if("{"==n)(e=u()).Type="Osg::"+i;else for(e[i]=g(a);0<b.length&&(r=o());)if(n=r.dataType,i=r.name,a=r.value,"Matrix"==i)e[i]=v();else if("PrimitiveSets"==i)e[i]=s();else if("textureUnit"==i)e[i]=function(){for(var e=[];;){var t=u();if(e.push(t),"textureUnit"!=_(g(b.nextRow(!0))).name)break;b.nextRow()}return e}();else if("VertexArray"==i||"TexCoordArray"==i||"NormalArray"==i||"ColorArray"==i)e[i]=function e(t,r){for(var n=t.name,i=[],a=0;;){var o={dataType:(m=t.value.split(/\s+/))[a=3==m.length?1:0],count:parseInt(m[1+a]),value:null,Type:"Osg::Array"};if("UniqueID"==m[1]&&(o.UniqueID=m[2],o.dataType=m[3],o.count=parseInt(m[4])),"Use"==o.dataType?o=S[m[2]]:(b.nextRow(),o.value=v(o.dataType),o.UniqueID&&(S[o.UniqueID]=o)),i.push(o),t=_(g(b.nextRow(!0))),r&&t.name==r){b.nextRow(!0);for(var s=e(t)[0],u=E[o.dataType],l=new o.value.constructor(s.count*u),c=0;c<s.count;c++)for(var d=u*s.value[c],f=u*c,h=0;h<u;h++){var p=o.value[d+h];l[f+h]=p}o.value=l,o.count=s.count;var m=b.nextRow(!0);(t=_(g(m))).name!=n&&(b.cacheRow=m)}if(t.name!=n)break;"Use"!=o.dataType&&b.nextRow()}return i}(r,t[i]);else if("{"==n)e[i]=u(),e[i].Type="Osg::"+i;else{if("}"==n)break;"num_children"==i||"num_drawables"==i?(a=parseInt(a),e[i]=a,e.children=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=u();return t}(a)):(a=a.replace(/\"/g,""),e[i]=a)}return e}function x(e){e=e.replace(/\s+/g,",");return JSON.parse("["+e+"]")}function M(e){var t=3;switch(e.dataType){case"Vec3fArray":case"Vec3dArray":case"Vec3DArray":case"Vec3Array":t=3;break;case"Vec2fArray":case"Vec2dArray":case"Vec2DArray":case"Vec2Array":t=2;break;case"Vec4fArray":case"Vec4dArray":case"Vec4DArray":case"Vec4Array":t=4}var r=e.value;return"string"==typeof r&&(r=new Float32Array((0,i.toByteArray)(r).buffer)),new THREE.BufferAttribute(r,t,e.normalize||e.Normalize)}function p(e,t,r,n){var i=THREE,n=function(e,a,o,s){if(e){var u=THREE;return w||(w={LINEAR:1006,LINEAR_MIPMAP_LINEAR:1008,LINEAR_MIPMAP_NEAREST:1007,NEAREST:1003,NEAREST_MIPMAP_LINEAR:1005,NEAREST_MIPMAP_NEAREST:1004},T={CLAMP_TO_EDGE:1001,REPEAT:1e3,MIRRORED:1002}),e.map(function(e){if(e.Use)return s[e.Use];var t=e.Texture2D,r=t.UniqueID,n="/"==a[a.length-1]?"":"/",i=t.file,e=a+n+i.replace(/"/g,"").replace(/(\/|\\)+/g,"/"),n=o[e];return n||(n=new u.Texture(e),i=0<i.search(/\.jpe?g($|\?)/i)||0===i.search(/^data\:image\/jpeg/),n.format=i?1022:1023,n.magFilter=w[t.mag_filter],n.anisotropy=parseInt(t.maxAnisotropy),i=w[t.min_filter],1006!=(n.minFilter=i)&&1003!=i||(n.generateMipmaps=!1),n.wrapS=T[t.wrap_s],n.wrapT=T[t.wrap_t],o[e]=n,o.count=o.count?o.count+1:1),s[r]=n})}}(e.StateSet.textureUnit,t,r,n),n=function(e,t){var r=THREE;0;var n,i=e.Material;if((i.UniqueID||i.uniqueID)&&(n=i.UniqueID||i.uniqueID,C[n]))return C[n];var a=new r.MeshPhongMaterial({side:2});a.name=i.name,"ON"==i.ColorMode&&(a.vertexColors=r.VertexColors);var o=x(i.diffuseColor);return a.color=(new r.Color).fromArray(o),o=x(i.emissionColor),a.emissive=(new r.Color).fromArray(o),a.emissiveIntensity=o[3],a.shininess=parseFloat(i.shininess),i=x(i.specularColor),a.specular=(new r.Color).fromArray(i),n&&(a.userData.uniqueID=n,C[n]=a),"TRANSPARENT_BIN"==e.rendering_hint&&(a.transparent=!0),e.BlendFunc&&e.BlendFunc,"ON"==e.GL_CULL_FACE&&(a.side=0),t&&0<t.length&&(a.map=t[0],1<t.length&&((e=t[1]).minFilter=1006,a.lightMap=e),2<t.length&&t[2]!=a.map&&(a.alphaMap=t[2])),a}(e.StateSet,n),a=new i.BufferGeometry;e.PrimitiveSets.forEach(function(e){"DrawArrays"==e.DrawFunc?a.addGroup(e.First,e.Count):a.setIndex(e.Indices)}),e.ColorArray&&(o=M(e.ColorArray[0]),"OVERALL"==e.ColorBinding?n.color=(new i.Color).fromArray(o.value||o.array||o):!o||n.map&&!n.vertexColors||a.setAttribute("color",o));var o=M(e.VertexArray[0]);if(a.setAttribute("position",o),e.TexCoordArray&&e.TexCoordArray.forEach(function(e,t){e=M(e);0==t?a.setAttribute("uv",e):a.setAttribute("uv"+(t+1),e)}),e.NormalArray){var s=M(s=e.NormalArray[0]);if("OVERALL"==e.NormalBinding){for(var u=new Float32Array(o.count*s.itemSize),l=0;l<u.length;l+=s.itemSize)for(var c=0;c<s.itemSize;c++)u[l+c]=s.array[c];var d=new i.BufferAttribute(u,s.itemSize,s.normalize);a.userData=a.userData||{},a.userData.NormalBinding="OVERALL",a.userData.NormalArray=s.array,a.setAttribute("normal",d)}else if("PER_PRIMITIVE"==e.NormalBinding){for(var f=s.itemSize,h=new Float32Array(o.count*f),p=s.count,m=0,g=0;g<p;g++)for(var _=g*f,v=0;v<3;v++){for(var y=(a.index?a.index.array[m]:m)*f,b=0;b<f;b++)h[y+b]=s.array[_+b];m++}d=new i.BufferAttribute(h,s.itemSize,s.normalize);a.setAttribute("normal",d)}else{d=s;a.setAttribute("normal",d)}}n=new i.Mesh(a,n);return n.name=e.name,n}function m(e,t){return(b=new a(e)).onProgress=t,u()}Object.defineProperty(d,"__esModule",{value:!0});var e=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e};function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}d.osgToJSON=function(e){return function t(e,r){e&&r(e),e.children&&e.children.forEach(function(e){t(e,r)})}(e,function(e){if("Osg::Geometry"==e.Type){for(var t in e)!e.hasOwnProperty(t)||"VertexArray"!=t&&"TexCoordArray"!=t&&"NormalArray"!=t&&"ColorArray"!=t||(t=e[t],Array.isArray(t)?t.forEach(function(e){"string"!=typeof e.value&&(e.value=void 0!==r?r.from(e.value.buffer).toString("base64"):(0,i.fromByteArray)(new Uint8Array(e.value.buffer)))}):"string"!=typeof t.value&&(t.value=void 0!==r?r.from(t.value.buffer).toString("base64"):(0,i.fromByteArray)(new Uint8Array(t.value.buffer))));e.PrimitiveSets.forEach(function(e){e.Indices&&(e.Indices=r.from(e.Indices).toString("base64"))})}e.Matrix&&(e.Matrix=Array.from(e.Matrix))}),e},d.readOsg=m,d.parseOsg=function(e,t,r,n,i,a,o){var s=THREE,u=a||{},l={};S={},C={},i=i||{},o&&console.time("readOsg"),"string"==typeof e?e=m(e):e instanceof Uint8Array?e=m(e=s.LoaderUtils.decodeText(e)):e instanceof ArrayBuffer&&(e=new Uint8Array(e),e=m(e=s.LoaderUtils.decodeText(e))),o&&console.timeEnd("readOsg"),o&&console.time("parseObject");var c=function t(e,r,n,i){var a=new THREE.Group;switch(e.Type){case"Osg::Geode":case"Osg::Group":case"Osg::Node":case"Osg::MatrixTransform":e.referenceFrame&&"RELATIVE"!=e.referenceFrame&&console.warn("unsupport ReferenceFrame"+e.referenceFrame+". use RELATIVE ReferenceFrame"),e.Matrix&&(a.matrix.fromArray(e.Matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.matrix.identity()),e.children.forEach(function(e){a.add(t(e,r,n,i))});break;case"Osg::Geometry":a=p(e,r,n,i);break;default:throw new Error("unsupport osg dataType "+e.Type+" ")}return a&&(a.Name=e.name),a}(e,t,u,l);if(c.osgRoot=e,o&&console.timeEnd("parseObject"),o=Object.keys(l),r&&0<o.length){var d,f,h=[];for(d in y=new s.ImageLoader(n),l)l.hasOwnProperty(d)&&(f=l[d],h.push(function(n,i){return new Promise(function(e,t){var r=n.image;"string"!=typeof r?e(n.image):i&&i[r]?(n.image=i[r],e(n.image)):((t=y.load(r,e,t))._srcUrl=r,t.uuid=THREE.Math.generateUUID(),n.image=t,i&&(i[r]=t))})}(f,i)));return a||(u={}),l={},S={},C={},Promise.all(h).then(function(){return c})}return a||(u={}),l={},S={},C={},c};var w,T,y,i=c("k_410"),b=void 0,a=(e(t,[{key:"nextRow",value:function(e){var t,r=/\r?\n+/.exec(this.text);return r?(this.cacheRow?(t=this.cacheRow,this.cacheRow=null):(t=this.text.substr(0,r.index),this.text=this.text.substr(r.index+r[0].length),e&&(this.cacheRow=t),this.onProgress&&this.onProgress(this.totalLength-this.length,this.totalLength)),t):this.text}},{key:"nextBlock",value:function(){var e=/}\r?\n+/.exec(this.text);if(e){var t=this.text.substr(0,e.index);return this.text=this.text.substr(e.index+e[0].length),this.onProgress&&this.onProgress(this.totalLength-this.length,this.totalLength),t}return this.text}},{key:"onProgress",value:function(e,t){}},{key:"length",get:function(){return this.text.length}}]),t),l={Vec2Array:Float32Array,Vec3Array:Float32Array,Vec4Array:Float32Array,UByteArray:Uint8Array,ByteArray:Int8Array,UShortArray:Uint16Array,ShortArray:Int16Array,UIntArray:Uint32Array,IntArray:Int32Array},S={},E={Vec3Array:3,Vec2Array:2,Vec4Array:2,UShortArray:1,ShortArray:1,IntArray:1,UIntArray:1},C={};function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.text=e,this.cacheRow=null,this.totalLength=e.length}}.call(this,c("buffer").Buffer)},{k_410:76,buffer:206}],191:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createUnrealBloomStage=function(e,t){var r=Cesium,n=r.PostProcessStageComposite,i=r.Cartesian3,a=r.PostProcessStage,o=r.Color;t=t||[3,5,7,9,11];for(var s,u,l,c,d,f,h,p,m=(p=e=e||"unreal_bloom",new(r=Cesium).PostProcessStage({name:p+"_bright",fragmentShader:T,uniforms:{luminosityThreshold:0,smoothWidth:.01,defaultColor:new r.Color.fromRgba(0),defaultOpacity:1}})),g=[m],_=.5,v=0;v<5;v++){var y=(s=e+"_blur_"+v,u=t[v],l=_,c=h=y=f=d=c=void 0,c=(h=Cesium).Cartesian2,d=h.PostProcessStage,f=h.PostProcessStageComposite,y=h.PostProcessStageSampleMode,h=new c(1,0),c=new c(0,1),u={defines:{KERNEL_RADIUS:u,SIGMA:u},fragmentShader:S},(0,w.parseDefines)(u),new f({name:s,stages:[new d({name:s+"_x_direction",fragmentShader:u.fragmentShader,textureScale:l,forcePowerOfTwo:!0,uniforms:{direction:h},sampleMode:y.LINEAR}),new d({name:s+"_y_direction",fragmentShader:u.fragmentShader,textureScale:l,forcePowerOfTwo:!0,uniforms:{direction:c},sampleMode:y.LINEAR})],inputPreviousStageTexture:!0}));g.push(y),_/=2}r=new n({name:e+"_blur_composite",stages:g,inputPreviousStageTexture:!0}),i={defines:{NUM_MIPS:5},uniforms:{blurTexture1:g[0].name,blurTexture2:g[1].name,blurTexture3:g[2].name,blurTexture4:g[3].name,blurTexture5:g[4].name,bloomStrength:1,bloomFactors:[1,.8,.6,.4,.2],bloomTintColors:[new i(1,1,1),new i(1,1,1),new i(1,1,1),new i(1,1,1),new i(1,1,1)],bloomRadius:.1,glowOnly:!1,selectedBloomFactor:.1},fragmentShader:E},(0,w.parseDefines)(i);var b=new a({name:e+"_generate_composite",fragmentShader:i.fragmentShader,uniforms:i.uniforms}),i={},x=o.fromBytes(255,255,255,255),M=1;return Object.defineProperties(i,{threshold:{get:function(){return m.uniforms.luminosityThreshold},set:function(e){m.uniforms.luminosityThreshold=e}},smoothWidth:{get:function(){return m.uniforms.smoothWidth},set:function(e){m.uniforms.smoothWidth=e}},strength:{get:function(){return b.uniforms.bloomStrength},set:function(e){b.uniforms.bloomStrength=e}},radius:{get:function(){return b.uniforms.bloomRadius},set:function(e){b.uniforms.bloomRadius=e}},bloomFactors:{get:function(){return b.uniforms.bloomFactors},set:function(e){e&&(b.uniforms.bloomFactors=e)}},bloomFactor:{get:function(){return M},set:function(e){if("number"==typeof e&&e)for(var t=(M=e)/5,r=0;r<5;r++)this.bloomFactors[r]=M-t*r}},bloomTintColors:{get:function(){return b.uniforms.bloomTintColors},set:function(e){e&&(b.uniforms.bloomTintColors=e)}},bloomTintColor:{get:function(){return x},set:function(e){var t;e&&(t=Cesium.Color,"number"==typeof e?x=t.fromRgba(e):"string"==typeof e?x=t.fromCssColorString(e):e.isColor?(x.red=e.r,x.green=e.g,x.blue=e.b):e instanceof t?x=e:t.clone(e,x),b.uniforms.bloomTintColors.forEach(function(e){e.x=x.red,e.y=x.green,e.z=x.blue}))}},glowOnly:{get:function(){return b.uniforms.glowOnly},set:function(e){b.uniforms.glowOnly=!!e}},selectedBloomFactor:{get:function(){return b.uniforms.selectedBloomFactor},set:function(e){"number"==typeof e&&e&&(b.uniforms.selectedBloomFactor=e)}}}),new n({name:e,stages:[r,b],inputPreviousStageTexture:!1,uniforms:i})};var w=e("s_418"),T="\n    uniform sampler2D colorTexture;\n    uniform vec3 defaultColor;\n    uniform float defaultOpacity;\n    uniform float luminosityThreshold;\n    uniform float smoothWidth;\n    \n    varying vec2 v_textureCoordinates;\n    void main() {\n    \tvec4 texel = texture2D( colorTexture, v_textureCoordinates );\n        \n       #ifdef CZM_SELECTED_FEATURE\n           if (!czm_selected()) {\n               texel = vec4(0.);\n           }\n       #endif\n       \n    \tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n    \tfloat v = dot( texel.xyz, luma );\n    \tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n    \tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n    \tgl_FragColor = mix( outputColor, texel, alpha );\n    }\n    ",S="\nvarying vec2 v_textureCoordinates;\nuniform sampler2D colorTexture;\nuniform vec2 colorTextureDimensions;\nuniform vec2 texSize;\nuniform vec2 direction;\n\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n}\nvoid main() {\n    \n    vec2 invSize = 1.0 / colorTextureDimensions;\n    float fSigma = float(SIGMA);\n    float weightSum = gaussianPdf(0.0, fSigma);\n    vec3 diffuseSum = texture2D( colorTexture, v_textureCoordinates).rgb * weightSum;\n    for( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n        float x = float(i);\n        float w = gaussianPdf(x, fSigma);\n        vec2 uvOffset = direction * invSize * x;\n        vec3 sample1 = texture2D( colorTexture, v_textureCoordinates + uvOffset).rgb;\n        vec3 sample2 = texture2D( colorTexture, v_textureCoordinates - uvOffset).rgb;\n        diffuseSum += (sample1 + sample2) * w;\n        weightSum += 2.0 * w;\n    }\n    gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n}",E="\nvarying vec2 v_textureCoordinates;\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\nuniform sampler2D colorTexture;\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform float bloomFactors[NUM_MIPS];\nuniform vec3 bloomTintColors[NUM_MIPS];\nuniform float selectedBloomFactor;\nuniform bool glowOnly;\n\nfloat lerpBloomFactor(const in float factor) { \n    float mirrorFactor = 1.2 - factor;\n    return mix(factor, mirrorFactor, bloomRadius);\n}\n\nvoid main() {\n    \n    vec4 color=texture2D(colorTexture, v_textureCoordinates);\n    vec4 bloomColor= bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.) * texture2D(blurTexture1, v_textureCoordinates) +                                      lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.) * texture2D(blurTexture2, v_textureCoordinates) +                                      lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.) * texture2D(blurTexture3, v_textureCoordinates) +                                      lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.) * texture2D(blurTexture4, v_textureCoordinates) +                                      lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.) * texture2D(blurTexture5, v_textureCoordinates) );\n    \n    #ifdef CZM_SELECTED_FEATURE\n        if (czm_selected()) {\n            gl_FragColor =glowOnly?bloomColor*selectedBloomFactor: color+ bloomColor*selectedBloomFactor;\n            return;\n        }\n    #endif\n    \n    gl_FragColor =glowOnly?bloomColor: bloomColor+color;\n}"},{s_418:177}],192:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PostProcessLib=void 0;e={createUnrealBloomStage:e("M_448").createUnrealBloomStage};r.PostProcessLib=e},{M_448:191}],193:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e},y=(e("e_417"),e("M_424")),b=n(e("e_414")),a=e("-_452"),u=e("3_453"),x=n(e("d_454")),M=e("3_421"),e=(n(e("M_456")),e("e_91")),w=n(e),T=(i(o,null,[{key:"loadGeojson",value:function(e){return Cesium.Resource.fetchJson(e)}},{key:"load",value:function(e,t,r,n){var i=this;return this.loadGeojson(e).then(function(e){return console.time("calcBBox"),a.geojsonHelper.calcBBox(e),console.timeEnd("calcBBox"),i.parse(e,t,r,n)})}},{key:"parse",value:function(e,o,s,u){s=s||function(e){},u=u||{},console.time("process contentSet");var l=[],c=void 0,d=0,f=[],h=[],p=e.features&&100<e.features.length?e.features.length/100:100;f.push(h),a.geojsonHelper.featureEach(e,function(e,t){e.geometry&&e.geometry.coordinates.length?(h.length>p&&(h=[],f.push(h)),h.push({feature:e,id:t})):0});var e=Cesium,m=e.Rectangle,g=e.TileBoundingRegion,_=e.Color,e=new w.default(f,function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.feature,r=r.id;try{var i=n.geometry.bbox,a=10*n.properties.Floor,o=m.fromDegrees(i[0],i[1],i[2],i[3]),s=new g({rectangle:o,minimumHeight:.1,maximumHeight:a});n.properties=n.properties||{},n.properties.featureId=r;var u={uri:n,boundingVolume:{region:s,sphere:s.boundingSphere},showDebugVolume:!1};l.push(u),d=Math.max(d,a),c?m.union(c,o,c):c=o.clone()}catch(e){throw console.error(e),e}}}),v=0;return e.run(function(e){s(v=.4*e)}).then(function(){s(v=40);try{var e=new g({rectangle:c,minimumHeight:.1,maximumHeight:d}),t=c.width/c.height,r=4,n=4;1<t?r=parseInt(Math.ceil(n*t)):n=parseInt(Math.ceil(r/t));var a=x.default.create({rootBoundingVolume:{region:e},maxLevel:u.maxLevel||5,zSliceLevel:u.zSliceLevel||6,xSize:r,ySize:n,zSize:2,minRange:u.minRange||2,debugVolume:u.debugVolume,showDebugVolume:u.showDebugVolume,debugVolumeColor:u.debugVolumeColor||_.CYAN.clone(),rtcCenter:e.boundingSphere.center,recursive:!1}),i=a.children.slice();return new w.default(i,function(e){e._createLODTreeDelay(!0)}).run(function(e){s(.2*e+v)}).then(function(){return s(v=60),i=a.children.slice(),new w.default(i,function(e){x.default.filterContents(l,e,!1)}).run(function(e){s(.1*e+v)}).then(function(){s(v=70);var t=[];return a.children.forEach(function(e){y.Object3D.traverse(e.children,function(e){e.refine="ADD",0<e.level&&t.push(e)})}),t.sort(function(e,t){return e.level-t.level}),h=[],(f=[]).push(h),p=100,t.forEach(function(e){h.length>p&&(h=[],f.push(h)),h.push(e)}),new w.default(f,function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.parent._getContentSetBeforeFilter();x.default.filterContents(n,r,!1)}}).run(function(e){s(.3*e+v)}).then(function(){v=100;var i,l,t=(l=o,{requestContent:function(e,o){function t(e){var t=void 0,r={},n=e.uri,e=n.properties.featureId;l(n,r);e=T.parseFeature(n,e,r),r=r.material;if(o)for(var i=(e=!(e instanceof Cesium.Geometry)?e.constructor.createGeometry(e):e).attributes.position.values,a=0;a<i.length;a+=3)i[a]-=o.x,i[a+1]-=o.y,i[a+2]-=o.z;u.has(r)?t=u.get(r):(s.push(t={material:r,geometries:[]}),u.set(r,t)),t.geometries.push(e)}var s=[],u=new WeakMap,r=[],n=[];return r.push(n),e.contain.forEach(function(e){100<n.length&&(n=[],r.push(n)),n.push(e)}),e.intersect.forEach(function(e){100<n.length&&(n=[],r.push(n)),n.push(e)}),new w.default(r,function(e){e.forEach(t)}).run().then(function(){var r=new y.Object3D;return s.forEach(function(e){var t=b.default.mergeGeometries(e.geometries),e=e.material,t=new M.Mesh(t,e);t.pickObject={id:t,mesh:t,primitive:i},r.add(t),t.matrixAutoUpdate=!1,t.modelMatrixNeedsUpdate=!1,t.frustumCulled=!1,u.delete(e)}),r.matrixAutoUpdate=!1,r.modelMatrixNeedsUpdate=!1,r.frustumCulled=!1,s.splice(0),e.contain.splice(0),e.intersect.splice(0),r})}});return(i=a).children.forEach(function(e){y.Object3D.traverse(e,function(e){e.contentProvider=t})}),s(v),a})})})}catch(e){throw console.error(e),e}})}},{key:"parseFeature",value:function(e,t,r){if(e.geometry){e=this.parseGeometry(e.geometry,r),r=e.attributes.position.values.length,r=new Float32Array(r);r.fill(t);t=Cesium,r=new t.GeometryAttribute({componentDatatype:t.ComponentDatatype.FLOAT,componentsPerAttribute:1,values:r});return e.attributes.batchId=r,e}}},{key:"parseGeometry",value:function(e,t){var r,n=this,i=e.type;return"Polygon"==i?e=this.parsePolygon(e.coordinates,t):"MultiPolygon"==i?(r=e.coordinates.map(function(e){return n.parsePolygon(e,t)}),e=b.default.mergeGeometries(r)):"MultiGeometry"==i&&(i=e.geometry.map(function(e){return n.parseGeometry(e,t)}),e=b.default.mergeGeometries(i)),e}},{key:"parsePolygon",value:function(e,t){for(var r=Cesium.PolygonHierarchy,n=this.transformCoordinates(e[0]),i=[],a=1;a<e.length;a++){var o=e[a],o=new r(this.transformCoordinates(o));i.push(o)}var s=u.ExtrudedPolygonGeometry,t=new s(Object.assign({polygonHierarchy:new r(n,i),generateExtrudedUvNormal:!0},t));return s.createGeometry(t)}},{key:"transformCoordinates",value:function(e){return e.map(function(e){return Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]||0)})}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=T},{e_414:11,"3_421":15,e_417:22,M_424:25,e_91:166,"-_452":174,"3_453":181,M_456:201,d_454:202}],194:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("W_429"),E=e("e_459"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(C,n.IRenderable),C);function C(d,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,C);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(C.__proto__||Object.getPrototypeOf(C)).call(this));if("undefined"==typeof THREE)throw new Error("three.js  is required.");var h,p,m,t,r,n,i,a=THREE,o=(a.InstancedBufferAttribute,a.InstancedMesh),s=a.SphereBufferGeometry,u=a.CircleBufferGeometry,l=a.MeshBasicMaterial,c=!1,g=!1,_=!0,v=!0,y=!1,b={id:e,primitive:e},x=[],M=[],w=null,T=!0;Object.defineProperties(e,{pickId:{get:function(){return T?w:null}},bloom:{get:function(){return T},set:function(e){T=e}},enabled:{get:function(){return _},set:function(e){_=e,h&&(h.visible=_),p&&(p.visible=g&&_)}},showSphere:{get:function(){return g},set:function(e){g=e,p&&(p.visible=g&&_)}},initialized:{get:function(){return c}},lights:{get:function(){return x}},distance:{get:function(){return d},set:function(e){v=d!=e,d=e}},decay:{get:function(){return f},set:function(e){f=e}}}),e.addLight=function(e){x.push(e),c&&(y=!0)},e.reset=function(){M.length=0;var e=this.lights.length;(p=new o(t,r,e)).frustumCulled=!1,p.pickObject=b,(h=new o(n,i,e)).frustumCulled=!1,p.setColorAt(0,x[0].color),h.setColorAt(0,x[0].color),this.update(!0,!0),p.visible=g&&_,h.visible=_,c=!0},e.init=function(){t=new s(.25,16,8,0,2*Math.PI,0,Math.PI/2),(r=new THREE.MeshBasicMaterial).transparent=!0,n=new u(1,64),i=new l,n.rotateX(-Math.PI/2),i.transparent=!0,i.onAfterCompile=function(e){var t;(m=e.uniforms).uDecay={value:f},m.uDistance={value:d},e=(t=e).vertexShader,e=(0,E.insertBeforeMain)(e,"varying vec3 vViewPosition;\nvarying vec3 vLightPosition;"),e=(0,E.insertBefore)(e,"mvPosition = modelViewMatrix *","vViewPosition = - mvPosition.xyz;"),e=(0,E.appendMain)(e,"vLightPosition= (instanceMatrix*vec4(0.,0.,0.,1.)).xyz;"),t.vertexShader=e,e=t.fragmentShader,e=Cesium.ShaderSource.replaceMain(e,"new_fixed_light_main"),t.fragmentShader=e+="\nvarying vec3 vViewPosition;\nvarying vec3 vLightPosition;\nuniform float uDecay;\nuniform float uDistance;\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n    #if defined ( PHYSICALLY_CORRECT_LIGHTS )\n        float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n        if( cutoffDistance > 0.0 ) {\n            distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n        }\n        return distanceFalloff;\n    #else\n        if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n            return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n        }\n        return 1.0;\n    #endif\n}\nvoid main(){\n    vec3 lVector = vLightPosition + vViewPosition;\n    float lightDistance = length( lVector );\n    float a=1.-lightDistance/uDistance;\n    if(a==0.){ discard; return;};\n    vec3 lightColor=vColor*punctualLightIntensityToIrradianceFactor( lightDistance, uDistance, uDecay );\n    if( lightColor == vec3( 0.0 ) )discard; \n    a*= length( lightColor );\n    gl_FragColor=vec4( lightColor ,a);\n}\n"},i.depthTest=!1,this.reset()};var S=[];return e.update=function(e,t){m&&(m.uDistance.value=d,m.uDecay.value=f),w=p.pickId;for(var r=0,n=!1,i=!1,a=!1,o=S.length=0;o<x.length;o++){var s=x[o],u=function(e,t,r){var n=M[t];if(n||(n={color:e.color.clone(),sphereColor:e.color.clone(),colorChanged:!0,visibleChanged:!1,visible:!0,intensity:0},M[t]=n),e.visible!=n.visible&&(n.visibleChanged=!0,n.visible=e.visible),!n.visible)return n;var i=e.intensity;return n.intensity==i&&!r||(t=e.color.r,r=e.color.g,e=e.color.b,n.intensity=i,n.color.setRGB(t*i,r*i,e*i),n.sphereColor.setRGB(t*(i+=1),r*i,e*i),n.colorChanged=!0),n}(s,o,e);u.visibleChanged&&(u.visibleChanged=!(a=!0)),s.visible?(u.colorChanged&&(i=!0),(v||t)&&(s.scale.setScalar(d),s.updateMatrix()),(s.matrixWorldNeedsUpdate||s._modelMatrixNeedsUpdate||t||!u.matrixWorld)&&(s.updateMatrixWorld(),n=!0,u.matrixWorld=s.matrixWorld,u.matriNeedsUpdate=!0),S.push(u),r++):(v||t)&&(s.scale.setScalar(d),s.updateMatrix())}if(a||i||n)for(var l=0;l<S.length;l++){var c=S[l];(c.colorChanged||a)&&(p.setColorAt(l,c.sphereColor),h.setColorAt(l,c.color),c.colorChanged=!1),(c.matriNeedsUpdate||a)&&(p.setMatrixAt(l,c.matrixWorld),h.setMatrixAt(l,c.matrixWorld),c.matriNeedsUpdate=!1)}(i||a)&&(p.instanceColor.needsUpdate=!0,h.instanceColor.needsUpdate=!0),(n||a)&&(p.instanceMatrix.needsUpdate=!0,h.instanceMatrix.needsUpdate=!0),a&&(p.count=r,h.count=r),v=!1},e.render=function(e,t){if(_){for(var r=0;r<x.length;r++){var n=x[r];this.visualizer.computeModelMatrix(n),n.visible=this.visualizer.isLightVisible(n,e)}y?(this.visualizer.remove(p,!0),this.visualizer.remove(h,!0),this.reset(),y=!1):this.update(),g&&t.push(p),t.push(h);for(var i=0;i<x.length;i++)x[i]._modelMatrixNeedsUpdate=!1}},e.destroy=function(){var e=this.visualizer;e&&(h&&e.remove(h),p&&e.remove(p),M.length=0,x.length=0,m=p=h=null,this.pickId=null)},e}r.default=n},{W_429:13,e_459:50}],195:[function(e,t,r){"use strict";function f(e,t,r,n){var i=t.getRenderTarget(),a=t.autoClear;t.autoClear=!1,t.setRenderTarget(n),t.clear(),t.render(e,r),t.setRenderTarget(i),t.autoClear=a}Object.defineProperty(r,"__esModule",{value:!0});var b,n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e},e=e("W_429"),x={vertexShader:["void main(){","    gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","void main(){","    vec2 uv=gl_FragCoord.xy*resolution;","    gl_FragColor=texture2D(tDiffuse,uv);","}"].join("\n")},M={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4(texel.rgb, texel.a>0. ?texel.a*opacity : 0.);//opacity * texel;","}"].join("\n")},n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,e.IRenderable),n(h,[{key:"add",value:function(e){this.scene.add(e),this._boundingVolumeNeedsUpdate=!0}},{key:"addPass",value:function(e){this.postPasses.includes(e)||this.postPasses.push(e)}},{key:"updateBoundingVolume",value:function(){var e,t,r;this._boundingVolumeNeedsUpdate&&(r=this._boundingBox.setFromObject(this.scene),e=this._mesh,t=r.max.clone().sub(r.min),e.scale.set(t.x,t.y,1),r=t.addVectors(r.max,r.min).divideScalar(2),e.position.set(r.x,r.y,this.z),e.updateMatrixWorld(),this.scene.updateMatrixWorld()),this._boundingVolumeNeedsUpdate=!1}},{key:"update",value:function(e){var t,r=b,n=r.OrthographicCamera,i=r.UniformsUtils,a=r.AdditiveBlending,o=r.Mesh,s=r.Vector2,u=r.WebGLRenderTarget,l=(r.NearestFilter,r.LinearFilter),c=r.RGBAFormat,d=r.PlaneBufferGeometry,f=r.ShaderMaterial,h=e.context,p=h.drawingBufferHeight,m=h.drawingBufferWidth,g=p/m,_=this._width,v=_*g,y=this._renderTarget,r=this._sampleRenderTarget,e=this._mesh,h=this._copyMesh;e||(t=new d(1,1),(s=new f({uniforms:{tDiffuse:{value:null},resolution:{value:new s}},vertexShader:x.vertexShader,fragmentShader:x.fragmentShader})).transparent=!0,(e=new o(t,s)).up.set(0,0,1),e.position.set(0,0,.1),e.frustumCulled=!1,this._mesh=e),h||(this._copyUniforms=i.clone((i=M).uniforms),this._copyMaterial=new b.ShaderMaterial({uniforms:this._copyUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:a,depthTest:!1,depthWrite:!1}),(h=new o(t=new d(2,2),this._copyMaterial)).frustumCulled=!1,h.updateMatrixWorld(),h.modelMatrixNeedsUpdate=!1,this._copyMesh=h,this._copyCamera=new n(-1,1,1,-1,0,1)),y?this._aspect!=g&&(y.setSize(_,v),r.setSize(_,v)):((y=new u(_,v,{minFilter:l,magFilter:l,format:c})).texture.name="GroundLineVisualizer.diffuse",this._renderTarget=y,(r=new u(_,v,{minFilter:l,magFilter:l,format:c})).texture.name="SSAARenderPass.sample",this._sampleRenderTarget=r),this._aspect=g;e=e.material.uniforms;e.tDiffuse.value=y.texture,e.resolution.value.set(1/m,1/p)}},{key:"copy",value:function(e,t,r){this._copyUniforms.tDiffuse.value=t.texture,this._copyUniforms.opacity.value=1,f(this._copyMesh,e,this._copyCamera,r)}},{key:"renderSSAAPass",value:function(e,t){var r=this._renderTarget,n=r,i=this._sampleRenderTarget,a=h.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],o=e.autoClear;e.autoClear=!1;var s=1/a.length;this._copyUniforms.tDiffuse.value=i.texture;for(var u=n.width,l=n.height,c=0;c<a.length;c++){var d=a[c];t.setViewOffset&&t.setViewOffset(u,l,.0625*d[0],.0625*d[1],u,l);d=s;this.unbiased&&(d+=1/32*((c+.5)/a.length-.5)),this._copyUniforms.opacity.value=d,e.setRenderTarget(i),e.clear(),e.render(this.scene,t),e.setRenderTarget(this.renderToScreen?null:r),0===c&&e.clear(),e.render(this._copyMesh,this._copyCamera)}t.clearViewOffset&&t.clearViewOffset(),e.autoClear=o}},{key:"onBeforeRender",value:function(e,t,r,n){var i,a,o,s,u,l,c,d;this.show&&this.scene.children.length&&e.camera==this.visualizer.mainCamera&&(i=[],this.scene.traverse(function(e){e.geometry&&i.push(e)}),0!=i.length&&(this.update(e),this.updateBoundingVolume(),a=this.visualizer,o=this._sampleRenderTarget,s=this._renderTarget,u=a.backgroundMesh.visible,l=a.isMoonVisible,e=a.isSunVisible,a.backgroundMesh.visible=!1,a.isMoonVisible=!1,a.isSunVisible=!1,c=[],this.postPasses.forEach(function(e){e.enabled&&(e.setSize(s.width,s.height),c.push(e))}),this.ssaaEnabled?(this.renderSSAAPass(t,r),d=t.getRenderTarget(),c.length&&(this.copy(t,s,o),c.forEach(function(e){e.render(t,s,o)}))):(d=t.getRenderTarget(),f(this.scene,t,r,c.length?o:s),c.length&&c.forEach(function(e){e.render(t,s,o)}),t.setRenderTarget(d)),a.backgroundMesh.visible=u,a.isMoonVisible=l,a.isSunVisible=e))}},{key:"render",value:function(e,t,r,n,i){this.show&&this.scene.children.length&&e.camera==this.visualizer.mainCamera&&(this._mesh&&t.push(this._mesh),this._frameNumber=e.frameNumber)}}]),h);function h(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return b=THREE,t.z=(e=e||{}).z||.1,t._aspect=-1,t._renderTarget=null,t._mesh=null,t._width=e.width||("undefined"!=typeof window?window.innerWidth:1920),t._boundingVolumeNeedsUpdate=!1,t._boundingBox=new b.Box3,t.ssaaEnabled=null==e.ssaaEnabled||e.ssaaEnabled,t.show=null==e.show||e.show,t.sampleLevel=e.sampleLevel||2,t.unbiased=null!=e.unbiased&&e.unbiased,t.scene=new b.Scene,t.postPasses=[],t}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],r.default=n},{W_429:13}],196:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.IContentProvider=void 0;var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e},e=(e("M_424"),e("e_462"));function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}e&&e.__esModule,r.IContentProvider=(n(a,[{key:"requestContent",value:function(e,t){throw new Error("IContentProvider.requestContent not implemented")}}]),a)},{M_424:25,e_462:203}],197:[function(e,t,r){"use strict";function s(e){var t=Cesium,e=t.Cartographic.fromCartesian(e);return t.Cartesian3.fromRadians(e.longitude,e.latitude,0)}function u(e,t){var r=Cesium,n=r.Rectangle,i=r.Cartographic,a=r.Cartesian3,o=r.IntersectionTests,s=r.Ray;if(e.region){r=i.fromCartesian(t),i=e.region.rectangle;return n.contains(i,r)}c=c||new s,a.clone(t,c.position),a.normalize(t,c.direction);e=e.boundingSphereWC||e.boundingSphere;return!!e&&o.raySphere(c,e)}function l(e,t,r){var n=r?t:s(t),i=e.children.length;if(u(e,n)){for(var a,o=0;o<i&&!(a=l(e.children[o],n,!0));o++);return a=!a&&e.isCommandsReady()?e:a}}Object.defineProperty(r,"__esModule",{value:!0}),r.memeoryOf=function t(r){var e,n,i=0;if(r.isTexture)var a=r.image,i=a.width*a.height*4;else if(r.isGeometry){var o,s,u=d.default.get(r).attributes;for(o in u)u[o]&&(s=u[o].array,i+=s.buffer.byteLength);r.index&&(i+=r.index.array.buffer.byteLength)}else r.isMesh?(e=t(r.geometry),a=r.material,Array.isArray(a)||(a=[a]),n=0,a.forEach(function(e){n+=t(e)}),i=n+e):r.isMaterial?f.forEach(function(e){(e=r[e])&&(i+=t(e))}):r.isObject3D&&r.children.forEach(function(e){i+=t(e)});return i},r.boundingBoxToRegion=function(e,t){for(var r=(u=Cesium).Rectangle,n=u.Cartographic,i=u.Matrix4,a=u.Cartesian3,o=u.Ellipsoid,s=u.TileBoundingRegion,u=e.minimum,e=e.maximum,l=[u.x,e.x],c=[u.y,e.y],d=[u.z,e.z],f=new a(0,0,0),h=new a,p=new n,m=2*Math.PI,g=-m,_=Math.PI,v=-_,y=Number.MAX_VALUE,b=-y,x=0;x<l.length;x++){f.x=l[x];for(var M=0;M<c.length;M++){f.y=c[M];for(var w=0;w<d.length;w++)f.z=d[w],i.multiplyByPoint(t,f,h),n.fromCartesian(h,o.WGS84,p),m=Math.min(p.longitude,m),g=Math.max(p.longitude,g),_=Math.min(p.latitude,_),v=Math.max(p.latitude,v),y=Math.min(p.height,y),b=Math.max(p.height,b)}}return new s({rectangle:r.fromRadians(m,_,g,v),minimumHeight:y,maximumHeight:b,ellipsoid:o.WGS84})},r.getSurfacePosition=s,r.tileContains=u,r.selectTileLoaded=l,r.updatePositionClamped=function(r,n,i,a){n.forEach(function(e){var t;e.positionClamped&&!a||(t=e.position.getValue(i.clock.currentTime),!l(r,t)||(t=i.scene.clampToHeight(t,n))&&(e.position=t,e.positionClamped=t))})};var c,e=e("h_435"),d=e&&e.__esModule?e:{default:e},f=["map","lightMap","bumpMap","aoMap","specularMap","alphaMap","envMap","normalMap","emissiveMap","displacementMap","metalnessMap","roughnessMap","transmissionMap","clearcoatNormalMap","clearcoatMap"]},{h_435:60}],198:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function f(e){var t,r,n,i,a,o,s;e.boundingSphere&&(t=(s=Cesium).Matrix3,r=s.Matrix4,o=s.BoundingSphere,a=e.tileset,n=(a||e).modelMatrix,i=r.getMaximumScale(n),s=e.boundingSphere,a=e.localBoundingSphere,s.radius*=i,r.multiplyByPoint(n,a.center,s.center),e.boundingSphere2d=o.projectTo2D(s,null,e.boundingSphere2d),e.aabbLocal&&(a=e.obb,o=e.aabbLocal,r.multiplyByPoint(n,o.center,e.aabb.center),r.multiplyByPoint(n,a.center,a.center),d=d||new t,s=r.getMatrix3(n,d),t.multiply(s,a.halfAxes,a.halfAxes),e.region=(0,w.boundingBoxToRegion)(o,n)),e.content&&(e.content.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,r.multiply(n,e.matrixWorld.elements,e.modelMatrix)),e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1}),e.debugVolume&&e.debugVolume.isObject3D&&(e.debugVolume._modelMatrix=n)))}function s(e){var t,a,o,r=e.osgRoot,n=void 0;return e._osgBuffer&&((r=h.readBuffer(e._osgBuffer))||(t=new Uint8Array(e._osgBuffer),t=THREE.LoaderUtils.decodeText(t),r=(0,l.readOsg)(t),e.content=(0,l.parseOsg)(r,!1)),e.osgRoot=r,e._osgBuffer=null),r?(e.rangeDataList=r.RangeDataList,e.rangeList=r.RangeList,e._isExpired||function(e){var t=Cesium,r=t.Color,n=t.AxisAlignedBoundingBox,i=t.OrientedBoundingBox,a=t.Matrix3,o=t.Cartesian3,s=t.BoxOutlineGeometry,u=(t.Transforms,t.Matrix4);c(e);var t=e.osgRoot,l=[];h.traverse(t,function(e){"Osg::Geometry"==e.Type&&(e=o.unpackArray(e.VertexArray.Value),l=l.concat(e))}),e.obbLocal=i.fromPoints(l),e.obb=e.obbLocal.clone(),e.aabbLocal=n.fromPoints(l),e.aabb=e.aabbLocal.clone();n=e.tileset.modelMatrix;u.multiplyByPoint(n,e.aabbLocal.center,e.aabb.center),u.multiplyByPoint(n,e.obb.center,e.obb.center),d=d||new a;u=u.getMatrix3(n,d);a.multiply(u,e.obb.halfAxes,e.obb.halfAxes),e.region=(0,w.boundingBoxToRegion)(e.aabbLocal,n),e.debugVolume&&(n=s.fromAxisAlignedBoundingBox(e.aabbLocal),n=s.createGeometry(n),r=new _.MeshMaterial({defaultColor:r.CYAN.clone(),wireframe:!0,allowPick:!1}),e.debugVolume=new g.Mesh(n,r),e.debugVolume.modelMatrixNeedsUpdate=!1,e.debugVolume._modelMatrix=e.tileset.modelMatrix)}(e),n="Osg::PagedLOD"==r.Type||"Osg::Geometry"==r.Type?(e.children[0]||function(e){var t=e.rangeDataList;{var r;t&&0<t.length&&(r=t[1],t=new C({tileset:(t=e).tileset,tileId:r,manager:t.manager,loader:t.loader,parent:t,root:t.root||t,uri:t.path+"/"+r,debugVolume:t.debugVolume,showDebugVolume:t.showDebugVolume,minRange:t.minRange}),e.children.push(t))}}(e),u(e)):(e.hasEmbedLOD=!0,e._contentMemorySize=0,o=[],(a=e).osgRoot.Children.forEach(function(e,t){var r,n,i=a.children[t];i?(i.osgRoot=e,i.state=E.default.LOADING,r=u(i)):(n=a.tileId+"."+t,(i=new C({uri:a.uri+t,tileId:n,parent:a,manager:a.manager,loader:a.loader,tileset:a.tileset,root:a.root||a,debugVolume:a.debugVolume,showDebugVolume:a.showDebugVolume,minRange:a.minRange,isEmbedLOD:!0})).state=E.default.LOADING,i.osgRoot=e,r=s(i),a.children.push(i)),r=r.then(function(){return i.state=E.default.LOADED,i.osgRoot=null,i.ready=!0,i._isExpired=!1,i.readyPromise.resolve(i),i}),o.push(r)}),Cesium.when.all(o,function(){return a.osgRoot=null,a}))):(n=Cesium.when.defer()).resolve(e),n}function u(r){var e,n=r.tileset,i=Cesium.when.defer();return r.content?(e=(0,w.memeoryOf)(r.content),n._memorySize+=e,r._contentMemorySize=e,i.resolve(r)):r.loader.parse(r.osgRoot,r.path,function(e){e.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,e.pickObject={id:r,mesh:e,primitive:n},e.material.autoRefresh=!1,e.modelMatrix=Cesium.Matrix4.multiply(n.modelMatrix,e.matrixWorld.elements,e.modelMatrix)),e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1});var t=(0,w.memeoryOf)(e);n._memorySize+=t,r._contentMemorySize=t,r.content=e,r.osgRoot=null,r.content.osgRoot=null,f(r),i.resolve(r)},function(e){console.error(e),i.reject(e)},{loadTexture:!0}),i}function c(e){var t=Cesium,r=t.BoundingSphere,n=t.Cartesian3,i=t.Matrix4;if(!e.tileset){var a=e.children.map(function(e){return e.localBoundingSphere});return e.localBoundingSphere=r.fromBoundingSpheres(a),e.boundingSphere=e.localBoundingSphere.clone(),0}var t=e.osgRoot,a=t.Children,o=t.UserCenter;if("Osg::PagedLOD"==t.Type)e.localBoundingSphere=new r(n.fromArray(o.center),o.radius);else if(a&&"Osg::PagedLOD"==a[0].Type){var s=[];t.Children.forEach(function(e){o=e.UserCenter,s.push(new r(n.fromArray(o.center),o.radius))}),e.localBoundingSphere=r.fromBoundingSpheres(s)}else{var u=[];if(h.traverse(t,function(e){"Osg::Geometry"==e.Type&&u.push(r.fromVertices(e.VertexArray.Value))}),0==u.length)throw new Error("cannot compute boundingSphere for node "+t);e.localBoundingSphere=r.fromBoundingSpheres(u)}e.boundingSphere=e.localBoundingSphere.clone();t=i.getMaximumScale(e.tileset.modelMatrix);e.boundingSphere.radius*=t,i.multiplyByPoint(e.tileset.modelMatrix,e.localBoundingSphere.center,e.boundingSphere.center),e.boundingSphere2d=r.projectTo2D(e.boundingSphere)}Object.defineProperty(r,"__esModule",{value:!0});var d,i,a=function(e,t,r){return t&&L(e.prototype,t),r&&L(e,r),e},o=e("W_29"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("__439")),l=e("s_466"),p=e("M_424"),m=e("W_429"),g=e("3_421"),_=e("e_417"),v=n(e("__471")),y=e("M_432"),b=e("i_473"),x=n(e("e_91")),M=n(e("3_437")),w=e("s_476"),T=(n(e("W_477")),e("e_478")),S=n(T),E=n(e("i_479")),C=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(A,m.IRenderable),a(A,[{key:"loadMetaData",value:function(){var n=this,t=this.uri;this.manager&&(t=this.manager.resolveURL(this.uri));var e=Cesium,r=e.Resource,i=e.Cartesian3,a=e.Cartographic,o=e.Transforms,s=e.Matrix4;return r.fetchXML(t).then(function(e){var t=e.getElementsByTagName("ModelMetadata");if(t&&0<t.length){var r=t[0],e=r.getElementsByTagName("SRS");if(e&&e.length){t=e[0].textContent,e=t.indexOf(":");if("ENU"!=t.split(":")[0])throw new Error("Unsupport SRS:"+t);e=t.substr(e+1);n.metadata.srs=JSON.parse("["+e+"]"),n.metadata.srs.reverse(),n.center=i.fromDegrees(n.metadata.srs[0],n.metadata.srs[1],n.metadata.srs[2]||0),n.centerCartographic=a.fromDegrees(n.metadata.srs[0],n.metadata.srs[1],n.metadata.srs[2]||0),n._srsModelMatrix=o.eastNorthUpToFixedFrame(n.center,Cesium.Ellipsoid.WGS84,n._srsMatrix)}r=r.getElementsByTagName("SRSOrigin");r&&r.length&&((r=r[0].textContent)&&(n.metadata.srsOrigin=JSON.parse("["+r+"]"),r=i.fromArray(n.metadata.srsOrigin),n._srsTransform=s.fromTranslation(r)))}else console.warn("metadata  "+n.url+" is empty.");s.multiply(n._transform,n._srsTransform,n._computedTransform),s.multiply(n._srsMatrix,n._computedTransform,n.modelMatrix),n.loadRootTiles()}).otherwise(function(e){console.trace(e),console.warn("metadata "+t+" load failed."+e),n.loadRootTiles()})}},{key:"loadRootTiles",value:function(){for(var e=this,t=this.minX;t<=this.maxX;t++)for(var r=b.StringUtil.paddingStart(t,3),n=this.minY;n<=this.maxY;n++){var i=b.StringUtil.paddingStart(n,3),a=this.tilePattern.replace("{x}",r).replace("{y}",i),i=this.dataDir+"/"+a+"/"+a+"."+this.ext,a=new A({uri:this.path+i,tileId:a,tileset:this,loader:this.loader,manager:this.manager,debugVolume:this.debugVolume,showDebugVolume:this.showDebugVolume,minRange:this.minRange});this.children.push(a)}var o=this.children.slice();return new x.default(o,function(r){return new Promise(function(t,e){r.requestTile().then(t).otherwise(function(e){console.warn("tile "+r.tileId+" load failed."+e),t()})})}).run(this.onInitProgress).then(function(){return c(e),f(e),e.state=E.default.READY,e.ready=!0,e.readyPromise.resolve(e),e})}},{key:"requestTile",value:function(){var e=Cesium,t=e.when,e=e.Resource,r=this;if(r.osgRoot){var n=t.defer();return n.resolve(r),n}t=new AbortController,n=t.signal;r._abortController=t;t=r.uri;return r.manager&&(t=r.manager.resolveURL(r.uri)),this.state=E.default.LOADING,e.fetchArrayBuffer({url:t,signal:n}).then(function(e){return r._osgBuffer=e,r._osgBufferSize=e.byteLength,s(r)}).then(function(){return r.hasEmbedLOD?r.state=E.default.READY:r.state=E.default.LOADED,r.ready=!0,r.readyPromise.resolve(r),r}).otherwise(function(e){throw r.state=E.default.ERROR,r.ready=!1,r.readyPromise.reject(e),e})}},{key:"computeVisibility",value:function(e){var t=(Cesium.Intersect,this.parent),r=e.cullingVolume,r=t?1==t._visibility?t._visibility:r.computeVisibility(this.region):r.computeVisibility(this.boundingSphere);return this._visibility=r,this._visible=-1<r,this._visible&&(r=this.geometryErrorScale,this.region?(this._distanceToCamera=this.region.distanceToCamera(e),r=this.tileset.geometryErrorScale):this._distanceToCamera=e.camera.distanceToBoundingSphere(this.boundingSphere),this.range=M.default.computeRange(this._distanceToCamera,this.boundingSphere.radius*r,e),this._visible=this.range>this.minRange),this._visible}},{key:"visit",value:function(r,n){if(this.frameNumber!=r.frameNumber&&this.computeVisibility(r),this._visible){var i=this.tileset;if(this._timeStamp=i._currentTimeStamp,this.rangeList&&0<this.rangeList.length){var e=this.rangeList[1];if(!(this.range>e[0]&&this.range<=e[1]))return this.state==E.default.READY?n.pushRendering(this):n.pushPending(this)}var a=0<this.children.length;this.children.forEach(function(e){if(e._timeStamp=i._currentTimeStamp,e.state!==E.default.READY)return a=!1,n.pushPending(e);var t=!0;e.hasEmbedLOD&&e.children.forEach(function(e){e.state!==E.default.READY&&(t=!1,n.pushPending(e))}),t?e.visit(r,n):a=!1}),a||(this.state==E.default.READY?n.pushRendering(this):n.pushPending(this))}this.frameNumber=r.frameNumber}},{key:"render",value:function(t,e,r,n,i){var a,o,s,u,l=this;if(this.ready){var c=this.queue;if(this._currentTimeStamp=Date.now(),t.frameNumber!=this.frameNumber){if(this.modelMatrixNeedsUpdate&&(p.Object3D.traverse(this,function(e){f(e)}),this.modelMatrixNeedsUpdate=!1),this.computeVisibility(t),!this._visible)return;this._shouldRaiseTileLoaded&&Cesium.requestAnimationFrame(function(){l.tileLoaded.raiseEvent(l),l._shouldRaiseTileLoaded=!1}),this._initialized||(a=t,o=r,s=i,u=n,(d=this).children.forEach(function(e){e.content.traverse(function(e){var t=e.material;t&&((t=t.map)&&o._textures.get(t,a),o._webglRenderItems.getAndUpdate(e,a,!1,s,u))}),e.state=E.default.READY}),d._initialized=!0),c.init(),this.children.forEach(function(e){e.visit(t,c)}),c.sortPendings();var d=c.shiftPending();d&&function(e,t,r,n,i){var a,o=e.state,s=e.tileset,u=r._textures,l=r._webglRenderItems;if(o==E.default.UNLOADED||o==E.default.EXPIRED){if(a=s._lodLoading){if(a==e)return;a._abortController.abort(),a=null}(s._lodLoading=e).requestTile().then(function(){s._lodLoading=null}).otherwise(function(e){console.warn("Failed to load tile:"+tileToLoad.uri),console.error(e),s._lodLoading=null})}else(a=s._lodInitializing)||(a=(s._lodInitializing=e).content,o==E.default.LOADED?(e.state=E.default.TEXTRURE_INITIALIZING,a.traverse(function(e){e=e.material;e&&e.map&&(e=e.map,u.get(e,t))}),Cesium.requestAnimationFrame(function(){e.state=E.default.TEXTRURE_INITIALIZED,s._lodInitializing=null})):o==E.default.TEXTRURE_INITIALIZED&&(e.state=E.default.RENDER_ITEM_INITIALIZING,a.traverse(function(e){e.geometry&&e.material&&l.getAndUpdate(e,t,!1,i,n)}),Cesium.requestAnimationFrame(function(){e.state=E.default.READY,s._shouldRaiseTileLoaded=!0,s._lodInitializing=null})))}(d,t,r,n,i)}this._memorySize>this.maximumMemorySize&&this.unload(),c.getRenderList(e),this.frameNumber=t.frameNumber}}},{key:"unload",value:function(){var t,r=this,e=this.tileset;if(e){this.hasEmbedLOD&&(t=!0,this.children.forEach(function(e){e._timeStamp==r.tileset._currentTimeStamp&&(t=!1)}),t&&(this.children.forEach(function(e){e.unload()}),this._isExpired=!0,this._loading=!1,this.state=E.default.EXPIRED));var n=this.content;n&&(e.visualizer.remove(n,!0),(0,y.releaseResources)(n),n.osgRoot&&(h.traverse(n.osgRoot,function(e){"Osg::Geometry"==e.Type&&destroyObject(e)}),delete n.osgRoot),this.content=null,this._osgBuffer=null,this._isExpired=!0,this._loading=!1,this.state=E.default.EXPIRED,0<e._memorySize&&(e._memorySize-=this._contentMemorySize),this._contentMemorySize=0)}else for(var i=this.queue.getExpiredList().splice(0);0<i.length;)i.pop().unload()}},{key:"destroy",value:function(){var t=Cesium.destroyObject;return p.Object3D.traverse(this.children,function(e){e.unload(),e.osgRoot&&h.traverse(e.osgRoot,function(e){"Osg::Geometry"==e.Type&&t(e)})}),this._renderList&&this._renderList.splice(0),this.boundingSphere=null,this.localBoundingSphere=null,this.aabb=null,this.aabbLocal=null,this.obb=null,this.obbLocal=null,this.region=null,this.visualizer.remove(this,!0),this.visualizer=null,t(this)}},{key:"isCommandsReady",value:function(){if(!this.tileset)return!1;if(this.state!==E.default.READY)return!1;var e=this.content,t=void 0;return p.Object3D.traverse(e,function(e){0!=t&&e.isMesh&&e.visible&&(null==t&&(t=!0),(e=e.renderItems)?e.forEach(function(e){e.loaded||(t=!1)}):t=!1)}),t}},{key:"selectTileLoaded",value:(i=function(e){return selectTileLoaded(this,e)},O.toString=function(){return i.toString()},O)},{key:"transform",get:function(){return this._transform},set:function(e){this.center&&!Cesium.Matrix4.equals(e,this._transform)&&(this._transform=e,this.modelMatrixNeedsUpdate=!0)}}],[{key:"updatePositionClamped",value:function(e,t,r,n){return(0,w.updatePositionClamped)(e,t,r,n)}}]),A);function A(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,e));t.isPagedLOD=!0,t.isEmbedLOD=!!e.isEmbedLOD,t.hasEmbedLOD=!!e.hasEmbedLOD,t.uri=e.uri,t.path=o.Path.GetDirectoryName(t.uri),t.debugVolume=e.debugVolume,t.showDebugVolume=e.showDebugVolume,t.rangeDataList=e.rangeDataList||[],t.rangeList=e.rangeList||[],t.minRange=e.minRange||8,t.boundingSphere=null,t.localBoundingSphere=null,t.aabb=null,t.aabbLocal=null,t.obb=null,t.obbLocal=null,t.region=null,t.state=E.default.UNLOADED,t.manager=e.manager;var r,n=Cesium;return t.uri.toLowerCase().endsWith(".xml")?(t.onInitProgress=e.onInitProgress,t.ext=e.ext||"osgb",t.dataDir=e.dataDir||"/Data",t.tilePattern=e.tilePattern||"Tile_+{x}_+{y}",t.metadata={},t.minX=e.minX||0,t.maxX=e.maxX||8,t.minY=e.minY||0,t.maxY=e.maxY||8,r=n.Matrix4,t._transform=e.transform||r.IDENTITY.clone(),t._srsTransform=r.IDENTITY.clone(),t._srsMatrix=r.IDENTITY.clone(),t._computedTransform=r.IDENTITY.clone(),t.modelMatrix=r.IDENTITY.clone(),t.modelMatrixNeedsUpdate=!0,t._memorySize=0,t.geometryErrorScale=e.geometryErrorScale||.75,t.maximumMemorySize=e.maximumMemorySize||524288e3,t.tileLoaded=new n.Event,t._shouldRaiseTileLoaded=!1,t.queue=new S.default(t),t.loadMetaData()):(t.parent=e.parent,t.root=e.root,t.tileId=e.tileId,t.tileset=e.tileset,t._timeStamp=Date.now(),t._contentMemorySize=0),t.loader=e.loader||new v.default(t.manager),t.fileLoader=new THREE.FileLoader(t.manager),t.children=e.children||[],t.ready=!1,t.readyPromise=n.when.defer(),t}function O(e){return i.apply(this,arguments)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=C},{W_429:13,"3_421":15,e_417:22,M_424:25,"3_437":27,M_432:42,W_477:72,__439:164,e_91:166,W_29:169,i_473:170,__471:188,s_466:190,s_476:197,e_478:199,i_479:200}],199:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(r){var t=[],n=[],i=[],a=[],o=0;this.init=function(){i.length=0,n.length=0,t.length=0,o=0,a.length=0},this.getExpiredList=function(){return r.children.forEach(function(e){s.Object3D.traverse(e.children,function(e){e._loading&&!e.content||!e.uri.endsWith(r.ext)||e._timeStamp==r._currentTimeStamp||i.push(e)})}),i},this.sortPendings=function(){n.sort(function(e,t){return(e=(e.parent||e)._distanceToCamera)-(t=(t.parent||t)._distanceToCamera)})},this.shiftPending=function(){return n.shift()},this.pushDebugging=function(e){a.push(e)},this.pushPending=function(e){var t=e.state;e._timeStamp=r._currentTimeStamp,e.isEmbedLOD&&(t==u.default.UNLOADED||t==u.default.EXPIRED)||t==u.default.LOADING||t==u.default.RENDER_ITEM_INITIALIZING||t==u.default.TEXTRURE_INITIALIZING||n.push(e)},this.pushRendering=function(e){e._timeStamp=r._currentTimeStamp,t.push(e),o+=e._contentMemorySize},this.getRenderList=function(n){t.forEach(function(e){var t=e.content,r=e.debugVolume,e=e.showDebugVolume;t&&n.push(t),e&&r&&r.isObject3D&&(r.frustumCulled=!1,n.push(r))})},Object.defineProperties(this,{memeryRendering:{get:function(){return o}},debuggingList:{get:function(){return a}},renderList:{get:function(){return t}},pendingList:{get:function(){return n}},expiredList:{get:function(){return getExpiredList()}}})};var s=e("M_424"),e=e("i_479"),u=e&&e.__esModule?e:{default:e}},{M_424:25,i_479:200}],200:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default={UNLOADED:0,LOADING:1,LOADED:2,TEXTRURE_INITIALIZING:3,TEXTRURE_INITIALIZED:4,RENDER_ITEM_INITIALIZING:5,READY:7,EXPIRED:8,ERROR:9}},{}],201:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var r=e.content;return r&&e.loader&&!r._model&&(e._loading||-1==t.indexOf(e)&&t.push(e),1)}Object.defineProperty(r,"__esModule",{value:!0});var i=function(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e},a=n(e("d_454")),m=e("M_424"),s=n(e("e_462")),o=e("M_432"),u=e("d_486"),g=n(e("i_431")),l=e("s_476"),i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s.default),i(c,[{key:"selectTileLoaded",value:function(e){return(0,l.selectTileLoaded)(this,e)}},{key:"isCommandsReady",value:function(){var e=void 0;if(!this.content&&!this.contentSet.length)return!1;if(this.content)e=this.content.isObject3D?this.content:this.content._model;else if(this.contentSet.length)return!0;if(e){var t=void 0;return m.Object3D.traverse(e,function(e){0!=t&&e.isMesh&&e.visible&&(null==t&&(t=!0),(e=e.renderItems)?e.forEach(function(e){e.loaded||(t=!1)}):t=!1)}),t}return!1}},{key:"setContentSet",value:function(e){for(var t=this,r=function(e){return e instanceof s.default||(e.modelMatrix=e.modelMatrix||t.modelMatrix,e.rtcCenter=e.rtcCenter||t.rtcCenter,e.debugVolume=t.debugVolume,e.showDebugVolume=t.showDebugVolume,e=new s.default(e)),e},n=0;n<e.contain.length;n++){var i=e.contain[n];e.contain[n]=r(i)}for(var a=0;a<e.intersect.length;a++){var o=e.intersect[a];e.intersect[a]=r(o)}this._contentSet=e}},{key:"visit",value:function(n,i,a,o){if(this.frameNumber!=n.frameNumber&&this.computeVisibility(n),this._visible){if(i.maxLevel=Math.max(this.level,i.maxLevel),i.visitTimes++,p(this,a))return void(this.frameNumber=n.frameNumber);var e,t=0<this.children.length,s=!1;t&&(e=this.children[0].minRange,t=this.range>=e),t&&(s=!0,this.children.forEach(function(e){var t,r=n.cullingVolume.computeVisibility(e.boundingSphereWC);-1!=r&&(e.visibility=r,e._visible=!0,e.computeRange(n),e.frameNumber=n.frameNumber,e.visit(n,i,a,o),t=e.content,r=e.contentSet,t&&!t.isObject3D?t._model?t._model._ready?e.isCommandsReady()||(s=!1):(s=!1,o.push(e)):s=!1:r&&r.length&&(r.ready||(s=!1)))})),s&&"ADD"!=this.refine||(this.content&&this.content._model&&!this.content._model._ready?o.push(this):(this.content&&!this._commandsReady&&(this._commandsReady=!0,this.root&&(this.root._needsRaiseTileLoaded=!0)),i.push(this)))}this.frameNumber=n.frameNumber}},{key:"render",value:function(a,t){var o=this;if(this.ready&&this.show){var e=Cesium,s=e.when,r=e.requestAnimationFrame,u=e.Color;this._needsRaiseTileLoaded=!1;var l=this._cacheRenderList||[];if(a.frameNumber!=this.frameNumber){if(l.splice(0),this.computeVisibility(a),this.frameNumber=a.frameNumber,!this._visible)return;this._currentTimeStamp=Date.now();var n,i,c,d=[],f=[],h=[];d.maxLevel=this.level,d.visitTimes=0,this.children.forEach(function(e){e._timeStamp=o._currentTimeStamp,e.visit(a,d,f,h)}),d.sort(function(e,t){return e._distanceToCamera-t._distanceToCamera}),d.forEach(function(t){var e,r,n,i;0!=t.show&&(t.debugVolume&&o.showDebugVolume&&(t.debugVolume.frustumCulled=!1,o.debugVolumeColor&&(r=(e=t.debugVolume.material.uniforms).defaultColor.value,Object.isExtensible(r)?u.clone(o.debugVolumeColor,r):e.defaultColor.value=o.debugVolumeColor),l.push(t.debugVolume)),!t.content&&0==t.contentSet.length||(t._timeStamp=o._currentTimeStamp,t.contentProvider?t._contentRequested?t.content&&l.push(t.content):o._contentRequesting||(o._contentRequesting=!0,n=t.contentProvider.requestContent(t.contentSet,o.rtcCenter),s(n,function(e){m.Object3D.traverse(e,function(e){e.frustumCulled=!1,e.isMesh&&o.rtcCenter&&(e.uniformMapLoadedCallback=o.uniformMapLoadedCallback)}),t.content=e,o._contentRequesting=!1}),t._contentRequested=!0):t.content&&((n=t.content).isObject3D?l.push(n):n._model?n._model._ready?l.push(n._model):-1==h.indexOf(t)&&h.push(t):p(t,f)),i=t.contentSet,0==o.generateLOD&&i&&0<i.length&&(i.ready=!0,i.contain.forEach(function(e){e.content&&!e.content._ready&&(e._distanceToCamera=a.camera.distanceToBoundingSphere(o.boundingSphereWC),i.ready=!1,h.push(e))}),i.intersect.forEach(function(e){e.debugVolume&&(e.debugVolume.material.defaultColor=u.RED),e.content&&!e.content._ready&&(e._distanceToCamera=a.camera.distanceToBoundingSphere(e.boundingSphereWC),i.ready=!1,h.push(e))}),i.ready&&(i.contain.forEach(function(e){e.debugVolume&&(e.debugVolume.material.defaultColor=u.CYAN),e.content&&e.render(a,l)}),i.intersect.forEach(function(e){e.debugVolume&&(e.debugVolume.material.defaultColor=u.RED),e.content&&e.render(a,l)})))))}),f&&0<f.length&&!this._loading&&(this._loading=!0,f.sort(function(e,t){return e._distanceToCamera-t._distanceToCamera}),(n=f.shift())._timeStamp=this._currentTimeStamp,this.imageCache=this.imageCache||{},this.texturesByUrl=this.texturesByUrl||{},i=this.imageCache[n.level],c=this.texturesByUrl[n.level],i||(this.imageCache[n.level]=i={}),n._loadContent(i,c).then(function(){o._memorySize+=n._contentMemorySize,n._timeStamp=o._currentTimeStamp,r(function(){o._loading=!1})})),0<h.length&&!this._texureCreating&&(0!=this.generateLOD&&h.sort(function(e,t){return(e=(e.parent||e)._distanceToCamera)-(t=(t.parent||t)._distanceToCamera)}),i=(e=h.shift()).content._model||e.content,c=this.visualizer._textureCache,e._timeStamp=this._currentTimeStamp,this._cacheTextureIds=this._cacheTextureIds||[],e=0==this.generateLOD?"":"L"+e.level+"_",i._ready=g.default.initTexture(a,i.mesh||i,c,this._cacheTextureIds,e,this.maximumTextureSize,this.maxMipmapSize),this._texureCreating=!0,r(function(){o._texureCreating=!1})),this._memorySize>this.maximumMemorySize&&this.unload()}l.forEach(function(e){t.push(e)}),this._cacheRenderList=l,this._needsRaiseTileLoaded&&r(function(){o.tileLoaded.raiseEvent(o)})}}},{key:"_loadContent",value:function(i,a){var o=this;return this._loading=!0,new Promise(function(t,r){var e=o.loader,n=o.content;o.uri=n.uri,e.load(n.uri,function(e){n._model=e,o._contentMemorySize=e._memorySize,e.traverse(function(e){e.isMesh&&((Array.isArray(e.material)?e.material:[e.material]).forEach(function(e){e.autoRefresh=!1,e.transparent&&(o.alphaTest&&0<o.alphaTest?e.alphaTest=o.alphaTest:(o.translucent||o.root.translucent)&&(e.translucent=!0))}),e.pickObject={id:o,mesh:e,primitive:o}),e.frustumCulled=!1,e.matrixAutoUpdate=!1,e.modelMatrixNeedsUpdate=!1,e.modelMatrix=o.modelMatrix}),o._loading=!1,t(e)},void 0,function(e){o._loading=!1,console.error(e),r(e)},{loadTexture:!0,imageCache:i,textureCache:a})})}},{key:"unload",value:function(){var e,t,r=this;if(0!=this.level)this.content&&this.content._model&&(e=this.root.visualizer,t=this.content._model,e.remove(t,!0),(0,o.releaseResources)(t),delete this.content._model),this._isExpired=!0,this._loading=!1;else{var n=[];this.children.forEach(function(e){m.Object3D.traverse(e.children,function(e){!e._loading&&e.content&&e.content._model&&e._timeStamp!=r._currentTimeStamp&&n.push(e)})}),n.sort(function(e,t){return t._timeStamp/t._distanceToCamera-e._timeStamp/t._distanceToCamera});var i=n.splice(0);do{var a=i.pop()}while((a.unload(),0<this._memorySize)&&(this._memorySize-=a._contentMemorySize,0<i.length))}}},{key:"destroy",value:function(){var r=Cesium.destroyObject,n=this.visualizer;return this._cacheRenderList&&this._cacheRenderList.splice(0),m.Object3D.traverse(this.children,function(e){var t;e._contentSet&&e._contentSet.contain.splice(0)&&e._contentSet.intersect,e._contentSet=null,e.debugVolume&&(e.debugVolume=e.debugVolume.destroy&&e.debugVolume.destroy()),e.content&&(t=e.content._model||e.content,n&&n.remove(t,!0),(0,o.releaseResources)(t),e.content=t.destroy&&t.destroy()),delete e.contentProvider,delete e.boundingVolume,delete e.visualizer,delete e.uniformMapLoadedCallback,r(e)}),n&&n.remove(this,!0),this._cacheTextureIds&&n&&(this._cacheTextureIds.forEach(function(e){var t=n._textureCache[e];t&&(t.isDestroyed&&t.isDestroyed()||t.destroy(),delete n._textureCache[e])}),this._cacheTextureIds=null),this.children.splice(0),this._contentSet&&this._contentSet.contain.splice(0)&&this._contentSet.intersect,this._contentSet=null,this.visualizer=null,this.imageCache=null,r(this)}},{key:"toJSON",value:function(){var t={boundingVolume:{box:a.default.packBoundingBox(this.boundingBox),sphere:a.default.packBoundingSphere(this.boundingSphere)},children:[],level:this.level,content:this.content,contentSet:this.contentSet,minRange:this.minRange,refine:this.refine};return this.children.forEach(function(e){((e=e.toJSON()).parent=t).children.push(e)}),t}},{key:"contentSet",get:function(){return this._contentSet},set:function(e){this.setContentSet(e)}}],[{key:"updatePositionClamped",value:function(e,t,r,n){return(0,l.updatePositionClamped)(e,t,r,n)}},{key:"load",value:function(t){var r=this,n=t.url,e=t.manager;t.rangePower=t.rangePower||4;var i=THREE.LoaderUtils.extractUrlBase(n);i&&0<i.length&&!i.endsWith("/")&&(i+="/");var a=new c({modelMatrix:t.modelMatrix,maximumMemorySize:t.maximumMemorySize,alphaTest:t.alphaTest,level:0,maxMipmapSize:t.maxMipmapSize,maximumTextureSize:t.maximumTextureSize,translucent:t.translucent});return a.ready=!1,new THREE.FileLoader(e).load(n,function(e){e=JSON.parse(e);r.fromJSON(e,t,a),a.uri=n,m.Object3D.traverse(a,function(e){e.content&&e.content.uri&&(e.content.uri=i+e.content.uri),t.minRange&&(e.minRange=t.minRange*Math.pow(t.rangePower,e.level))}),a.ready=!0,a.readyPromise.resolve(a)},void 0,function(e){a.readyPromise.reject(e)}),a}},{key:"fromJSON",value:function(e,t,r){var n=t.loader;n||(n=new u.VISMLoader(t.manager),t.dracoDecoderPath&&n.setDracoDecoderPath(t.dracoDecoderPath),t.loader=n);n={modelMatrix:t.modelMatrix,boundingVolume:e.boundingVolume,content:e.content,level:e.level,minRange:e.minRange,refine:e.refine||t.refine,debugVolume:!!t.debugVolume,showDebugVolume:!!t.showDebugVolume,alphaTest:t.alphaTest,maximumMemorySize:t.maximumMemorySize};return r?r.init(n):r=new c(n),r.loader=t.loader,this.createChildren(r,e.children,r,t),r}},{key:"createChildren",value:function(r,e,n,i){var a=this;r.children=e.map(function(e){var t=new c({modelMatrix:i.modelMatrix,boundingVolume:e.boundingVolume,content:e.content,level:e.level,debugVolume:!!i.debugVolume,showDebugVolume:!!i.showDebugVolume,refine:e.refine||i.refine,minRange:e.minRange,alphaTest:i.alphaTest});return t.loader=i.loader,t.root=n,t.parent=r,e.children&&e.children.length&&a.createChildren(t,e.children,n,i),t})}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e)),r=Cesium,n=r.defaultValue,i=r.when,r=r.Event;return t.ready=!0,t.show=n(e.show,!0),t.readyPromise=i.defer(),t.maximumTextureSize=e.maximumTextureSize,t.maxMipmapSize=n(e.maxMipmapSize,1024),t.isQuadtreeLOD=!0,t.tileLoaded=new r,t.children=[],t.level=e.level||0,t.maxLevel=e.maxLevel,t._contentSet={contain:[],intersect:[],length:0},e.contentSet&&(t.contentSet=e.contentSet),t.refine=e.refine||"ADD",t.rangeMode=e.rangeMode||"PIXEL_SIZE_ON_SCREEN",t.parent=e.parent,t.root=e.root,t.translucent=n(e.translucent,!1),t.alphaTest=0,"number"==typeof e.alphaTest&&(t.alphaTest=e.alphaTest),t._memorySize=0,t.maximumMemorySize=e.maximumMemorySize||209715200,t}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=i},{M_424:25,M_432:42,i_431:53,d_486:189,s_476:197,d_454:202,e_462:203}],202:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){o=o||new THREE.Box3,l=l||new THREE.Box3,o.min.copy(e.minimum||e.min),o.max.copy(e.maximum||e.max),l.min.copy(t.minimum||t.min),l.max.copy(t.maximum||t.max)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e},s=n(e("e_414")),u=e("e_30"),m=n(e("M_456")),o=void n(e("e_462")),l=void 0,a=(a(c,null,[{key:"computeBoundingVolume",value:function(e){var t=Cesium,r=t.BoundingSphere,n=t.AxisAlignedBoundingBox,i=t.Cartesian3,a=t.Matrix4;e.updateMatrixWorld(!0);var o=[];e.updateMatrixWorld(),e.traverse(function(t){if(t.isMesh){var e=t.geometry.getAttribute("position");e&&e.count,e=e.array;try{(e=i.unpackArray(e)).forEach(function(e){a.multiplyByPoint(t.matrixWorld.elements,e,e),o.push(e)})}catch(t){console.error(t)}}});t=n.fromPoints(o),e=r.fromPoints(o),n=t.center,r=[];return i.pack(n,r,0),i.pack(t.minimum,r,3),i.pack(t.maximum,r,6),{sphere:[e.center.x,e.center.y,e.center.z,e.radius],box:r}}},{key:"computeLODPower",value:function(e){var t=Cesium.Cartesian3,r=e.geometry,n=(n=r.attributes.position).array||n.values;r.boundingBox||r.computeBoundingBox();var i=r.boundingBox,a=i.min.x,o=i.min.y,e=i.max.x,n=i.max.y,i=new t(a,n,0),a=new t(a,o,0),o=new t(e,o,0),e=new t(e,n,0),n=0;n+=(0,u.computeArea)(i,a,o),n+=(0,u.computeArea)(i,o,e);r=s.default.computeSurfaceArea(r);return r*(r/n)}},{key:"packBoundingRegion",value:function(e,t,r){return r=r||0,t=t||[],Cesium.Rectangle.pack(e.rectangle,r),t[r+4]=e.minimumHeight,t[r+5]=e.maximumHeight,t}},{key:"unpackBoundingRegion",value:function(e,t){var r=Cesium,n=r.Rectangle;return new r.TileBoundingRegion({rectangle:n.unpack(e,t=t||0),minimumHeight:e[t+4],maximumHeight:e[t+5]})}},{key:"packBoundingBox",value:function(e,t,r){r=r||0,t=t||[];var n=Cesium.Cartesian3;return n.pack(e.center,t,r),n.pack(e.minimum,t,r+3),n.pack(e.maximum,t,r+6),t}},{key:"unpackBoundingBox",value:function(e,t,r){t=t||0;var n=Cesium,i=n.Cartesian3,n=n.AxisAlignedBoundingBox;return r=r||new n,i.unpack(e,t,r.center),i.unpack(e,t+3,r.minimum),i.unpack(e,t+6,r.maximum),r}},{key:"packBoundingSphere",value:function(e,t,r){return r=r||0,t=t||[],Cesium.Cartesian3.pack(e.center,t,r),t[r+3]=e.radius,t}},{key:"unpackBoundingSphere",value:function(e,t,r){t=t||0;var n=Cesium,i=n.Cartesian3,n=n.BoundingSphere;return r=r||new n,i.unpack(e,t,r.center),r.radius=e[t+3],r}},{key:"splitBoundingVolume",value:function(e,t,r,n){var i=[],a=void 0,o=void 0;if(e.box&&(a=this.splitBoundingBox(e.box,t,r,n)),e.region&&(o=this.splitBoundingRegion(e.region,t,r,n)),a||o)for(var s=(o||a).length,u=0;u<s;u++){var l={};o&&(l.region=o[u]),a&&(l.box=a[u]),i.push(l)}return i}},{key:"splitBoundingBox",value:function(e,t,r,n){for(var i=Cesium,a=i.Cartesian3,o=i.AxisAlignedBoundingBox,s=[],u=a.subtract(e.maximum,e.minimum,new a),l=[x=new a(0,0,0),M=new a(0,0,0)],c=1/(t=t||2),d=1/(r=r||2),f=1/(n=n||1),h=0;h<t;h++)for(var p=h*c,m=(h+1)*c,g=0;g<r;g++)for(var _=g*d,v=(g+1)*d,y=0;y<n;y++){var b=(y+1)*f,x=a.fromElements(p,_,y*f,x);x=a.multiplyComponents(u,x,x),x=a.add(e.minimum,x,x),M=a.fromElements(m,v,b,M),M=a.multiplyComponents(u,M,M);var M=a.add(e.minimum,M,M),b=o.fromPoints(l);s.push(b)}return s}},{key:"splitBoundingRegion",value:function(e,t,r,n){for(var i=Cesium,a=i.Rectangle,o=i.TileBoundingRegion,i=e.rectangle,s=i.west,u=i.south,l=i.width,c=i.height,i=e.maximumHeight,d=e.minimumHeight,f=i-d,h=[],p=1/(t=t||2),m=1/(r=r||2),g=1/(n=n||1),_=0;_<t;_++)for(var v=_*p*l,y=(_+1)*p*l,b=0;b<r;b++)for(var x=b*m*c,M=(b+1)*m*c,w=0;w<n;w++){var T=w*g*f,S=(w+1)*g*f,S=new o({rectangle:new a(s+v,u+x,s+y,u+M),minimumHeight:d+T,maximumHeight:d+S});h.push(S)}return h}},{key:"boxContains",value:function(e,t){return i(e,t),o.containsBox(l)}},{key:"boxIntersect",value:function(e,t){i(e,t);t=o.intersect(l);return!t.isEmpty()}},{key:"regionContains",value:function(e,t){var r=e.rectangle,n=t.rectangle,i=e.minimumHeight-t.minimumHeight,t=e.maximumHeight-t.maximumHeight;return r.west-n.west<=0&&0<=r.east-n.east&&r.south-n.south<=0&&0<=r.north-n.north&&(i<=0&&0<=t)}},{key:"regionIntersect",value:function(e,t){var r=e.rectangle,n=t.rectangle,i=e.maximumHeight-t.minimumHeight,e=t.maximumHeight-e.minimumHeight;return 0<i&&0<e&&!!Cesium.Rectangle.intersection(r,n)}},{key:"filterContents",value:function(t,n,r,i,a,o){var s,e,u,l,c=this;i=i||2,r=void 0===r||r,0!=n.level?(s={contain:new Array,intersect:new Array,length:0},(e=n.minRadius)||(a||((a=t.maxRaius||0)||(t.forEach(function(e){a=Math.max(e.boundingVolume.sphere.radius,a)}),t.maxRaius=a),a=Math.min(a,n.boundingVolume.sphere.radius),t.maxRaius=a),e=a/Math.pow(i,n.maxLevel)*Math.pow(i,n.maxLevel-n.level),n.minRadius=n.level==n.maxLevel?0:e),t.forEach(function(e){var t,r;n.region&&e.boundingVolume.region?(r=e.boundingVolume.region,t=n.region,c.regionContains(t,r)?(s.contain.push(e),s.length++):c.regionIntersect(t,r)&&(s.intersect.push(e),s.length++)):(t=e.boundingVolume.box,r=n.boundingBox,c.boxContains(r,t)?(s.contain.push(e),s.length++):c.boxIntersect(r,t)&&(s.intersect.push(e),s.length++))}),u=(n.contentSet=s).contain.concat(s.intersect),r?n.children.forEach(function(e){c.filterContents(u,e,i,r,a||t.maxRaius,o)}):(u.maxRaius=a,n._getContentSetBeforeFilter=function(){return u}),n.parent&&"ADD"==n.parent.refine&&(o=o||function(e,t){return!((t=t.boundingVolume.sphere.radius)<=n.minRadius||n.parent&&t>=n.parent.minRadius)},l={contain:[],intersect:[],length:0},s.contain.forEach(function(e){o(n,e)&&(l.contain.push(e),l.length++)}),s.intersect.forEach(function(e){o(n,e)&&(l.intersect.push(e),l.length++)}),n.contentSet=l)):n.children.forEach(function(e){c.filterContents(t,e,i,r,a,o)})}},{key:"createLODTree",value:function(r,n,i,a,o,s,u,l,c,d,f){var h=this,p=r.level+1;n<p||(o=o||1/0,this.splitBoundingVolume(r.boundingVolume,1==p?s:2,1==p?u:2,l&&1==p?l:1).forEach(function(e){var t=new m.default({parent:r,boundingVolume:e,level:p,minRange:i*Math.pow(4,p-1),debugVolumeColor:d,debugVolume:c,showDebugVolume:f,modelMatrix:r.modelMatrix,rtcCenter:r.rtcCenter,maxLevel:n});a?h.createLODTree(t,n,i,a,o,s,u,l,c,d,f):t._createLODTreeDelay=function(e){h.createLODTree(t,n,i,e=void 0!==e&&e,o,s,u,l,c,d,f)},r.children.push(t)}))}},{key:"create",value:function(e){var t=e.rootBoundingVolume,r=e.maxLevel,n=e.zSliceLevel,i=e.minRange,a=e.debugVolume,o=e.showDebugVolume,s=e.debugVolumeColor||Cesium.Color.YELLOW,u=e.modelMatrix,l=e.rtcCenter,c=void 0===e.recursive||e.recursive,l=new m.default({boundingVolume:t,level:0,debugVolumeColor:s,debugVolume:a,showDebugVolume:o,minRange:i,modelMatrix:u,rtcCenter:l,maxLevel:r,maximumTextureSize:e.maximumTextureSize});return this.createLODTree(l,r,i,c,n,e.xSize,e.ySize,e.zSize||2,a,s,o),l}},{key:"fromJSON",value:function(e,i){i=i||{};var t=new m.default(Object.assign(i,e));return function r(n,e){e.children.forEach(function(e){var t=new m.default(Object.assign(i,e));t.parent=n,r(t,e),n.children.push(t)})}(t,e),t}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=a},{e_414:11,e_30:171,M_456:201,e_462:203}],203:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d,n=function(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e},l=e("3_421"),c=e("e_417"),i=e("W_429"),a=(e("M_424"),e("e_497"),e("d_454")),s=a&&a.__esModule?a:{default:a},u=e("s_476"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,i.IRenderable),n(o,[{key:"init",value:function(e){var t=Cesium,r=t.defaultValue,n=t.Matrix4,i=t.AxisAlignedBoundingBox,t=t.BoundingSphere;this.minRange=e.minRange||4,this.boundingVolume=e.boundingVolume,this.uri=e.uri,this.contentProvider=e.contentProvider,this.frustumCulled=r(e.frustumCulled,!0),this.debugVolume=r(e.debugVolume,!0),this.showDebugVolume=r(e.showDebugVolume,!0),this.modelMatrixNeedsUpdate=!0,this._modelMatrix=null,this.rtcCenter=e.rtcCenter,this.content=e.content||null;var a,o,l,c,r=this.boundingVolume;r.box&&Array.isArray(this.boundingVolume.box)&&(a=r.box,r.box=s.default.unpackBoundingBox(a)),r.region&&Array.isArray(r.region)&&(a=r.region,r.region=s.default.unpackBoundingRegion(a)),r.sphere&&Array.isArray(r.sphere)&&(o=r.sphere,r.sphere=s.default.unpackBoundingSphere(o),r.sphereWC=t.clone(r.sphere)),r.box&&!r.region&&e.modelMatrix&&(r.region=(0,u.boundingBoxToRegion)(r.box,e.modelMatrix)),r.sphere?r.sphereWC=t.clone(r.sphere):r.box?(o=[(o=r.box).minimum,o.maximum],r.sphere=t.fromPoints(o),r.sphereWC=t.clone(r.sphere)):r.region&&(r.sphere=r.region.boundingSphere,r.sphereWC=r.region.boundingSphere),r.boxWC=i.clone(this.boundingVolume.box),this.modelMatrix=e.modelMatrix||n.IDENTITY.clone(),this.geometricError=r.sphere.radius,this.rtcCenter&&(c=void 0,(l=this).uniformMapLoadedCallback=function(e,t,r){var n,i,a,o,s,u;c||(n=t.context.uniformState,i=l,t=Cesium,a=t.Matrix4,o=t.defined,s=t.Cartesian3,u=new a,d=d||new a,c=function(){return o(i.rtcCenter)?(a.getTranslation(n.model,d),s.add(d,i.rtcCenter,d),a.multiplyByPoint(n.view,d,d),a.setTranslation(n.modelView,d,u)):n.modelView}),e.modelView=c,e.u_modelView=c,e.modelViewMatrix=c,e.u_modelViewMatrix=c}),this.debugVolume&&this.createDebugVolume(e.debugVolumeColor)}},{key:"createDebugVolume",value:function(e){var t=Cesium,r=t.RectangleOutlineGeometry,n=t.Ellipsoid,i=t.BoxOutlineGeometry,a=t.Color,t=void 0;if(t=this.region&&this.rtcCenter?new r({rectangle:this.region.rectangle,height:this.region.minimumHeight,extrudedHeight:this.region.maximumHeight,ellipsoid:n.WGS84}):i.fromAxisAlignedBoundingBox(this.boundingBox),this.rtcCenter)for(var o=this.rtcCenter,s=(t=t.constructor.createGeometry(t)).attributes.position.values,u=0;u<s.length;u+=3)s[u]-=o.x,s[u+1]-=o.y,s[u+2]-=o.z;a=new c.MeshMaterial({defaultColor:a.clone(e||a.CYAN),wireframe:!0}),a=new l.Mesh(t,a);a.pickObject={id:this,mesh:this,primitive:this.root||this},a.frustumCulled=!1,this.region&&this.rtcCenter&&(a.modelMatrixNeedsUpdate=!1),a.uniformMapLoadedCallback=this.uniformMapLoadedCallback,this.debugVolume=a}},{key:"computeRange",value:function(e,t){var r=Cesium,n=r.defaultValue(t,1),t=e.camera,n=e.context.drawingBufferHeight*n;this._distanceToCamera=t.distanceToBoundingSphere(this.boundingSphereWC);r=Math.max(this._distanceToCamera,r.Math.EPSILON7),t=t.frustum.sseDenominator,t=this.geometricError*n/(r*t);return t/=e.pixelRatio,this.range=t}},{key:"computeVisibility",value:function(e){var t;return Cesium.Intersect,this._visible=!0,this.frustumCulled&&(1!=(t=(t=this.parent)&&t.visibility)&&(t=e.cullingVolume.computeVisibility(this.boundingSphereWC)),this.visibility=t,this._visible=-1!=t),this._visible&&(this.range=this.computeRange(e),this._visible=this.range>=this.minRange),this._visible}},{key:"render",value:function(e,t){var r,n=this;this.frameNumber!=e.frameNumber&&this.computeVisibility(e)&&(this.debugVolume&&this.showDebugVolume&&(this.debugVolume.frustumCulled=!1,t.push(this.debugVolume)),this.uri&&this.contentProvider&&!this._contentRequested?(r=this.contentProvider.requestContent(this.uri,this.rtcCenter),Cesium.when(r,function(e){n.rtcCenter&&!e.uniformMapLoadedCallback&&(e.uniformMapLoadedCallback=n.uniformMapLoadedCallback),e.frustumCulled=!1,n.content=e}),this._contentRequested=!0):this.content&&(this.content.isObject3D?(this.content.matrixAutoUpdate&&this.content.updateMatrixWorld(),t.push(this.content)):this.content.mesh&&t.push(this.content.mesh)),this.modelMatrixNeedsUpdate=!1,this.frameNumber=e.frameNumber)}},{key:"boundingSphere",get:function(){return this.boundingVolume.sphere}},{key:"boundingBox",get:function(){return this.boundingVolume.box}},{key:"boundingSphereWC",get:function(){return this.boundingVolume.sphereWC}},{key:"boundingBoxWC",get:function(){return this.boundingVolume.boxWC}},{key:"region",get:function(){return this.boundingVolume.region}},{key:"modelMatrix",set:function(e){var t,r;e&&(t=(r=Cesium).Matrix4,r=r.BoundingSphere,e=e.elements||e,t.equals(e,this._modelMatrix)||(this._modelMatrix=t.clone(e,this._modelMatrix),this.boundingBoxWC&&t.multiplyByPoint(this.modelMatrix,this.boundingBox.center,this.boundingBoxWC.center),this.region&&r.equals(this.boundingSphereWC,this.region.boundingSphere)||t.multiplyByPoint(this.modelMatrix,this.boundingSphere.center,this.boundingSphereWC.center),this.modelMatrixNeedsUpdate=!0))},get:function(){return this._modelMatrix}}]),o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return t.minRange=null,t.boundingVolume=null,t.uri=null,t.contentProvider=null,t.frustumCulled=null,t.debugVolume=null,t.showDebugVolume=null,t.modelMatrixNeedsUpdate=!0,t._modelMatrix=null,t.rtcCenter=null,t.content=e.content||null,e.boundingVolume&&t.init(e),t}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.default=n},{W_429:13,"3_421":15,e_417:22,M_424:25,e_497:196,s_476:197,d_454:202}],204:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this._queue=[],this._loadingTiles=new Map,this._loadingCount=0,this.maxLoadingCount=e||1,this.workFuncName=t||"requestTile",this.deferredList=[],this.immediateList=[]}r.TaskList=(n(a,[{key:"add",value:function(e){this.has(e)||this._queue.push(e)}},{key:"has",value:function(e){return this._loadingTiles.has(e.tileId)||-1!=this._queue.indexOf(e)}},{key:"remove",value:function(e){if(this._loadingTiles.has(e.tileId)&&this._loadingTiles.delete(e.tileId),-1!=this._queue.indexOf(e))for(var t=0;t<this.length;t++)if(this._queue[t]==e)return this._queue.splice(t,1)}},{key:"update",value:function(e){var t=this;if(0<this.length&&this._loadingCount<this.maxLoadingCount){var r=[],n=[];this._queue.forEach(function(e){(0==e.visibility?r:n).push(e)});var i=0<n.length?n:r;if((0!=n.length||!e)&&(i.sort(function(e,t){return e._distanceToCamera&&t._distanceToCamera?e._distanceToCamera-t._distanceToCamera:1==e.visibility&&0==t.visibility?-1:0==e.visibility&&1==t.visibility?1:e.parent&&t.parent?e._distanceToCamera-t.parent._distanceToCamera:t.priority-e.priority}),this.deferredList=r,this.immediateList=n,0!=i.length)){var a=i.shift();return this._loadingTiles.set(a.tileId,a),Cesium.when(a[this.workFuncName](),function(){e?Cesium.requestAnimationFrame(function(){t._loadingCount--}):t._loadingCount--,t._loadingTiles.delete(a.tileId)},function(e){console.warn("tile "+a.tileId+"  load failed."),t._loadingCount--,t._loadingTiles.delete(a.tileId)}),this._loadingCount++,this._queue=n.concat(r),console.log(this.workFuncName,this._queue.length),!0}}}},{key:"length",get:function(){return this._queue.length+this.immediateList.length+this.deferredList.length}}]),a)},{}],205:[function(e,t,r){"use strict";function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}function s(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(l[n>>18&63]+l[n>>12&63]+l[n>>6&63]+l[63&n]);return i.join("")}r.byteLength=function(e){var e=(t=u(e))[0],t=t[1];return 3*(e+t)/4-t},r.toByteArray=function(e){for(var t,r=(n=u(e))[0],n=n[1],i=new d(3*(r+n)/4-n),a=0,o=0<n?r-4:r,s=0;s<o;s+=4)t=c[e.charCodeAt(s)]<<18|c[e.charCodeAt(s+1)]<<12|c[e.charCodeAt(s+2)]<<6|c[e.charCodeAt(s+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=255&t;return 2===n&&(t=c[e.charCodeAt(s)]<<2|c[e.charCodeAt(s+1)]>>4,i[a++]=255&t),1===n&&(t=c[e.charCodeAt(s)]<<10|c[e.charCodeAt(s+1)]<<4|c[e.charCodeAt(s+2)]>>2,i[a++]=t>>8&255,i[a++]=255&t),i},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],a=0,o=r-n;a<o;a+=16383)i.push(s(e,a,o<a+16383?o:a+16383));return 1==n?(t=e[r-1],i.push(l[t>>2]+l[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+"=")),i.join("")};for(var l=[],c=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)l[i]=n[i],c[n.charCodeAt(i)]=i;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],206:[function(e,t,P){!function(d){"use strict";function i(e){if(A<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=d.prototype,e}function d(e,t,r){if("number"!=typeof e)return n(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return o(e)}function n(e,t,r){if("string"==typeof e)return function(e,t){if(!d.isEncoding(t="string"!=typeof t||""===t?"utf8":t))throw new TypeError("Unknown encoding: "+t);var r=0|l(e,t),n=i(r),t=n.write(e,t);return n=t!==r?n.slice(0,t):n}(e,t);if(ArrayBuffer.isView(e))return s(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(T(e,ArrayBuffer)||e&&T(e.buffer,ArrayBuffer))return function(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');return(r=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=d.prototype,r}(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return d.from(n,t,r);n=function(e){if(d.isBuffer(e)){var t=0|u(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||S(e.length)?i(0):s(e):"Buffer"===e.type&&Array.isArray(e.data)?s(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function o(e){return a(e),i(e<0?0:0|u(e))}function s(e){for(var t=e.length<0?0:0|u(e.length),r=i(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function u(e){if(A<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return 0|e}function l(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||T(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(e).length;default:if(i)return n?-1:x(e).length;t=(""+t).toLowerCase(),i=!0}}function t(e,t,r){var n,i,a,o=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!r||r<0||n<r)&&(r=n);for(var i="",a=t=!t||t<0?0:t;a<r;++a)i+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[a]);return i}(this,t,r);case"utf8":case"utf-8":return m(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":return n=this,a=r,0===(i=t)&&a===n.length?E.fromByteArray(n):E.fromByteArray(n.slice(i,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}(this,t,r);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function r(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function c(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=S(r=+r)?i?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=d.from(t,n)),d.isBuffer(t))return 0===t.length?-1:f(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):f(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function f(e,t,r,n,i){function a(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s/=o=2,u/=2,r/=2}if(i)for(var l=-1,c=r;c<s;c++)if(a(e,c)===a(t,-1===l?0:c-l)){if(c-(l=-1===l?c:l)+1===u)return l*o}else-1!==l&&(c-=c-l),l=-1;else for(c=r=s<r+u?s-u:r;0<=c;c--){for(var d=!0,f=0;f<u;f++)if(a(e,c+f)!==a(t,f)){d=!1;break}if(d)return c}return-1}function h(e,t,r,n){return w(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function p(e,t,r,n){return w(function(e,t){for(var r,n,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,n=n%256,i.push(n),i.push(r);return i}(t,e.length-r),e,r,n)}function m(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a,o,s,u,l=e[i],c=null,d=239<l?4:223<l?3:191<l?2:1;if(i+d<=r)switch(d){case 1:l<128&&(c=l);break;case 2:128==(192&(a=e[i+1]))&&127<(u=(31&l)<<6|63&a)&&(c=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&2047<(u=(15&l)<<12|(63&a)<<6|63&o)&&(u<55296||57343<u)&&(c=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)&&u<1114112&&(c=u)}null===c?(c=65533,d=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=d}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}function g(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function _(e,t,r,n,i,a){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function v(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function y(e,t,r,n,i){return t=+t,r>>>=0,i||v(e,0,r,4),C.write(e,t,r,n,23,4),r+4}function b(e,t,r,n,i){return t=+t,r>>>=0,i||v(e,0,r,8),C.write(e,t,r,n,52,8),r+8}function x(e,t){t=t||1/0;for(var r,n=e.length,i=null,a=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&a.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,r<128){if(--t<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function M(e){return E.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function w(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function T(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function S(e){return e!=e}var E=e("base64-js"),C=e("ieee754");P.Buffer=d,P.SlowBuffer=function(e){return d.alloc(+(e=+e!=e?0:e))},P.INSPECT_MAX_BYTES=50;var A=2147483647;P.kMaxLength=A,(d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=n,d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,d.alloc=function(e,t,r){return t=t,r=r,a(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)},d.allocUnsafe=o,d.allocUnsafeSlow=o,d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(T(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),T(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var r=d.allocUnsafe(t),n=0,i=0;i<e.length;++i){var a=e[i];if(T(a,Uint8Array)&&(a=d.from(a)),!d.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,n),n+=a.length}return r},d.byteLength=l,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)r(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)r(this,t,t+3),r(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)r(this,t,t+7),r(this,t+1,t+6),r(this,t+2,t+5),r(this,t+3,t+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?m(this,0,e):t.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=P.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},d.prototype.compare=function(e,t,r,n,i){if(T(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=t)return 0;if(i<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(n,i),l=e.slice(t,r),c=0;c<s;++c)if(u[c]!==l[c]){a=u[c],o=l[c];break}return a<o?-1:o<a?1:0},d.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},d.prototype.indexOf=function(e,t,r){return c(this,e,t,r,!0)},d.prototype.lastIndexOf=function(e,t,r){return c(this,e,t,r,!1)},d.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||i<r)&&(r=i),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var a,o,s,u=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var i=e.length-r;(!n||(n=Number(n))>i)&&(n=i),(i=t.length)/2<n&&(n=i/2);for(var a=0;a<n;++a){var o=parseInt(t.substr(2*a,2),16);if(S(o))return a;e[r+a]=o}return a}(this,e,t,r);case"utf8":case"utf-8":return o=t,s=r,w(x(e,(a=this).length-o),a,o,s);case"ascii":return h(this,e,t,r);case"latin1":case"binary":return h(this,e,t,r);case"base64":return a=this,o=t,s=r,w(M(e),a,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p(this,e,t,r);default:if(u)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),u=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;d.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e);t=this.subarray(e,t);return t.__proto__=d.prototype,t},d.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},d.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},d.prototype.readUInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*t)),n},d.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var n=t,i=1,a=this[e+--n];0<n&&(i*=256);)a+=this[e+--n]*i;return(i*=128)<=a&&(a-=Math.pow(2,8*t)),a},d.prototype.readInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||g(e,2,this.length);e=this[e]|this[e+1]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt16BE=function(e,t){e>>>=0,t||g(e,2,this.length);e=this[e+1]|this[e]<<8;return 32768&e?4294901760|e:e},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return e>>>=0,t||g(e,4,this.length),C.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||g(e,4,this.length),C.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||g(e,8,this.length),C.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||g(e,8,this.length),C.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},d.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||_(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+r},d.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||_(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=0,a=1,o=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},d.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||_(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=r-1,a=1,o=0;for(this[t+i]=255&e;0<=--i&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},d.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},d.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeFloatLE=function(e,t,r){return y(this,e,t,!0,r)},d.prototype.writeFloatBE=function(e,t,r){return y(this,e,t,!1,r)},d.prototype.writeDoubleLE=function(e,t,r){return b(this,e,t,!0,r)},d.prototype.writeDoubleBE=function(e,t,r){return b(this,e,t,!1,r)},d.prototype.copy=function(e,t,r,n){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var i=(n=e.length-t<n-r?e.length-t+r:n)-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var a=i-1;0<=a;--a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},d.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!d.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i;1===e.length&&(i=e.charCodeAt(0),("utf8"===n&&i<128||"latin1"===n)&&(e=i))}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(a=t;a<r;++a)this[a]=e;else{var o=d.isBuffer(e)?e:d.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=o[a%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g}.call(this,e("buffer").Buffer)},{"base64-js":205,buffer:206,ieee754:207}],207:[function(e,t,r){r.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,d=r?i-1:0,f=r?-1:1,r=e[t+d];for(d+=f,a=r&(1<<-c)-1,r>>=-c,c+=s;0<c;a=256*a+e[t+d],d+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;0<c;o=256*o+e[t+d],d+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(r?-1:1);o+=Math.pow(2,n),a-=l}return(r?-1:1)*o*Math.pow(2,a-n)},r.write=function(e,t,r,n,i,a){var o,s,u=8*a-i-1,l=(1<<u)-1,c=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,h=n?1:-1,a=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+c?d/n:d*Math.pow(2,1-c))*n&&(o++,n/=2),l<=o+c?(s=0,o=l):1<=o+c?(s=(t*n-1)*Math.pow(2,i),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,i),o=0));8<=i;e[r+f]=255&s,f+=h,s/=256,i-=8);for(o=o<<i|s,u+=i;0<u;e[r+f]=255&o,f+=h,o/=256,u-=8);e[r+f-h]|=128*a}},{}]},{},[1])(1)});var{GeometricPointLights,VectorPolylineGeometry,LineGlowMaterial,VectorPolygonGeometry,PostProcessLib,MeshPhongMaterial,MeshMaterial,Mesh,Object3D,author,CameraUtils,RendererUtils,initCesium,readRenderTarget,GeometryUtils,MeshVisModel,GroundLineVisualizer,PagedLOD,QuadtreeLODUtil,QuadtreeLOD,BuildingVector3DLoader,ExtrudeGradientMaterial}=CesiumMeshVisualizerDemo;export{GeometricPointLights,VectorPolylineGeometry,LineGlowMaterial,VectorPolygonGeometry,PostProcessLib,MeshPhongMaterial,MeshMaterial,Mesh,Object3D,author,CameraUtils,RendererUtils,initCesium,readRenderTarget,GeometryUtils,MeshVisModel,GroundLineVisualizer,PagedLOD,QuadtreeLODUtil,QuadtreeLOD,BuildingVector3DLoader,ExtrudeGradientMaterial};